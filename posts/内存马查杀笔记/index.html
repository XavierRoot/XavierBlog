<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>å†…å­˜é©¬æŸ¥æ€ç¬”è®°-å…¥é—¨ç‰ˆ - Xavier&#39;s Blog</title><meta name="author" content="Xavier">
<meta name="description" content="æœ¬æ–‡ä»¥å“¥æ–¯æ‹‰ä¸ºä¾‹ä¸»è¦è®²è§£å¯¹Filterç±»å’ŒServletç±»çš„æ’æŸ¥å¤„ç½®"><meta name="keywords" content=''>
  <meta itemprop="name" content="å†…å­˜é©¬æŸ¥æ€ç¬”è®°-å…¥é—¨ç‰ˆ">
  <meta itemprop="description" content="æœ¬æ–‡ä»¥å“¥æ–¯æ‹‰ä¸ºä¾‹ä¸»è¦è®²è§£å¯¹Filterç±»å’ŒServletç±»çš„æ’æŸ¥å¤„ç½®">
  <meta itemprop="datePublished" content="2025-06-25T00:00:00+00:00">
  <meta itemprop="dateModified" content="2025-06-25T00:00:00+00:00">
  <meta itemprop="wordCount" content="4292">
  <meta itemprop="keywords" content=""><meta property="og:url" content="http://localhost:1313/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/">
  <meta property="og:site_name" content="Xavier&#39;s Blog">
  <meta property="og:title" content="å†…å­˜é©¬æŸ¥æ€ç¬”è®°-å…¥é—¨ç‰ˆ">
  <meta property="og:description" content="æœ¬æ–‡ä»¥å“¥æ–¯æ‹‰ä¸ºä¾‹ä¸»è¦è®²è§£å¯¹Filterç±»å’ŒServletç±»çš„æ’æŸ¥å¤„ç½®">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-06-25T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-06-25T00:00:00+00:00">
    <meta property="article:tag" content="BlueTeam">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="å†…å­˜é©¬æŸ¥æ€ç¬”è®°-å…¥é—¨ç‰ˆ">
  <meta name="twitter:description" content="æœ¬æ–‡ä»¥å“¥æ–¯æ‹‰ä¸ºä¾‹ä¸»è¦è®²è§£å¯¹Filterç±»å’ŒServletç±»çš„æ’æŸ¥å¤„ç½®">
<meta name="application-name" content="Xavier&#39;s Blog">
<meta name="apple-mobile-web-app-title" content="Xavier&#39;s Blog"><meta name="theme-color" data-light="#f8f8f8" data-dark="#252627" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" type="text/html" href="http://localhost:1313/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/" title="å†…å­˜é©¬æŸ¥æ€ç¬”è®°-å…¥é—¨ç‰ˆ - Xavier&#39;s Blog" /><link rel="prev" type="text/html" href="http://localhost:1313/posts/arl_setup_record/" title="ARLç¯å¡”Dockerç‰ˆæ­å»ºè®°å½•" /><link rel="next" type="text/html" href="http://localhost:1313/test/" title="Test" /><link rel="alternate" type="text/markdown" href="http://localhost:1313/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/index.md" title="å†…å­˜é©¬æŸ¥æ€ç¬”è®°-å…¥é—¨ç‰ˆ - Xavier's Blog"><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "å†…å­˜é©¬æŸ¥æ€ç¬”è®°-å…¥é—¨ç‰ˆ",
    "inLanguage": "en",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "http:\/\/localhost:1313\/posts\/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0\/"
    },"genre": "posts","keywords": "BlueTeam","wordcount":  4292 ,
    "url": "http:\/\/localhost:1313\/posts\/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0\/","datePublished": "2025-06-25T00:00:00+00:00","dateModified": "2025-06-25T00:00:00+00:00","publisher": {
      "@type": "Organization",
      "name": ""},"author": {
        "@type": "Person",
        "name": "Xavier"
      },"description": "æœ¬æ–‡ä»¥å“¥æ–¯æ‹‰ä¸ºä¾‹ä¸»è¦è®²è§£å¯¹Filterç±»å’ŒServletç±»çš„æ’æŸ¥å¤„ç½®"
  }
  </script><script src="/js/head/color-scheme.min.js"></script></head>
  <body data-header-desktop="sticky" data-header-mobile="auto"><div class="wrapper" data-page-style="normal"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper">
    <div class="header-title">
      <a href="/" title="Xavier&#39;s Blog"><span class="header-title-text">Xavier&#39;s Blog</span></a><span class="header-subtitle">ä¸€ä¸ªå®‰å…¨å·¥ä½œè€…</span></div>
    <nav>
      <ul class="menu"><li class="menu-item">
              <a class="menu-link" href="/posts/"><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden="true"></i> Posts</a></li><li class="menu-item">
              <a class="menu-link" href="/categories/"><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden="true"></i> Categories</a></li><li class="menu-item">
              <a class="menu-link" href="/tags/"><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> Tags</a></li><li class="menu-item">
              <a class="menu-link" href="/friends/"><i class="fa-solid fa-user-group fa-fw fa-sm" aria-hidden="true"></i> Friends</a></li><li class="menu-item">
              <a class="menu-link" href="/tools/"><i class="fa-solid fa-screwdriver-wrench fa-fw fa-sm" aria-hidden="true"></i> Tools</a></li><li class="menu-item">
              <a class="menu-link" href="/about/"><i class="fa-solid fa-circle-info fa-fw fa-sm" aria-hidden="true"></i> About</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id="search-desktop">
            <input type="text" placeholder="æœç´¢æ–‡ç« æ ‡é¢˜æˆ–å†…å®¹â€¦â€¦" id="search-input-desktop">
            <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="æœç´¢">
              <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
            </a>
            <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="æ¸…ç©º">
              <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
            </a>
            <span class="search-button search-loading" id="search-loading-desktop">
              <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
            </span>
          </li><li class="menu-item theme-switch" title="åˆ‡æ¢ä¸»é¢˜">
          <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
        </li></ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/" title="Xavier&#39;s Blog"><span class="header-title-text">Xavier&#39;s Blog</span></a><span class="header-subtitle">ä¸€ä¸ªå®‰å…¨å·¥ä½œè€…</span></div>
      <div class="menu-toggle" id="menu-toggle-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li class="search-wrapper">
            <div class="search mobile" id="search-mobile">
              <input type="text" placeholder="æœç´¢æ–‡ç« æ ‡é¢˜æˆ–å†…å®¹â€¦â€¦" id="search-input-mobile">
              <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="æœç´¢">
                <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
              </a>
              <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="æ¸…ç©º">
                <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
              </a>
              <span class="search-button search-loading" id="search-loading-mobile">
                <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
              </span>
            </div>
            <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
              å–æ¶ˆ
            </a>
          </li><li class="menu-item"><a class="menu-link" href="/posts/"><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden="true"></i> Posts</a></li><li class="menu-item"><a class="menu-link" href="/categories/"><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden="true"></i> Categories</a></li><li class="menu-item"><a class="menu-link" href="/tags/"><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> Tags</a></li><li class="menu-item"><a class="menu-link" href="/friends/"><i class="fa-solid fa-user-group fa-fw fa-sm" aria-hidden="true"></i> Friends</a></li><li class="menu-item"><a class="menu-link" href="/tools/"><i class="fa-solid fa-screwdriver-wrench fa-fw fa-sm" aria-hidden="true"></i> Tools</a></li><li class="menu-item"><a class="menu-link" href="/about/"><i class="fa-solid fa-circle-info fa-fw fa-sm" aria-hidden="true"></i> About</a></li><li class="menu-item menu-system">
          <span class="menu-system-item theme-switch" title="åˆ‡æ¢ä¸»é¢˜"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></span></li>
      </ul>
    </nav>
  </div>
</header><div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
  </div>
  <div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
  </div><main class="container"><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label="åˆé›†"></aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX"><span>å†…å­˜é©¬æŸ¥æ€ç¬”è®°-å…¥é—¨ç‰ˆ</span>
      </h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><span class="author"><img loading="lazy" src="/resource/friends/me.png" alt="Xavier" data-title="Xavier" width="20" height="20" class="avatar" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/>&nbsp;Xavier</span></span><span class="post-included-in">&nbsp;æ”¶å½•äº <a href="/categories/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/" class="post-category" title="åˆ†ç±» - åº”æ€¥å“åº”"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> åº”æ€¥å“åº”</a></span></div><div class="post-meta-line"><span title="å‘å¸ƒäº 2025-06-25 00:00:00"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden="true"></i><time datetime="2025-06-25">2025-06-25</time></span>&nbsp;<span title="4292 å­—"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden="true"></i>çº¦ 4300 å­—</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden="true"></i>é¢„è®¡é˜…è¯» 9 åˆ†é’Ÿ</span>&nbsp;</div>
    </div><div class="details toc" id="toc-static" data-kept="false">
        <div class="details-summary toc-title">
          <span>ç›®å½•</span>
          <span><i class="details-icon fa-solid fa-angle-right" aria-hidden="true"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#ç®€è¿°">ç®€è¿°</a></li>
    <li><a href="#ç¯å¢ƒå‡†å¤‡">ç¯å¢ƒå‡†å¤‡</a></li>
    <li><a href="#æŸ¥æ€æ€è·¯">æŸ¥æ€æ€è·¯</a></li>
    <li><a href="#æŸ¥æ€æ£€æµ‹å·¥å…·">æŸ¥æ€æ£€æµ‹å·¥å…·</a>
      <ul>
        <li><a href="#java-memshell-scanner">java-memshell-scanner</a></li>
        <li><a href="#arthas">Arthas</a>
          <ul>
            <li><a href="#å¸¸ç”¨å‘½ä»¤"><strong>å¸¸ç”¨å‘½ä»¤</strong></a></li>
          </ul>
        </li>
        <li><a href="#å…¶ä»–å·¥å…·">å…¶ä»–å·¥å…·</a></li>
      </ul>
    </li>
    <li><a href="#æ¡ˆä¾‹-å“¥æ–¯æ‹‰å†…å­˜é©¬">æ¡ˆä¾‹-å“¥æ–¯æ‹‰å†…å­˜é©¬</a>
      <ul>
        <li><a href="#æ³¨å…¥å†…å­˜é©¬">æ³¨å…¥å†…å­˜é©¬</a></li>
        <li><a href="#java-memshell-scanneræ’æŸ¥">java-memshell-scanneræ’æŸ¥</a></li>
        <li><a href="#arthasæ’æŸ¥">Arthasæ’æŸ¥</a></li>
        <li><a href="#æ¸…é™¤å†…å­˜é©¬">æ¸…é™¤å†…å­˜é©¬</a></li>
      </ul>
    </li>
    <li><a href="#å‚è€ƒæ–‡çŒ®">å‚è€ƒæ–‡çŒ®</a></li>
    <li><a href="#æ–‡ä»¶å±æ€§">æ–‡ä»¶å±æ€§</a></li>
  </ul>
</nav></div>
      </div><div class="content" id="content" data-end-flag="It&#39;s end."><h2 id="ç®€è¿°" class="heading-element"><span>ç®€è¿°</span>
  <a href="#%e7%ae%80%e8%bf%b0" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>å¤§å‹æ´¾å¯¹æ´»åŠ¨åœ¨å³ï¼Œå¯èƒ½ä¼šé‡åˆ°å†…å­˜é©¬åœºæ™¯ï¼Œæœ¬ç¯‡å†™ç»™å¯¹Javaä¸ç†Ÿæ‚‰çš„æœ‹å‹ï¼Œä¸ä¼šæ¶‰åŠå¾ˆå¤šæŠ€æœ¯ç»†èŠ‚ã€‚</p>
<p><strong>å†…å­˜é©¬å†å²</strong>ï¼š</p>
<p>å†…å­˜é©¬å†å²ä¹Ÿå¾ˆå¤šå¹´äº†ï¼Œç½‘ä¸Šæ–‡ç« ä¹Ÿå¾ˆå¤šï¼Œæ€»æœ‰èƒ½å¸®åŠ©åˆ°ä½ çš„ã€‚</p>
<blockquote>
<p>å…¶å®å†…å­˜é©¬ç”±æ¥å·²ä¹…ï¼Œæ—©åœ¨17å¹´n1ntyå¸ˆå‚…çš„<a href="https://mp.weixin.qq.com/s/x4pxmeqC1DvRi9AdxZ-0Lw"target="_blank" rel="external nofollow noopener noreferrer">ã€ŠTomcatæºç è°ƒè¯•ç¬”è®°-çœ‹ä¸è§çš„shellã€‹</a>ä¸­å·²åˆè§ç«¯å€ªï¼Œä½†ä¸€ç›´ä¸æ¸©ä¸ç«ã€‚
åç»è¿‡rebeyongå¸ˆå‚…ä½¿ç”¨<a href="https://www.cnblogs.com/rebeyond/p/9686213.html"target="_blank" rel="external nofollow noopener noreferrer">agentæŠ€æœ¯</a>åŠ æŒåï¼Œæ‹“å±•äº†å†…å­˜é©¬çš„ä½¿ç”¨åœºæ™¯ï¼Œç„¶ç»ˆåœç•™åœ¨å¥‡æŠ€æ·«å·§ä¸Šã€‚
åœ¨å„ç±»hwæ´—ç¤¼ä¹‹åï¼Œæ–‡ä»¶shellæ˜æ˜¾æ°”æ•°å·²å°½ã€‚å†…å­˜é©¬ä»¥æ•‘å‘½ç¨»è‰çš„èº«ä»½é‡å›å¤§ä¼—è§†é‡ã€‚</p>
<p>ç‰¹åˆ«æ˜¯ä»Šå¹´ï¼ˆ2020ï¼‰åœ¨shiroçš„å›æ˜¾ç ”ç©¶ä¹‹åï¼Œå¼•å‘äº†æ— æ•°å®‰å…¨ç ”ç©¶å‘˜å¯¹å†…å­˜webshellçš„ç ”ç©¶ï¼Œå…¶ä¸­æ¶Œç°å‡ºäº†LandGreyå¸ˆå‚…æ„é€ çš„<a href="https://landgrey.me/blog/12/"target="_blank" rel="external nofollow noopener noreferrer">Spring controllerå†…å­˜é©¬</a>ã€‚</p>
</blockquote>
<p><strong>å†…å­˜é©¬ç®€è¿°</strong>ï¼š</p>
<p>å¸¸è§„çš„WebshellåŸºäºæ–‡ä»¶ç±»å½¢å¼å­˜åœ¨ï¼Œè€Œå†…å­˜é©¬æ˜¯ä¸€ç§æ— æ–‡ä»¶æ”»å‡»æ‰‹æ®µï¼Œå› æ­¤ä¹Ÿè¢«ç§°ä¸º<strong>ä¸è½åœ°é©¬</strong>æˆ–è€…<strong>æ— æ–‡ä»¶é©¬</strong>ã€‚</p>
<p>å†…å­˜é©¬åœ¨è¯­è¨€ç±»å‹ä¸Šæœ‰PHPå†…å­˜é©¬ï¼ŒPythonå†…å­˜é©¬ï¼Œè€Œæœ¬æ–‡ä¸»è¦ä¾§é‡äºâ€œå¸‚åœºå æœ‰ç‡â€æœ€é«˜çš„javaå†…å­˜é©¬çš„æ£€æµ‹ä¸æŸ¥æ€ï¼Œjavaå†…å­˜é©¬ä¸»è¦åˆ†ä¸ºä¸‰å¤§ç±»å‹ï¼š</p>
<ol>
<li>servlet-apiç±»ï¼šfilterå‹ã€servletå‹ã€listenerå‹</li>
<li>springç±»ï¼šæ‹¦æˆªå™¨ã€controllerå‹</li>
<li>Java Instrumentationç±»ï¼šagentå‹</li>
</ol>
<p><strong>åŸç†ç®€è¿°</strong>ï¼š</p>
<p>Java Servlet çš„å®ç°åŸç†ï¼Œå¦‚ä¸‹å›¾ï¼š</p>
<p><a class="lightgallery" href="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/wps1.png?size=large" data-thumbnail="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/wps1.png?size=small" data-sub-html="<h2>img</h2>"><img loading="lazy" src="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/wps1.png" alt="img" srcset="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/wps1.png?size=small, /posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/wps1.png?size=medium 1.5x, /posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/wps1.png?size=large 2x" data-title="img" style="--width: 1280px;--aspect-ratio: 1280 / 274;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></a></p>
<p>å®¢æˆ·ç«¯å‘èµ·çš„webè¯·æ±‚ä¼šä¾æ¬¡ç»è¿‡Listenerã€Filterã€Servletä¸‰ä¸ªç»„ä»¶ï¼Œè€Œå†…å­˜é©¬åˆ©ç”¨åœ¨è¯·æ±‚è¿‡ç¨‹ä¸­åœ¨å†…å­˜ä¸­ä¿®æ”¹æˆ–åŠ¨æ€æ³¨å†Œæ–°çš„ç»„ä»¶ï¼Œè¾¾åˆ°æ³¨å…¥Webshellçš„ç›®çš„ã€‚</p>
<h2 id="ç¯å¢ƒå‡†å¤‡" class="heading-element"><span>ç¯å¢ƒå‡†å¤‡</span>
  <a href="#%e7%8e%af%e5%a2%83%e5%87%86%e5%a4%87" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>æœ¬æ–‡ä¾§é‡åœ¨å†…å­˜é©¬æŸ¥æ€ï¼Œæˆ‘ä»¬å¯ä»¥å‡†å¤‡ä¸€ä¸ªç®€å•ç¯å¢ƒã€‚</p>
<ul>
<li>Tomcatï¼Œæˆ‘ç”¨çš„æ˜¯ Tomcat 9.0.85</li>
<li>Webshellç®¡ç†å·¥å…·ï¼šå“¥æ–¯æ‹‰ã€å†°è</li>
<li>å†…å­˜é©¬æ’æŸ¥å·¥å…·ï¼š<a href="https://github.com/alibaba/arthas"target="_blank" rel="external nofollow noopener noreferrer">Arthas</a>ã€<a href="https://github.com/c0ny1/java-memshell-scanner"target="_blank" rel="external nofollow noopener noreferrer">java-memshell-scanner</a></li>
</ul>
<p>é¦–å…ˆå¯åŠ¨TomcatæœåŠ¡å™¨</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">â”Œâ”€â”€<span class="o">(</span>xavierğŸ’€X-AQ550M<span class="o">)</span>-<span class="o">[</span>~/CodeSpace/Tomcat/apache-tomcat-9.0.85-2/bin<span class="o">]</span>
</span></span><span class="line"><span class="cl">â””â”€$ chmod +x catalina.sh
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">â”Œâ”€â”€<span class="o">(</span>xavierğŸ’€X-AQ550M<span class="o">)</span>-<span class="o">[</span>~/CodeSpace/Tomcat/apache-tomcat-9.0.85-2/bin<span class="o">]</span>
</span></span><span class="line"><span class="cl">â””â”€$ ./catalina.sh start
</span></span><span class="line"><span class="cl">Using CATALINA_BASE:   /Users/xavier/CodeSpace/Tomcat/apache-tomcat-9.0.85-2
</span></span><span class="line"><span class="cl">Using CATALINA_HOME:   /Users/xavier/CodeSpace/Tomcat/apache-tomcat-9.0.85-2
</span></span><span class="line"><span class="cl">Using CATALINA_TMPDIR: /Users/xavier/CodeSpace/Tomcat/apache-tomcat-9.0.85-2/temp
</span></span><span class="line"><span class="cl">Using JRE_HOME:        /Library/Java/JavaVirtualMachines/jdk-18.0.2.jdk/Contents/Home
</span></span><span class="line"><span class="cl">Using CLASSPATH:       /Users/xavier/CodeSpace/Tomcat/apache-tomcat-9.0.85-2/bin/bootstrap.jar:/Users/xavier/CodeSpace/Tomcat/apache-tomcat-9.0.85-2/bin/tomcat-juli.jar
</span></span><span class="line"><span class="cl">Using CATALINA_OPTS:
</span></span><span class="line"><span class="cl">Tomcat started.</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="æŸ¥æ€æ€è·¯" class="heading-element"><span>æŸ¥æ€æ€è·¯</span>
  <a href="#%e6%9f%a5%e6%9d%80%e6%80%9d%e8%b7%af" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>æˆ‘ä»¬éœ€è¦äº†è§£çš„æ˜¯å¦‚ä½•å»å¿«é€Ÿç¡®è®¤å†…å­˜é©¬æ˜¯å¦å­˜åœ¨ï¼Œå¦‚ä½•ç¡®å®šå…¶ä½ç½®ï¼Œå¦‚ä½•è¿›è¡Œæ¸…é™¤ã€‚</p>
<p>æ¶ˆæ¯æ¥æºï¼šä¸ºä»€ä¹ˆæ€€ç–‘æœ‰å†…å­˜é©¬ï¼Œé€šå¸¸æ˜¯ä»¥ä¸‹é›†ä¸­æƒ…å†µï¼š</p>
<ul>
<li>æµé‡è®¾å¤‡çš„å†…å­˜é©¬å‘Šè­¦ï¼Œæœ‰å…·ä½“è¯·æ±‚çš„uriå¯ä»¥è¾…åŠ©åé¢æ’æŸ¥</li>
<li>ä¸»æœºé˜²æŠ¤çš„å¯ç–‘å‘½ä»¤å‘Šè­¦ï¼Œ</li>
<li>æœåŠ¡å™¨çªç„¶è¿›è¡Œæ¨ªå‘æ”»å‡»æ‰«æ</li>
<li>å…¶ä»–äººå·¥ä¸ŠæŠ¥ï¼šæ¯”å¦‚æœåŠ¡å™¨æ€§èƒ½å¼‚å¸¸ï¼ŒæŸäº›æ¥å£è®¿é—®å¼‚å¸¸ç­‰ã€‚</li>
</ul>
<p>æ’æŸ¥æ€è·¯ï¼š</p>
<ol>
<li>å¼„æ¸…æ¥šå½“å‰ç¯å¢ƒçš„æœåŠ¡æ¶æ„ï¼šä¸­é—´ä»¶ã€ç»„ä»¶ã€æ¡†æ¶ç­‰</li>
<li><strong>æ—¥å¿—æ’æŸ¥</strong>ï¼šæ’æŸ¥æœåŠ¡å™¨webæ—¥å¿—ï¼ŒæŸ¥çœ‹æ˜¯å¦æœ‰å¯ç–‘çš„webè®¿é—®æ—¥å¿—ï¼Œæ¯”å¦‚æœ‰å¤§é‡è¯·æ±‚URLè·¯å¾„ç›¸åŒä½†å‚æ•°ä¸åŒçš„ï¼Œæˆ–è€…é¡µé¢ä¸å­˜åœ¨ä½†æ˜¯è¿”å›200çš„è¯·æ±‚ï¼Œæˆ–è€…åŒä¸€ä¸ªURLè¯·æ±‚æœ‰å¤§é‡è®¿é—®è®°å½•ä¸º500ç­‰ç­‰ã€‚</li>
<li><strong>ä¸­é—´ä»¶æ’æŸ¥</strong>ï¼šå¦‚æœwebæ—¥å¿—æœªå‘ç°å¼‚å¸¸ï¼Œå¯ä»¥æ’æŸ¥æ˜¯å¦ä¸ºä¸­é—´ä»¶æ¼æ´å¯¼è‡´ä»£ç æ‰§è¡Œæ³¨å…¥å†…å­˜é©¬ï¼Œæ’æŸ¥ä¸­é—´ä»¶çš„error.logæ—¥å¿—æŸ¥çœ‹æ˜¯å¦æœ‰å¯ç–‘çš„æŠ¥é”™ï¼Œæ ¹æ®æ³¨å…¥æ—¶é—´å’Œæ–¹æ³•ï¼Œæ ¹æ®ä¸šåŠ¡ä½¿ç”¨çš„ç»„ä»¶æ’æŸ¥æ˜¯å¦å¯èƒ½å­˜åœ¨javaä»£ç æ‰§è¡Œæ¼æ´ä»¥åŠæ˜¯å¦å­˜åœ¨è¿‡webshellï¼Œæ’æŸ¥æ¡†æ¶æ¼æ´ï¼Œååºåˆ—åŒ–æ¼æ´ã€‚</li>
<li>æŸ¥çœ‹æ˜¯å¦æœ‰ç±»ä¼¼å“¥æ–¯æ‹‰ã€å†°èç‰¹å¾çš„urlè¯·æ±‚ï¼Œå“¥æ–¯æ‹‰å’Œå†°èçš„å†…å­˜é©¬æ³¨å…¥æµé‡ç‰¹å¾ä¸æ™®é€šwebshellçš„æµé‡ç‰¹å¾åŸºæœ¬å»åˆã€‚</li>
<li>é€šè¿‡æŸ¥æ‰¾è¿”å›200çš„urlè·¯å¾„å¯¹åº”çš„webç›®å½•ä¸‹æ˜¯å¦çœŸå®å­˜åœ¨æ–‡ä»¶ï¼Œå¦‚ä¸å­˜åœ¨å¤§æ¦‚ç‡ä¸ºå†…å­˜é©¬ã€‚</li>
<li>ä¸Šè¿°æ˜¯å¤§è‡´æ€è·¯ï¼Œæ¥ä¸‹å»è¦è¿›è¡Œå…·ä½“æ’æŸ¥åˆ†æï¼Œå°±éœ€è¦é€‰æ‹©åˆé€‚çš„å·¥å…·è¿›è¡Œåˆ†æã€‚</li>
</ol>
<h2 id="æŸ¥æ€æ£€æµ‹å·¥å…·" class="heading-element"><span>æŸ¥æ€æ£€æµ‹å·¥å…·</span>
  <a href="#%e6%9f%a5%e6%9d%80%e6%a3%80%e6%b5%8b%e5%b7%a5%e5%85%b7" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>æœ¬æ–‡ä¸»è¦è®²è§£ä½¿ç”¨ java-memshell-scannerã€Arthasè¿›è¡Œå†…å­˜é©¬æ’æŸ¥ï¼Œå…¶ä»–çš„å¯è‡ªè¡Œè¯•éªŒã€‚</p>
<p>é¦–å…ˆæˆ‘ä»¬åœ¨ä¸æ³¨å…¥å†…å­˜é©¬çš„æƒ…å†µä¸‹ï¼Œå…ˆä½¿ç”¨å·¥å…·æŸ¥çœ‹ä¸€ä¸‹å½“å‰çŠ¶æ€</p>
<h3 id="java-memshell-scanner" class="heading-element"><span>java-memshell-scanner</span>
  <a href="#java-memshell-scanner" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li><a href="https://github.com/c0ny1/java-memshell-scanner"target="_blank" rel="external nofollow noopener noreferrer">java-memshell-scanner</a>ï¼Œc0ny1å¸ˆå‚…ç¼–å†™çš„jspå†…å­˜é©¬æ£€æµ‹è„šæœ¬ï¼Œé€šè¿‡jspè„šæœ¬æ‰«æå¹¶æŸ¥æ€å„ç±»ä¸­é—´ä»¶å†…å­˜é©¬ï¼Œæ¯” Java agent è¦æ¸©å’Œä¸€äº›ã€‚</li>
</ul>
<p>è¯¥è„šæœ¬çš„ä½¿ç”¨éå¸¸ç®€å•ï¼Œå°† java-memshell-scanner è„šæœ¬æ”¾åœ¨èƒ½è®¿é—®çš„webè·¯å¾„ä¸‹ï¼Œç„¶åç›´æ¥è®¿é—®å°±å¯ä»¥è·å¾—ç»“æœã€‚æ”¯æŒFilterç±»å’ŒServletç±»å†…å­˜é©¬æŸ¥æ€ã€‚</p>
<p>å°†java-memshell-scannerä¸‹çš„tomcat-memshell-scanner.jspå¤åˆ¶åˆ°ç½‘ç«™ç›®å½•ä¸‹ï¼Œ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">â”Œâ”€â”€<span class="o">(</span>xavierğŸ’€X-AQ550M<span class="o">)</span>-<span class="o">[</span>~/â€¦/Tomcat/apache-tomcat-9.0.85-2/webapps/ROOT<span class="o">]</span>
</span></span><span class="line"><span class="cl">â””â”€$ ll
</span></span><span class="line"><span class="cl">total <span class="m">384</span>
</span></span><span class="line"><span class="cl">-rw-r--r--@ <span class="m">1</span> xavier  staff  <span class="m">27530</span>  <span class="m">1</span>  <span class="m">5</span>  <span class="m">2024</span> asf-logo-wide.svg
</span></span><span class="line"><span class="cl">-rw-r--r--@ <span class="m">1</span> xavier  staff    <span class="m">713</span>  <span class="m">1</span>  <span class="m">5</span>  <span class="m">2024</span> bg-button.png
</span></span><span class="line"><span class="cl">-rw-r--r--@ <span class="m">1</span> xavier  staff   <span class="m">1918</span>  <span class="m">1</span>  <span class="m">5</span>  <span class="m">2024</span> bg-middle.png
</span></span><span class="line"><span class="cl">-rw-r--r--@ <span class="m">1</span> xavier  staff   <span class="m">1401</span>  <span class="m">1</span>  <span class="m">5</span>  <span class="m">2024</span> bg-nav.png
</span></span><span class="line"><span class="cl">-rw-r--r--@ <span class="m">1</span> xavier  staff   <span class="m">3103</span>  <span class="m">1</span>  <span class="m">5</span>  <span class="m">2024</span> bg-upper.png
</span></span><span class="line"><span class="cl">-rw-r--r--@ <span class="m">1</span> xavier  staff  <span class="m">21630</span>  <span class="m">1</span>  <span class="m">5</span>  <span class="m">2024</span> favicon.ico
</span></span><span class="line"><span class="cl">-rw-r--r--@ <span class="m">1</span> xavier  staff  <span class="m">12453</span>  <span class="m">1</span>  <span class="m">5</span>  <span class="m">2024</span> index.jsp
</span></span><span class="line"><span class="cl">-rw-r--r--@ <span class="m">1</span> xavier  staff   <span class="m">7075</span>  <span class="m">1</span>  <span class="m">5</span>  <span class="m">2024</span> RELEASE-NOTES.txt
</span></span><span class="line"><span class="cl">-rw-r--r--@ <span class="m">1</span> xavier  staff   <span class="m">1092</span>  <span class="m">6</span> <span class="m">17</span> 23:20 shell01.jsp
</span></span><span class="line"><span class="cl">-rw-rw-r--@ <span class="m">1</span> xavier  staff  <span class="m">16876</span> <span class="m">10</span> <span class="m">13</span>  <span class="m">2020</span> tomcat-memshell-scanner.jsp
</span></span><span class="line"><span class="cl">-rw-r--r--@ <span class="m">1</span> xavier  staff   <span class="m">5895</span>  <span class="m">1</span>  <span class="m">5</span>  <span class="m">2024</span> tomcat.css
</span></span><span class="line"><span class="cl">-rw-r--r--@ <span class="m">1</span> xavier  staff  <span class="m">68761</span>  <span class="m">1</span>  <span class="m">5</span>  <span class="m">2024</span> tomcat.svg
</span></span><span class="line"><span class="cl">drwxr-xr-x@ <span class="m">3</span> xavier  staff     <span class="m">96</span>  <span class="m">1</span>  <span class="m">5</span>  <span class="m">2024</span> WEB-INF</span></span></code></pre></td></tr></table>
</div>
</div><p>é€šè¿‡Webç«¯è¿›è¡Œè®¿é—®ï¼Œå¯ä»¥çœ‹å¾—åªæœ‰é»˜è®¤çš„Tomcat filterå’Œservletã€‚</p>
<p><a class="lightgallery" href="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704171413960.png?size=large" data-thumbnail="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704171413960.png?size=small" data-sub-html="<h2>image-20250704171413960</h2>"><img loading="lazy" src="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704171413960.png" alt="image-20250704171413960" srcset="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704171413960.png?size=small, /posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704171413960.png?size=medium 1.5x, /posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704171413960.png?size=large 2x" data-title="image-20250704171413960" style="--width: 1642px;--aspect-ratio: 1642 / 750;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></a></p>
<h3 id="arthas" class="heading-element"><span>Arthas</span>
  <a href="#arthas" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li><a href="https://github.com/alibaba/arthas"target="_blank" rel="external nofollow noopener noreferrer">Arthas</a>ï¼ŒArthasæ˜¯ä¸€æ¬¾å¼€æºçš„Javaè¯Šæ–­å·¥å…·ï¼ŒåŸºæœ¬ä½¿ç”¨åœºæ™¯æ˜¯å®šä½å¤ç°ä¸€äº›ç”Ÿäº§ç¯å¢ƒæ¯”è¾ƒéš¾ä»¥å®šä½é—®é¢˜ã€‚å¯ä»¥åœ¨çº¿æ’æŸ¥é—®é¢˜ï¼Œä»¥åŠåŠ¨æ€è¿½è¸ªJavaä»£ç ï¼Œå®æ—¶ç›‘æ§JVMçŠ¶æ€ç­‰ç­‰ã€‚</li>
</ul>
<p><strong>å¯åŠ¨</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">java -jar .<span class="se">\a</span>rthas-boot.jar <span class="c1">#javaåº”ç”¨è¿›ç¨‹PID</span></span></span></code></pre></td></tr></table>
</div>
</div><p><a class="lightgallery" href="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704172042048.png?size=large" data-thumbnail="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704172042048.png?size=small" data-sub-html="<h2>image-20250704172042048</h2>"><img loading="lazy" src="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704172042048.png" alt="image-20250704172042048" srcset="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704172042048.png?size=small, /posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704172042048.png?size=medium 1.5x, /posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704172042048.png?size=large 2x" data-title="image-20250704172042048" style="--width: 992px;--aspect-ratio: 992 / 444;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></a></p>
<p>æŸ¥çœ‹å½“å‰çš„Servletã€Filterã€Listener</p>
<p><a class="lightgallery" href="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704172218729.png?size=large" data-thumbnail="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704172218729.png?size=small" data-sub-html="<h2>image-20250704172218729</h2>"><img loading="lazy" src="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704172218729.png" alt="image-20250704172218729" srcset="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704172218729.png?size=small, /posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704172218729.png?size=medium 1.5x, /posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704172218729.png?size=large 2x" data-title="image-20250704172218729" style="--width: 1107px;--aspect-ratio: 1107 / 874;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></a></p>
<p><a class="lightgallery" href="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250710151627116.png?size=large" data-thumbnail="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250710151627116.png?size=small" data-sub-html="<h2>image-20250710151627116</h2>"><img loading="lazy" src="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250710151627116.png" alt="image-20250710151627116" srcset="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250710151627116.png?size=small, /posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250710151627116.png?size=medium 1.5x, /posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250710151627116.png?size=large 2x" data-title="image-20250710151627116" style="--width: 738px;--aspect-ratio: 738 / 558;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></a></p>
<h4 id="å¸¸ç”¨å‘½ä»¤" class="heading-element"><span><strong>å¸¸ç”¨å‘½ä»¤</strong></span>
  <a href="#%e5%b8%b8%e7%94%a8%e5%91%bd%e4%bb%a4" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h4><p>è¾“å…¥Mbean æŸ¥çœ‹æˆ–ç›‘æ§ Mbean çš„å±æ€§ä¿¡æ¯ï¼Œæ ¹æ®å†…å­˜é©¬çš„ç‰¹æ€§ï¼Œè¿›è¡Œç­›é€‰å‡ºå¼‚å¸¸ç»„ä»¶ï¼Œ</p>
<p><strong>1.æŸ¥çœ‹URLè·¯ç”±ï¼ˆçœ‹Servletå†…å­˜é©¬ï¼‰</strong></p>
<blockquote>
<p>å†…å­˜é©¬è®¿é—®è§¦å‘ç‰¹å¾ï¼šURLåœ°å€è·¯å¾„åœ¨æºç ä¸­ä¸å­˜åœ¨</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="o">[</span>arthas@38043<span class="o">]</span>$ mbean <span class="p">|</span> grep <span class="s2">&#34;name=/&#34;</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>arthas@38043<span class="o">]</span>$ mbean <span class="p">|</span> grep Servlet
</span></span><span class="line"><span class="cl"><span class="o">[</span>arthas@38043<span class="o">]</span>$ mbean <span class="p">|</span> grep Filter
</span></span><span class="line"><span class="cl"><span class="o">[</span>arthas@38043<span class="o">]</span>$ mbean <span class="p">|</span> grep Listener</span></span></code></pre></td></tr></table>
</div>
</div><p>æŸ¥çœ‹ Mbean çš„ä¿¡æ¯ï¼ŒæŸ¥çœ‹å¼‚å¸¸Filterã€Servletã€ListenerèŠ‚ç‚¹</p>
<p><strong>2. scæŸ¥çœ‹JVM å·²åŠ è½½çš„ç±»ä¿¡æ¯</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">sc <span class="c1">#(æŸ¥çœ‹JVMå·²åŠ è½½çš„ç±»ä¿¡æ¯)</span>
</span></span><span class="line"><span class="cl">sc xxx.* <span class="c1">#æ¨¡ç³Šæœç´¢ç±»</span>
</span></span><span class="line"><span class="cl">sc *.xxx	<span class="c1">#æ”¯æŒå„ç§ç±»å‹ </span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">sc *.Filter  <span class="c1">#æœç´¢ç¬¦åˆpatternçš„Filter</span>
</span></span><span class="line"><span class="cl">sc *.Servlet 
</span></span><span class="line"><span class="cl">sc *.Listener
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#Springæ¡†æ¶å†…å­˜é©¬</span>
</span></span><span class="line"><span class="cl">sc * <span class="p">|</span> grep Controller
</span></span><span class="line"><span class="cl">sc * <span class="p">|</span> grep Interceptor</span></span></code></pre></td></tr></table>
</div>
</div><p>æ ¹æ®ç±»ååˆ¤æ–­ï¼Œæœç´¢æ˜¯å¦æœ‰ç›¸å…³èµ„æ–™ï¼Œè‹¥æ²¡æœ‰åˆ™ä¸‹è½½å…¶æºç ï¼ŒæŸ¥çœ‹æ˜¯å¦æœ‰åé—¨ï¼Œä¹Ÿå¯ç›´æ¥ä¸Šä¼ å¾®æ­¥åœ¨çº¿</p>
<p>æŸ¥çœ‹æŸç±»åŠ è½½çš„ç±»ä¿¡æ¯</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">sc -d &lt;class_name&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹x.AES_BASE64ç±»åŠ è½½çš„ç±»ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">sc -d payload x.AES_BASE64
</span></span><span class="line"><span class="cl">sc -d org.apache.jsp.tomcat_002dmemshell_002dscanner_jsp</span></span></code></pre></td></tr></table>
</div>
</div><p>åç¼–è¯‘æŒ‡å®šç±»</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">jad --source-only &lt;class_name&gt;
</span></span><span class="line"><span class="cl">jad --source-only org.apache.jsp.memshell_jsp  <span class="c1">#åç¼–è¯‘æŒ‡å®šç±»</span></span></span></code></pre></td></tr></table>
</div>
</div><p>åç¼–è¯‘è¾“å‡ºçš„ç»“æœèƒ½æŸ¥çœ‹åˆ°å†…å­˜é©¬çš„æ¶æ„è¯­å¥</p>
<p>dumpå·²åŠ è½½ç±»çš„å­—èŠ‚ç </p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="c1">#dumpå·²åŠ è½½ç±»çš„bytecodeåˆ°ç‰¹å®šç›®å½•</span>
</span></span><span class="line"><span class="cl">dump org.apache.coyote.type.PlaceholderForType</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="å…¶ä»–å·¥å…·" class="heading-element"><span>å…¶ä»–å·¥å…·</span>
  <a href="#%e5%85%b6%e4%bb%96%e5%b7%a5%e5%85%b7" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ul>
<li><a href="https://github.com/r00t4dm/aLIEz"target="_blank" rel="external nofollow noopener noreferrer">aLIEz</a>ï¼Œå†…å­˜é©¬æŸ¥æ€å·¥å…·ï¼Œé‡‡ç”¨åå°„åŠ¨æ€åŠ è½½JDKä¾èµ–ï¼Œä¸ä¼šç›´æ¥transformerå»æ”¹bytecodeï¼Œ ç°åœ¨æ˜¯ç›´æ¥dumpå‡ºæ¥ä¾èµ–ç ”ç©¶äººå‘˜è‡ªå·±åˆ†æã€‚æ€å„ä¸ªJavaEEå®¹å™¨ã€ä¸­é—´ä»¶çš„å†…å­˜é©¬</li>
<li><a href="https://github.com/LandGrey/copagent"target="_blank" rel="external nofollow noopener noreferrer">copagent</a>ï¼šè‡ªåŠ¨æå–é¡¹ç›® éœ€è¦è‡ªå·±æ’æŸ¥ï¼Œèƒ½æ’æŸ¥å‡ ä¹ä¸»æµå†…å­˜é©¬æŠ€æœ¯</li>
<li><a href="https://github.com/geekmc/FindShell"target="_blank" rel="external nofollow noopener noreferrer">FindShell</a>ï¼šå†…å­˜é©¬æŸ¥æ€å·¥å…·ï¼Œå°¤å…¶é’ˆå¯¹Agentå‹ï¼ŒåŸç†æ˜¯dumpå‡ºJVMå½“å‰çš„classå¹¶è¿›è¡Œå­—èŠ‚ç åˆ†æï¼Œå¹¶åŠ å…¥è‡ªåŠ¨ä¿®å¤çš„åŠŸèƒ½</li>
<li><a href="https://github.com/xyy-ws/NoAgent-memshell-scanner"target="_blank" rel="external nofollow noopener noreferrer">NoAgent-memshell-scanner</a>ï¼ŒNoAgentå†…å­˜é©¬æ£€æµ‹ç¨‹åºï¼Œæ”¯æŒæ£€æµ‹ agentå‹å†…å­˜é©¬ã€tomcat filter/servlet/listener/valveå‹å†…å­˜é©¬ã€spring interceptor,controllerå‹å†…å­˜é©¬ï¼Œæ”¯æŒéagentå‹å†…å­˜é©¬çš„åˆ é™¤åŠŸèƒ½ã€‚</li>
<li><a href="https://github.com/4ra1n/shell-analyzer"target="_blank" rel="external nofollow noopener noreferrer">shell-analyzer</a>ï¼Œä¸€æ¬¾GUIç‰ˆæœ¬çš„å®æ—¶å†…å­˜é©¬æŸ¥æ€å·¥å…·ï¼Œæ”¯æŒæœ¬åœ°æŸ¥æ€ä¸è¿œç¨‹æŸ¥æ€ï¼› ä»…æµ‹è¯•äº†Tomcatè¿™ä¸€ç§ä¸­é—´ä»¶ï¼Œä¸è¿‡ç†è®ºä¸Šä»»ä½•å®ç°äº†Servletè§„èŒƒçš„ä¸­é—´ä»¶éƒ½å¯ä»¥æŸ¥æ€</li>
</ul>
<h2 id="æ¡ˆä¾‹-å“¥æ–¯æ‹‰å†…å­˜é©¬" class="heading-element"><span>æ¡ˆä¾‹-å“¥æ–¯æ‹‰å†…å­˜é©¬</span>
  <a href="#%e6%a1%88%e4%be%8b-%e5%93%a5%e6%96%af%e6%8b%89%e5%86%85%e5%ad%98%e9%a9%ac" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h3 id="æ³¨å…¥å†…å­˜é©¬" class="heading-element"><span>æ³¨å…¥å†…å­˜é©¬</span>
  <a href="#%e6%b3%a8%e5%85%a5%e5%86%85%e5%ad%98%e9%a9%ac" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>å“¥æ–¯æ‹‰ç”Ÿæˆæ™®é€šçš„Webshellï¼Œå°†shell01.jspæ”¾åˆ°Tomcat Webç›®å½•ä¸‹</p>
<p><a class="lightgallery" href="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250701165045731.png?size=large" data-thumbnail="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250701165045731.png?size=small" data-sub-html="<h2>image-20250701165045731</h2>"><img loading="lazy" src="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250701165045731.png" alt="image-20250701165045731" srcset="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250701165045731.png?size=small, /posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250701165045731.png?size=medium 1.5x, /posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250701165045731.png?size=large 2x" data-title="image-20250701165045731" style="--width: 1060px;--aspect-ratio: 1060 / 500;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></a></p>
<p><a class="lightgallery" href="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250701165149201.png?size=large" data-thumbnail="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250701165149201.png?size=small" data-sub-html="<h2>image-20250701165149201</h2>"><img loading="lazy" src="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250701165149201.png" alt="image-20250701165149201" srcset="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250701165149201.png?size=small, /posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250701165149201.png?size=medium 1.5x, /posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250701165149201.png?size=large 2x" data-title="image-20250701165149201" style="--width: 2092px;--aspect-ratio: 2092 / 666;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></a></p>
<p>é€šè¿‡å“¥æ–¯æ‹‰è¿æ¥Webshellï¼Œè¿æ¥æ­£å¸¸ï¼Œ</p>
<p><a class="lightgallery" href="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250701165316310.png?size=large" data-thumbnail="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250701165316310.png?size=small" data-sub-html="<h2>image-20250701165316310</h2>"><img loading="lazy" src="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250701165316310.png" alt="image-20250701165316310" srcset="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250701165316310.png?size=small, /posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250701165316310.png?size=medium 1.5x, /posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250701165316310.png?size=large 2x" data-title="image-20250701165316310" style="--width: 978px;--aspect-ratio: 978 / 1040;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></a></p>
<p>å³é”®è¿›å…¥ï¼Œåœ¨shellé¡µé¢é€‰æ‹©å†…å­˜é©¬MemoryShell æˆ– FilterShellï¼Œé€‰æ‹©ç›¸åº”çš„ç±»å‹è¿›è¡Œæ‰§è¡Œã€‚</p>
<p>å“¥æ–¯æ‹‰å†…å­˜é©¬æ˜¯servletå‹å’Œfilterå‹ï¼Œè¿™ä¸¤ç§ç›¸å¯¹æ¯”è¾ƒå¥½æ’æŸ¥ã€‚</p>
<p><strong>æ³¨å…¥Servletå‹</strong></p>
<p>æ³¨å…¥å‰å¯ä»¥å…ˆé€‰æ‹© ServletManage ç‚¹å‡» getAllServletï¼ŒæŸ¥çœ‹ä¸‹å½“å‰çš„çŠ¶æ€</p>
<p><a class="lightgallery" href="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704174554882.png?size=large" data-thumbnail="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704174554882.png?size=small" data-sub-html="<h2>image-20250704174554882</h2>"><img loading="lazy" src="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704174554882.png" alt="image-20250704174554882" srcset="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704174554882.png?size=small, /posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704174554882.png?size=medium 1.5x, /posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704174554882.png?size=large 2x" data-title="image-20250704174554882" style="--width: 1141px;--aspect-ratio: 1141 / 327;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></a></p>
<p>é€šè¿‡MemoryShellï¼Œè®¾ç½®å¥½é€‰é¡¹åï¼Œç‚¹å‡» run è¿›è¡Œæ³¨å…¥</p>
<p><a class="lightgallery" href="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704174658776.png?size=large" data-thumbnail="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704174658776.png?size=small" data-sub-html="<h2>image-20250704174658776</h2>"><img loading="lazy" src="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704174658776.png" alt="image-20250704174658776" srcset="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704174658776.png?size=small, /posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704174658776.png?size=medium 1.5x, /posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704174658776.png?size=large 2x" data-title="image-20250704174658776" style="--width: 1141px;--aspect-ratio: 1141 / 720;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></a></p>
<p>æ³¨å…¥åå†æ¬¡ç‚¹å‡» ServletManageï¼Œç‚¹å‡» getAllServletï¼ŒæŸ¥çœ‹ä¸‹å½“å‰çš„çŠ¶æ€ï¼Œå¯ä»¥çœ‹åˆ°æ–°å¢äº†ä¸€æ¡ã€‚</p>
<p><a class="lightgallery" href="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704174756333.png?size=large" data-thumbnail="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704174756333.png?size=small" data-sub-html="<h2>image-20250704174756333</h2>"><img loading="lazy" src="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704174756333.png" alt="image-20250704174756333" srcset="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704174756333.png?size=small, /posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704174756333.png?size=medium 1.5x, /posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704174756333.png?size=large 2x" data-title="image-20250704174756333" style="--width: 1141px;--aspect-ratio: 1141 / 330;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></a></p>
<p><strong>æ³¨å…¥Filterå‹</strong></p>
<p>æ³¨å…¥å‰å¯ä»¥å…ˆç‚¹å‡» getAllFilterï¼ŒæŸ¥çœ‹ä¸‹å½“å‰çš„çŠ¶æ€</p>
<p><a class="lightgallery" href="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704174253794.png?size=large" data-thumbnail="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704174253794.png?size=small" data-sub-html="<h2>image-20250704174253794</h2>"><img loading="lazy" src="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704174253794.png" alt="image-20250704174253794" srcset="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704174253794.png?size=small, /posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704174253794.png?size=medium 1.5x, /posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704174253794.png?size=large 2x" data-title="image-20250704174253794" style="--width: 1141px;--aspect-ratio: 1141 / 342;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></a></p>
<p>é€šè¿‡ç‚¹å‡» addFilterShell è¿›è¡Œæ³¨å…¥</p>
<p><a class="lightgallery" href="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704174348788.png?size=large" data-thumbnail="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704174348788.png?size=small" data-sub-html="<h2>image-20250704174348788</h2>"><img loading="lazy" src="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704174348788.png" alt="image-20250704174348788" srcset="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704174348788.png?size=small, /posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704174348788.png?size=medium 1.5x, /posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704174348788.png?size=large 2x" data-title="image-20250704174348788" style="--width: 1141px;--aspect-ratio: 1141 / 380;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></a></p>
<p>æ³¨å…¥åå†æ¬¡ç‚¹å‡» getAllFilterï¼ŒæŸ¥çœ‹ä¸‹å½“å‰çš„çŠ¶æ€ï¼Œå¯ä»¥çœ‹åˆ°æ–°å¢äº†ä¸€æ¡ã€‚</p>
<p><a class="lightgallery" href="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704174428579.png?size=large" data-thumbnail="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704174428579.png?size=small" data-sub-html="<h2>image-20250704174428579</h2>"><img loading="lazy" src="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704174428579.png" alt="image-20250704174428579" srcset="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704174428579.png?size=small, /posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704174428579.png?size=medium 1.5x, /posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704174428579.png?size=large 2x" data-title="image-20250704174428579" style="--width: 1141px;--aspect-ratio: 1141 / 289;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></a></p>
<h3 id="java-memshell-scanneræ’æŸ¥" class="heading-element"><span>java-memshell-scanneræ’æŸ¥</span>
  <a href="#java-memshell-scanner%e6%8e%92%e6%9f%a5" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>é€šè¿‡è®¿é—® /tomcat-memshell-scanner.jsp å³å¯è¿›è¡Œæ’æŸ¥ï¼Œå¯ä»¥çœ‹åˆ°æ–°å¢çš„ä¸¤æ¡éƒ½è¢«æ‰¾åˆ°äº†ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">http://localhost:8080/tomcat-memshell-scanner.jsp</span></span></code></pre></td></tr></table>
</div>
</div><p><a class="lightgallery" href="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704175033216.png?size=large" data-thumbnail="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704175033216.png?size=small" data-sub-html="<h2>image-20250704175033216</h2>"><img loading="lazy" src="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704175033216.png" alt="image-20250704175033216" srcset="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704175033216.png?size=small, /posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704175033216.png?size=medium 1.5x, /posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704175033216.png?size=large 2x" data-title="image-20250704175033216" style="--width: 1650px;--aspect-ratio: 1650 / 858;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></a></p>
<p>é€šè¿‡dumpå¯ä»¥ä¸‹è½½ç›¸åº”çš„classç±»è¿›è¡Œåˆ†æï¼Œç‚¹å‡»Killå³å¯åˆ é™¤ç›¸åº”å†…å­˜é©¬ã€‚</p>
<h3 id="arthasæ’æŸ¥" class="heading-element"><span>Arthasæ’æŸ¥</span>
  <a href="#arthas%e6%8e%92%e6%9f%a5" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>Arthas åªèƒ½æ’æŸ¥æ˜¯å¦å­˜åœ¨ï¼Œæå–å†…å­˜é©¬Classå¹¶åç¼–è¯‘ï¼Œæ— æ³•ç›´æ¥åˆ é™¤ã€‚</p>
<p>æŸ¥çœ‹ Mbean çš„ä¿¡æ¯ï¼ŒæŸ¥çœ‹å¼‚å¸¸Filter/ServletèŠ‚ç‚¹</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">mbean <span class="p">|</span> grep <span class="s2">&#34;Servlet&#34;</span></span></span></code></pre></td></tr></table>
</div>
</div><p><a class="lightgallery" href="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704175429049.png?size=large" data-thumbnail="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704175429049.png?size=small" data-sub-html="<h2>image-20250704175429049</h2>"><img loading="lazy" src="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704175429049.png" alt="image-20250704175429049" srcset="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704175429049.png?size=small, /posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704175429049.png?size=medium 1.5x, /posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704175429049.png?size=large 2x" data-title="image-20250704175429049" style="--width: 1126px;--aspect-ratio: 1126 / 580;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">mbean | grep Filter</span></span></code></pre></td></tr></table>
</div>
</div><p><a class="lightgallery" href="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704175556864.png?size=large" data-thumbnail="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704175556864.png?size=small" data-sub-html="<h2>image-20250704175556864</h2>"><img loading="lazy" src="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704175556864.png" alt="image-20250704175556864" srcset="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704175556864.png?size=small, /posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704175556864.png?size=medium 1.5x, /posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250704175556864.png?size=large 2x" data-title="image-20250704175556864" style="--width: 1084px;--aspect-ratio: 1084 / 274;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></a></p>
<p>åœ¨çœŸå®å¸¸è§ä¸­ï¼Œå°±éœ€è¦æˆ‘ä»¬å¯¹è¿™äº›ç›¸åº”çš„servletã€filteråç§°æœ‰ä¸€äº›äº†è§£ï¼Œä»è€Œå‘ç°å…¶ä¸­çš„å¼‚å¸¸å¯ç–‘ç±»ã€‚</p>
<p>æœç´¢æŸ¥çœ‹JVMå·²åŠ è½½çš„ç±»ä¿¡æ¯ï¼Œæ¨¡ç³ŠåŒ¹é…Servletå’ŒFilterç±»</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">sc *.Servlet
</span></span><span class="line"><span class="cl">sc *.Filter</span></span></code></pre></td></tr></table>
</div>
</div><p><a class="lightgallery" href="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250710152406816.png?size=large" data-thumbnail="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250710152406816.png?size=small" data-sub-html="<h2>image-20250710152406816</h2>"><img loading="lazy" src="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250710152406816.png" alt="image-20250710152406816" srcset="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250710152406816.png?size=small, /posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250710152406816.png?size=medium 1.5x, /posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250710152406816.png?size=large 2x" data-title="image-20250710152406816" style="--width: 734px;--aspect-ratio: 734 / 611;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></a></p>
<p>å¯ä»¥çœ‹åˆ°æ–°å¢äº†å¾ˆå¤šç±»ï¼Œå…¶ä¸­æœ‰äº›æ˜¯æˆ‘ä»¬ä¸Šä¼ çš„shell01.jspå¯¼è‡´ çš„ï¼Œæˆ‘ä»¬å¯¹å…¶ä¸­å¯ç–‘çš„ç±»è¿›è¡Œåˆ†æã€‚</p>
<p>åç¼–è¯‘æŒ‡å®šçš„ç±»</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">jad --source-only org.apache.jsp.shell01_jsp</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™é‡Œå¯ä»¥çœ‹åˆ°ï¼Œåç¼–è¯‘è¾“å‡ºçš„ç»“æœèƒ½å¾ˆæ¸…æ™°çš„æŸ¥çœ‹åˆ°å†°èé©¬çš„å†…å®¹å’Œå¯†ç ã€‚</p>
<p><a class="lightgallery" href="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250710152745725.png?size=large" data-thumbnail="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250710152745725.png?size=small" data-sub-html="<h2>image-20250710152745725</h2>"><img loading="lazy" src="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250710152745725.png" alt="image-20250710152745725" srcset="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250710152745725.png?size=small, /posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250710152745725.png?size=medium 1.5x, /posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250710152745725.png?size=large 2x" data-title="image-20250710152745725" style="--width: 934px;--aspect-ratio: 934 / 492;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></a></p>
<p>dumpå¯ç–‘ç±»è¿›è¡Œåˆ†æ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">dump org.apache.coyote.deser.CreatorProperty
</span></span><span class="line"><span class="cl">dump org.apache.coyote.deser.std.ByteBufferDeserializer</span></span></code></pre></td></tr></table>
</div>
</div><p><a class="lightgallery" href="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250710153452974.png?size=large" data-thumbnail="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250710153452974.png?size=small" data-sub-html="<h2>image-20250710153452974</h2>"><img loading="lazy" src="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250710153452974.png" alt="image-20250710153452974" srcset="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250710153452974.png?size=small, /posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250710153452974.png?size=medium 1.5x, /posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250710153452974.png?size=large 2x" data-title="image-20250710153452974" style="--width: 1150px;--aspect-ratio: 1150 / 469;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></a></p>
<p>é€šè¿‡åç¼–è¯‘å·¥å…·åç¼–è¯‘ç›¸å…³ç±»ï¼Œå¯ä»¥æŸ¥çœ‹åˆ°å†…å­˜é©¬çš„æ¶æ„è¯­å¥</p>
<p><code>org.apache.coyote.deser.CreatorProperty</code>å¯¹åº”çš„Servletç±»å†…å­˜é©¬ï¼š</p>
<p><a class="lightgallery" href="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250710154030604.png?size=large" data-thumbnail="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250710154030604.png?size=small" data-sub-html="<h2>image-20250710154030604</h2>"><img loading="lazy" src="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250710154030604.png" alt="image-20250710154030604" srcset="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250710154030604.png?size=small, /posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250710154030604.png?size=medium 1.5x, /posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250710154030604.png?size=large 2x" data-title="image-20250710154030604" style="--width: 1199px;--aspect-ratio: 1199 / 1172;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></a></p>
<p><code>org.apache.coyote.deser.std.ByteBufferDeserializer</code>å¯¹åº”çš„Filterç±»å†…å­˜é©¬ï¼š</p>
<p><a class="lightgallery" href="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250710154308303.png?size=large" data-thumbnail="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250710154308303.png?size=small" data-sub-html="<h2>image-20250710154308303</h2>"><img loading="lazy" src="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250710154308303.png" alt="image-20250710154308303" srcset="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250710154308303.png?size=small, /posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250710154308303.png?size=medium 1.5x, /posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250710154308303.png?size=large 2x" data-title="image-20250710154308303" style="--width: 1199px;--aspect-ratio: 1199 / 1172;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></a></p>
<p>å†…å­˜Dump</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="o">[</span>arthas@13465<span class="o">]</span>$ heapdump
</span></span><span class="line"><span class="cl">Dumping heap to /Users/xavier/CodeSpace/Tomcat/apache-tomcat-9.0.85-2/temp/heapdump2025-07-10-16-325369075522353126614.hprof ...
</span></span><span class="line"><span class="cl">Heap dump file created
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#è®¾ç½®ä¿å­˜è·¯å¾„æ—¶å»ºè®®ç”¨ç»å¯¹è·¯å¾„</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>arthas@13465<span class="o">]</span>$ heapdump /Users/xavier/Desktop/Tmp/heapdump-1.hprof 
</span></span><span class="line"><span class="cl">Dumping heap to /Users/xavier/Desktop/Tmp/heapdump-1.hprof ...
</span></span><span class="line"><span class="cl">Heap dump file created</span></span></code></pre></td></tr></table>
</div>
</div><p>æ ¹æ®å…³é”®è¯è¿›è¡Œæ£€ç´¢</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">$ strings heapdump-1.hprof <span class="p">|</span> grep <span class="s2">&#34;POST /&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">$ strings heapdump-1.hprof<span class="p">|</span> grep <span class="s2">&#34;favicon.ico&#34;</span>
</span></span><span class="line"><span class="cl">com/taobao/arthas/core/http/favicon.icoPK
</span></span><span class="line"><span class="cl">POST //favicon.ico HTTP/1.1
</span></span><span class="line"><span class="cl">org.apache.catalina.core.ContainerBase.<span class="o">[</span>Catalina<span class="o">]</span>.<span class="o">[</span>localhost<span class="o">]</span>.<span class="o">[</span>/<span class="o">]</span>.<span class="o">[</span>/favicon.ico<span class="o">]</span>!
</span></span><span class="line"><span class="cl"><span class="nv">J2EEApplication</span><span class="o">=</span>none,J2EEServer<span class="o">=</span>none,WebModule<span class="o">=</span>//localhost/,j2eeType<span class="o">=</span>Servlet,name<span class="o">=</span>/favicon.ico!
</span></span><span class="line"><span class="cl">Catalina:J2EEApplication<span class="o">=</span>none,J2EEServer<span class="o">=</span>none,WebModule<span class="o">=</span>//localhost/,j2eeType<span class="o">=</span>Servlet,name<span class="o">=</span>/favicon.ico<span class="s2">&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">/favicon.ico!
</span></span></span><span class="line"><span class="cl"><span class="s2">/favicon.icoo</span></span></span></code></pre></td></tr></table>
</div>
</div><p>æ¥è‡ªç½‘ç»œçš„ å†°èã€å“¥æ–¯æ‹‰å†…å­˜æ£€æµ‹å‘½ä»¤</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl"><span class="c1"># dumpå†…å­˜ï¼Œç”¨arthas Dumpå†…å­˜æ›¿ä»£</span>
</span></span><span class="line"><span class="cl">jmap -dump:live,format<span class="o">=</span>b,file<span class="o">=</span>heapdump.hprof pid
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ£€æµ‹Godzilla</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> grep -q <span class="s1">&#39;getBasicsInfo&#39;</span> heapdump.hprof <span class="o">&amp;&amp;</span> grep -q <span class="s1">&#39;srcFileName&#39;</span> heapdump.hprof <span class="o">&amp;&amp;</span> grep -q <span class="s1">&#39;destFileName&#39;</span> heapdump.hprof<span class="p">;</span><span class="k">then</span> <span class="nb">echo</span> <span class="s1">&#39;exist Godzilla&#39;</span><span class="p">;</span><span class="k">else</span> <span class="nb">echo</span> <span class="s1">&#39;&#39;</span><span class="p">;</span><span class="k">fi</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ£€æµ‹å†°è</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> grep -q <span class="s1">&#39;basicInfo&#39;</span> heapdump.hprof <span class="o">&amp;&amp;</span> grep -q <span class="s1">&#39;currentPath&#39;</span> heapdump.hprof <span class="o">&amp;&amp;</span> grep -q <span class="s1">&#39;driveList&#39;</span> heapdump.hprof<span class="p">;</span><span class="k">then</span> <span class="nb">echo</span> <span class="s1">&#39;exist behinder&#39;</span><span class="p">;</span><span class="k">else</span> <span class="nb">echo</span> <span class="s1">&#39;&#39;</span><span class="p">;</span><span class="k">fi</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div><p><a class="lightgallery" href="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250710164718823.png?size=large" data-thumbnail="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250710164718823.png?size=small" data-sub-html="<h2>image-20250710164718823</h2>"><img loading="lazy" src="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250710164718823.png" alt="image-20250710164718823" srcset="/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250710164718823.png?size=small, /posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250710164718823.png?size=medium 1.5x, /posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/resource/index.assets/image-20250710164718823.png?size=large 2x" data-title="image-20250710164718823" style="--width: 1154px;--aspect-ratio: 1154 / 126;background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/></a></p>
<h3 id="æ¸…é™¤å†…å­˜é©¬" class="heading-element"><span>æ¸…é™¤å†…å­˜é©¬</span>
  <a href="#%e6%b8%85%e9%99%a4%e5%86%85%e5%ad%98%e9%a9%ac" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>æ¸…æ¥šå†…å­˜é©¬æœ€å¸¸è§çš„æ–¹å¼å°±æ˜¯å¯¹æœåŠ¡è¿›è¡Œé‡å¯ã€‚</p>
<p>é’ˆå¯¹äºServletç±»å’ŒFilterç±»ï¼Œå¯ä»¥é‡‡ç”¨å·¥å…·è¿›è¡Œæ¸…é™¤ï¼Œæ¯”å¦‚ä¸Šé¢çš„ Java-Memshell-Scanner ç‚¹å‡» Kill è¿›è¡Œæ¸…é™¤ã€‚</p>
<h2 id="å‚è€ƒæ–‡çŒ®" class="heading-element"><span>å‚è€ƒæ–‡çŒ®</span>
  <a href="#%e5%8f%82%e8%80%83%e6%96%87%e7%8c%ae" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><ul>
<li><a href="https://gv7.me/articles/2020/kill-java-web-filter-memshell/"target="_blank" rel="external nofollow noopener noreferrer">æŸ¥æ€Java web filterå‹å†…å­˜é©¬</a> c0ny1 2020-08-13</li>
<li><a href="https://gv7.me/articles/2020/filter-servlet-type-memshell-scan-capture-and-kill/"target="_blank" rel="external nofollow noopener noreferrer">Filter/Servletå‹å†…å­˜é©¬çš„æ‰«ææŠ“æ•ä¸æŸ¥æ€</a> c0ny1Â  2020-09-09</li>
<li><a href="https://zgao.top/%e5%86%b0%e8%9d%8e%e3%80%81%e5%93%a5%e6%96%af%e6%8b%89-%e5%86%85%e5%ad%98%e9%a9%ac%e5%ba%94%e6%80%a5%e6%8e%92%e6%9f%a5/"target="_blank" rel="external nofollow noopener noreferrer">å†°èã€å“¥æ–¯æ‹‰ å†…å­˜é©¬åº”æ€¥æ’æŸ¥</a></li>
</ul>
<h2 id="æ–‡ä»¶å±æ€§" class="heading-element"><span>æ–‡ä»¶å±æ€§</span>
  <a href="#%e6%96%87%e4%bb%b6%e5%b1%9e%e6%80%a7" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>åˆ›å»ºæ—¶é—´ï¼š2025-06-25   10:52</p>
<p>ä¿®è®¢è®°å½•ï¼š</p>
<ul>
<li>2025-06-25 ï¼Œæ­¤æ¬¡ä¿®è®¢å†…å®¹| æ–°å»º</li>
</ul>
<p>å¤‡æ³¨ï¼šxxx</p>
</div><div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod">
        <span title="æ›´æ–°äº 2025-06-25 00:00:00">æ›´æ–°äº 2025-06-25&nbsp;</span>
      </div></div><div class="post-info-line">
        <div class="post-info-md"></div>
        <div class="post-info-share">
          <span></span>
        </div>
      </div></div>

  <div class="post-info-more">
    <section class="post-tags"><i class="fa-solid fa-tags fa-fw me-1" aria-hidden="true"></i><a href="/tags/blueteam/" class="post-tag" title="æ ‡ç­¾ - BlueTeam">BlueTeam</a></section>
    <section>
      <span><a href="javascript:void(0);" onclick="window.history.back();">è¿”å›</a></span>&nbsp;|&nbsp;<span><a href="/">ä¸»é¡µ</a></span>
    </section>
  </div><div class="post-nav"><a href="/posts/arl_setup_record/" class="post-nav-item" rel="prev" title="ARLç¯å¡”Dockerç‰ˆæ­å»ºè®°å½•"><i class="fa-solid fa-angle-left fa-fw" aria-hidden="true"></i>ARLç¯å¡”Dockerç‰ˆæ­å»ºè®°å½•</a><a href="/posts/20250710-%E5%89%8D%E7%AB%AFjs%E5%8A%A0%E8%A7%A3%E5%AF%86%E5%AF%B9%E6%8A%97/" class="post-nav-item" rel="next" title="å‰ç«¯JSåŠ è§£å¯†å¯¹æŠ—æ–¹æ³•ç®€è¿°">å‰ç«¯JSåŠ è§£å¯†å¯¹æŠ—æ–¹æ³•ç®€è¿°<i class="fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article>

  <aside class="toc" id="toc-auto" aria-label="ç›®å½•"><h2 class="toc-title">ç›®å½•&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden="true"></i></h2>
      <div class="toc-content always-active" id="toc-content-auto"></div></aside></main><footer class="footer">
    <div class="footer-container"><div class="footer-line visitor">
          <span id="busuanzi_container_site_uv" title='æ€»è®¿å®¢æ•°'><i class="fa-regular fa-user fa-fw me-1" aria-hidden="true"></i><span id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span></span><span id="busuanzi_container_site_pv" class="footer-divider" title='æ€»è®¿é—®é‡'><i class="fa-regular fa-eye fa-fw me-1" aria-hidden="true"></i><span id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span></span>
        </div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role="button" aria-label="å›åˆ°é¡¶éƒ¨"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden="true"></i><span class="variant-numeric d-none">0%</span>
        </div></div><div id="mask"></div><div class="reading-progress-bar" style="left: 0;top: 0;"></div><noscript>
    <div class="noscript-warning">è¯¥ç½‘ç«™åœ¨å¯ç”¨ JavaScript çš„æƒ…å†µä¸‹æ•ˆæœæœ€ä½³ã€‚</div>
  </noscript>
</div><link rel="stylesheet" href="/lib/lightgallery/css/lightgallery-bundle.min.css"><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.css"><link rel="stylesheet" href="/lib/pace/themes/blue/pace-theme-minimal.css"><script src="/lib/autocomplete/autocomplete.min.js" defer></script><script src="/lib/fuse/fuse.min.js" defer></script><script src="/lib/twemoji/twemoji.min.js" defer></script><script src="/lib/lightgallery/lightgallery.min.js" defer></script><script src="/lib/lightgallery/plugins/thumbnail/lg-thumbnail.min.js" defer></script><script src="/lib/lightgallery/plugins/zoom/lg-zoom.min.js" defer></script><script src="/lib/cookieconsent/cookieconsent.min.js" defer></script><script src="/lib/pace/pace.min.js" async defer></script><script>window.config={"code":{"copyTitle":"å¤åˆ¶åˆ°å‰ªè´´æ¿","maxShownLines":20},"comment":{"enable":false},"cookieconsent":{"content":{"dismiss":"åŒæ„","link":"äº†è§£æ›´å¤š","message":"æœ¬ç½‘ç«™ä½¿ç”¨ Cookies æ¥æ”¹å–„æ‚¨çš„æµè§ˆä½“éªŒã€‚"},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"lightgallery":true,"search":{"distance":100,"findAllMatches":false,"fuseIndexURL":"/search.json","highlightTag":"em","ignoreFieldNorm":false,"ignoreLocation":false,"isCaseSensitive":false,"location":0,"maxResultLength":10,"minMatchCharLength":2,"noResultsFound":"æ²¡æœ‰æ‰¾åˆ°ç»“æœ","snippetLength":30,"threshold":0.3,"type":"fuse","useExtendedSearch":false},"twemoji":true,"version":"v0.3.16"};console.log('Page config:', window.config);</script><script src="/js/theme.min.js" defer></script></body>
</html>
