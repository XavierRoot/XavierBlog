# 002-Nmapè¿›é˜¶å­¦ä¹ å¿ƒå¾—


&lt;!--more--&gt;



![å›¾ç‰‡](resource/index.assets/640.png)

## 0x00 å¼•

â€‹		è¯´èµ·ç«¯å£æ‰«æï¼Œä½ å¯ä»¥ä¸¾å‡ºä¸€å¤§å †çš„å·¥å…·ï¼Œä½†æœ‰ä¸€æ¬¾ç¥žå™¨ï¼Œä¸€å®šæ˜¯ç™»åœºçŽ‡æœ€é«˜çš„ï¼Œé‚£å°±æ˜¯Nmapã€‚ä½œä¸ºæœ€ä¸ºå¤§ä¼—æ‰€ç†Ÿæ‚‰çš„å·¥å…·ï¼Œç›¸ä¿¡å¤§å®¶éƒ½â€œç†Ÿç»ƒæŽŒæ¡â€äº†Nmapçš„ä½¿ç”¨æŠ€å·§ï¼Œæˆ‘æ›¾ç»ä¹Ÿæ˜¯é‚£ä¹ˆè®¤ä¸ºçš„ï¼Œç›´åˆ°æˆ‘çœ‹åˆ°äº†å®˜æ–¹å‡ºç‰ˆä¹¦åˆŠã€ŠNmap Network Scanningã€‹ï¼ˆç”µå­ç¨¿ï¼Œç®€ç§°NNSï¼‰ï¼Œæ‰çŸ¥é“åŽŸæ¥è‡ªå·±ä¸€ç›´åªæ˜¯â€œä¼šç”¨â€è€Œå·²ã€‚

â€‹		é¦–å…ˆï¼Œæˆ‘ä»¬æ¥æå‡ºä¸€äº›é—®é¢˜ï¼Œå¦‚æžœèƒ½æ¸…æ¥šå›žç­”ä¸‹åˆ—é—®é¢˜ï¼Œé‚£ä¹ˆæ­å–œä½ ä¸ç”¨æµªè´¹30åˆ†é’Ÿé˜…è¯»æœ¬æ–‡äº†ï¼Œé—®é¢˜å¦‚ä¸‹ï¼š

1. Nmapæ”¯æŒå“ªäº›åŠŸèƒ½é€‰é¡¹ï¼Ÿ

2. Nmapçš„æ‰§è¡Œè¿‡ç¨‹æ˜¯æ€Žä¹ˆæ ·çš„ï¼Ÿ

3. Nmap åŒ…å«äº†å“ªäº›é»˜è®¤é€‰é¡¹ï¼Ÿå¦‚æ‰§è¡Œäº†å“ªäº›æŽ¢æµ‹æŠ€æœ¯ç­‰

4. Nmapæœ‰å“ªäº›ç«¯å£æŽ¢æµ‹æŠ€æœ¯ï¼Œæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

5. Nmapçš„æ‰«æé€Ÿåº¦æ…¢ä¸€ç›´è¢«äººè¯Ÿç—…ï¼Œæœ‰ä»€ä¹ˆæ–¹æ³•å¯ä»¥åŠ é€Ÿå—ï¼Ÿ

    

â€‹		æœ‰å…³Nmapçš„æ–‡ç« ç½‘ç»œä¸Šå·²ç»å¾ˆå¤šäº†ï¼Œå¤§å¤šæ•°äººå¯èƒ½å·²ç»çœ‹è¿‡äº†ä¸å°‘äº†ï¼Œæ‰€ä»¥æœ‰äº›ç®€å•çš„åœ°æ–¹æˆ‘ä¼šä¸€ç¬”å¸¦è¿‡ï¼Œå¤§å®¶ç½‘ä¸Šæœç´¢ä¸€ä¸‹ï¼Œä¹Ÿè®¸ä¼šèŽ·å¾—æ›´å¤šçš„çŸ¥è¯†ç¢°æ’žã€‚æ—¢ç„¶ç½‘ä¸Šæ–‡ç« é‚£ä¹ˆå¤šï¼Œæˆ‘ä¸ºä»€ä¹ˆè¿˜è¦å†™å‘¢ï¼Ÿé¦–å…ˆä¹Ÿæ˜¯ä¸»è¦ç›®çš„ï¼Œæ˜¯è®°å½•è‡ªå·±çš„å­¦ä¹ å¿ƒå¾—ï¼ŒæŽ¨åŠ¨ä¿ƒè¿›è‡ªå·±æˆé•¿ï¼›å…¶æ¬¡æ˜¯æˆ‘å‘çŽ°ç½‘ä¸Šå¾ˆå¤šæ–‡ç« åªæ˜¯ç®€å•çš„åˆ—ä¸¾äº†Nmapçš„åŠŸèƒ½é€‰é¡¹ï¼Œç½—åˆ—äº†ä¸€å †å´æ²¡æœ‰æ·±å…¥åŽ»è¯´æ˜Žè¿™äº›é€‰é¡¹çš„æ³¨æ„äº‹é¡¹ï¼Œå› æ­¤ä¼šé€ æˆå¾ˆå¤šçš„è¯¯è§£å’Œé”™è¯¯ä½¿ç”¨ï¼Œä¾‹å¦‚ï¼šæœ‰ä¸€ä¸ªé€‰é¡¹ -Pnï¼Œç”¨äºŽè·³è¿‡ä¸»æœºå‘çŽ°é˜¶æ®µï¼Œ

é»˜è®¤ç›®æ ‡ä¸»æœºåœ¨çº¿ï¼Œæ•´ä¸ªæµç¨‹å°‘è¿›è¡Œä¸€ä¸ªé˜¶æ®µï¼Œè¿™æ ·æ‰«æé€Ÿåº¦å°±ä¼šåŠ å¿«äº†å§ï¼Ÿï¼ˆ*çœŸçš„ä¹ˆï¼Ÿ:D*ï¼‰ï¼›è¿˜æœ‰ä¹Ÿæ˜¯ç±»ä¼¼çš„ï¼Œæœ‰äº›æ–‡ç« ç»™å‡ºäº†åº”å¯¹å„ç§åœºæ™¯çš„NmapæŒ‡ä»¤ï¼Œå¦‚æžœä¸åŽ»äº†è§£é‚£äº›æŒ‡ä»¤å°±ç›²ç›®çš„ç…§æ¬ï¼Œé‚£ä¹ˆä½ å¯èƒ½è¢«æ–‡ç« ä½œè€…çš„â€œç¬”è¯¯â€æ‰€è¯¯å¯¼ã€‚å•°å—¦äº†ä¸€å †ï¼Œæˆ‘ä»¬å¼€å§‹å§ï¼

 

â€‹		NmapåŠŸèƒ½é€‰é¡¹å¯ä»¥æŸ¥çœ‹ `Nmap -h` ï¼Œæˆ‘è¿™é‡Œå°±ä¸ä¸€æ¡æ¡åŽ»è¯´äº†ï¼Œä¸‹æ–‡æ¶‰åŠåˆ°æ—¶å†è¯´ã€‚

## 0x01. æŒ‡å®šæ‰«æç›®æ ‡

â€‹		é¦–å…ˆï¼Œæˆ‘æ‰“ç®—ä»Žæœ€ç®€å•çš„Nmapçš„å‘½ä»¤æ¡ˆä¾‹è®²èµ·ï¼š`nmap 192.168.1.1`ã€‚é€šå¸¸ç»å¤§å¤šæ•°äººä½¿ç”¨Nmapæ—¶ï¼Œéƒ½æ˜¯éœ€è¦é’ˆå¯¹ç‰¹å®šçš„ç›®æ ‡è¿›è¡Œæ‰«æçš„ï¼Œæ‰€ä»¥å°±å…ˆæ¥è¯´è¯´NmapæŒ‡å®šæ‰«æç›®æ ‡çš„å‡ ç§æ–¹å¼ã€‚çŒœçŒœä»¥ä¸‹å“ªäº›ç›®æ ‡æ ¼å¼æ˜¯èƒ½å¤Ÿè¢«nmapè§£æžçš„å‘¢ï¼Ÿ

- 192.168.1.1 192.168.1.2
- 192.168.1.1,2,3
- 192.168.1.1/28
- 192.168.1.-
- 192.168.2-3.1-255
- 192.168.1.250-
- 192.168.1.-20
- 192.168.3-5,7.1
- scanme.nmap.org
- scanme.nmap.org/32
- -.-.1.1
- 0-.0.255.13.37
- 2001:800:40:2a03::3 	

â€‹		ç­”æ¡ˆæ˜¯é™¤äº†-.-.1.1ä»¥å¤–ï¼Œéƒ½å¯ä»¥ä½œä¸ºç›®æ ‡è¾“å…¥ã€‚Nmapæ”¯æŒåŸŸåå½¢å¼ï¼›æ”¯æŒCIDRå¯»å€ï¼ˆä»Ž/0å…¨ç½‘åˆ°/32å½“å‰IPï¼‰ï¼›æ”¯æŒIPv6åœ°å€ï¼Œä½†éœ€è¦æŒ‡å®šé€‰é¡¹-6æ¥å¼€å¯IPv6æ”¯æŒã€‚

â€‹		è¿žå­—ç¬¦ï¼ˆ-ï¼‰è¡¨ç¤ºä»Ž0-255ï¼Œå½“æŒ‡å®šä»Ž0å¼€å§‹ï¼Œæˆ–åˆ°255ç»“æŸæ—¶ï¼Œå¯ä»¥çœç•¥0å’Œ255ã€‚é‚£ä¹ˆä¸ºä»€ä¹ˆ-.-.1.1ä¸å¯ä»¥å‘¢ï¼Ÿå› ä¸ºç›´æŽ¥ä»¥è¿žå­—ç¬¦ï¼ˆ-ï¼‰å¼€å¤´ï¼ŒNmapä¼šå°†å®ƒè§†ä¸ºä¸€ä¸ªåŠŸèƒ½é€‰é¡¹è§£æžï¼Œè€Œä¸æ˜¯ä½œä¸ºç›®æ ‡åœ°å€ã€‚

â€‹		Nmapåœ¨å‘½ä»¤è¡Œä¸Šå¯ä»¥åŒæ—¶æŽ¥å—å¤šä¸ªä¸»æœºä½œä¸ºç›®æ ‡ï¼Œè€Œä¸”ä¸è¦æ±‚æ˜¯ç»Ÿä¸€ç±»åž‹çš„ï¼Œå¦‚ï¼šnmap scanme.nmap.org 192.168.0.0/8 10.0.0,1,3-7.-

ï¼ˆ**æ³¨æ„**ï¼šä¸åŒ…æ‹¬Ipv6ï¼ŒIpv6å’ŒIpv4ä¸èƒ½åŒæ—¶å¯ç”¨ï¼‰ã€‚å¤šä¸ªä¸»æœºä¹‹é—´ç”±ä¸€ä¸ªæˆ–å¤šä¸ªç©ºæ ¼åˆ†éš”ã€‚

â€‹	**-iL**

â€‹		Nmap è¿˜æ”¯æŒä»Žæ–‡ä»¶åˆ—è¡¨ä¸­è¯»å–ç›®æ ‡ï¼ŒåŠŸèƒ½é€‰é¡¹ä¸º -iL ï¼ŒåŒæ ·ä¹Ÿæ”¯æŒä¸Šè¿°æ ¼å¼ï¼Œç”±ä¸€ä¸ªæˆ–å¤šä¸ªç©ºæ ¼ï¼Œåˆ¶è¡¨ç¬¦æˆ–æ¢è¡Œç¬¦åˆ†éš”ã€‚

â€‹		æ­¤å¤–Nmapè¿˜æ”¯æŒä»Žæ ‡å‡†è¾“å…¥ä¸­è¯»å–ç›®æ ‡ä¸»æœºåˆ—è¡¨ï¼Œå¯ä½¿ç”¨è¿žå­—ç¬¦ï¼ˆ-ï¼‰ä½œä¸º -iL çš„æ–‡ä»¶åï¼Œä¾‹å¦‚ï¼š

â€‹	`sort -u IpList.txt | nmap -iL -`		

â€‹	`egrep&#39;^ lease&#39;/var/lib/dhcp/dhcpd.leases | awk&#39;{print $ 2}&#39;| nmap -iL-`

**`--exclude` å’Œ `--excludefile &lt;filename&gt;`**

â€‹		æŽ’é™¤æ‰«æç›®æ ‡æœ‰ä¸¤ä¸ªåŠŸèƒ½é€‰é¡¹ï¼š`--exclude` å’Œ `--excludefile &lt;filename&gt;`ï¼Œå¾ˆæ˜Žæ˜¾åŽè€…æ˜¯ä»Žæ–‡ä»¶ä¸­è¯»å–éœ€æŽ’é™¤çš„æ‰«æç›®æ ‡ï¼Œå°±ä¸ç»†è¯´äº†ã€‚

â€‹		è¿™é‡Œæœ‰ä¸€ä¸ªæ³¨æ„äº‹é¡¹ï¼š--exclude åŠŸèƒ½é€‰é¡¹åŽé¢æŽ¥çš„å‚æ•°æ˜¯ç”¨é€—å·åˆ†éš”çš„ï¼Œå› æ­¤ä¸æ”¯æŒ192.168.1.10,20,30æ¥æŒ‡å®šæŽ’é™¤IP

â€‹	**-iR**

â€‹		å…¶å®žï¼Œé™¤äº†æŒ‡å®šç›®æ ‡è¿›è¡Œæ‰«æä¹‹å¤–ï¼ŒNmapè¿˜æ”¯æŒæ¼«æ— ç›®çš„çš„å…¨ç½‘æ‰«æï¼ŒåŠŸèƒ½é€‰é¡¹ä¸º`-iR &lt;number&gt;`ï¼Œè¡¨ç¤ºä»Žå…¨ç½‘ä¸­éšæœºé€‰æ‹©æŒ‡å®š number ä¸ªä¸»æœºè¿›è¡Œæ‰«æï¼Œå¦‚æžœnumberä¸º0ï¼Œè¡¨ç¤ºæŒç»­æ‰«æç›´åˆ°ç”¨æˆ·ç»ˆæ­¢ï¼Œ-iR è¿™ä¸ªåŠŸèƒ½ä¸€èˆ¬å¾ˆå°‘ä¼šç”¨åˆ°ã€‚

â€‹	**-sL**

â€‹		å…‰çœ‹ä¸éªŒè¯å®¹æ˜“è¢«éª—ï¼Œå¦‚ä½•å¿«é€Ÿçš„éªŒè¯å‘¢ï¼ŒåŽ»è¯•ä¸€ä¸‹ -sL é€‰é¡¹å§ï¼Œå®ƒä¼šåˆ—å‡ºè¿›è¡Œæ‰«æçš„ç›®æ ‡æ¸…å•ï¼Œè€Œä¸è¿›è¡Œæ‰«æï¼Œé€šå¸¸å°±æ˜¯ç”¨äºŽæŽ’æŸ¥å¾…æ‰«æçš„ç›®æ ‡æ˜¯å¦å‡†ç¡®ã€‚

![img](resource/index.assets/1623764141_60c8acad01a28aa2c373b.png)

â€‹		æˆ‘ä»¬å¯ä»¥çœ‹åˆ°IPæ®µèƒ½å¯¹ä¸Šï¼Œå¯¹åŸŸåç›®æ ‡ï¼ŒNmapè¿›è¡Œäº†åŸŸåè§£æžå’Œåå‘DNSï¼Œä¸‹æ–‡å°±å°†ä»‹ç»Nmapçš„è¿è¡Œé¡ºåºäº†ã€‚

## 0x02. Nmapè¿è¡Œæµç¨‹

â€‹		Nmapçš„è¿è¡Œè¿‡ç¨‹å¯è§å®˜æ–¹æ–‡æ¡£ï¼šhttps://nmap.org/book/nmap-phases.html

â€‹		ä¸€ä¸ªç®€å•çš„Nmapè¿è¡Œæµç¨‹å¯ä»¥æè¿°è¾“å…¥ã€ä¸»æœºå‘çŽ°ã€ç«¯å£æ‰«æã€ç‰ˆæœ¬æŽ¢æµ‹ã€æ“ä½œç³»ç»ŸæŽ¢æµ‹ã€è¾“å‡ºï¼Œå¦‚ä¸‹å›¾ï¼š

![img](resource/index.assets/1623764178_60c8acd2a0b7b5b4ed11d.png)

â€‹		ä¸€ä¸ªå®Œæ•´çš„Nmapæ‰«ææµç¨‹å°±æ˜¯ï¼šé¢„æ‰«æè„šæœ¬åŠ è½½ï¼Œç›®æ ‡åˆ—ä¸¾ï¼Œä¸»æœºå‘çŽ°ï¼ŒDNSåå‘è§£æžï¼Œç«¯å£æ‰«æï¼ŒæœåŠ¡ä¸Žç‰ˆæœ¬æŽ¢æµ‹ï¼Œæ“ä½œç³»ç»ŸæŽ¢æµ‹ï¼Œç½‘ç»œè·¯ç”±ç›‘æµ‹ï¼Œè„šæœ¬æ‰«æï¼Œç»“æžœè¾“å‡ºï¼ŒåŽæ‰«æè„šæœ¬åŠ è½½ã€‚å¤§æ„å¦‚å›¾ï¼šï¼ˆå›¾æºè‡ªç½‘ç»œï¼Œ*PSï¼šè¿™ç§å›¾æ˜¯æ‹¿ä»€ä¹ˆåšçš„ï¼Œæƒ³ä¿®æ”¹å‡ ä¸ªåœ°æ–¹*ï¼‰

![img](resource/index.assets/1623764219_60c8acfb3ef7813e28221.png)

â€‹		å®Œæ•´çš„æµç¨‹å¦‚ä¸Šæ‰€ç¤ºï¼Œä½†å¾ˆå¤šæµç¨‹æä¾›äº†ç‰¹å®šçš„åŠŸèƒ½é€‰é¡¹æ¥è¿›è¡Œå¼€å¯æˆ–è·³è¿‡è¯¥é˜¶æ®µã€‚æŽ¥ä¸‹æ¥å°†ä»‹ç»å„ä¸ªé˜¶æ®µçš„è®¾è®¡ç›®ï¼Œå¦‚ä½•å¼€å¯/å…³é—­è¯¥é˜¶æ®µï¼Œä»¥åŠè¯¥é˜¶æ®µçš„ä¸€äº›æ³¨æ„äº‹é¡¹ã€‚

- **é¢„æ‰«æè„šæœ¬**ï¼ˆScript pre-scanningï¼‰ï¼šä½¿ç”¨ `--script` æˆ– `-sC`åŠŸèƒ½é€‰é¡¹å¼€å¯Nmapè„šæœ¬å¼•æ“Žæ—¶ï¼Œå½“æŒ‡å®šçš„è„šæœ¬ä¸­å­˜åœ¨ç›¸åº”è„šæœ¬ï¼Œæ‰ä¼šæ‰§è¡Œè¿™ä¸ªé˜¶æ®µï¼Œé»˜è®¤ä¸è¿›è¡Œè¯¥é˜¶æ®µã€‚è¯¥é˜¶æ®µå®žçŽ°çš„åŠŸèƒ½ä¸ºæŒ‡å®šè„šæœ¬çš„åŠŸèƒ½ã€‚
- **ç›®æ ‡æžšä¸¾**ï¼šè¿™ä¸ªé˜¶æ®µç”¨äºŽè§£æžç”¨æˆ·è¾“å…¥çš„ç›®æ ‡ï¼Œå°†åŸŸåã€CIDRç­‰è§£æžä¸ºIPåœ°å€ä»¥ä¾›æ‰«æï¼Œè¿™æ˜¯å¿…ä¸å¯å°‘çš„ä¸€ä¸ªé˜¶æ®µã€‚`-sL -n`è¾“å‡ºçš„ç»“æžœå°±æ˜¯è¿™ä¸ªé˜¶æ®µçš„è¾“å‡ºç»“æžœã€‚ï¼ˆ-n è¡¨ç¤ºä¸è¿›è¡Œåå‘DNSè§£æžï¼‰
- **ä¸»æœºå‘çŽ°**ï¼ˆpingæ‰«æï¼‰ï¼šè¯¥é˜¶æ®µç”¨äºŽåˆ¤æ–­æ‰€æŒ‡å®šçš„ç›®æ ‡ä¸»æœºæœ‰å“ªäº›æ˜¯åœ¨çº¿çš„ï¼ŒåŒæ—¶è¿˜ä¼šæ”¶é›†ä¸Žç›®æ ‡ä¸»æœºä¹‹é—´çš„ç½‘ç»œçŠ¶å†µï¼Œç”¨äºŽåŠ é€ŸåŽç»­çš„ç«¯å£æ‰«æã€‚è¿™ä¸ªé˜¶æ®µæ”¯æŒå¾ˆå¤šä¸»æœºå‘çŽ°æŠ€æœ¯ï¼Œå¹¶ä¸”æ˜¯å¤šç§æŽ¢é’ˆä¸€åŒå·¥ä½œã€‚è¿™ä¸ªé˜¶æ®µé»˜è®¤è¿è¡Œï¼Œå¯ä»¥ä½¿ç”¨`-Pn` å¯ä»¥è·³è¿‡ä¸»æœºå‘çŽ°é˜¶æ®µï¼Œé»˜è®¤ç›®æ ‡ä¸»æœºåœ¨çº¿ã€‚
- **åå‘DNSè§£æž**ï¼šNmapä¼šé€šè¿‡pingæ‰«æå‘çŽ°æ‰€æœ‰åœ¨çº¿ä¸»æœºçš„åå‘DNSåç§°ï¼Œä¸»æœºåç§°å¯èƒ½æ³„éœ²è¯¥ä¸»æœºçš„åŠŸèƒ½ç”¨é€”ã€‚`-n`å¯ä»¥ç¦ç”¨åå‘è§£æžï¼Œè€Œ `-R`åˆ™è¡¨ç¤ºå¯¹æ‰€æœ‰ä¸»æœºï¼ˆå³ä½¿ä¸åœ¨çº¿ï¼‰ä¹Ÿè¿›è¡Œåå‘DNSè§£æžã€‚
- **ç«¯å£æ‰«æ**ï¼šNmapçš„æ ¸å¿ƒåŠŸèƒ½ï¼Œç”¨äºŽèŽ·å–ç«¯å£çš„å¼€æ”¾çŠ¶æ€ï¼Œæ”¯æŒå¤šç§æ‰«ææŠ€æœ¯ï¼Œä½†åŒä¸€æ—¶é—´åªèƒ½é€‰æ‹©ä¸€ç§æ‰«ææŠ€æœ¯æŽ¢é’ˆè¿›è¡ŒæŽ¢æµ‹ï¼Œè¾“å‡ºç»“æžœæœ‰å…­ç§ï¼šopenã€closedã€filteredã€unfilteredã€open|filteredã€closed|filteredã€‚**æ³¨æ„**ï¼š*è¿™äº›çŠ¶æ€ä¸æ˜¯ç«¯å£æœ¬èº«çœŸå®žçŠ¶æ€ï¼Œè€Œæ˜¯æè¿°Nmapå¦‚ä½•çœ‹å¾…å®ƒä»¬ã€‚ä¸åŒçš„æ‰«ææŠ€æœ¯å¾—åˆ°çš„çŠ¶æ€ä¹Ÿä¸ä¸€æ ·ï¼Œéœ€è¦å­¦ä¼šäº†è§£å…¶å«ä¹‰*ã€‚é»˜è®¤æ‰§è¡Œï¼Œä½†`-sn` å¯ä»¥è·³è¿‡ç«¯å£æ‰«æåŠŸèƒ½
- **æœåŠ¡å’Œç‰ˆæœ¬æŽ¢æµ‹**ï¼šå½“è¯†åˆ«åˆ°å¼€æ”¾çš„ç«¯å£æ—¶ï¼Œå¯å¯¹è¯¥ç«¯å£ä¸Šè¿è¡Œçš„æœåŠ¡å’Œç‰ˆæœ¬è¿›è¡ŒæŽ¢æµ‹ã€‚ä½¿ç”¨`-sV`å¯ç”¨ç‰ˆæœ¬æŽ¢æµ‹ã€‚
- **æ“ä½œç³»ç»Ÿæ£€æµ‹**ï¼š`-O` å¼€å¯ä¸»æœºæ“ä½œç³»ç»Ÿæ£€æµ‹ã€‚**æ³¨æ„**ï¼š*æ“ä½œç³»ç»Ÿæ£€æµ‹åˆ°çš„ç³»ç»Ÿå¯èƒ½ä¸Žç‰ˆæœ¬æŽ¢æµ‹é˜¶æ®µæ‰«æåˆ†æžå¾—å‡ºçš„ç³»ç»Ÿä¸ä¸€è‡´ï¼Œèƒ½çŒœåˆ°æ˜¯ä¸ºä»€ä¹ˆå—ï¼Ÿ*
- **ç½‘ç»œè·¯ç”±ç›‘æµ‹**ï¼ˆTracerouteï¼‰ï¼š`--traceroute` é€‰é¡¹å¼€å¯è¯¥åŠŸèƒ½ã€‚å®ƒå¯ä»¥ä½¿ç”¨ä¹‹å‰é˜¶æ®µç¡®å®šçš„æœ€ä½³å¯ç”¨æŽ¢æµ‹æ•°æ®åŒ…ï¼Œæ‰¾åˆ°å¹¶è¡Œåˆ°è¾¾å¤šä¸ªä¸»æœºçš„ç½‘ç»œè·¯ç”±ã€‚Traceroute é€šå¸¸æ¶‰åŠä¸­é—´ä¸»æœºçš„å¦ä¸€è½®åå‘ DNS è§£æžã€‚
- **è„šæœ¬æ‰«æ**ï¼šNmapè„šæœ¬å¼•æ“Žï¼ˆNSEï¼‰ä¸­çš„è„šæœ¬å¤§éƒ¨åˆ†è¿è¡Œåœ¨è¿™ä¸€é˜¶æ®µã€‚ä½¿ç”¨ `--script` æˆ–`-sC`ç­‰é€‰é¡¹å¯ç”¨æ­¤åŠŸèƒ½ã€‚Nmapæ”¯æŒ6ç§ç±»åž‹çš„è„šæœ¬ï¼ŒåŒæ—¶è¿˜å…è®¸é«˜ç«¯çŽ©å®¶æ ¹æ®éœ€æ±‚è‡ªå·±ç¼–å†™è„šæœ¬ï¼ŒæŽŒæ¡Nmap è„šæœ¬æ‰©å±•å¼€å‘æ˜¯å¾ˆæœ‰å¸®åŠ©çš„ã€‚
- **ç»“æžœè¾“å‡º**ï¼šè¿™ä¸€é˜¶æ®µNmapä¼šå°†å…¶æ”¶é›†åˆ°çš„æ‰€æœ‰ä¿¡æ¯å†™å…¥å±å¹•æˆ–æ–‡ä»¶ã€‚æ”¯æŒå¤šç§æ ¼å¼è¾“å‡ºï¼Œé»˜è®¤æ˜¯è¾“å‡ºåˆ°å±å¹•ã€‚
- **åŽæ‰«æè„šæœ¬**ï¼ˆScript post-scanningï¼‰ï¼šåœ¨ Nmap å®Œæˆæ‰«æå’Œæ­£å¸¸è¾“å‡ºåŽï¼Œæ­¤é˜¶æ®µçš„è„šæœ¬å¯ä»¥å¤„ç†ç»“æžœå¹¶æä¾›æœ€ç»ˆæŠ¥å‘Šå’Œç»Ÿè®¡ä¿¡æ¯ã€‚é»˜è®¤ä¸åŒ…å«ä»»ä½•è„šæœ¬ï¼Œä¹Ÿå°±ç›¸å½“äºŽé»˜è®¤ä¸è¿›è¡Œè¿™ä¸ªé˜¶æ®µï¼Œåªæœ‰åœ¨ç”¨æˆ·åŒ…å«å¹¶æ‰§è¡Œä»–ä»¬è‡ªå·±çš„æ‰«æåŽè„šæœ¬æ—¶æ‰ä¼šè¿è¡Œã€‚åŒæ ·ä¹Ÿæ˜¯ä½¿ç”¨ `--script` ç­‰é€‰é¡¹å¯ç”¨ã€‚

 

## 0x03. é»˜è®¤çš„é€‰é¡¹æŠ€æœ¯

â€‹		Nmap é»˜è®¤çš„é€‰é¡¹æŠ€æœ¯ï¼Œè¿™é‡Œæˆ‘ä»¬è¿˜æ˜¯ç”¨ `nmap 192.168.1.1/24` ä¸ºä¾‹åˆ†æžï¼Œåœ¨ä¸Šæ–‡äº†è§£å®Œè¿è¡Œæµç¨‹ä¹‹åŽï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“è¿™æ¡å‘½ä»¤åŒ…å«äº†ç›®æ ‡åˆ—ä¸¾ã€ä¸»æœºå‘çŽ°ã€åå‘DNSè§£æžã€ç«¯å£æ‰«æå’Œç»“æžœè¾“å‡ºè¿™ä¹ˆ5ä¸ªé˜¶æ®µã€‚

### 3.1 ç›®æ ‡åˆ—ä¸¾

â€‹		ç›®æ ‡åˆ—ä¸¾è¿™é‡Œå°±æ˜¯å°†CIDRç±»è§£æžä¸ºIPåœ°å€åˆ—è¡¨ï¼Œå¦‚æžœæœ‰åŸŸåçš„è¯ï¼Œéœ€è¦è¿›è¡ŒDNSè§£æžå°†åŸŸåè½¬åŒ–ä¸ºIPåœ°å€ã€‚é»˜è®¤æƒ…å†µä¸‹, Nmap ä¼šé€šè¿‡ resolv.conf æ–‡ä»¶ (Unix)å’Œæ³¨å†Œè¡¨ (Win32) æ¥ç¡®å®šä½¿ç”¨çš„DNSè§£æžå™¨ï¼Œä¼šå‘ä¸»æœºä¸Šé…ç½®çš„åŸŸåæœåŠ¡å™¨è¿›è¡Œè§£æžIPåœ°å€ã€‚Nmapæœ‰ä¸¤ä¸ªåŠŸèƒ½é€‰é¡¹æ”¯æŒæŽ§åˆ¶DNSè§£æžæœåŠ¡å™¨ï¼Œåˆ†åˆ«ä¸º`--system-dns` å’Œ `--dns-servers &lt;server1&gt;[,&lt;server2&gt;[,...]]`ï¼ŒæŽ¨èä½¿ç”¨åŽè€…ï¼ŒåŽŸå› åŽé¢å†è¯´ã€‚

### 3.2 ä¸»æœºå‘çŽ°

â€‹		ä¸»æœºå‘çŽ°é»˜è®¤ä½¿ç”¨å¤šç§ping æ‰«ææŠ€æœ¯æŽ¢é’ˆåŒæ—¶æŽ¢æµ‹ï¼ŒåŒ…æ‹¬æœ‰ï¼š-PE -PS443 -PA80 -PP  é€‰é¡¹ã€‚æ„å‘³ç€å¯¹æ¯ä¸ªæœºå™¨å‘é€ä¸€ä¸ªICMP echo è¯·æ±‚ï¼Œä¸€ä¸ª TCP SYN åŒ…ï¼Œä¸€ä¸ª TCP ACK åŒ…ï¼Œå’Œä¸€ä¸ª ICMP æ—¶é—´æˆ³è¯·æ±‚åŒ…ã€‚å¦‚æžœæ˜¯å¯¹ç§æœ‰åœ°å€ï¼Œè¿˜ä¼šä½¿ç”¨-PRï¼Œarpæ‰«æè¿›è¡ŒæŽ¢æµ‹ã€‚

â€‹		`--packet-trace`å…è®¸æˆ‘ä»¬æŸ¥çœ‹Nmapæ‰€å‘èµ·çš„æ•°æ®åŒ…æµï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªé€‰é¡¹æ¥è¿›è¡ŒéªŒè¯ï¼Œå¦‚å›¾ï¼š

![img](resource/index.assets/1623764375_60c8ad9757139410759fc.png)

â€‹		æ ¹æ®å®žéªŒæˆ‘ä»¬å¯ä»¥å¾—å‡ºNmapä¸»æœºå‘çŽ°æŽ¢æµ‹çš„é¡ºåºï¼Œä»»æ„æŽ¢æµ‹æ”¶åˆ°ç›®æ ‡ä¸»æœºçš„å“åº”åŽå°†åœæ­¢ä¸»æœºå‘çŽ°é˜¶æ®µï¼Œä¸åœ¨å‘é€å…¶ä»–æŽ¢é’ˆï¼›å¯¹äºŽæœªæ”¶åˆ°å“åº”çš„ä¸»æœºï¼ŒNmapä¼šè¿›è¡Œ1æ¬¡é‡æ”¾ï¼Œä»¥é˜²å› ç½‘ç»œå› ç´ å¼•èµ·çš„è¶…æ—¶ä¸¢åŒ…ç­‰å½±å“åˆ¤æ–­ã€‚å¯¹ç§æœ‰åœ°å€åˆ™ä¼šé‡‡ç”¨ARPè¿›è¡ŒæŽ¢æµ‹ã€‚

â€‹		Nmap æ”¯æŒå¤šç§ä¸»æœºå‘çŽ°æŠ€æœ¯ï¼Œå¯ä»¥ç”¨ -h æŸ¥çœ‹ HOST DISCOVERY å­—æ®µï¼Œæ”¯æŒçš„æŠ€æœ¯é€‰é¡¹æœ‰ï¼š-PS/PA/PU/PYï¼Œ-PE/PP/PMï¼Œ-POï¼Œ**æ³¨æ„ï¼šå¦‚æžœä½ æŒ‡å®šäº†ä»»ä½• -P é€‰é¡¹ï¼Œå®ƒä¼šæ›¿æ¢é»˜è®¤çš„å‘çŽ°æŽ¢é’ˆï¼Œè€Œä¸æ˜¯åœ¨é»˜è®¤åŸºç¡€ä¸Šå¢žåŠ æ–°çš„æŽ¢é’ˆç±»åž‹ã€‚**

### 3.3 åå‘DNSè§£æž

â€‹		Nmapä¼šå°†å­˜æ´»ä¸»æœºåˆ—è¡¨ä¼ å…¥è¿™ä¸ªé˜¶æ®µè¿›è¡Œåå‘DNSè§£æžï¼Œé€šè¿‡è§£æžå‡ºçš„ä¸»æœºåç§°ï¼Œç”¨æˆ·å¯ä»¥æŽ¨æµ‹è¯¥ä¸»æœºçš„ç”¨é€”ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š

![img](resource/index.assets/1623764434_60c8add2d368ee88b5d10.png)

â€‹		ä»Žç»“æžœæˆ‘ä»¬å¯ä»¥æŽ¨æµ‹å‡ºï¼Œè¯¥IPæ˜¯é˜¿é‡Œçš„å…¬å…±DNSæœåŠ¡å™¨ã€‚

â€‹		åŒæ—¶æˆ‘ä»¬æ³¨æ„åˆ°ï¼Œå¯¹ä¸€ä¸ªIPçš„åå‘è§£æžç”¨æ—¶0.07sï¼Œå¦‚æžœæ˜¯å¯¹å¤šä¸ªIPè¿™ä¸ªæ—¶é—´å°†ä¼šæ›´é•¿ï¼ŒDNSè§£æžä¼šå½±å“æ‰«ææ—¶é•¿ã€‚ä¾‹å¦‚æˆ‘å¯¹223.5.5.5-10å…±6ä¸ªIPè¿›è¡ŒæŽ¢æµ‹ï¼Œåœ¨åå‘DNSè§£æžä¸Šå°±éœ€è¦èŠ±è´¹2.63ç§’ã€‚

![img](resource/index.assets/1623764465_60c8adf1f2bc1054359e2.png)

â€‹		ä¸ºä»€ä¹ˆ1ä¸ªIPåªè¦0.07sï¼Œè€Œ6ä¸ªå´è¦2.63sï¼Œç›¸å·®é‚£ä¹ˆå¤šï¼ŸåŽŸå› å…¶å®žå¾ˆç®€å•ï¼Œå¦‚æžœä½ äº†è§£DNSçš„è§£æžè¿‡ç¨‹å°±åº”è¯¥æŒ‡å®šï¼Œå½“æœ¬åœ°DNSè§£æžä¸åˆ°ï¼Œå®ƒä¼šå‘å…¶ä»–DNSè¿›è¡ŒæŸ¥è¯¢ï¼Œ223.5.5.5æ˜¯ä¸€ä¸ªç›¸å¯¹çŸ¥åçš„ä¸»æœºï¼Œå¾ˆå·®å¾ˆå¤šDNSæœåŠ¡å™¨éƒ½ä¼šæœ‰æ”¶å½•ï¼Œè§£æžå°±å¿«ï¼Œè€Œå…¶ä»–IPå°±æ²¡æœ‰çŸ¥ååº¦ï¼Œéœ€è¦å‘å…¶ä»–DNSè¿›è¡ŒæŸ¥è¯¢ï¼ŒNmapéœ€è¦ç­‰å¾…ç¬¬ä¸‰æ–¹è¿”å›žç»“æžœï¼Œè€—æ—¶å°±å¤§å¤§å¢žåŠ äº†ã€‚

â€‹		è¿™é‡Œæ¥è§£é‡Šä¸€ä¸‹`--system-dns` å’Œ `--dns-servers &lt;server1&gt;[,&lt;server2&gt;[,...]]`çš„åŒºåˆ«ï¼Œå‰è€…æ˜¯é™å®šä½¿ç”¨ç³»ç»ŸDNSè§£æžå™¨ï¼Œèµ„æºæœ‰é™ï¼›è€ŒåŽè€…å¯ä»¥æ‰‹åŠ¨æŒ‡å®šDNSæœåŠ¡å™¨ä¸”å…è®¸å¤šä¸ªï¼Œå°¤å…¶æ˜¯æŒ‡å®šä¸€äº›çŸ¥åæœåŠ¡å™¨æ—¶ï¼Œè§£æžé€Ÿåº¦ä¼šç›¸å¯¹åŠ å¿«ä¸€äº›ã€‚

### 3.4 ç«¯å£æ‰«æ

â€‹		Nmap é»˜è®¤çš„ç«¯å£æ‰«ææŠ€æœ¯æ˜¯SYNæŽ¢æµ‹ï¼Œå¯¹åº”çš„é€‰é¡¹æ˜¯ -sSï¼Œè¿™è¢«ç§°ä¸ºTCP åŠè¿žæŽ¥ï¼ŒåŽŸç†ç½‘ä¸Šè‡ªæŸ¥ï¼Œå¾ˆå¤šæ‰«æå™¨éƒ½ä¼šç”¨è¿™ç§æ–¹å¼è¿›è¡ŒæŽ¢æµ‹ï¼Œå› æ­¤å¾ˆå¤šIDSéƒ½èƒ½æ£€æµ‹åˆ°ã€‚å…¶ä»–ç«¯å£æ‰«ææŠ€æœ¯å¯è§ nmap -h ä¸­ SCAN TECHNIQUES ä¸€èŠ‚ï¼Œå®ƒç»™å‡ºäº†æŠ€æœ¯åç§°ï¼Œç›¸ä¿¡ç½‘ä¸Šèƒ½æœåˆ°ç›¸åº”çš„æŠ€æœ¯åŽŸç†ã€‚ã€ŠNmap Network Scanningã€‹ç¬¬äº”ç« ï¼šç«¯å£æ‰«ææŠ€æœ¯å’Œç®—æ³•è¯¦ç»†ä»‹ç»äº†å„ç§æ‰«ææŠ€æœ¯åŠåŽŸç†ã€‚

â€‹		Nmap é»˜è®¤é…ç½®æ˜¯æ‰«ææœ€å¸¸è§çš„1000ä¸ªç«¯å£ï¼Œé‚£ä¹ˆæœ‰æ²¡æœ‰äººè·Ÿæˆ‘ä¸€æ ·å¥½å¥‡è¿‡è¿™æœ€å¸¸è§çš„1000ä¸ªç«¯å£åˆ°åº•æ˜¯å“ªäº›ç«¯å£å‘¢ï¼Ÿnmap-servicesæ–‡ä»¶ä¸­å°±è®°å½•ç€ï¼Œhttps://nmap.org/book/nmap-services.html ç»™å‡ºäº†å¦‚ä½•é˜…è¯»å’Œç†è§£è¯¥æ–‡ä»¶ï¼Œæ¯ä¸€è¡Œè¡¨ç¤ºåœ¨ç›¸åº”ç«¯å£å‘çŽ°ç‰¹å®šæœåŠ¡çš„å¯èƒ½æ€§ï¼ŒNmapçš„è¿™ä¸ªæœ€å¸¸è§çš„1000ä¸ªå°±æ˜¯åŸºäºŽè¿™ä¸ªæ–‡ä»¶å¾—å‡ºçš„ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡è¿™ä¸ªæ–‡ä»¶åŽ»ç»Ÿè®¡ä¸€ä¸‹å„ç«¯å£çš„é¢‘çŽ‡ï¼Œä½†æ˜¯æˆ‘æ²¡åŽ»åšï¼Œæ‰€ä»¥æˆ‘è¿˜æ˜¯ä¸çŸ¥é“æœ€å¸¸è§çš„1000ä¸ªæ˜¯å“ªäº›ç«¯å£ ðŸ˜† ã€‚

â€‹		å¯¹äºŽæ‰«æçš„ç«¯å£èŒƒå›´ï¼ŒNmapæä¾›äº†å‡ ä¸ªæŽ§åˆ¶é€‰é¡¹ã€‚

â€‹		`-p`é€‰é¡¹ï¼Œç”¨æˆ·æŒ‡å®šæ‰«æèŒƒå›´ï¼ŒæŒ‡å®šç‰¹å®šçš„ç«¯å£ï¼Œå¦‚ -p 80,443ï¼Œnmapè¿˜æ”¯æŒæŒ‡å®šåè®®åç§°åŽ»æŸ¥è¯¢æœ€å¯èƒ½å‡ºçŽ°çš„ç«¯å£ï¼Œå¦‚ -p http,httpsï¼ŒNmapä¼šæŽ¢æµ‹80ï¼Œ8008å’Œ433ç«¯å£ã€‚åŒæ ·ä¹Ÿå¯ä»¥é€šè¿‡nmap-servicesæ–‡ä»¶æŸ¥è¯¢ã€‚è¿™é‡Œè¿˜æ”¯æŒé€šé…ç¬¦ï¼Œä¾‹å¦‚-p *htttpï¼Œç»“æžœå¦‚ä¸‹ï¼š

![img](resource/index.assets/1623764940_60c8afcca53d199b615af.png)

â€‹		`--exclude-ports` é€‰é¡¹ï¼ŒæŽ’é™¤ç‰¹å®šç«¯å£ï¼Œä¸è¿›è¡Œæ‰«æï¼›

â€‹		`-F`é€‰é¡¹ï¼Œfastæ¨¡å¼ï¼Œæ‰«ææœ€å¸¸è§çš„100ä¸ªç«¯å£ï¼›

â€‹		`-r` é€‰é¡¹ï¼ŒæŽ§åˆ¶ç«¯å£ä»Žå°åˆ°å¤§ä¾æ¬¡è¿›è¡Œæ‰«æï¼Œè€Œä¸æ˜¯éšæœºé€‰æ‹©ã€‚

â€‹		`--top-ports &lt;number&gt;` é€‰é¡¹ï¼Œæ‰«ææœ€å¸¸è§çš„æŒ‡å®šæ•°é‡ä¸ªç«¯å£ã€‚å‰ n ä¸ªç«¯å£æ˜¯ç”±Â **/usr/share/nmap/nmap-services**æ–‡ä»¶ç¡®å®šçš„ã€‚æœ‰æ—¶å€™ä¸ºäº†å…¨é¢çš„ç›®æ ‡ä¸»æœºçš„ç«¯å£çŠ¶æ€ï¼Œä¼šè¿›è¡Œå…¨ç«¯å£æ‰«æï¼Œä»¥å…é—æ¼æ”»å‡»é¢ã€‚NNSä¸€ä¹¦[ç¬¬å…­ç« ï¼Œä¼˜åŒ–Nmapæ€§èƒ½ï¼šç«¯å£é€‰æ‹©æ•°æ®å’Œç­–ç•¥](https://nmap.org/book/performance-port-selection.html)ä¸­ï¼Œç»™å‡ºäº†ä¸€å¼ å…³äºŽç«¯å£æ‰«ææ•°é‡å’Œæœ‰æ•ˆæ€§çš„è¡¨æ ¼ï¼ŒTCPä»…éœ€æ‰«æ3328ä¸ªç«¯å£å°±èƒ½è¾¾åˆ°99%çš„æ•ˆçŽ‡ï¼ŒUDPä»…éœ€15094ä¸ªï¼Œè€Œè¾¾åˆ°100%åˆ™éœ€è¦65536å…¨ç«¯å£æ‰«æã€‚å› æ­¤æ˜¯ä¸ºäº†ä¿è¯å‡†ç¡®çŽ‡ä»…éœ€å…¨ç«¯å£æ‰«æï¼Œè¿˜æ˜¯ç‰ºç‰²1ç‚¹å‡†ç¡®çŽ‡æ¢å–æ›´çŸ­çš„æ‰«ææ—¶é•¿ï¼Œå–å†³äºŽä¸ªäººé€‰æ‹©ã€‚

â€‹		`--port-ratio &lt;ratio&gt;` é€‰é¡¹ï¼ŒæŽ§åˆ¶åªæ‰«æå¯èƒ½æ€§å¤§äºŽæŒ‡å®šratioçš„ç«¯å£ï¼ŒåŒæ ·æ ¹æ® nmap-services æ–‡ä»¶ç»Ÿè®¡æ•°æ®ã€‚

### 3.5 ç»“æžœè¾“å‡º

â€‹		é»˜è®¤ç»“æžœæ˜¯è¾“å‡ºåˆ°å‘½ä»¤è¡Œç•Œé¢ã€‚å…¶ä»–å¯¹è¾“å‡ºçš„æŽ§åˆ¶é€‰é¡¹æœ‰ï¼š

#### è¾“å‡ºæ–‡ä»¶ç±»åž‹æŽ§åˆ¶ï¼š

â€‹		-oN é€‰é¡¹ï¼Œä»¥äººç±»å¯è¯»çš„æ™®é€šæ¨¡å¼ï¼ˆä¸Žå‘½ä»¤è¡Œç•Œé¢çš„è¾“å‡ºç»“æžœä¸€è‡´ï¼‰ä¿å­˜åˆ°æŒ‡å®šæ–‡ä»¶ä¸­ï¼›

â€‹		-oX é€‰é¡¹ï¼Œè¾“å‡ºä¸ºXMLæ–‡ä»¶æ ¼å¼ã€‚å› ä¸ºXMLçš„åŠŸèƒ½æ€§ï¼Œæ˜“ä¸Žå…¶ä»–å·¥å…·è¿›è¡Œè”åŠ¨ï¼›

â€‹		-oS é€‰é¡¹ï¼Œè¾“å‡ºä¸ºâ€œè„šæœ¬å°å­â€æ ¼å¼ï¼ˆScript kiddieï¼‰ï¼Œè¾“å‡ºå†…å®¹ä¼šæœ‰å¤§å°å†™äº¤å‰ï¼Œéƒ¨åˆ†å­—æ¯ç”±å…¶ä»–ç¬¦å·ä»£æ›¿ï¼›ä½œè€…åŽŸè¯ï¼š

&gt; It is simply a joke *making fun* of the script kiddiesâ€”they don&#39;t actually use this mode (I hope).

â€‹		-oG é€‰é¡¹ï¼Œè¾“å‡ºä¸ºé€‚åˆGrepçš„æ ¼å¼ï¼Œè¯¥æ ¼å¼æ›´é€‚åˆåœ¨UnixçŽ¯å¢ƒä¸‹ä½¿ç”¨Grepå‘½ä»¤æ¥èŽ·å–æ•°æ®ã€‚

â€‹		-oA é€‰é¡¹ï¼ŒåŒæ—¶è¾“å‡ºNormalï¼ˆ-oNï¼‰ã€XMLï¼ˆ-oXï¼‰ã€Grepableï¼ˆ-oG ï¼‰æ ¼å¼æ–‡ä»¶ã€‚

â€‹		Nmapçš„è¿™äº›å‚æ•°éƒ½æ”¯æŒåœ¨æ–‡ä»¶åä¸­ä½¿ç”¨ç±»ä¼¼strftimeçš„è½¬æ¢ï¼Œ %H, %M, %S, %m, %d, %y,å’Œ%Y å®Œå…¨ä¸€è‡´ï¼Œ%T ç­‰åŒäºŽ %H%M%Sï¼ˆæ—¶åˆ†ç§’ï¼‰ï¼Œ%R ç­‰åŒäºŽ%H%M, ï¼Œ %D ç­‰åŒäºŽ %m%d%yï¼ˆæœˆæ—¥å¹´ï¼‰ã€‚å› æ­¤ `-oX &#39;scan-%T-%D.xml&#39;` ä¼šç”Ÿæˆæ–‡ä»¶åä¸º `scan-144840-121307.xml` çš„XMLæ–‡ä»¶ã€‚

â€‹		Normalå’ŒGrepableæ ¼å¼çš„æ–‡ä»¶ï¼Œæ”¯æŒä¸­æ–­æ‰«æåŽç»§ç»­æ‰«æï¼Œå‘½ä»¤ä¸º `nmap --resume &lt;filename&gt;`ï¼ŒXMLæ–‡ä»¶è¾“å‡ºä¸æ”¯æŒï¼ŒåŽŸå› æ˜¯XMLæ–‡ä»¶è¿½åŠ å†…å®¹æ›´éš¾ã€‚

â€‹		--append-output é€‰é¡¹ï¼Œåœ¨æŒ‡å®šæ–‡ä»¶åŽé¢è¿½åŠ å†…å®¹ã€‚ä¸Šè¿°çš„ -oN ä¹‹ç±»é€‰é¡¹é»˜è®¤ä¼šè¦†ç›–æŒ‡å®šæ–‡ä»¶ï¼Œå½“ä½ æƒ³ä¿ç•™åŽŸæ–‡ä»¶ï¼Œåœ¨åŽé¢é™„åŠ æ–°ç»“æžœæ—¶ï¼Œç”¨è¿™ä¸ªé€‰é¡¹ã€‚åŒæ ·ä¹Ÿä¸é€‚åˆ -oX é€‰é¡¹ï¼Œå› ä¸ºä»–ä¼šå¯¼è‡´XMLæ–‡ä»¶è§£æžå¤±è´¥ï¼Œéœ€è¦æ‰‹åŠ¨ä¿®å¤ã€‚

#### è¾“å‡ºä¿¡æ¯æŽ§åˆ¶

â€‹		-v é€‰é¡¹ï¼Œæ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯ï¼Œå¯ä»¥ -vv æˆ–-v2 èŽ·å–æ›´è¯¦ç»†ä¿¡æ¯ï¼›

â€‹		-d é€‰é¡¹ï¼Œæ˜¾ç¤ºè°ƒè¯•ä¿¡æ¯ï¼Œå¯ä»¥ -dd æˆ– -d2 èŽ·å–æ›´è¯¦ç»†çš„è°ƒè¯•ä¿¡æ¯ï¼›

â€‹		--packet-trace é€‰é¡¹ï¼Œæ˜¾ç¤ºæ•°æ®åŒ…è¿½è¸ªï¼›

â€‹		å…¶ä»–è¿˜æœ‰ --reasonã€--openã€--iflistã€--stylesheetã€--webxmlã€-no-stylesheet ï¼Œå¯ä»¥æŸ¥çœ‹nmap -h ï¼Œæ²¡ä»€ä¹ˆè¦è¯´æ˜Žçš„å†…å®¹ã€‚

#### å‘½ä»¤è¡Œäº¤äº’å¼æŽ§åˆ¶

â€‹		åœ¨æ‰«æè¿‡ç¨‹ä¸­ï¼Œå¯ä»¥é€šè¿‡æŒ‰é”®è¿›è¡Œäº¤äº’å¼æŽ§åˆ¶ï¼Œè°ƒæ•´Nmapåœ¨å‘½ä»¤è¡Œç•Œé¢çš„è¾“å‡ºä¿¡æ¯ã€‚nmapè¿è¡Œæ—¶ï¼Œæ‰€æœ‰æŒ‰é”®éƒ½ä¼šè¢«æ•èŽ·ã€‚è¿™å…è®¸æ‚¨ä¸Žç¨‹åºäº¤äº’è€Œæ— éœ€ä¸­æ­¢å’Œé‡æ–°å¯åŠ¨å®ƒã€‚æŸäº›ç‰¹æ®Šé”®å°†æ›´æ”¹é€‰é¡¹ï¼Œè€Œä»»ä½•å…¶ä»–é”®å°†æ‰“å°å‡ºä¸€æ¡çŠ¶æ€æ¶ˆæ¯ï¼Œå‘Šè¯‰æ‚¨æœ‰å…³æ‰«æçš„ä¿¡æ¯ã€‚é€šå¸¸æ˜¯å°å†™å­—æ¯å¢žåŠ æ‰“å°é‡ï¼Œå¤§å†™å­—æ¯å‡å°‘æ‰“å°é‡ã€‚æ‚¨ä¹Ÿå¯ä»¥æŒ‰â€œ?â€å¯»æ±‚å¸®åŠ©ã€‚

- v/V		å¢žåŠ /å‡å°‘è¯¦ç»†ç¨‹åº¦è¾“å‡ºï¼Œå¯¹åº” `-v`é€‰é¡¹åŠŸèƒ½
- d/D		å¢žå¤§/å‡å°è°ƒè¯•çº§åˆ«ï¼Œå¯¹åº” `-d`é€‰é¡¹åŠŸèƒ½
- p/P		æ‰“å¼€/å…³é—­æ•°æ®åŒ…è·Ÿè¸ªï¼Œå¯¹åº” `--packet-trace` é€‰é¡¹åŠŸèƒ½
- ? 		  æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯

### 3.6 å°ç»“

â€‹		å›žå½’åˆ°é—®é¢˜ï¼ŒNmap åŒ…å«äº†å“ªäº›é»˜è®¤é€‰é¡¹ï¼Œå¦‚æ‰§è¡Œäº†å“ªäº›æŽ¢æµ‹æŠ€æœ¯ç­‰ï¼Ÿ

â€‹		Nmap 1.1.1.1 åŒ…å«çš„ -PEï¼ˆICMP EchoæŽ¢æµ‹ï¼‰ï¼Œ-PS443ï¼ˆå¯¹443ç«¯å£æ˜¯SYNæŽ¢æµ‹ï¼‰ï¼Œ-PA80ï¼ˆå¯¹80ç«¯å£çš„ACKæŽ¢æµ‹ï¼‰ï¼Œ-PPï¼ˆICMP æ—¶é—´æˆ³æŽ¢æµ‹ï¼‰ä¸»æœºå‘çŽ°æŠ€æœ¯ï¼Œåå‘DNSè§£æžæŠ€æœ¯ï¼Œ-sSï¼ˆSYNæŽ¢æµ‹ï¼‰ç«¯å£æ‰«ææŠ€æœ¯æ‰«æ1000ä¸ªç«¯å£ï¼Œå°†ç»“æžœè¾“å‡ºåˆ°äº¤äº’å¼å‘½ä»¤è¡Œä¸­ã€‚

## 0x04 ç«¯å£æ‰«ææŠ€æœ¯

ä¸»æœºå‘çŽ°æŠ€æœ¯çš„åŽŸç†ä¸è¯´äº†

Nmapçš„ç«¯å£æŽ¢æµ‹æŠ€æœ¯çŸ¥é“å¤šå°‘ç§ï¼Œå¯¹åº”çš„åŽŸç†æ˜¯ä»€ä¹ˆï¼Ÿæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œåˆ†åˆ«é€‚åˆä»€ä¹ˆåœºæ™¯ï¼Ÿ

### 4.1 -sS SYNæ‰«æ

â€‹		-sS	SYNæ‰«æï¼ŒåŠè¿žæŽ¥æ‰«æï¼Œä¼˜ç‚¹æ˜¯æ‰«æé€Ÿåº¦å¿«ï¼Œä¸å®¹æ˜“è¢«è®°å½•ï¼Œé€‚ç”¨äºŽä»»ä½•å…¼å®¹TCPå †æ ˆï¼Œå¯ä»¥æ¸…æ™°å¯é åœ°åŒºåˆ†ç«¯å£å¼€å¯ã€å…³é—­å’Œè¿‡æ»¤çŠ¶æ€ã€‚ä½†éœ€è¦rootæƒé™åŽ»æž„é€ åŽŸå§‹æ•°æ®åŒ…ï¼Œç›®å‰IDSå¯ä»¥æ£€æµ‹åˆ°è¿™ç§æ‰«ææ–¹å¼ã€‚

â€‹		åŽŸç†ç®€å•æ¥è¯´å°±æ˜¯åˆ©ç”¨äº†TCPä¸‰æ¬¡æ¡æ‰‹ï¼Œå‘ç›®æ ‡å‘é€SYNæ•°æ®åŒ…ï¼Œ

â€‹		è‹¥æ”¶åˆ°SYN/ACKè¿”å›žï¼Œåˆ™ç«¯å£å¼€æ”¾ï¼Œå‘é€RSTåŒ…ç»ˆæ­¢å»ºç«‹è¿žæŽ¥ï¼ˆå›¾5.2ï¼‰ï¼›

â€‹		è‹¥æ”¶åˆ°RSTè¿”å›žåŒ…ï¼Œåˆ™ç›®æ ‡ç«¯å£å…³é—­ï¼ˆå›¾5.3ï¼‰ï¼›

â€‹		è‹¥ç›®æ ‡æ— å“åº”ï¼Œåˆ™è¯¥ç«¯å£å¯èƒ½è¢«è¿‡æ»¤ï¼ˆå›¾5.4ï¼‰ã€‚

![img](resource/index.assets/1623765991_60c8b3e779fa68aed2f07.jpeg)

![img](resource/index.assets/1623765996_60c8b3ecaf176e60ecdbf.jpeg)

![img](resource/index.assets/1623766004_60c8b3f47fdf55da09640.jpeg)

### 4.2 -sT TCP è¿žæŽ¥æ‰«æ

â€‹		-sT	TCP connect è¿žæŽ¥æ‰«æï¼Œå»ºç«‹å®Œæ•´çš„è¿žæŽ¥ï¼Œä¼šè¢«æ—¥å¿—ã€IDSç­‰è®°å½•ã€‚

â€‹		è¿™é€šå¸¸æ˜¯éžé«˜æƒé™ç”¨æˆ·çš„é»˜è®¤æ‰«ææ–¹å¼ï¼ŒNmapä¼šè°ƒç”¨ç³»ç»Ÿåº•å±‚çš„connectä¸Žç›®æ ‡ç«¯å£å»ºç«‹è¿žæŽ¥ã€‚ä¸€æ¬¡å®Œæ•´çš„è¿žæŽ¥å»ºç«‹è¿‡ç¨‹éœ€è¦SYNã€SYN/ACKã€ACKã€Dataã€RST 5ä¸ªæ•°æ®åŒ…ï¼Œé€Ÿåº¦æ¯”SYNæ…¢ã€‚

![img](resource/index.assets/1623766011_60c8b3fb9109772800c59.jpeg)

### 4.3 -sA ACKæ‰«æ

â€‹		-sA	ACKæ‰«æï¼Œé€‚åˆç”¨æ¥æ˜ å°„é˜²ç«å¢™è§„åˆ™ã€‚

â€‹		ACKæ‰«æä¸èƒ½ç¡®å®šç«¯å£ä¸ºå¼€å‘çŠ¶æ€ï¼Œå¯ä»¥ç”¨äºŽæ˜ å°„é˜²ç«å¢™è§„åˆ™é›†ï¼Œç¡®å®šæ˜¯å¦æœ‰çŠ¶æ€ç›‘æµ‹é˜²ç«å¢™ï¼Œä»¥åŠå¯¹å“ªäº›ç«¯å£è¿›è¡Œäº†è¿‡æ»¤ã€‚å½“æ‰«æè¢«è¿‡æ»¤ç³»ç»Ÿæ—¶ï¼Œæ— è®ºæ˜¯å¼€å¯æˆ–å…³é—­çš„ç«¯å£éƒ½ä¼šè¿”å›žRSTæ•°æ®åŒ…ï¼Œåˆ™Nmapä¼šæ ‡è®°ä¸º unfiltered ï¼›è‹¥ç«¯å£æ²¡æœ‰å“åº”åŒ…æˆ–æ”¶åˆ°ICMPä¸å¯è¾¾æŠ¥é”™ï¼Œåˆ™æ ‡è®°ä¸º filteredã€‚

### 4.4 -sW çª—å£æ‰«æ

â€‹		-sW 	Windowsæ‰«æï¼Œ

â€‹		çª—å£æ‰«æåŽŸç†ä¸ŽACKæ‰«æç›¸åŒï¼Œä½†å®ƒä¼šåˆ©ç”¨ç³»ç»Ÿçš„å®žçŽ°ç»†èŠ‚åŒºåˆ†ç«¯å£å¼€æ”¾å’Œå…³é—­ï¼Œè€Œä¸æ˜¯éƒ½æ ‡è®°ä¸º unfilteredã€‚å®ƒä¼šå¯¹RSTæ•°æ®åŒ…çš„TCPçª—å£å€¼è¿›è¡Œåˆ¤æ–­ï¼Œè‹¥çª—å£å­—æ®µä¸º0ï¼Œåˆ™è¯¥ç«¯å£æ ‡è®°ä¸ºclosedï¼Œè‹¥ç«¯å£å­—æ®µéž0ï¼Œåˆ™æ ‡è®°ä¸ºopenã€‚

â€‹		è¿™ç§æ‰«ææŠ€æœ¯ä¾èµ–äºŽéƒ¨åˆ†æ“ä½œç³»ç»Ÿçš„ç‰¹æ€§ï¼Œæ™®éæ€§ä¸é«˜ã€‚æŸäº›ç³»ç»Ÿå¼€æ”¾çš„ç«¯å£ä¸Šçª—å£å¤§å°ä¸ºæ­£æ•°ï¼Œè€Œå…³é—­ç«¯å£åˆ™ä¸º0ã€‚

### 4.5 -sM Maimonæ‰«æ

â€‹		-sM	Maimonæ‰«æï¼Œä»¥å‘çŽ°è€…Uriel Maimonå‘½åï¼Œä½¿ç”¨ FIN/ACK æ•°æ®åŒ…ä¸ºæŽ¢é’ˆã€‚

â€‹		æ ¹æ®RFC 793ï¼ˆTCPï¼‰ï¼Œæ— è®ºç«¯å£æ˜¯æ‰“å¼€è¿˜æ˜¯å…³é—­éƒ½åº”ç”ŸæˆRSTæ•°æ®åŒ…æ¥å“åº”æ­¤æŽ¢æµ‹ã€‚ä½†æ˜¯ï¼ŒUrielæ³¨æ„åˆ°ï¼Œå¦‚æžœç«¯å£æ˜¯å¼€æ”¾çš„ï¼Œåˆ™è®¸å¤šBSDæ´¾ç”Ÿçš„ç³»ç»Ÿåªä¼šä¸¢å¼ƒè¯¥æ•°æ®åŒ…ï¼ŒNmapå€Ÿæ­¤ç¡®å®šæ‰“å¼€çš„ç«¯å£ã€‚è‹¥æ— å“åº”åŒ…ï¼Œåˆ™æ ‡è®°ä¸º open|filtered ï¼›è‹¥æ”¶åˆ°RSTåŒ…ï¼Œåˆ™ç«¯å£ä¸º closedï¼›è‹¥æ”¶åˆ°ICMPä¸å¯è¾¾æŠ¥é”™ï¼Œåˆ™ç«¯å£ä¸º filteredã€‚

â€‹		ä¸è¿‡åœ¨çŽ°ä»£ç³»ç»Ÿä¸Šå¾ˆå°‘å‡ºçŽ°è¿™ç§é”™è¯¯ï¼Œä»–ä»¬éƒ½å°†å›žå¤RSTæ•°æ®åŒ…ï¼Œå› æ­¤ç”¨å¤„ä¸å¤§ã€‚

### 4.6 -sU UDPæ‰«æ

â€‹		-sU	UDPæ‰«æï¼Œé€Ÿåº¦å¾ˆæ…¢ï¼Œæ‰«æä¸Šåƒä¸ªç«¯å£éœ€è¦è‡³å°‘17åˆ†é’Ÿï¼Œå¤šæ•°Linuxç³»ç»Ÿä¼šé™åˆ¶ ICMPå“åº”é€ŸçŽ‡ã€‚

â€‹		UDPæ‰«æä¼šå‘æŒ‡å®šçš„ç›®æ ‡ç«¯å£å‘é€UDPæ•°æ®åŒ…ï¼Œå¯¹äºŽå¤§å¤šæ•°ç«¯å£æ­¤æ•°æ®åŒ…ä¸ºç©ºï¼ˆæ— æœ‰æ•ˆè½½è·ï¼‰ï¼Œä½†å¯¹äºŽä¸€äº›å¸¸è§ç«¯å£ï¼Œå°†å‘é€ç‰¹å®šåè®®çš„æœ‰æ•ˆè½½è·æ•°æ®åŒ…ã€‚æ ¹æ®å“åº”åŒ…çš„å­˜åœ¨ä¸Žå¦ï¼Œå°†ç«¯å£åˆ†ä¸ºå››ä¸ªçŠ¶æ€ï¼š

- ç›®æ ‡ç«¯å£çš„ä»»ä½• UDP å“åº” (å¼‚å¸¸)											open
- æœªæ”¶åˆ°è¿”å›žä¿¡æ¯ (å³ä¾¿é‡ä¼ )											   open|filtered
- ICMP ç«¯å£ä¸å¯è¾¾é”™è¯¯ (type 3, code 3)								closed
- å…¶ä»– ICMP ä¸å¯è¾¾é”™è¯¯ (type 3, code 1, 2, 9, 10, or 13)	filtered

### 4.7 -sN/sF/sX Nullæ‰«æã€FINæ‰«æã€Xmasæ‰«æ

â€‹		-sN/sF/sX	è®¾ç½®TCPæ ‡å¿—ä½ã€‚è¿™ä¸‰ç§æ‰«æç±»åž‹ï¼ˆä»¥åŠ--scanflagsé€‰é¡¹ï¼‰åˆ©ç”¨TCP RFC æ ‡å‡†ä¸­çš„ç»†èŠ‚æ¥åŒºåˆ†å¼€æ”¾ç«¯å£å’Œå…³é—­ç«¯å£ï¼Œé€šå¸¸åªèƒ½ç¡®å®šå…³é—­çš„ç«¯å£ã€‚

â€‹		å½“ç›®æ ‡ä¸»æœºç¬¦åˆRFCæ ‡å‡†æ—¶ï¼Œå‘é€ä¸€ä¸ªä¸åŒ…å«SYNï¼ŒRSTï¼ŒACKæ ‡å¿—çš„æ•°æ®åŒ…ï¼Œå½“ç›®çš„ç«¯å£å…³é—­æ—¶å°†è¿”å›žRSTåŒ…ï¼Œå½“ç«¯å£å¼€æ”¾æ—¶ç›®æ ‡ä¸»æœºå°†ä¸¢å¼ƒæ•°æ®åŒ…ï¼Œå› æ­¤æ— å“åº”åŒ…ï¼Œä½†ä¹Ÿå¯èƒ½æ˜¯é˜²æŠ¤è®¾å¤‡å¯¼è‡´æ— å“åº”ã€‚å› æ­¤åªè¦ä¸åŒ…å«SYNã€RSTã€ACKè¿™ä¸‰ä¸ªä½ï¼Œåˆ™å…¶ä»–ä¸‰ä¸ªä½ï¼ˆFINï¼ŒPSHå’ŒURGï¼‰çš„ä»»ä½•ç»„åˆéƒ½å¯ä»¥ã€‚

â€‹		-sN ä¸è®¾ç½®ä»»ä½•æ ‡å¿—ä½ï¼›

â€‹		-sF åªè®¾ç½®TCP FINä½ï¼ŒFINä½è¡¨ç¤ºå…³é—­è¿žæŽ¥ï¼ˆfinishï¼‰ï¼›

â€‹		-sX è®¾ç½®FINã€PSHå’ŒURGæ ‡å¿—ï¼ŒPSHè¡¨ç¤ºæ•°æ®ä¼ è¾“ï¼ˆpush)ï¼ŒURGè¡¨ç¤ºç´§æ€¥ï¼ˆurgentï¼‰ã€‚

â€‹		æ ¹æ®æ‰«æç»“æžœï¼Œå°†ç«¯å£åˆ†ä¸ºä¸‰ç§çŠ¶æ€ï¼Œè‹¥æ— å“åº”åŒ…ï¼Œåˆ™æ ‡è®°ç«¯å£çŠ¶æ€ä¸º open|filteredï¼›è‹¥æ”¶åˆ°TCP RSTåŒ…ï¼Œåˆ™ç«¯å£çŠ¶æ€ä¸º closedï¼›è‹¥æ”¶åˆ° ICMPä¸å¯è¾¾é”™è¯¯ï¼ˆtype 3, code 1, 2, 9, 10, or 13)ï¼Œåˆ™æ ‡è®°ç«¯å£çŠ¶æ€ä¸º filteredã€‚

â€‹		è¿™ä¸‰ç§æ‰«æä¼˜ç‚¹åœ¨äºŽå¯ä»¥è§„é¿éƒ¨åˆ†éžçŠ¶æ€é˜²ç«å¢™å’ŒåŒ…è¿‡æ»¤è·¯ç”±è®¾å¤‡ï¼Œè€Œä¸”æ¯”SYNæ›´åŠ éšè”½ï¼›ä½†ç¼ºç‚¹æ˜¯å¹¶éžæ‰€æœ‰çš„ç³»ç»Ÿéƒ½éµå¾ªRFC 793æ ‡å‡†ï¼Œè€Œä¸”æ— æ³•åŒºåˆ† open å’Œ filtered ç«¯å£ã€‚

### 4.8 --scanflags è‡ªå®šä¹‰æ‰«æ

â€‹		--scanflags  è‡ªå®šä¹‰æ‰«æï¼Œå¯ä»¥å®šåˆ¶åŒ–TCPæ ‡å¿—ä½ï¼ŒåŽŸç†åŒä¸Šã€‚å¯ä»¥é€šè¿‡è¯¥é€‰é¡¹è®¾ç½® URGã€ACKã€PSHã€RSTã€SYN å’Œ FIN çš„ä»»æ„ç»„åˆï¼Œè¿™ç§å®šåˆ¶åŒ–å¯ä»¥ç”¨æ¥ç ”ç©¶ç»•è¿‡é˜²ç«å¢™è®¾å¤‡ï¼Œè¿™å—æ²¡æœ‰ç ”ç©¶ï¼Œæ¬¢è¿Žè¯„è®ºã€‚

### 4.9 -sI ç©ºé—²æ‰«æ

â€‹		-sI ç©ºé—²æ‰«æï¼Œä¹Ÿæœ‰ç§°ä¹‹ä¸ºåƒµå°¸æ‰«æï¼Œåˆ©ç”¨åƒµå°¸ä¸»æœºè¿›è¡Œæ‰«æï¼Œä¼˜ç‚¹æ˜¯éšè”½æ€§å¼ºï¼Œç¼ºç‚¹æ˜¯éœ€è¦å…ˆæ‰¾ä¸€å°åˆé€‚çš„åƒµå°¸ä¸»æœºã€‚ç½‘ä¸Šæœ‰æ–‡ç« ã€‚

â€‹		é¦–å…ˆæˆ‘ä»¬éœ€è¦çŸ¥é“ï¼š

- ç¡®å®šTCPç«¯å£çŠ¶æ€çš„ä¸€ç§æ–¹æ³•æ˜¯å‘é€SYNæ•°æ®åŒ…åˆ°è¯¥ç«¯å£ã€‚è‹¥ç«¯å£å¼€æ”¾ï¼Œåˆ™ç›®æ ‡ä¸»æœºå°†å“åº” SYN / ACKï¼ˆä¼šè¯è¯·æ±‚ç¡®è®¤ï¼‰æ•°æ®åŒ…ï¼›è‹¥ç«¯å£å…³é—­ï¼Œåˆ™ç›®æ ‡ä¸»æœºå°†å“åº”RSTï¼ˆé‡ç½®ï¼‰æ•°æ®åŒ…ã€‚
- æ”¶åˆ°æœªç»è¯·æ±‚çš„SYN / ACKæ•°æ®åŒ…çš„è®¡ç®—æœºå°†ä»¥RSTå“åº”ï¼Œæœªç»è¯·æ±‚çš„RSTå°†è¢«å¿½ç•¥ã€‚
- æ¯ä¸ªIPæ•°æ®åŒ…éƒ½æœ‰ä¸€ä¸ªç‰‡æ®µæ ‡è¯†å·ï¼ˆIP IDï¼‰ã€‚ç”±äºŽè®¸å¤šæ“ä½œç³»ç»Ÿå‘é€çš„æ¯ä¸ªæ•°æ®åŒ…æ—¶åªæ˜¯å¢žåŠ æ­¤æ•°å­—ï¼Œå› æ­¤æŽ¢æµ‹IP IDå¯ä»¥å‘Šè¯‰æ”»å‡»è€…è‡ªä¸Šæ¬¡æŽ¢æµ‹ä»¥æ¥å·²å‘é€äº†å¤šå°‘ä¸ªæ•°æ®åŒ…ã€‚

â€‹		é€šè¿‡ç»„åˆè¿™äº›ç‰¹ç‚¹ï¼Œå¯ä»¥ä¼ªé€ æ‚¨çš„èº«ä»½ï¼ŒåŒæ—¶æ‰«æç›®æ ‡ç½‘ç»œï¼Œä»Žè€Œçœ‹èµ·æ¥åƒæ˜¯æ— è¾œçš„åƒµå°¸æœºå™¨è¿›è¡Œäº†æ‰«æã€‚ç®€å•æ¥è¯´ï¼Œç©ºé—²æ‰«ææŠ€æœ¯ä¸»è¦æ˜¯è¿›è¡Œä¸‹é¢ä¸‰æ­¥ï¼š

1. æŽ¢æµ‹åƒµå°¸çš„IP IDå¹¶å°†å…¶è®°å½•ä¸‹æ¥ã€‚
2. ä¼ªé€ æ¥è‡ªåƒµå°¸çš„SYNæ•°æ®åŒ…ï¼Œå¹¶å°†å…¶å‘é€åˆ°ç›®æ ‡ä¸»æœºçš„ç«¯å£ä¸Šã€‚æ ¹æ®ç«¯å£çŠ¶æ€ï¼Œç›®æ ‡çš„ååº”å¯èƒ½ä¼šå¯¼è‡´åƒµå°¸çš„IP IDå¢žåŠ ã€‚
3. å†æ¬¡æŽ¢æµ‹åƒµå°¸ä¸»æœºçš„IP IDã€‚ç„¶åŽï¼Œé€šè¿‡å°†æ­¤æ–°IP IDä¸Žæ­¥éª¤1ä¸­è®°å½•çš„IP IDè¿›è¡Œæ¯”è¾ƒæ¥ç¡®å®šç›®æ ‡ç«¯å£çŠ¶æ€ã€‚è‹¥IDåŠ 2ï¼Œåˆ™ç«¯å£å¼€æ”¾ã€‚

![img](resource/index.assets/1623766027_60c8b40be998dd88f9218.jpeg)

![img](resource/index.assets/1623766039_60c8b41788098b90eaa4e.jpeg)

![img](resource/index.assets/1623766049_60c8b421acaca638269e6.jpeg)

â€‹		è¿™é¡¹æŠ€æœ¯çš„éš¾ç‚¹åœ¨äºŽå¦‚ä½•æ‰¾åˆ°ä¸€å°åˆé€‚çš„åƒµå°¸ä¸»æœºã€‚è‹¥åƒµå°¸ä¸»æœºæ¯”è¾ƒæ´»è·ƒï¼Œåˆ™IP IDåºåˆ—å·å°†ä¸å‡†ç¡®ï¼Œæ— æ³•åˆ¤æ–­ç«¯å£çŠ¶æ€ã€‚

### 4.10 -sY/sZ SCTP INIT/COOKIE-ECHOæ‰«æ

â€‹		-sY/sZ	SCTP INIT/COOKIE-ECHOæ‰«æï¼Œè¿™ä¸¤ç§æ‰«ææ–¹å¼æ˜¯åŸºäºŽSCTPåè®®ã€‚

â€‹		SCTPï¼ˆStream Control Transmission Protocolï¼ŒæµæŽ§åˆ¶ä¼ è¾“åè®®ï¼‰æ˜¯IETFï¼ˆInternet Engineering Task Forceï¼‰åœ¨2000å¹´å®šä¹‰çš„ä¸€ä¸ªä¼ è¾“å±‚åè®®ã€‚SCTPå¯ä»¥çœ‹ä½œæ˜¯TCPåè®®çš„æ”¹è¿›ï¼Œå®ƒæ”¹è¿›äº†TCPçš„ä¸€äº›ä¸è¶³ã€‚å®ƒä¸€ç§æä¾›äº†å¯é ã€é«˜æ•ˆã€æœ‰åºçš„æ•°æ®ä¼ è¾“åè®®ã€‚ç›¸æ¯”ä¹‹ä¸‹TCPæ˜¯é¢å‘å­—èŠ‚çš„ï¼Œè€ŒSCTPæ˜¯é’ˆå¯¹æˆå¸§çš„æ¶ˆæ¯ã€‚RFC 4960è¯¦ç»†åœ°å®šä¹‰äº†SCTPï¼Œä»‹ç»æ€§çš„æ–‡æ¡£æ˜¯RFC 3286ã€‚

â€‹		TCPå»ºç«‹è¿žæŽ¥çš„è¿‡ç¨‹æ˜¯ï¼šSYNã€SYN/ACKã€ACKï¼›

â€‹		è€ŒSCTPå»ºç«‹è¿žæŽ¥çš„è¿‡ç¨‹æ˜¯ï¼šINITã€INIT-ACKã€COOKIE-ECHOã€COOKIE-ACK

![img](resource/index.assets/1623766058_60c8b42aa48461d9a2411.jpeg)

â€‹		ä¸»æœºå‘çŽ°é˜¶æ®µçš„ -PY é€‰é¡¹ä¸Ž -sY åŽŸç†ä¸€æ ·ï¼Œé€šè¿‡å‘ç›®æ ‡ä¸»æœºçš„æŒ‡å®šç«¯å£å‘é€ INITæ•°æ®åŒ…ï¼Œæ ¹æ®ä¸»æœºå“åº”åˆ¤æ–­æ˜¯å¦å­˜æ´»ã€‚

â€‹		-sY/sZ ä¸ŽTCPåè®®ä¸‹çš„ -sS/sAï¼Œæ€æƒ³æ˜¯ä¸€è‡´çš„ã€‚		-sY SCTP INITæ‰«ææ˜¯TCP SYNæ‰«æçš„SCTPç­‰æ•ˆç‰©ã€‚ä¼˜ç‚¹æ˜¯é€Ÿåº¦å¿«ï¼Œä¸å—é™åˆ¶æ€§é˜²ç«å¢™çš„é™åˆ¶ã€‚ä¸ŽSYNæ‰«æä¸€æ ·ï¼ŒINITæ‰«æç›¸å¯¹éšè”½ï¼Œå› ä¸ºå®ƒæ°¸è¿œä¸ä¼šå®ŒæˆSCTPè¿žæŽ¥ã€‚èƒ½æœ‰æ•ˆåŒºåˆ†å¼€å¯ï¼Œå…³é—­å’Œè¿‡æ»¤çŠ¶æ€ã€‚

â€‹		-sZ  SCTP COOKIE-ECHOæ‰«æï¼Œåˆ©ç”¨äº†SCTPåè®®åœ¨å®žçŽ°ä¸Šï¼Œè‹¥å‘å¼€æ”¾çš„ç«¯å£å‘é€COOKIE-ECHOè¯·æ±‚ï¼Œåˆ™è¯¥ç«¯å£ä¼šç›´æŽ¥ä¸¢å¼ƒè¯¥æ•°æ®åŒ…ä¸åšå“åº”ï¼›è€Œå¯¹å…³é—­çš„ç«¯å£ï¼Œåˆ™ç›®æ ‡ä¸»æœºä¼šè¿”å›žABORTå“åº”ã€‚åŒæ ·ä¹Ÿå¯ä»¥ç”¨äºŽæ£€æµ‹åŸºäºŽçŠ¶æ€æ£€æµ‹çš„é˜²ç«å¢™ã€‚ç¼ºç‚¹æ˜¯ä¸èƒ½åŒºåˆ†æ‰“å¼€å’Œè¿‡æ»¤çš„ç«¯å£ã€‚

### 4.11 -sO åè®®æ‰«æ

â€‹		-sO IPå±‚åè®®æ‰«æï¼Œè¿™ä¸ç®—æ˜¯ç«¯å£æ‰«ææŠ€æœ¯ï¼Œè¯¥æ‰«ææŠ€æœ¯ç”¨äºŽåˆ¤æ–­ç›®æ ‡ä¸»æœºæ‰€æ”¯æŒçš„åè®®ã€‚

â€‹		è¯¥æ‰«ææŠ€æœ¯å…è®¸ç”¨æˆ·é€šè¿‡-pé€‰æ‹©æ‰«æçš„åè®®å·ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨-Fæ‰«ænmap-protocolsæ–‡ä»¶ä¸­çš„æ‰€æœ‰åè®®ï¼ˆå…±145ç§åè®®ï¼‰ï¼Œé»˜è®¤æƒ…å†µä¸‹ä¼šæ‰«æ256ä¸ªå¯èƒ½çš„å€¼ï¼Œä»¥å¸¸è§„ç«¯å£è¡¨æ ¼å½¢å¼æŠ¥å‘Šç»“æžœã€‚

### 4.12 -b FTP bounce scan

â€‹		-b FTP bounce scanï¼Œé€æ¸å¼ƒç”¨

â€‹		è¿™ç§æ‰«ææŠ€æœ¯æ˜¯åˆ©ç”¨FTPæœåŠ¡å™¨çš„åŠŸèƒ½ã€‚FTPåè®®ï¼ˆRFC 959ï¼‰çš„ä¸€ä¸ªæœ‰è¶£åŠŸèƒ½æ˜¯æ”¯æŒæ‰€è°“çš„ä»£ç†FTPè¿žæŽ¥ã€‚è¿™ä½¿ç”¨æˆ·å¯ä»¥è¿žæŽ¥åˆ°ä¸€ä¸ªFTPæœåŠ¡å™¨ï¼Œç„¶åŽè¦æ±‚å°†æ–‡ä»¶å‘é€åˆ°ç¬¬ä¸‰æ–¹æœåŠ¡å™¨ã€‚åœ¨è®¸å¤šçº§åˆ«ä¸Šï¼Œè¿™ç§åŠŸèƒ½å·²ç»å¾ˆå®¹æ˜“è¢«æ»¥ç”¨ï¼Œå…¶ä¸­ä¹‹ä¸€æ˜¯å¯¼è‡´FTPæœåŠ¡å™¨å¯¹å…¶ä»–ä¸»æœºè¿›è¡Œç«¯å£æ‰«æã€‚å› æ­¤å¤§å¤šæ•°FTPæœåŠ¡å™¨éƒ½ä¸å†æ”¯æŒè¯¥åŠŸèƒ½ï¼Œæ‰€ä»¥è¿™é¡¹æ‰«ææŠ€æœ¯ä¹ŸåŸºæœ¬å¼ƒç”¨äº†ã€‚

### 4.13 ç»„åˆåˆ©ç”¨

â€‹		æœ‰æ—¶å€™éœ€è¦é€šè¿‡å¤šç§æ‰«ææŠ€æœ¯æ¥å¯¹ç¡®å®šç«¯å£çŠ¶æ€ã€‚ä¾‹å¦‚ï¼š

â€‹		å…ˆæ‰§è¡ŒFINæ‰«æï¼ŒNmapä¼šæ‰¾åˆ°å…³é—­çš„ç«¯å£ï¼ŒåŒæ—¶åˆ—å‡º 39ä¸ªç«¯å£ä¸ºâ€œopen|filteredâ€ï¼›ç„¶åŽå†å¯¹è¿™39ä¸ªç«¯å£è¿›è¡ŒACKæ‰«æï¼Œå…¶ä¸­æœ‰2ä¸ªä¸ºfilteredï¼Œå…¶ä»–37ä¸ªå¤„äºŽæœªè¿‡æ»¤çŠ¶æ€æ„å‘³ç€openæˆ–closedã€‚å¦‚æžœä¸€ç§æ‰«æç±»åž‹å°†ç«¯å£æ ‡è¯†ä¸ºopenæˆ–filtered ï¼Œå¦ä¸€ç§æ‰«æç±»åž‹å°†å…¶æ ‡è¯†ä¸ºopenæˆ–closedï¼Œé‚£ä¹ˆè¯¥ç«¯å£å¿…é¡»ä¸ºæ‰“å¼€çŠ¶æ€ã€‚é€šè¿‡ç»„åˆè¿™ä¸¤ç§æ‰«æç±»åž‹ï¼Œæˆ‘ä»¬äº†è§£åˆ°æœ‰37ä¸ªç«¯å£å¼€æ”¾ï¼Œä¸¤ä¸ªå·²è¿‡æ»¤ï¼Œè€Œ961å·²å…³é—­ã€‚

## 0x05 Nmapé«˜æ•ˆæ‰«æç­–ç•¥

â€‹		Nmapçš„æ‰«æé€Ÿåº¦æ…¢ä¸€ç›´è¢«äººè¯Ÿç—…ï¼Œé¦–å…ˆåˆ†æžä¸€ä¸‹Nmapæ‰«ææ…¢å¯èƒ½çš„åŽŸå› ï¼Œå†æ ¹æ®[NNS ç¬¬å…­ç«  ä¼˜åŒ–Nmapè¡¨çŽ°](https://nmap.org/book/performance.html)å’Œå¹³æ—¶çš„ä½¿ç”¨å¿ƒå¾—ç»™å‡ºä¸€äº›å»ºè®®ã€‚

### 5.1 Nmapæ…¢åœ¨å“ªï¼Ÿ

â€‹		Nmapæ‰«æçš„æ…¢ï¼Œä¸€éƒ¨åˆ†æ˜¯å› ä¸ºå…¶æ‰«æç®—æ³•ï¼Œå¦ä¸€éƒ¨åˆ†æ˜¯éƒ¨åˆ†é«˜çº§åŠŸèƒ½çš„åŽŸå› ã€‚ä»¥ä¸‹æ˜¯æˆ‘è®¤ä¸ºå¯èƒ½å¯¼è‡´Nmapæ…¢çš„åŽŸå› ï¼š

1. **ç½‘ç»œçŠ¶æ€ç›‘æµ‹ï¼ˆæ‹¥å¡žæŽ§åˆ¶ï¼‰**

   Nmapæä¾›ç½‘ç»œçŠ¶æ€ç›‘æµ‹ï¼ŒNmapä¼šåŸºäºŽç½‘ç»œçŠ¶æ€é€‚å½“çš„è°ƒæ•´æ‰«æé€Ÿåº¦ï¼Œä»¥ä¿æŒç½‘ç»œå…è®¸çš„é€Ÿåº¦ã€‚Nmap ä½¿ç”¨ä¸‰ç§æ¨¡ä»¿ TCP çš„ç®—æ³•æ¥æŽ§åˆ¶æ‰«æçš„æ¿€è¿›ç¨‹åº¦ï¼šæ‹¥å¡žçª—å£ã€æŒ‡æ•°é€€é¿å’Œæ…¢å¯åŠ¨ã€‚æ‹¥å¡žçª—å£æŽ§åˆ¶ Nmap ä¸€æ¬¡å¯èƒ½æœ‰å¤šå°‘ä¸ªæœªå®Œæˆçš„æŽ¢æµ‹ã€‚è‹¥çª—å£å·²æ»¡ï¼Œåˆ™ä¸å†å‘é€ï¼Œç›´åˆ°æ”¶åˆ°å“åº”æˆ–æŽ¢æµ‹è¶…æ—¶ã€‚å½“ Nmap æ£€æµ‹åˆ°ä¸¢å¼ƒçš„æ•°æ®åŒ…æ—¶ï¼ŒæŒ‡æ•°é€€é¿ä¼šå¯¼è‡´ Nmap æ˜¾ç€å˜æ…¢ã€‚æ¯å½“æ£€æµ‹åˆ°ä¸¢å¼ƒæ—¶ï¼Œæ‹¥å¡žçª—å£é€šå¸¸ä¼šå‡å°‘åˆ° 1ã€‚æ…¢å¯åŠ¨åˆ™ç”¨äºŽé€æ¸æé«˜æ‰«æé€Ÿåº¦ä»¥ç¡®å®šç½‘ç»œçš„æ€§èƒ½é™åˆ¶ã€‚

   **æ‹¥å¡žçª—å£å’Œé˜ˆå€¼**ï¼š

   ![æ‹¥å¡žçª—å£å’Œé˜ˆå€¼](resource/index.assets/1623951039_60cb86bf20d05d83d60e9.jpeg)

2. **è‡ªé€‚åº”é‡ä¼ **

   æœ€ç®€å•çš„æ‰«æä»ªï¼ˆå’Œæ— çŠ¶æ€çš„ï¼‰ é€šå¸¸æ ¹æœ¬ä¸é‡ä¼ æŽ¢æµ‹ã€‚å¦‚æžœæ²¡æœ‰æ£€æµ‹åˆ°ä¸¢åŒ…ï¼ŒNmap å¯èƒ½åªåœ¨æ”¶åˆ°æŽ¢æµ‹å“åº”å¤±è´¥æ—¶é‡ä¼ ä¸€æ¬¡ã€‚å½“å‡ºçŽ°å¤§é‡ä¸¢åŒ…çŽ°è±¡æ—¶ï¼ŒNmap å¯èƒ½ä¼šé‡ä¼ åæ¬¡æˆ–æ›´å¤šæ¬¡ã€‚è¿™å…è®¸ Nmap å¿«é€Ÿæ‰«æå¿«é€Ÿã€å¯é ç½‘ç»œä¸Šçš„ä¸»æœºï¼ŒåŒæ—¶åœ¨æ‰«ææœ‰é—®é¢˜çš„ç½‘ç»œæˆ–æœºå™¨æ—¶ä¿æŒå‡†ç¡®æ€§ï¼ˆä»¥ç‰ºç‰²ä¸€äº›é€Ÿåº¦ä¸ºä»£ä»·ï¼‰ã€‚å½“è¾¾åˆ°æŸä¸ªé˜ˆå€¼æ—¶ï¼ŒNmapæ‰ä¼šæ”¾å¼ƒé‡ä¼ ã€‚

3. **æ‰«æå»¶è¿Ÿ**

   æ•°æ®åŒ…å“åº”é€ŸçŽ‡é™åˆ¶å¯èƒ½æ˜¯ Nmap ç­‰ç«¯å£æ‰«æå™¨é¢ä¸´çš„æœ€ä¸¥é‡çš„é—®é¢˜ã€‚å½“ç›®æ ‡ä¸»æœºå­˜åœ¨æ•°æ®åŒ…å“åº”é€ŸçŽ‡é™åˆ¶æ—¶ï¼ŒNmapä¼šè¯•å›¾æ£€æµ‹è¿™ç§æƒ…å†µï¼Œå¯ç”¨æ‰«æå»¶è¿Ÿï¼Œå®ƒä¼šåœ¨å‘é€åˆ°å•ä¸ªç›®æ ‡çš„æ¯ä¸ªæŽ¢æµ‹ä¹‹é—´å®žçŽ°çŸ­å»¶è¿Ÿï¼ˆä½Žè‡³ 5 æ¯«ç§’ï¼‰ã€‚å¦‚æžœæ•°æ®åŒ…å“åº”é€ŸçŽ‡ä¾ç„¶åœ¨ä¸‹é™ï¼ŒNmap å°†ç»§ç»­å°†å»¶è¿ŸåŠ å€ï¼Œç›´åˆ°ä¸‹é™åœæ­¢æˆ– Nmap è¾¾åˆ°å…è®¸çš„æœ€å¤§æ‰«æå»¶è¿Ÿã€‚

   ![å—æ‰«æå»¶è¿Ÿå½±å“çš„æ‰«æé€ŸçŽ‡](resource/index.assets/1623766063_60c8b42fe078d762f6924.jpeg)

4. DNSè§£æžåŠŸèƒ½

   â€‹		Nmapæä¾›DNSè§£æžå’Œåå‘DNSè§£æžåŠŸèƒ½ã€‚é€šå¸¸æ­£å‘DNSè§£æžé€Ÿåº¦å¾ˆå¿«ï¼Œä½†åå‘DNSè§£æžéœ€è¦è€—è´¹å¾ˆé•¿æ—¶é—´ï¼Œå°¤å…¶æ˜¯å¯¹å¤§é‡ç›®æ ‡è¿›è¡ŒæŽ¢æµ‹æ—¶ï¼Œåå‘DNSè§£æžè¿‡ç¨‹ä¼šèŠ±è´¹å¤§é‡æ—¶é—´ã€‚

5. æœåŠ¡ç‰ˆæœ¬æŽ¢æµ‹

   â€‹		ç«¯å£æ‰«ææ˜¯Nmapçš„æ ¸å¿ƒåŠŸèƒ½ï¼ŒåŒæ—¶Nmapè¿˜æä¾›å¯¹æ‰€å‘çŽ°çš„ç«¯å£è¿›è¡ŒæœåŠ¡ç‰ˆæœ¬æŽ¢æµ‹ã€‚åœ¨è¿™ä¸€çŽ¯èŠ‚éœ€è¦å‘é€å¤§é‡çš„æ•°æ®åŒ…æ¥ç¡®å®šæœåŠ¡ç‰ˆæœ¬ã€‚åœ¨è¿™ä¸ªé˜¶æ®µNmapä¼šä¸ŽTCPç«¯å£å»ºç«‹è¿žæŽ¥å¹¶ç›‘å¬è¯¥ç«¯å£æœåŠ¡çº¦5ç§’ï¼Œä»¥æœŸæœ›åœ¨ç›®æ ‡ç«¯å£æœåŠ¡çš„æ¬¢è¿Žæ ‡è¯­bannerä¸­èŽ·å–ä¿¡æ¯ï¼Œå¹¶ä¸Žnmap-service-probesæ–‡ä»¶æŒ‡çº¹è¿›è¡ŒåŒ¹é…ï¼›ä½†è‹¥æœªèƒ½åŒ¹é…ï¼Œåˆ™éœ€è¦ä½¿ç”¨å…¶ä»–æŽ¢é’ˆåŽ»è¯±å¯¼èŽ·å–æŒ‡çº¹ã€‚

6. â€¦â€¦

### 5.2 æ–¹æ³•è®ºæŠ€å·§

1. **ä¿æŒç‰ˆæœ¬æ›´æ–°**

2. **é€‰æ‹©æœ‰åˆ©çš„ç½‘ç»œä½ç½®**

   â€‹		æˆ‘çš„ç†è§£æœ‰ä¸¤ä¸ªæ–¹é¢ï¼Œä¸€æ˜¯é€‰ä¸€ä¸ªç½‘ç»œçŽ¯å¢ƒå¥½çš„åœ°æ–¹ï¼Œå‡å°‘è¶…æ—¶é‡æ”¾ç­‰çŽ°è±¡ï¼›

   â€‹		ç¬¬äºŒä¸ªæ˜¯ä»Žé˜²ç«å¢™åŽé¢æ‰«ï¼Œèƒ½å¤Ÿä»Žå†…ç½‘æ‰«æå°±ä¸è¦ä»Žå…¬ç½‘æ‰«æï¼Œä¸­é—´å°‘ä¸€äº›è·¯ç”±é˜²ç«å¢™ç­‰ç½‘ç»œè®¾å¤‡ï¼Œè¿™æ ·æ•°æ®æ›´å…¨é¢ä¸”å‡†ç¡®ã€‚

   â€‹		å½“ç„¶å¾ˆå¤šæ—¶å€™æˆ‘ä»¬æ²¡æœ‰é€‰æ‹©çš„ä½™åœ°ã€‚

3. **å¤šé˜¶æ®µæ‰«æ**

   â€‹		å¦‚æžœè®¡åˆ’è¿›è¡Œå…¨é¢çš„å®‰å…¨å®¡æ ¸ï¼Œå¯¹å…¨ç«¯å£è¿›è¡Œæ‰«æï¼Œæˆ‘å¯èƒ½ä¼šè€ƒè™‘å…ˆå¯¹ç»™å®šèµ„äº§èŒƒå›´è¿›è¡Œä¸€æ¬¡å¿«é€Ÿçš„æ‰«æï¼Œå¦‚`nmap -n -F &lt;targets&gt;`ï¼›åŒæ—¶åŽå°è¿›è¡Œå¿½ç•¥ä¸»æœºå­˜æ´»çŠ¶æ€çš„å…¨ç«¯å£æŽ¢æµ‹ï¼Œå¦‚`nmap -Pn -n &lt;targets&gt; -p-`ã€‚		

4. **å¹¶å‘è¿›è¡ŒNmapæ‰«æ**

   â€‹		åœ¨åŒä¸€å°ä¸»æœºä¸Šè¿è¡Œå¤šä¸ªNmapè¿›ç¨‹ï¼Œå°†å¤§ä»»åŠ¡è¿›è¡Œåˆ†è§£ã€‚å®˜æ–¹è¯´äº”ä¸ªæˆ–åä¸ªéƒ½è¿˜å¥½ï¼Œå¯åŠ¨å¤ªå¤šå¹¶å‘ä»»åŠ¡å®¹æ˜“å¯¼è‡´èµ„æºç«žäº‰ã€‚

   â€‹		å¦ä¸€ç§å¹¶è¡Œæ–¹å¼æ˜¯åœ¨ä¸åŒä¸»æœºä¸Šè¿è¡Œã€‚

   â€‹		ä¾‹å¦‚ï¼šéœ€è¦æ‰«ä¸€ä¸ªBæ®µï¼Œé‚£å°±æ˜¯256ä¸ªCæ®µï¼Œæˆ‘å¯èƒ½ä¼šè€ƒè™‘å°†ä»»åŠ¡åˆ†ä¸ºåœ¨æœ¬åœ°ç§»åŠ¨åŠžå…¬çš„ç»ˆç«¯ä¸Šè¿è¡Œ1ä¸ªCæ®µï¼Œåœ¨è¿œç¨‹ä¸»æœºä¸Šè¿è¡Œ3ä¸ªCæ®µ&#43;64ä¸ª*3&#43;60ä¸ªï¼Œè¿™ä¹ˆ6ä¸ªä»»åŠ¡ã€‚

5. **åˆ†ç¦»å’Œä¼˜åŒ–UDPæ‰«æ**

   â€‹		Nmapè™½ç„¶æ”¯æŒ -sSUï¼Œä½†åœ¨æ³¨é‡æ€§èƒ½æ—¶ä¸å»ºè®®ç»“åˆä½¿ç”¨TCPå’ŒUDPæ‰«æã€‚å› ä¸ºUDPæ‰«æé€šå¸¸ä¼šå¾ˆæ…¢ã€‚æ‰€ä»¥å»ºè®®åˆ†å¼€è¿›è¡Œã€‚

   â€‹		ç”±äºŽUDPç«¯å£æ‰«ææŠ€æœ¯çš„ç‰¹æ®Šæ€§ï¼Œopenå’Œfilteredçš„ç«¯å£éƒ½ä¸ä¼šå‘é€å“åº”åŒ…ï¼Œå› æ­¤éœ€è¦æ—¶é—´åŽ»ç­‰å¾…ï¼›è€Œæ— å“åº”åŒ…çš„æƒ…å†µä¸ºäº†æŽ’é™¤å› ç½‘ç»œåŽŸå› å¯¼è‡´çš„ä¸¢åŒ…è¿˜éœ€è¦è¿›è¡Œé‡ä¼ ç¡®è®¤ã€‚è€Œå¯¹äºŽå…³é—­çš„ç«¯å£ï¼Œä¼šæ”¶åˆ°ICMPç«¯å£ä¸å¯è¾¾ï¼Œéƒ¨åˆ†ç³»ç»Ÿä¼šé™åˆ¶ ICMP æ¶ˆæ¯å‘é€é€ŸçŽ‡ã€‚å› æ­¤UDPæ‰«æä¼šå¾ˆæ…¢ã€‚

   â€‹		å®˜æ–¹ä¹Ÿç»™å‡ºäº†ä¸€äº›æ”¹å–„UDPæ‰«ææ€§èƒ½çš„å»ºè®®ï¼Œæ•´ä½“ä¸Šä¸Žæœ¬ç« å…¶ä»–å†…å®¹æƒ³æ³•ç›¸åŒã€‚å¢žåŠ ä¸»æœºå¹¶è¡Œæ•°ï¼ˆ--min-hostgroupï¼‰åŒæ—¶æ‰«æå¤šä¸ªä¸»æœºï¼›ä¼˜å…ˆæ‰«æå¸¸è§ç«¯å£-Fï¼›ç‰ˆæœ¬æŽ¢æµ‹æ—¶ï¼ŒæŒ‡å®š  --version-intensity 0 ä»…å°è¯•æœ€æœ‰å¯èƒ½é’ˆå¯¹ç»™å®šç«¯å£å·æœ‰æ•ˆçš„æŽ¢é’ˆï¼›ä»Žé˜²ç«å¢™åŽæ‰«æï¼›--host-timeout æŒ‡å®šä¸»æœºè¶…æ—¶æ—¶é—´ï¼Œè·³è¿‡å“åº”ç¼“æ…¢çš„ä¸»æœºï¼›æœ€åŽä¸€æ¡ï¼Œä¿æŒå†·é™ï¼Œåšç‚¹åˆ«çš„ï¼Œä¸è¦ç›¯ç€è¿›åº¦æ¡ï¼Œçœ¼ä¸è§å¿ƒä¸çƒ¦ï¼ˆ/doge/ï¼‰

6. **å¿½ç•¥éžå…³é”®æµ‹è¯•ã€‚æ˜Žç¡®æµ‹è¯•ç›®çš„**

   â€‹		é¦–å…ˆéœ€è¦æƒ³æ¸…æ¥šæˆ‘ä»¬çš„æµ‹è¯•ç›®çš„ï¼Œæ˜Žç¡®æµ‹è¯•ç›®çš„åŽå¯¹ä»»åŠ¡è¿›è¡Œåˆ’åˆ†ï¼Œé€‰å–æ‰«æç­–ç•¥ï¼ŒæŒ‡å®šå‚æ•°é€‰é¡¹ã€‚

   ä¾‹å¦‚ï¼š

   â€‹		å¦‚æžœä½ åªéœ€æŽ¢æµ‹ç½‘ç»œå†…å­˜æ´»ä¸»æœºï¼Œå°±æ²¡å¿…è¦è¿›è¡Œç«¯å£æ‰«æï¼Œç”¨-snç¦ç”¨ç«¯å£æ‰«æï¼›

   â€‹		**é™åˆ¶æ‰«æçš„ç«¯å£æ•°ã€‚**å½“é‡åˆ°é€ŸçŽ‡é™åˆ¶å’Œæ— å“åº”æ—¶ï¼ŒNmapæ‰«æé€ŸçŽ‡ä¼šä¸‹é™ï¼Œç»å¤§æ•°ä¸»æœºåªä¼šå¼€å‘å‡ ç™¾ä¸ªç«¯å£ï¼Œå¦‚æžœä»…æ‰«æ100ä¸ªç«¯å£è€Œä¸æ˜¯é»˜è®¤çš„1000ä¸ªç«¯å£ï¼Œåˆ™ç«¯å£æ‰«æçš„é€Ÿåº¦å¤§çº¦æ˜¯å…¶10å€ã€‚å…¨ç«¯å£æ‰«æçš„100%å‡†ç¡®çŽ‡ä¸Ž--top-ports 3328 çš„99%å‡†ç¡®çŽ‡çš„å–èˆã€‚

   â€‹		**è·³è¿‡é«˜çº§æ‰«æç±»åž‹ã€‚** -A é€‰é¡¹ä¼šåŒæ—¶å¼€å¯è„šæœ¬æŽ¢æµ‹ -sCï¼Œç‰ˆæœ¬æŽ¢æµ‹-sVï¼Œæ“ä½œç³»ç»ŸæŽ¢æµ‹ -Oå’Œè·¯ç”±è·Ÿè¸ª--tracerouteï¼Œç¡®å®šè¿™äº›åŠŸèƒ½æ˜¯å¦éƒ½éœ€è¦å¼€å¯ï¼›å½“é’ˆå¯¹å¤§è§„æ¨¡ç½‘ç»œè¿›è¡Œæ‰«ææ—¶ï¼Œè¿™äº›é«˜çº§åŠŸèƒ½ä¼šèŠ±è´¹å¾ˆé•¿çš„æ—¶é—´ï¼Œå»ºè®®è·³è¿‡-sC -sVï¼Œç„¶åŽæ ¹æ®éœ€è¦åœ¨å„ç«¯å£ä¸Šæ‰§è¡Œä»–ä»¬ã€‚è‡³äºŽæ“ä½œç³»ç»ŸæŽ¢æµ‹å’Œè·¯ç”±è·Ÿè¸ªï¼Œç»å¤§éƒ¨åˆ†æ—¶å€™å¯èƒ½å¹¶ä¸åœ¨æ„ã€‚ä½œä¸ºä¸€ç§æŠ˜è¡·æ–¹æ³•ï¼Œæ‚¨å¯ä»¥æŒ‡å®š--osscan-limit --max-os-tries 1ï¼Œæ¥å‘Šè¯‰Nmapä¸è¦é‡è¯•æ— æ³•åŒ¹é…çš„æ“ä½œç³»ç»Ÿï¼Œå¹¶å¯¹æ²¡æœ‰å¼€æ”¾è‡³å°‘ä¸€ä¸ªTCPç«¯å£å’Œä¸€ä¸ªå…³é—­çš„TCPç«¯å£çš„ä»»ä½•ä¸»æœºè·³è¿‡æ“ä½œç³»ç»Ÿæ£€æµ‹ã€‚

   â€‹		**ä¸å¿…è¦æ—¶å…³é—­DNSè§£æžã€‚**Nmapé»˜è®¤ä¼šä¸»æœºè¿›è¡Œåå‘DNSè§£æžï¼Œå°¤å…¶æ˜¯ä½¿ç”¨-Pnå’Œ-Ræ—¶ï¼Œä¼šå¯¹æ‰€æœ‰ä¸»æœºæ‰§è¡Œæ­¤æ“ä½œï¼Œè¿™ä¼šèŠ±è´¹å¾ˆå¤šæ—¶é—´ã€‚å¯ä»¥ä½¿ç”¨ `--dns-servers` æŒ‡å®šDNSæœåŠ¡å™¨æ¥åŠ é€Ÿè¿™ä¸€è¿‡ç¨‹ã€‚ä¸è¿‡ï¼Œåœ¨ä¸å¿…è¦æ—¶ï¼Œå»ºè®®ä½¿ç”¨-nç¦ç”¨DNSè§£æžã€‚å¯¹äºŽé’ˆå¯¹å¤§é‡ä¸»æœºçš„ç®€å•æ‰«æï¼ˆä¾‹å¦‚pingæ‰«æï¼‰ï¼Œçœç•¥DNSæœ‰æ—¶å¯ä»¥å°†æ‰«ææ—¶é—´å‡å°‘20ï¼…æˆ–æ›´å¤šã€‚

### 5.3 Nmapé€‰é¡¹æŠ€å·§

1. **åŠ é€Ÿé€‰é¡¹æŽ§åˆ¶ã€‚**

   nmap -h ä¸­ TIMING AND PERFORMANCE éƒ¨åˆ†çš„é€‰é¡¹å¯ä»¥å¸®åˆ°å¾ˆå¤šã€‚

2. - --min-hostgroup, --max-hostgroup

     å¯æŒ‡å®šæœ€å°å’Œæœ€å¤§ä¸»æœºç»„å¤§å°ï¼Œå½±å“å¹¶å‘æ‰«æä¸»æœºé€ŸçŽ‡ã€‚

   - --min-parallelism, --max-parallelism

     å¯æŒ‡å®šæœ€å°å’Œæœ€å¤§å¹¶å‘è¿è¡Œçš„æŽ¢é’ˆæ•°é‡

   - --min-rtt-timeout, --max-rtt-timeout, --initial-rtt-timeout

     å¯æŒ‡å®šæœ€å°ã€æœ€å¤§å’Œåˆå§‹åŒ–æŽ¢é’ˆè¶…æ—¶å€¼ï¼Œéœ€å†™ä¸Šå•ä½ï¼Œé€šå¸¸ä¸ºæ¯«ç§’msã€‚Nmap åœ¨æ¯æ¬¡æŽ¥æ”¶åˆ°æŽ¢é’ˆå“åº”æ—¶è®°å½•è€—æ—¶ï¼Œä¼°ç®—ç½‘ç»œæƒ…å†µå¹¶è¿›è¡Œè®¡ç®—å¾—å‡ºtimeoutæ•°å€¼ã€‚

   - --max-retries

     å…è®¸æŽ¢é’ˆé‡ä¼ çš„æœ€å¤§å€¼

   - --host-timeout

     æŒ‡å®šå•ä¸ªä¸»æœºæ‰«æçš„æœ€å¤§æ—¶é•¿ï¼Œå½“åˆ°è¾¾æœ€å¤§æ—¶é—´ï¼Œå°†æ”¾å¼ƒè¯¥ä¸»æœºã€‚

   - --scan-delay, --max-scan-delay

     æŒ‡å®šé’ˆå¯¹å•ä¸ªä¸»æœºæ¯ä¸ªæŽ¢é’ˆä¹‹é—´çš„æœ€å°å’Œæœ€å¤§å»¶è¿ŸæŽ§åˆ¶ï¼›

   - --min-rate, --max-rate

     æŒ‡å®šæ¯ç§’å‘é€çš„æŽ¢é’ˆæ•°æ®åŒ…æœ€å°å’Œæœ€å¤§é€ŸçŽ‡ï¼Œè¿™ä¸ªå€¼å…è®¸è¶…è¿‡Nmapçš„æ‹¥å¡žæŽ§åˆ¶ç®—æ³•é™åˆ¶ã€‚

   - --defeat-rst-ratelimit

     æŒ‡å®šç›®æ ‡ä¸»æœºçš„RSTæ•°æ®åŒ…å“åº”çŽ‡ï¼Œè¿™ä¸ªä¸å¤ªäº†è§£ã€‚

3. **ä¼˜åŒ–æ—¶é—´å‚æ•° -T**

   Nmapæä¾›äº†ä¸€äº›æ—¶é—´æ¨¡æ¿-T0-5ï¼Œéšç€æ•°å­—å¢žå¤§ï¼Œæ‰«æé€Ÿåº¦å°†åŠ å¿«ã€‚å¯ä»¥ä½¿ç”¨ `nmap -T5 -d` çš„å½¢å¼æŸ¥çœ‹æ—¶é—´æ¨¡æ¿çš„å‚æ•°

![-Tx -d](resource/index.assets/1623765912_60c8b398dcb4ec3f4655b.jpeg)

ä¸åŒçº§åˆ«çš„å‚æ•°è§ä¸‹è¡¨

|           åç§°            | T0 (Paranoid) | T1(Sneaky) | T2(Polite) | T3(Normal) | T4(Aggressive) | T5(Insane) |
| :-----------------------: | :-----------: | :--------: | :--------: | :--------: | :------------: | :--------: |
|      min-rtt-timeout      |      100      |    100     |    100     |    100     |      100       |     50     |
|      max-rtt-timeout      |    300,000    |   15,000   |   10,000   |   10,000   |     1,250      |    300     |
|    initial-rtt-timeout    |    300,000    |   15,000   |   1,000    |   1,000    |      500       |    250     |
|        max-retries        |      10       |     10     |     10     |     10     |       6        |     2      |
| åˆå§‹åŒ–æ‰«æå»¶è¿Ÿ scan-delay |    300,000    |   15,000   |    400     |     0      |       0        |     0      |
|      æœ€å¤§TCPæ‰«æå»¶è¿Ÿ      |    300,000    |   15,000   |   1,000    |   1,000    |       10       |     5      |
|      æœ€å¤§UDPæ‰«æå»¶è¿Ÿ      |    300,000    |   15,000   |   1,000    |   1,000    |     1,000      |   1,000    |
|       host-timeout        |       0       |     0      |     0      |     0      |       0        |  900,000   |
|      min-parallelism      |     åŠ¨æ€      |    åŠ¨æ€    |    åŠ¨æ€    |    åŠ¨æ€    |      åŠ¨æ€      |    åŠ¨æ€    |
|      max-parallelism      |       1       |     1      |     1      |    åŠ¨æ€    |      åŠ¨æ€      |    åŠ¨æ€    |
|       min-hostgroup       |     åŠ¨æ€      |    åŠ¨æ€    |    åŠ¨æ€    |    åŠ¨æ€    |      åŠ¨æ€      |    åŠ¨æ€    |
|       max-hostgroup       |     åŠ¨æ€      |    åŠ¨æ€    |    åŠ¨æ€    |    åŠ¨æ€    |      åŠ¨æ€      |    åŠ¨æ€    |
|         min-rate          |    æ— é™åˆ¶     |   æ— é™åˆ¶   |   æ— é™åˆ¶   |   æ— é™åˆ¶   |     æ— é™åˆ¶     |   æ— é™åˆ¶   |
|         max-rate          |    æ— é™åˆ¶     |   æ— é™åˆ¶   |   æ— é™åˆ¶   |   æ— é™åˆ¶   |     æ— é™åˆ¶     |   æ— é™åˆ¶   |
|   defeat-rst-ratelimit    |  é»˜è®¤æœªå¯ç”¨   | é»˜è®¤æœªå¯ç”¨ | é»˜è®¤æœªå¯ç”¨ | é»˜è®¤æœªå¯ç”¨ |   é»˜è®¤æœªå¯ç”¨   | é»˜è®¤æœªå¯ç”¨ |

æ³¨æ„ï¼šåŠ¨æ€çš„ï¼Œä¸å—æ—¶é—´æ¨¡æ¿é™åˆ¶

### 5.4 -Pn åŠ é€Ÿ

â€‹		*ä¹‹å‰æœ‰ä¸€ä¸ªç–‘é—®å°±æ˜¯ `-Pn` è·³è¿‡ä¸»æœºå‘çŽ°é˜¶æ®µï¼Œæ˜¯å¦èƒ½ç¼©çŸ­æ‰«ææ—¶é—´ï¼Ÿ*

â€‹		ç­”æ¡ˆæ˜¯å¦å®šçš„ï¼Œå› ä¸ºä¸»æœºå‘çŽ°é˜¶æ®µæ‰€è¿›è¡Œçš„ä¸å…‰æ˜¯æŽ¢æµ‹ä¸»æœºæ˜¯å¦å­˜æ´»ï¼ŒåŒæ—¶ä¹Ÿè®°å½•äº†ä¸Žç›®æ ‡ä¸»æœºä¹‹é—´çš„ç½‘ç»œæƒ…å†µï¼Œç»™å‡ºä¸€ä¸ªRTTè¯„ä¼°å¹¶è°ƒæ•´è¶…æ—¶é‡ä¼ ç­‰å¾…æœºåˆ¶ï¼Œæ¥æé«˜æŽ¥ä¸‹åŽ»çš„ç«¯å£æ‰«æé€Ÿåº¦ã€‚

â€‹		ä¸è¿‡æˆ‘ä»¬å¯ä»¥é€šè¿‡Nmapçš„ä¸€äº›é€‰é¡¹æ¥æ‰‹åŠ¨æŒ‡å®šè¿™äº›å‚æ•°ï¼Œæ¥åŠ å¿«æ‰«æé€Ÿåº¦ã€‚

â€‹		-Pn æœ€å¤§çš„é—®é¢˜å°±æ˜¯æ— æ³•èŽ·å–åˆ°ç½‘ç»œçŠ¶æ€ä¿¡æ¯ï¼Œç”±äºŽé‡ä¼ å’ŒRTTä¼°ç®—çš„é—®é¢˜ï¼Œå¯¼è‡´æ•´ä¸ªæ‰«æè¿‡ç¨‹ç­‰å¾…æ—¶é—´è¿‡é•¿ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨æŒ‡å®š--max-rtt-timeout, --initial-rtt-timeoutã€‚

â€‹		Nmapæ²¡æœ‰ä»Žæ¯ä¸ªä¸»æœºä¸Šæ”¶é›†åˆ°è¶³å¤Ÿçš„å“åº”æ¥å‡†ç¡®ä¼°ç®—å»¶è¿Ÿå’Œä¸¢åŒ…çŽ‡ï¼Œé‚£ä¹ˆæˆ‘ä»¬é¦–å…ˆéœ€è¦è§£å†³è¿™ä¸ªé—®é¢˜ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å‘½ä»¤è¡Œæ¥æ‰‹åŠ¨æ”¶é›†è¯¥ä¿¡æ¯ï¼Œå¯ä»¥é€šè¿‡ping ç›¸é‚»çš„åœ¨çº¿ä¸»æœºèŽ·å–å»¶è¿Ÿä¼°è®¡ï¼Œå½“ç„¶å¯èƒ½ä¼šæœ‰ç¦pingçš„çŽ°è±¡ï¼Œå¯ä»¥ç”¨nmapé™„èµ çš„å°å·¥å…·nping å¯¹å¼€æ”¾çš„ç«¯å£è¿›è¡ŒæŽ¢æµ‹ï¼ŒèŽ·å–å»¶è¿Ÿä¼°è®¡ã€‚

â€‹		æ ¹æ®è¿™ä¸ªå»¶è¿Ÿï¼Œæˆ‘ä»¬å¤§è‡´èƒ½çŸ¥é“åˆ°è¯¥ç›®æ ‡èŒƒå›´ä¸»æœºçš„ç½‘ç»œçŠ¶å†µï¼Œå› æ­¤æˆ‘ä»¬åªéœ€è¦æ‰‹åŠ¨æŒ‡å®š--max-rtt-timeout, --initial-rtt-timeout ä¸ºæ¯”è¿™ä¸ªå»¶è¿Ÿå¤§ä¸€å®šç¨‹åº¦çš„å€¼å°±å¯ä»¥äº†ã€‚ä¾‹å¦‚å»¶è¿Ÿä¸º60æ¯«ç§’ï¼Œåˆ™æˆ‘ä»¬å¯ä»¥å°†å…¶æŒ‡å®šä¸º --max-rtt-timeout 200ms --initial-rtt-timeout 150msã€‚

â€‹		ä¸€ä¸ªå®Œæ•´çš„æ¡ˆä¾‹ï¼Œè§ [ã€ŠNNSã€‹ç¬¬å››ç« ï¼šç«¯å£æ‰«ææ¦‚è¿°â€”â€”æ¡ˆä¾‹ï¼šæ‰«æå¤§åž‹ç½‘ç»œä»¥æŸ¥æ‰¾æŸä¸ªå¼€æ”¾çš„TCPç«¯å£](https://nmap.org/book/solution-find-open-port.html)ã€‚

## 0x06 æ€»ç»“

â€‹		æœ¬æ–‡ç®—æ˜¯åŸºäºŽã€ŠNmap Network Scanningã€‹çš„è¯»åŽæ„Ÿå§ï¼Œå…¨ä¹¦å†…å®¹å¾ˆå¤šä¹Ÿå­¦åˆ°äº†å¾ˆå¤šï¼ŒåŒæ—¶ä¹Ÿå¯¹è‡ªå·±çš„ç›¸å…³çŸ¥è¯†è¿›è¡Œäº†ä¸€ä¸ªæ•´ç†ã€‚

â€‹		è¿™é‡Œè¿˜æœªæ¶‰åŠåˆ°NSEè„šæœ¬å¼•æ“Žï¼Œé‚£æ˜¯ä¸€ä¸ªå®è—ï¼Œå…·æœ‰å¾ˆå¥½çš„æ‰©å±•æ€§ï¼Œå¯ä»¥åŸºäºŽNSEè„šæœ¬å¼•æ“Žï¼Œå¼€å‘å®šåˆ¶åŒ–è‡ªå·±çš„è„šæœ¬ä»¥å®žçŽ°ç›¸åº”çš„åŠŸèƒ½ã€‚ç½‘ç»œä¸Šä¹Ÿæœ‰å¾ˆå¤šç›¸å…³çš„æ–‡ç« å¯ä»¥å­¦ä¹ å‚è€ƒã€‚

â€‹		è¿˜æœ‰ä¸€éƒ¨åˆ†å†…å®¹æ˜¯å…³äºŽé˜²ç«å¢™å’ŒIDSçš„å¯¹æŠ—æŠ€å·§ï¼Œè¿™éƒ¨åˆ†ç”±äºŽå®žè·µæ£€éªŒçš„æ¯”è¾ƒå°‘ï¼Œæ²¡ä»€ä¹ˆå‘è¨€æƒï¼Œå°±ä¸è¯´äº†ã€‚

â€‹		æœ€åŽï¼Œæ„Ÿè§‰å¤§å®¶çš„é˜…è¯»ï¼Œå¦‚æžœè§‰å¾—æœ¬æ–‡å†™çš„è¿˜å¯ä»¥ï¼Œå¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œéº»çƒ¦æ‚¨ç‚¹ä¸ªèµžï¼›å¦‚æžœæ‚¨æœ‰ä»»ä½•çš„æ‰¹è¯„ã€æ„è§å’Œå»ºè®®ï¼Œæ¬¢è¿Žåœ¨è¯„è®ºåŒºç•™è¨€ã€‚


---

> ä½œè€…: Xavier  
> URL: https://www.bthoughts.top/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/  

